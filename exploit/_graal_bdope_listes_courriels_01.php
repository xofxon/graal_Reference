<?php 
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_courriel_02";
$t_origines_ok[1]="_graal_fen_listes_courriels_01";
fa_acces_script();
$quellecouleur=fa_recup_param('quellecouleur','');
switch ($quellecouleur){
  case "verte"  : $genre="1";break;
  case "orange" : $genre="2";break;
  case "rouge"  : $genre="3";break;
  default:fa_redirige("acces_interdit");break;
}
$vl_c_action=fa_recup_param('vl_c_action','??????');
$vl_c_refweb=fa_recup_param('vl_c_refweb','');
$vl_e_type=intval(fa_recup_param('vl_e_type','0'));
$vf_c_echo='';
switch (TRUE) {
  case $vl_c_action=='??????':
    exit;
    break;    
  case $vl_c_action=='supprimer': 
    $sql_req = "DELETE FROM _courriel_re_listes WHERE refweb='$vl_c_refweb'";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vl_c_action=='ajouter':
    $sql_req = "INSERT INTO _courriel_re_listes set refweb='$vl_c_refweb',genre=$genre,type=$vl_e_type;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vl_c_action=="ajouter_kilometre":
    $vl_c_var=fa_recup_param('var','vs_tempo_panier_liste_expe');
    $vl_t_listecles=fa_recup_session("$vl_c_var",'');
    unset($_SESSION["$vl_c_var"]);
    $vl_e_i=-1;
    foreach($vl_t_listecles as $vl_raf) {
      $vl_e_i++;
      $sql_req = "INSERT INTO _courriel_re_listes set refweb='$vl_t_listecles[$vl_e_i]',genre=$genre,type=$vl_e_type;";
      $vf_c_echo.=_graal_exec_requete($sql_req);
    }
    break;
} 
_graal_ferme_connexion();
echo $vf_c_echo;       
?>
