<?php
_graal_requete_charge_varlib($id_fen_doc_fabr,$vl_e_uti_cleunik);
$vl_c_bqh_101=fa_recup_dico("bqh_101");
$vl_c_bqh_102=fa_recup_dico("bqh_102");
$vl_c_bqh_103=fa_recup_dico("bqh_103");
$vl_c_bqh_104=fa_recup_dico("bqh_104");
$vl_c_bqh_105=fa_recup_dico("bqh_105");
$vl_c_bqh_106=fa_recup_dico("bqh_106");
$vl_c_bqh_107=fa_recup_dico("bqh_107");
$vl_c_bqh_108=fa_recup_dico("bqh_108");
$vl_c_bqh_109=fa_recup_dico("bqh_109");
$vl_c_bqh_110=fa_recup_dico("bqh_110");
$vl_c_bqh_111=fa_recup_dico("bqh_111");
$vl_c_bqh_112=fa_recup_dico("bqh_112");
$vl_c_bqh_113=fa_recup_dico("bqh_113");
$vl_c_bqh_114=fa_recup_dico("bqh_114");
$vl_c_bqh_115=fa_recup_dico("bqh_115");
$vl_c_bqh_116=fa_recup_dico("bqh_116");
$vl_c_bqh_117=fa_recup_dico("bqh_117");
$vl_c_bqh_118=fa_recup_dico("bqh_118");
$vl_c_bqh_119=fa_recup_dico("bqh_119");
$vl_c_bqh_120=fa_recup_dico("bqh_120");
$vl_c_bqh_121=fa_recup_dico("bqh_121");
$vl_c_bqh_122=fa_recup_dico("bqh_122");
$vl_c_bqh_123=fa_recup_dico("bqh_123");
$vl_c_bqh_124=fa_recup_dico("bqh_124");
$vl_c_bqh_125=fa_recup_dico("bqh_125");
$vl_c_bqh_126=fa_recup_dico("bqh_126");
$vl_c_bqh_127=fa_recup_dico("bqh_127");
$vl_c_bqh_128=fa_recup_dico("bqh_128");
$vl_c_bqh_129=fa_recup_dico("bqh_129");
$vl_c_bqh_130=fa_recup_dico("bqh_130");
$vl_c_bqh_131=fa_recup_dico("bqh_131");
$vl_c_bqh_132=fa_recup_dico("bqh_132");


$vl_c_bqh_133=fa_recup_dico("bqh_133");
$vl_c_bqh_134=fa_recup_dico("bqh_134");
$vl_c_bqh_135=fa_recup_dico("bqh_135");
$vl_c_bqh_136=fa_recup_dico("bqh_136");
$vl_c_bqh_137=fa_recup_dico("bqh_137");
$vl_c_bqh_138=fa_recup_dico("bqh_138");
$vl_c_bqh_139=fa_recup_dico("bqh_139");
$vl_c_bqh_140=fa_recup_dico("bqh_140");
$vl_c_bqh_141=fa_recup_dico("bqh_141");
$vl_c_bqh_142=fa_recup_dico("bqh_142");
$vl_c_bqh_143=fa_recup_dico("bqh_143");
$vl_c_bqh_144=fa_recup_dico("bqh_144");
$vl_c_bqh_145=fa_recup_dico("bqh_145");
$vl_c_bqh_146=fa_recup_dico("bqh_146");
$vl_c_bqh_147=fa_recup_dico("bqh_147");
$vl_c_bqh_148=fa_recup_dico("bqh_148");
$vl_c_bqh_149=fa_recup_dico("bqh_149");
$vl_c_bqh_150=fa_recup_dico("bqh_150");
$vl_c_bqh_151=fa_recup_dico("bqh_151");
$vl_c_bqh_152=fa_recup_dico("bqh_152");
$vl_c_bqh_153=fa_recup_dico("bqh_153");
$vl_c_bqh_154=fa_recup_dico("bqh_154");
$vl_c_bqh_155=fa_recup_dico("bqh_155");$vl_c_bqh_155="Supprimer la fabrication";

$vl_c_dico_00002=fa_recup_dico("dico_00002");
$vl_c_dico_00003=fa_recup_dico("dico_00003");
$vl_c_dico_00004=fa_recup_dico("dico_00004");
$vl_c_dico_00005=fa_recup_dico("dico_00005");
$vl_c_dico_00006=fa_recup_dico("dico_00006");

$vl_c_dico_00107=fa_recup_dico("dico_00107");
$vl_c_dico_00108=fa_recup_dico("dico_00108");
$vl_c_dico_00109=fa_recup_dico("dico_00109");
$vl_c_dico_00110=fa_recup_dico("dico_00110");
$vl_c_dico_00115=fa_recup_dico("dico_00115");
$vl_c_dico_00120=fa_recup_dico("dico_00120");
$ml_statu_ligne_fab=fa_brik_menulist_choix('124',1,-1,-1,'','ml_fabr_ligne_statut',"broadcaster_02",0);
$vl_c_context_00=<<<EOT
  <popupset>
    <popup id="pop_arbre_act_cial_lignes">
      <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_act_cial_lignes');" />
    </popup>
  </popupset>
EOT;
$sql_req="SELECT f1.statut as statut from _actions f1 where action_cleunik=$vl_action_cleunik;";
$result = _graal_requete_bd($sql_req);
$row = mysql_fetch_assoc($result);
$statut_fab=$row['statut'];
_graal_libere_requete_bd($result);
$sql_req="select count(*) as nombre from _fab_lignes_nomenc f1 left join _fab_lignes f2 using(fab_ligne_cleunik) left join _fab_entetes f3 using (fab_cleunik) where f3.action_cleunik=$vl_action_cleunik and f1.statut <> -39";
$result = _graal_requete_bd($sql_req);
$row = mysql_fetch_assoc($result);
$nombre_fab_nomenc_pas_termine=$row['nombre'];
_graal_libere_requete_bd($result);
if (($statut_fab==-40)||($nombre_fab_nomenc_pas_termine==0)) {
  $boutons_fab="";
} else {
  $boutons_fab=<<<EOT
		<toolbarseparator />
    <hbox id="bloc_lignes">
      <toolbarbutton class="aa01" observes="broadcaster_01" id="tb_ligne_01" tooltiptext="$vl_c_bqh_125" oncommand="pf_fabr_ligne('nouveau');"/>
      <toolbarbutton class="aa01" observes="broadcaster_01" id="tb_ligne_02" tooltiptext="$vl_c_bqh_124" oncommand="pf_fabr_ligne('ouvrir');" />
			<toolbarbutton class="aa01" observes="broadcaster_01" id="tb_ligne_03" tooltiptext="$vl_c_bqh_154" oncommand="pf_fabr_ligne('supprimer');" />
    </hbox>
    <toolbarseparator />
    <button tooltiptext ="$vl_c_bqh_235" id="bt_fab_solde" label="$vl_c_bqh_235 $vl_c_bqh_122" oncommand="pf_fabr_solde();" observes="broadcaster_01"/><spacer flex="1"/>
EOT;
}
$sql_req="select count(*) as nombre from _fab_lignes_nomenc f1 left join _fab_lignes f2 using(fab_ligne_cleunik) left join _fab_entetes f3 using (fab_cleunik) left join _fab_lignes_nomenc_detail f4 on f1.fab_ligne_nomenc_cleunik=f4.fab_ligne_nomenc_cleunik where (f4.quantite_fabriq_saisie<>0 or f4.quantite_rebute_saisie<>0) and f3.action_cleunik=$vl_action_cleunik;";
$result = _graal_requete_bd($sql_req);
$row = mysql_fetch_assoc($result);
$nombre=$row['nombre'];
_graal_libere_requete_bd($result);

if ($nombre==0){
	$vl_c_supprime_fabrication="<button observes='broadcaster_01' class='supprimer' id='bt_supprime_fabrication' tooltiptext ='$vl_c_bqh_155 $nombre' label='$vl_c_bqh_155' oncommand='pf_validation(".'"supprimer"'.")'/>";
} else {
	$vl_c_supprime_fabrication="";
}
$vl_c_enregistrer="<button observes='broadcaster_01' class='enregistrer' id='bt_val_nomencfab' tooltiptext ='$vl_c_dico_00005' label='$vl_c_dico_00005' oncommand='pf_fabr_ligne_valider()'/>";
$vl_c_annuler="<button observes='broadcaster_01' class='annuler' id='bt_nomencfab_annuler' tooltiptext ='$vl_c_dico_00006' label='$vl_c_dico_00006' oncommand='pf_fabr_ligne_annuler()'/>";
$ml_statut_fabr=fa_brik_menulist_choix('124',1,-1,-1,'','ml_statut_fabr',"broadcaster_01",0);
$vl_c_xml=simplexml_load_string(fa_recup_session("vs_param_environ",""));
$selection_article=fa_ent_xml($vl_c_xml->selection_article->attributes());

echo <<<END
$vl_c_context_00
<vbox flex="1" class="overflow_01">
<tabbox id="tabbox_02" flex="1" orient="vertical" class="overflow_01">
  <tabs id="tab_act_fabr">
    <tab class="" id="tab_act_fabr_entete" linkedpanel="tabpanel_act_fabr_entete" label="$vl_c_bqh_101" selected="true" first-tab="true" />
    <tab class="" id="tab_act_fabr_lignes" linkedpanel="tabpanel_act_fabr_lignes" label="$vl_c_bqh_102"/>
    <tab class="" id="tab_act_fabr_divers" linkedpanel="tabpanel_act_fabr_divers" label="$vl_c_bqh_103" collapsed="true"/>
  </tabs>
  <tabpanels flex="1">
  	<tabpanel id="tabpanel_act_fabr_entete" orient="vertical">
			<vbox flex="1">
				<hbox> 
			    <label control="la_fabr_entete_code" value="$vl_c_bqh_104"/>
			    <textbox flex="1" observes="broadcaster_02" id="tb_fabr_entete_code"   _graal_fab_cleunik="0" _graal_fab_ligne_cleunik="0"/>
					$ml_statu_ligne_fab
					$vl_c_supprime_fabrication
			  </hbox>
				<hbox> 
			    <label control="la_fabr_entete_date_crea" value="$vl_c_bqh_105"/>
			    <textbox flex="1" id="tb_fabr_entete_date_creation" readonly="true"/>
			    <label control="la_fabr_entete_date_modi" value="$vl_c_bqh_106"/>
			    <textbox flex="1" id="tb_fabr_entete_date_modifica" readonly="true"/>
			  </hbox>
				<vbox flex="1"> 
			    <label control="la_fabr_entete_blocnotebrut" value="$vl_c_bqh_107"/>
			    <textbox flex="1" observes="broadcaster_02" id="tb_fabr_entete_blocnotebrut"   multiline="true"/>
			  </vbox>
				<hbox> 
			    <label control="la_fabr_ligne_code_article" value="$vl_c_bqh_108"/>
			    <textbox flex="1" id="tb_fabr_ligne_code_article" readonly="true"/>
			    <textbox flex="3" id="tb_fabr_ligne_desc_article" readonly="true"/>
			  </hbox>
				<hbox>
  				<label value="$vl_c_bqh_109"/>
  				<textbox flex="1" min="-Infinity" _graal_qte_init="0" disabled="true" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_fabr_ligne_qte_lancee"   />
  				<label value="$vl_c_bqh_110"/>
  				<textbox flex="1" min="-Infinity" _graal_qte_init="0" observes="broadcaster_02" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_fabr_ligne_qte_fabriq"   />
  				<label value="$vl_c_bqh_126"/>
  				<textbox flex="1" min="-Infinity" _graal_qte_init="0" observes="broadcaster_02" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_fabr_ligne_qte_rebute"   />
					<label value="$vl_c_bqh_111"/>
  				<textbox flex="1" observes="broadcaster_02" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_fabr_ligne_pu"   />
				</hbox>
				<vbox flex="1"> 
			    <label control="la_fabr_ligne_blocnotebrut" value="$vl_c_bqh_112"/>
			    <textbox flex="1" observes="broadcaster_02" id="tb_fabr_ligne_blocnotebrut"   multiline="true"/>
			  </vbox>
			</vbox>
		</tabpanel>


<tabpanel id="tabpanel_act_fabr_lignes">
   <vbox flex="1">
      <deck id="deck_saisie_fab_01" selectedIndex="0" flex="1">
			<vbox label="raf pour dire boite deck 01">
			<toolbar grippyhidden="true">
  		  <toolbarbutton class="table-rafraichir" tooltiptext="$vl_c_bqh_123" raf_oncommand="pf_cial_affiche_lignes();"/>
				$boutons_fab
      </toolbar>
			  <tree id="arbre_fabric_lignes_nomenc" flex="1" flags="" ref="*" querytype="xml" datasources="" enableColumnDrag="true" context="pop_arbre_act_cial_lignes" hidecolumnpicker="false" ondblclick="pf_fabr_ligne('ouvrir');" observes="broadcaster_01">
	        <treecols>
	          <treecol hidden="true" id="tc_fab_ligne_nomenc_cleunik" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol hidden="true" id="tc_art_cleunik_fils" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol id="tc_noligne" class="centre" label="$vl_c_bqh_113" sort="?noligne" /><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol id="tc_code_article_fils" label="$vl_c_bqh_114" sort="?code_article_fils" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol id="tc_description_article_fils" label="$vl_c_bqh_115" sort="?description_article_fils" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol id="tc_quantite_lancee" class="droite" label="$vl_c_bqh_116" sort="?quantite_lancee" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol id="tc_quantite_fabriq" hidden="true" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol id="tc_quantite_rebute" hidden="true" /><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol id="tc_cumul_quantite_fabriq_saisie" class="droite" label="$vl_c_bqh_117" sort="?cumul_quantite_fabriq_saisie" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol id="tc_cumul_quantite_rebute_saisie" class="droite" label="$vl_c_bqh_118" sort="?cumul_quantite_rebute_saisie" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol id="tc_statut" label="$vl_c_bqh_119" sort="?statut"/><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol id="tc_unite_quantite" label="$vl_c_bqh_120" sort="?unite_quantite" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol id="tc_pu" class="droite" label="$vl_c_bqh_121" sort="?pu" /><splitter class="tree-splitter" resizeafter="grow"/>
	        </treecols>
	        <template><query expr="*"/><action>
	          <treechildren>
	            <treeitem uri="?" seltype="single">
	              <treerow>
	                <treecell label="?fab_ligne_nomenc_cleunik"/>
	                <treecell label="?art_cleunik_fils"/>
	                <treecell label="?noligne"/>
	                <treecell label="?code_article_fils"/>
	                <treecell label="?description_article_fils"/>
	                <treecell label="?quantite_lancee"/>
	                <treecell label="?quantite_fabriq"/>
	                <treecell label="?quantite_rebute"/>
									<treecell label="?cumul_quantite_fabriq_saisie"/>
	                <treecell label="?cumul_quantite_rebute_saisie"/>
	                <treecell label="?statut"/>
	                <treecell label="?unite_quantite"/>
	                <treecell label="?pu"/>
	              </treerow>
	            </treeitem>
	          </treechildren>
	        </action></template>
	      </tree>
			</vbox>
			<vbox label="raf pour dire boite deck 02">
				<vbox>
  				<vbox>
						<hbox>
						<label value="$vl_c_bqh_109"/>
	  				<textbox flex="1" min="-Infinity" disabled="true" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_deja_fabr_ligne_qte_lancee"   />
						<label value="$vl_c_bqh_129"/>
	  				<textbox flex="1" min="-Infinity" disabled="true" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_deja_fabr_ligne_qte_fabriq"   />
						<label value="$vl_c_bqh_130"/>
	  				<textbox flex="1" min="-Infinity" disabled="true" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_deja_fabr_ligne_qte_rebute"   />
  					</hbox>
					</vbox>
					<vbox>
					
								
					
						<hbox>
						<label value="$vl_c_bqh_110"/>
	  				<textbox flex="1" min="-Infinity" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_fabr_ligne_qte_fabriq_saisie"  onblur="pf_fabr_statut();" />
	  				<label value="$vl_c_bqh_128"/>
	  				<textbox flex="1" min="-Infinity" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_fabr_ligne_qte_rebute_saisie"  onblur="pf_fabr_statut();" />
						<menulist sizetopopup="none" crop="end" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="1" id="ml_saisie_fabr_ligne_statut" _graal_nombre="2">
							<menupopup>
								<menuitem crop="none" value="En cours" id="-23" _graal_cleunik="-23" label="En cours" selected="true"/>
								<menuitem crop="none" value="Traitement soldé" id="-40" _graal_cleunik="-40" label="Traitement soldé"/>
							</menupopup>
						</menulist>
						<button id="bt_fabr_calcul_nombre" label="$vl_c_bqh_131" oncommand="pf_fabr_nomenc_saisie();"/>
						</hbox>
						<hbox flex="1">
                  <label value="$vl_c_ben_110"/>
                  <hbox>
            				<spacer flex="1"/>
							<datepicker type="popup" monthLeadingZero="true" dateLeadingZero="true" observes="broadcaster_01" id="dp_dat_deb_fabriq"/>
            				<spacer flex="1"/>
            			</hbox>                  
                  <label value="$vl_c_ben_111"/>
                  <toolbarbutton id="tb_debut_maintenant_fabriq" class="ag04" tooltiptext="$vl_c_ben_121" oncommand="pf_maintenant(this.id)"/>
				  <timepicker is24HourClock="true" id="tb_heu_deb_fabriq" observes="broadcaster_01"/>
             </hbox>
					</vbox>
				</vbox>
				<tree id="arbre_saisie_fabric_lignes_nomenc" editable="true" flex="1" flags="" ref="*" querytype="xml" datasources="" enableColumnDrag="true" context="pop_saisie_fabric_lignes_nomenc" hidecolumnpicker="false">
	        <treecols>
	          <treecol editable="false" hidden="true" id="tc_fab_ligne_nomenc_cleunik" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol editable="false" hidden="true" id="tc_art_cleunik_fils" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" id="tc_noligne" class="centre" label="$vl_c_bqh_113" sort="?noligne" /><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" id="tc_code_article_fils" label="$vl_c_bqh_114" sort="?code_article_fils" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol editable="false" id="tc_description_article_fils" label="$vl_c_bqh_115" sort="?description_article_fils" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol editable="false" id="tc_quantite_lancee" class="droite" label="$vl_c_bqh_116" sort="?quantite_lancee" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol editable="true" id="tc_quantite_fabriq" class="droite" label="$vl_c_bqh_127" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol editable="true" id="tc_quantite_rebute" class="droite" label="$vl_c_bqh_132" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol editable="false" hidden="true" id="tc_statut" label="$vl_c_bqh_119" sort="?statut" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol editable="false" id="tc_unite_quantite" label="$vl_c_bqh_120" sort="?unite_quantite" /><splitter class="tree-splitter" resizeafter="grow"/>
	          <treecol editable="false" id="tc_pu" class="droite" label="$vl_c_bqh_121" sort="?pu" /><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" hidden="true" id="tc_valeur_complement_type" label="Type"/><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" id="tc_valeur_complement_type_clair" label="Type" /><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" id="tc_valeur_complement" class="droite" label="Complément"/><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" hidden="true" id="tc_fab_hg" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" hidden="true" id="tc_fab_base_valorisation" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" hidden="true" id="tc_fab_nb_decimales_qte" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" hidden="true" id="tc_fab_nbdec_pu" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
						<treecol editable="false" id="tc_unite_quantite_lib" label="$vl_c_bqh_120" sort="?unite_quantite" /><splitter class="tree-splitter" resizeafter="grow"/>
	        </treecols>
	        <template><query expr="*"/><action>
	          <treechildren>
	            <treeitem uri="?" seltype="single">
	              <treerow>
	                <treecell label="?fab_ligne_nomenc_cleunik"/>
	                <treecell label="?art_cleunik_fils"/>
	                <treecell label="?noligne"/>
	                <treecell label="?code_article_fils"/>
	                <treecell label="?description_article_fils"/>
	                <treecell label="?quantite_lancee"/>
	                <treecell label="?quantite_fabriq"/>
	                <treecell label="?quantite_rebute"/>
	                <treecell label="?statut"/>
	                <treecell label="?unite_quantite"/>
	                <treecell label="?pu"/>
									<treecell label="?valeur_complement_type"/>
									<treecell label="?valeur_complement_type_clair"/>
	                <treecell label="?valeur_complement"/>
									<treecell label="?hg"/>
									<treecell label="?base_valorisation"/>
									<treecell label="?nb_decimales_qte"/>
									<treecell label="?nbdec_pu"/>
									<treecell label="?unite_quantite_lib"/>
	              </treerow>
	            </treeitem>
	          </treechildren>
	        </action></template>
	      </tree>
				<hbox>
					<label value="$vl_c_bqh_111 brut"/>
  				<textbox flex="1" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_fabr_ligne_pu_saisie_bru"   disabled="true"/>
					<label value="$vl_c_bqh_111 net"/>
					<textbox flex="1" type="number" hidespinbuttons="true" decimalplaces="2" id="tb_fabr_ligne_pu_saisie_net"   disabled="true"/>
					<button flex="1" id="bt_fabr_calule_pu" label="Calculer" oncommand="pf_fabr_valorise_saisie();"/>
				</hbox>
				<hbox>
					<button flex="1" class="ac07" id="bt_fabr_solde_annule" label="Annuler" oncommand="pf_fabr_solde_annule();"/>
					<button flex="1" class="ac05" id="bt_fabr_solde_valide" label="Valider la saisie de toutes les lignes" oncommand="pf_fabr_solde_valide();" collapsed="true"/>
				</hbox>
			</vbox>
			<vbox label="raf pour dire boite deck 03">
			
			<groupbox flex="1">
  			<caption><label value="$vl_c_bqh_133"/></caption>
        <grid flex="1">
          <columns >
           <column flex="1" />
           <column flex="4" />
          </columns>
          <rows>
           <row>
             <label value="$vl_c_bqh_134"/>
             <textbox observes="broadcaster_02" id="tb_nomencfab_noligne" type="number" hidespinbuttons="true" size="3"   />
           </row>
           <row id="row_selection_article" collapsed="true">
            <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' observes="broadcaster_02" flex="1" id="selart_nomenc_fab_ml_zone" class="normal" oncommand="pf_param_choix_selart_nomenc_fab();" value="$selection_article">
              <menupopup>
                <menuitem label="$vl_c_bqh_135" value="1"/>
                <menuitem label="$vl_c_bqh_136" value="2"/>
                <menuitem label="$vl_c_bqh_137" value="3"/>
              </menupopup>
            </menulist>

            <hbox>
            <textbox observes="broadcaster_02" flex="1" type="autosuggest" autosuggestsearch="" autosuggestparam="recherche" autosuggestlimit="limit" limit="50"
              minlength="2"
              maxrows="50"
              ref="urn:suggest:values"
              label="?label"
              properties="?prop"
              issuggest="?issuggest"
              _graal_cleunik=""
              id="selart_nomenc_fab"
            />
            <button observes="broadcaster_02" class="ad02" oncommand="pf_fabr_nomclaturefab_sel_article_pour_ligne();"/>
            </hbox>
           </row>
           <row>
             <label value="$vl_c_bqh_136"/>
             <textbox readonly="true" id="tb_nomencfab_codefils"   />
           </row>
           <row>
             <label value="$vl_c_bqh_135"/>
             <textbox readonly="true" id="tb_nomencfab_descourfils"   />
           </row>
					 <row>
             <label value="$vl_c_bqh_141"/>
              <textbox observes="broadcaster_02" id="tb_nomencfab_nbdecimales" type="number" max="4" min="0"  onblur="pf_fabr_change_nombre_decimales();"/>
           </row>
					 <row>
             <label value="$vl_c_bqh_138"/>
            	<textbox min="-Infinity" disabled="true" id="tb_nomencfab_quantite_lancee" type="number" hidespinbuttons="true" decimalplaces="2"/>
           </row>
           <row>
             <label value="$vl_c_bqh_139"/>
							<hbox flex="1">
						 		<label value="$vl_c_bqh_153" id="la_nomencfab_quantite_fabriq_deja"/>
	              <textbox min="-Infinity" disabled="true" id="tb_nomencfab_quantite_fabriq_deja" type="number" hidespinbuttons="true" decimalplaces="2"/>
								<textbox min="-Infinity" observes="broadcaster_02" id="tb_nomencfab_quantite_fabriq" type="number" hidespinbuttons="true" decimalplaces="2"  onblur="pf_fabr_nomenclaturefab_valorise();" flex="1" />
							</hbox>
           </row>
           <row>
             <label value="$vl_c_bqh_140"/>
						 <hbox flex="1">
						 		<label value="$vl_c_bqh_153" id="la_nomencfab_quantite_rebute_deja"/>
             		<textbox min="-Infinity" disabled="true" id="tb_nomencfab_quantite_rebute_deja" type="number" hidespinbuttons="true" decimalplaces="2"/>
								<textbox min="-Infinity" observes="broadcaster_02" id="tb_nomencfab_quantite_rebute" type="number" hidespinbuttons="true" decimalplaces="2" onblur="pf_fabr_nomenclaturefab_valorise();" flex="1"/>
							</hbox>
           </row>
					 <row>
              <label value="$vl_c_ben_110"/>
              <hbox>
			  <datepicker type="popup" monthLeadingZero="true" dateLeadingZero="true" observes="broadcaster_01" id="dp_dat_deb_fabriq_ligne"/>
                <label value="$vl_c_ben_111"/>
                <toolbarbutton id="tb_debut_maintenant_fabriq_ligne" class="ag04" tooltiptext="$vl_c_ben_121" oncommand="pf_maintenant(this.id)"/>
				<timepicker is24HourClock="true" id="tb_heu_deb_fabriq_ligne" observes="broadcaster_01"/>
								<label value="$vl_c_bqh_119"/>
								 $ml_statut_fabr
							</hbox>
					 </row>
					 <row>
					 <label value="$vl_c_bqh_142"/>
                <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' observes="broadcaster_02" flex="1" id="ml_nomencfab_arrondi_fab" class="normal" _graal_nombre="3">
              <menupopup>
                <menuitem label="$vl_c_bqh_143" value="1" selected="true"/>
                <menuitem label="$vl_c_bqh_144" value="2" />
								<menuitem label="$vl_c_bqh_145" value="3" />
              </menupopup>
            </menulist>
					</row>	
           <row>
             <label value="$vl_c_bqh_146"/>
                <hbox>
                  <textbox id="tb_nomencfab_valorisation" type="number" hidespinbuttons="true" decimalplaces="2" readonly="true"  onblur="pf_fabr_nomenclaturefab_valorise();" _graal_base_valorisation=""/>
                  <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' observes="broadcaster_02" flex="1" id="ml_nomencfab_base_valorisation" oncommand="pf_fabr_change_menu_actifs_nomencfab_base_valorisation();" flags="" ref="*" querytype="xml" datasources="">
                    <template><query expr="*"/><action>
                      <menupopup>
                        <menuitem uri="?" class="menuitem-iconic ?prop" _graal_nombre="?nombre" label="?tar_designation" value="?tar_cleunik" _graal_cleunik="?tar_cleunik" _graal_base_valorisation="?pu_reference"/> <!--  Les tarifs -->
                      </menupopup>
                    </action></template>
                  </menulist>
                  
                </hbox>
            </row>
           <row>
             <label value="$vl_c_bqh_147"/>
             <hbox>
               <textbox observes="broadcaster_02" id="tb_nomencfab_valeur_complement" type="number" hidespinbuttons="true" decimalplaces="2"  onblur="pf_fabr_nomenclaturefab_valorise();" />
               <label value="Type"/>
                <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' observes="broadcaster_02" flex="1" id="ml_nomencfab_valeur_complement_type" class="normal" oncommand="pf_fabr_nomenclaturefab_valorise();">
              <menupopup>
                <menuitem label="$vl_c_bqh_148" value="1" selected="true"/>
                <menuitem label="$vl_c_bqh_149" value="2" />
              </menupopup>
            </menulist>
            </hbox>
            </row>
           <row>
             <label value="$vl_c_bqh_150"/>
                <hbox>
                  <textbox id="tb_nomencfab_valeurligne" type="number" hidespinbuttons="true" decimalplaces="2" readonly="true"  />
                  <_graal_raf flex="1" />
                </hbox>
            </row>

           <row flex= "10">
             <label value="$vl_c_bqh_151"/>
             <textbox observes="broadcaster_02" id="tb_nomencfab_blocnotebrut" multiline="true" row="10"   flex="1"/>
           </row>
          </rows>
        </grid>
<hbox>
$vl_c_enregistrer<spacer flex="1"/>
$vl_c_annuler<spacer flex="1"/>
</hbox>
</groupbox>
			
			
			
			
			
			
			
			
			
			
			</vbox>
		</deck>	
    </vbox>
  </tabpanel>
  <tabpanel id="tabpanel_act_fabr_divers" class="overflow_01" orient="vertical">
	</tabpanel>
          </tabpanels>
        </tabbox>
</vbox>
END;
?>
