<?php
include("_graal_header_xml.inc.php");
define('EOL', "\r\n");
$vl_c_recherche=fa_recup_param('vl_c_recherche','');
// execution de la requète SQL
//select action_cleunik as action_cleunik,MATCH(description) AGAINST ('BRELOT') as score from _action where MATCH(description) AGAINST ('BRELOT')
$sql_req = "select doc_cleunik as doc_cleunik,titre as titre,descriptif_sommaire as descriptif_sommaire,MATCH(doc_brut) AGAINST ('$vl_c_recherche') as score from _documents_texte where MATCH(doc_brut) AGAINST ('$vl_c_recherche')";
$result = _graal_requete_bd($sql_req);
echo(fa_xcree_entete_rdf());
  // boucle de récupération des enregistrements de la requête et génération du contenu RDF
  while ($row = mysql_fetch_assoc($result))
    {
      echo('<RDF:li>'.EOL);
      echo('<RDF:Description>');
      echo('<row:doc_cleunik NC:parseType="Integer">'.fa_ent_xml($row['doc_cleunik']).'</row:doc_cleunik>');
      echo('<row:titre>'.fa_ent_xml($row['titre']).'</row:titre>');
      echo('<row:descriptif_sommaire>'.fa_ent_xml($row['descriptif_sommaire']).'</row:descriptif_sommaire>');
      echo('<row:score>'.fa_ent_xml($row['score']).'</row:score>');
      echo('</RDF:Description>'.EOL);
      echo('</RDF:li>'.EOL);
    }
echo('</RDF:Bag>'.EOL);
echo('</RDF:RDF>'.EOL);
_graal_libere_requete_bd($result);
_graal_ferme_connexion();
?>
