<?php
include("_graal_header_xul.inc.php");
$vl_c_quelsdocs=fa_recup_param('quelsdocs','?');
$vl_e_nomcomplet=fa_recup_session('vs_nomcomplet','tesquiconnard?');
$vs_envaa=fa_recup_session('vs_envaa','0');	//	Nombre d'utilisateurs
$vl_e_doc_cleunik=fa_recup_param('doc_cleunik','A');
$vl_e_portee_cleunik=fa_recup_param('portee_cleunik','0');
$vl_c_genre=fa_recup_param('genre','utilis');
switch ($vl_c_quelsdocs){
  case "unlien_action"  : $vl_c_id_fenetre="Fen_00428";$vl_c_id_inc_doc_06="Div_00012";$vl_c_id_graal_inc_ged_criteres_entreprise="Div_00346";$vl_c_id_graal_inc_ged_criteres_lesmiens="Div_00349";$vl_c_id_graal_inc_ged_criteres_lesautres="Div_00352";$vl_c_id_graal_inc_ged_criteres_tous="Div_00377";$vl_c_tab_hidden="true";$class_tabedition="ah05";break;   //  Un lien d'acteur
  case "unlien_interl"  : $vl_c_id_fenetre="Fen_00415";$vl_c_id_inc_doc_06="Div_00012";$vl_c_id_graal_inc_ged_criteres_entreprise="Div_00346";$vl_c_id_graal_inc_ged_criteres_lesmiens="Div_00349";$vl_c_id_graal_inc_ged_criteres_lesautres="Div_00352";$vl_c_id_graal_inc_ged_criteres_tous="Div_00377";$vl_c_tab_hidden="true";$class_tabedition="ah05";break;   //  Un lien d'acteur
  case "unlien_articl"  : $vl_c_id_fenetre="Fen_00412";$vl_c_id_inc_doc_06="Div_00012";$vl_c_id_graal_inc_ged_criteres_entreprise="Div_00346";$vl_c_id_graal_inc_ged_criteres_lesmiens="Div_00349";$vl_c_id_graal_inc_ged_criteres_lesautres="Div_00352";$vl_c_id_graal_inc_ged_criteres_tous="Div_00377";$vl_c_tab_hidden="true";$class_tabedition="ah05";break;   //  Un lien d'acteur
  case "unlien_acteur"  : $vl_c_id_fenetre="Fen_00409";$vl_c_id_inc_doc_06="Div_00012";$vl_c_id_graal_inc_ged_criteres_entreprise="Div_00346";$vl_c_id_graal_inc_ged_criteres_lesmiens="Div_00349";$vl_c_id_graal_inc_ged_criteres_lesautres="Div_00352";$vl_c_id_graal_inc_ged_criteres_tous="Div_00377";$vl_c_tab_hidden="true";$class_tabedition="ah05";break;   //  Un lien d'acteur
  case "unlien"         : $vl_c_id_fenetre="Fen_00082";$vl_c_id_inc_doc_06="Div_00012";$vl_c_id_graal_inc_ged_criteres_entreprise="Div_00346";$vl_c_id_graal_inc_ged_criteres_lesmiens="Div_00349";$vl_c_id_graal_inc_ged_criteres_lesautres="Div_00352";$vl_c_id_graal_inc_ged_criteres_tous="Div_00377";$vl_c_tab_hidden="true";$class_tabedition="ah05";break;   //  Un lien sélectionné
  case "mesliens"       : $vl_c_id_fenetre="Fen_00082";$vl_c_id_inc_doc_06="Div_00012";$vl_c_id_graal_inc_ged_criteres_entreprise="Div_00346";$vl_c_id_graal_inc_ged_criteres_lesmiens="Div_00349";$vl_c_id_graal_inc_ged_criteres_lesautres="Div_00352";$vl_c_id_graal_inc_ged_criteres_tous="Div_00377";$vl_c_tab_hidden="false";$class_tabedition="bb08";break;  //Mes pseudos-documents (liens internets)
  case "nosliens"       : $vl_c_id_fenetre="Fen_00083";$vl_c_id_inc_doc_06="Div_00359";$vl_c_id_graal_inc_ged_criteres_entreprise="Div_00346";$vl_c_id_graal_inc_ged_criteres_lesmiens="Div_00349";$vl_c_id_graal_inc_ged_criteres_lesautres="Div_00352";$vl_c_id_graal_inc_ged_criteres_tous="Div_00377";$vl_c_tab_hidden="false";$class_tabedition="bb09";break;  // Nos pseudos-documents (liens internets) 
  case "leurliens"      : $vl_c_id_fenetre="Fen_00084";$vl_c_id_inc_doc_06="Div_00360";$vl_c_id_graal_inc_ged_criteres_entreprise="Div_00346";$vl_c_id_graal_inc_ged_criteres_lesmiens="Div_00349";$vl_c_id_graal_inc_ged_criteres_lesautres="Div_00352";$vl_c_id_graal_inc_ged_criteres_tous="Div_00377";$vl_c_tab_hidden="false";$class_tabedition="bc01";break; //  Leurs pseudos-documents (liens internets)
  case "unlien_entrep"  : $vl_c_id_fenetre="Fen_00419";$vl_c_id_inc_doc_06="Div_00012";$vl_c_id_graal_inc_ged_criteres_entreprise="Div_00346";$vl_c_id_graal_inc_ged_criteres_lesmiens="Div_00349";$vl_c_id_graal_inc_ged_criteres_lesautres="Div_00352";$vl_c_id_graal_inc_ged_criteres_tous="Div_00377";$vl_c_tab_hidden="true";$class_tabedition="ah05";break;   //  Un lien d'acteur
  default : fa_redirige("acces_interdit");break;
}
$vl_tc_composants=array($vl_c_id_inc_doc_06,$vl_c_id_graal_inc_ged_criteres_entreprise,$vl_c_id_graal_inc_ged_criteres_lesmiens,$vl_c_id_graal_inc_ged_criteres_lesautres,$vl_c_id_graal_inc_ged_criteres_tous);
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=1;
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_aab_100=fa_recup_dico("aab_100");
$vl_c_aab_101=fa_recup_dico("aab_101");
$vl_c_aab_102=fa_recup_dico("aab_102");
$vl_c_aab_103=fa_recup_dico("aab_103");
$vl_c_aab_104=fa_recup_dico("aab_104");
$vl_c_aab_105=fa_recup_dico("aab_105");
$vl_c_aab_106=fa_recup_dico("aab_106");
$vl_c_aab_107=fa_recup_dico("aab_107");
$vl_c_aab_108=fa_recup_dico("aab_108");
$vl_c_aab_109=fa_recup_dico("aab_109");
$vl_c_aab_110=fa_recup_dico("aab_110");
$vl_c_aab_111=fa_recup_dico("aab_111");
$vl_c_aab_112=fa_recup_dico("aab_112");
$vl_c_aab_113=fa_recup_dico("aab_113");
$vl_c_aab_114=fa_recup_dico("aab_114");
$vl_c_aab_115=fa_recup_dico("aab_115");
$vl_c_aab_116=fa_recup_dico("aab_116");
$vl_c_aab_117=fa_recup_dico("aab_117");
$vl_c_aab_120=fa_recup_dico("aab_120");
$vl_c_aab_121=fa_recup_dico("aab_121");
$vl_c_aab_122=fa_recup_dico("aab_122");
$vl_c_aab_123=fa_recup_dico("aab_123");
$vl_c_aab_124=fa_recup_dico("aab_124");
$vl_c_aab_125=fa_recup_dico("aab_125");
$vl_c_aab_126=fa_recup_dico("aab_126");
$vl_c_aab_127=fa_recup_dico("aab_127");
$vl_c_aab_128=fa_recup_dico("aab_128");
$vl_c_aab_130=fa_recup_dico("aab_130");
$vl_c_aab_131=fa_recup_dico("aab_131");
$vl_c_aab_132=fa_recup_dico("aab_132");
$vl_c_aab_133=fa_recup_dico("aab_133");
$vl_c_aab_134=fa_recup_dico("aab_134");
$vl_c_aab_135=fa_recup_dico("aab_135");
$vl_c_aab_136=fa_recup_dico("aab_136");
$vl_c_aab_137=fa_recup_dico("aab_137");
$vl_c_aab_138=fa_recup_dico("aab_138");
$vl_c_aab_139=fa_recup_dico("aab_139");
$vl_c_aab_140=fa_recup_dico("aab_140");
$vl_c_aab_145=fa_recup_dico("aab_145");

$vl_c_aab_150=fa_recup_dico("aab_150");
$vl_c_aab_151=fa_recup_dico("aab_151");
$vl_c_aab_152=fa_recup_dico("aab_152");
$vl_c_aab_153=fa_recup_dico("aab_153");
$vl_c_aab_154=fa_recup_dico("aab_154");
$vl_c_aab_155=fa_recup_dico("aab_155");

$vl_c_aab_163=fa_recup_dico("aab_163");
$vl_c_aab_164=fa_recup_dico("aab_164");
$vl_c_aab_165=fa_recup_dico("aab_165");
$vl_c_aab_166=fa_recup_dico("aab_166");
$vl_c_aab_167=fa_recup_dico("aab_167");
$vl_c_aab_168=fa_recup_dico("aab_168");
$vl_c_aab_169=fa_recup_dico("aab_169");
$vl_c_aab_170=fa_recup_dico("aab_170");$vl_c_aab_170="Ajouter à un dossier";
$vl_c_dico_00058=fa_recup_dico("dico_00058");
$vl_c_dico_00059=fa_recup_dico("dico_00059");
$vl_c_dico_00073=fa_recup_dico("dico_00073");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
switch ($vl_c_quelsdocs){
  case "unlien_acteur"  : $vl_c_qui=_graal_requete_acteur($vl_e_portee_cleunik);break;   //  Un lien d'acteur
  case "unlien_articl"  : $vl_c_qui="";break;   //  Un lien d'article
  case "unlien_interl"  : $vl_c_qui="";break;   //  Un lien d'interlocuteur
  case "unlien_action"  : $vl_c_qui="";break;   //  Un lien d'action
}
$vl_c_aab_100.=$vl_c_qui;
$vl_c_context_00='<popupset><popup id="pop_arbre_des_connexions"><menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\'arbre_des_connexions\');" /></popup></popupset>';
$vl_b_infos_01_hidden="true";
include("_graal_header_winxul.inc.php");
echo <<<END
<window context="graal_cp00" id="_graal_fen_pseudodocs_01" onload="fa_aa(this);pf_etat_fen('ini')" title="$vl_c_aab_100" _graal_lesquels="$vl_c_quelsdocs" _graal_typedoc="1" $c_xmlns> 
$vl_c_graal_cp00
$vl_c_context_00
<broadcasterset><broadcaster id="broadcaster_01" /></broadcasterset>
END;
include("_graal_visites.inc.php");

include_once("js/_graal_01.js.php");
include("js/_graal_pseudodocs_01.js.php");
include_once("js/_graal_07_ged.js.php");
echo('<vbox id="vb_tableau" flex="10" hidden="'.$vl_c_tab_hidden.'">');
include("_graal_inc_doc_06.php");
echo <<<END
</vbox>
<splitter ondblclick="pf_cache_tab()" hidden="$vl_c_tab_hidden"/>
<hbox flex="1">

  <tabbox id="tabbox_01" flex="1" orient="vertical" class="overflow_01">
    <tabs id="tab_infogene">
       <tab class="$class_tabedition" id="tab_edition" linkedpanel="tabpanel_edition" first-tab="true" label="$vl_c_aab_100" selected="true"/>
       <tab class="al01" id="tab_criteres" linkedpanel="tabpanel_critere" label="$vl_c_aab_137"/>
       <tab class="al12" id="tab_commentaires" linkedpanel="tabpanel_commentaires" label="$vl_c_aab_139"/>
			 <tab class="am08" id="tab_connexions" linkedpanel="tabpanel_connexions" label="$vl_c_aab_145"/>
    </tabs>
    <tabpanels flex="1">
  		<tabpanel id="tabpanel_edition" flex="1">
        <vbox flex="1">


<menubar id="menu_menus" >
<toolbarseparator />
  <menu id="menu_02" observes="broadcaster_01" label="$vl_c_aab_114" accesskey="C" >
   <menupopup>
  <menuitem id="menu_02_01" label="$vl_c_aab_115" oncommand="pf_action('droits')" />
  <menuseparator id="menu_02_07"/>
  <menuitem id="menu_02_09" label="$vl_c_aab_135" class="menuitem-iconic ak08" oncommand="pf_action('favoris_ajout')" />
  <menuitem id="menu_02_10" label="$vl_c_aab_136" class="menuitem-iconic ak09" oncommand="pf_action('favoris_supprimer')" />
  <menuitem id="menu_02_05" label="$vl_c_aab_170" class="menuitem-iconic aj01" oncommand="pf_action('dossier_ajouter')" />
  <menuseparator id="menu_02_11"/>
  <menuitem id="menu_02_06" label="$vl_c_aab_116" oncommand="pf_action('recup_titre')" />
  <menuitem id="menu_02_04" label="$vl_c_aab_117" oncommand="pf_action('meta_description')" />
  <menuseparator id="menu_02_08"/>
  <menuitem id="menu_02_03" disabled="true" label="$vl_c_aab_120" />
  <menuitem id="menu_03_05" disabled="true" label="$vl_c_aab_125" />
   </menupopup>
 </menu>
<toolbarseparator />
  <menu id="menu_03" observes="broadcaster_01" label="$vl_c_aab_121" accesskey="T" >
   <menupopup>
  <menuitem id="menu_03_01" disabled="true" label="$vl_c_aab_122" />
  <menuitem id="menu_03_02" disabled="true" label="$vl_c_aab_123" />
  <menuitem id="menu_03_03" label="$vl_c_aab_110" oncommand="pf_alimente_table()" />
END;
$vl_tb_droits=_graal_requete_droits_fenetre("Trait_00007",$vl_e_uti_cleunik);
if ($vl_tb_droits[0]==true) {echo('<menuitem id="menu_03_03" label="'.$vl_c_aab_124.'" oncommand="pf_maj_rss();"/>'); }
echo <<<END
  
   </menupopup>
 </menu>
<toolbarseparator />
  <menu id="menu_04" label="?" accesskey="?" >
   <menupopup>
  <menuitem id="menu_04_01" disabled="true" label="$vl_c_aab_126" accesskey="VK_F1"/>
  <menuseparator id="menu_04_02"/>
  <menuitem id="menu_04_03" disabled="true" label="$vl_c_aab_127" acceskey="S"/>
  <menuitem id="menu_04_04" disabled="true" label="$vl_c_aab_128" acceskey="D"/>
  <menuseparator id="menu_04_07"/>
  <menuitem id="menu_04_08" disabled="true" label="$vl_c_aab_130" tooltiptext="$vl_c_aab_134"/>
   </menupopup>
 </menu>
</menubar>
  
      <hbox flex="1">
      <vbox flex="1">
    <grid flex="1">
  <columns flex="1">
   <column/>
   <column/>
   <column flex="1"/>
  </columns>
    <rows>
        <row >
         <label control="la_emplacement" value="$vl_c_aab_111"/>
         <toolbarbutton class="aa13" tooltiptext="$vl_c_aab_131"  oncommand="pf_action('atteindre')"/>
         <textbox observes="broadcaster_01" id="tb_emplacement"   maxlenght="260"/>
        </row>
        <row >
         <label control="la_titre" value="$vl_c_aab_104"/>
         <toolbarbutton observes="broadcaster_01" class="aa12" tooltiptext="$vl_c_aab_132" oncommand="pf_action('recup_titre')"/>
         <textbox observes="broadcaster_01" id="tb_titre"  />
        </row>
        <row flex= "2">
          <label control="la_descriptif_sommaire" value="$vl_c_aab_106"/>
          <toolbarbutton observes="broadcaster_01" class="aa12" tooltiptext="$vl_c_aab_133" oncommand="pf_action('meta_description')"/>
          <textbox observes="broadcaster_01" id="tb_descriptif_sommaire"   multiline="true" />
        </row>
        <row>
          <label control="la_origine" value="$vl_c_aab_138"/>
          <flex/>
          <textbox observes="broadcaster_01" id="tb_origine"  />
        </row>
        <row > 
         <label/>
         <label/>
         <hbox>
           <label control="la_dateheurecreation" value="$vl_c_aab_112"/><label id="la_dateheurecreation" />
           <label control="la_dateheuremodif" value="$vl_c_aab_113"/><label id="la_dateheuremodif" />
         </hbox>         
        </row>
    </rows>
</grid>
</vbox>
      </hbox>
            </vbox>
      </tabpanel>
      <tabpanel id="tabpanel_critere" flex="1">
        <tabbox id="tabbox_02" flex="1" orient="vertical" class="overflow_01">
          <tabs>
            <tab class="ag17" id="tab_edition_critere_entreprise" linkedpanel="tabpanel_critere_entreprise" first-tab="true" label="$vl_c_dico_00058" selected="true"/>
            <tab class="ak15" id="tab_edition_critere_lesmiens" linkedpanel="tabpanel_critere_lesmiens" label="$vl_e_nomcomplet"/>
END;
if ($vs_envaa!=1){
echo <<<END
            <tab class="ak19" linkedpanel="tabpanel_critere_lesautres" id="tab_edition_critere_lesautres" label="$vl_c_dico_00059"/>
            <tab class="bd01" id="tab_edition_critere_tous" linkedpanel="tabpanel_critere_tous" label="$vl_c_dico_00073"/>
END;
}
echo <<<END
          </tabs>
END;
echo('<tabpanels flex="1"><tabpanel id="tabpanel_critere_entreprise" flex="1">');
include("_graal_inc_ged_criteres_entreprise.php");
echo('</tabpanel><tabpanel id="tabpanel_critere_lesmiens" flex="1">');
include("_graal_inc_ged_criteres_lesmiens.php");
echo('</tabpanel>');
if ($vs_envaa!=1){
	echo('<tabpanel id="tabpanel_critere_lesautres" flex="1">');
	include("_graal_inc_ged_criteres_lesautres.php");
	echo('</tabpanel><tabpanel id="tabpanel_critere_tous" flex="1">');
	include("_graal_inc_ged_criteres_tous.php");
	echo('</tabpanel>');
}
echo <<<END
</tabpanels>
        </tabbox>
      </tabpanel>
      <tabpanel id="tabpanel_commentaires" flex="1">
        <vbox flex="1">
          <hbox flex="1">
            <toolbarbutton id="tb_aller_commentaires" tooltiptext="$vl_c_aak_127" class="al13" oncommand="pf_ouvre('commentaires','')" observes="broadcaster_01"/>
            <iframe onload="event.stopPropagation();" id="if_commentaires_doc" flex="1" src="" />
          </hbox>
        </vbox>
      </tabpanel>
<tabpanel id="tabpanel_connexions" flex="1">  
      <vbox flex="1">
        <hbox>
          <toolbarbutton observes="broadcaster_01" class="am14" tooltiptext="$vl_c_aab_150" id="tb_connecte_fichier_ged" oncommand="pf_connecte('doc');"/>
          <toolbarbutton observes="broadcaster_01" class="am11" tooltiptext="$vl_c_aab_151" id="tb_connecte_fichier_ged" oncommand="pf_deconnecte('doc');"/>
					<toolbarbutton observes="broadcaster_01" class="am13" tooltiptext="$vl_c_aab_152" id="tb_connecte_fichier_ged" oncommand="pf_connecte('note');"/>
          <toolbarbutton observes="broadcaster_01" class="am10" tooltiptext="$vl_c_aab_153" id="tb_connecte_fichier_ged" oncommand="pf_deconnecte('note');"/>
					<toolbarbutton observes="broadcaster_01" class="am12" tooltiptext="$vl_c_aab_154" id="tb_connecte_fichier_ged" oncommand="pf_connecte('pseudodocs');"/>
          <toolbarbutton observes="broadcaster_01" class="am09" tooltiptext="$vl_c_aab_155" id="tb_connecte_fichier_ged" oncommand="pf_deconnecte('pseudodocs');"/>
        </hbox>
        <tree id="arbre_des_connexions" enableColumnDrag="true" flex="1" flags="" ref="*" querytype="xml" datasources="" ondblclick="pf_ouvre_ged();" seltype="single" context="pop_arbre_des_connexions" >
          <treecols>
            <treecol id="arbre_des_connexions_doc_cleunik" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_emplacement" label="$vl_c_aab_163" sort="?emplacement"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_titre" label="$vl_c_aab_164" sort="?titre"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_typedoc" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_descriptif_sommaire" label="$vl_c_aab_165" sort="?descriptif_sommaire"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_origine" label="$vl_c_aab_166" sort="?origine"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_portee" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_rattachement" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_infos_01" hidden="$vl_b_infos_01_hidden" label="$vl_c_aab_167" sort="?infos_01"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_dateheurecreation" label="$vl_c_aab_168" sort="?dateheurecreation_brut"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol id="arbre_des_connexions_dateheuremodif" label="$vl_c_aab_169" sort="?dateheuremodif_brut"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
            <treecol hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
         </treecols>
        <template><query expr="*"/><action>
          <treechildren>
            <treeitem uri="?" seltype="single">
              <treerow>
                <treecell label="?doc_cleunik" />
                <treecell label="?emplacement"/>
                <treecell properties="?properties" label=" ?titre"/>
                <treecell label="?typedoc" />
                <treecell label="?descriptif_sommaire"/>
                <treecell label="?origine"/>
                <treecell label="?portee"/>
                <treecell label="?rattachement"/>
                <treecell label="?infos_01"/>
                <treecell label="?dateheurecreation"/>
                <treecell label="?dateheuremodif"/>
                <treecell label="?dateheurecreation_brut"/>
                <treecell label="?dateheuremodif_brut"/>
  
              </treerow>
            </treeitem>
          </treechildren>
        </action></template>
      </tree>
    </vbox>
  </tabpanel>
    </tabpanels>
  </tabbox>
      <spacer  />
            <vbox id="boutons_standards">
END;
include("_graal_inc_boutons_01.php");
echo <<<END
            </vbox>

</hbox>
 </window>
END;
?>
