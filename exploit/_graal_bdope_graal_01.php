<?php 
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_actions_graal_01";
$t_origines_ok[1]="_graal_fen_actions_graal_02";
$t_origines_ok[2]="_graal_fen_actions_graal_03";
$t_origines_ok[3]="_graal_fen_actions_02";
fa_acces_script();
$vf_c_action=fa_recup_param('vf_c_action','??????');
$vl_act_cleunik=intval(fa_recup_param('vl_act_cleunik','-1'));
$vl_int_cleunik=intval(fa_recup_param('vl_int_cleunik','-1'));
$vl_action_cleunik=intval(fa_recup_param('vl_action_cleunik','-1'));
$vl_blocnotebrut=fa_recup_param('vl_blocnotebrut','');
$vl_choix_cleunik=intval(fa_recup_param('vl_choix_cleunik',''));
$vl_ancien_choix_cleunik=intval(fa_recup_param('vl_ancien_choix_cleunik',''));
$vl_principal=intval(fa_recup_param('vl_principal',1));
$vl_portee=intval(fa_recup_param('vl_portee','0'));
$vf_c_echo='';
switch (TRUE) {
  case $vf_c_action=='supprimer': 
    $sql_req = "DELETE FROM _graal WHERE act_cleunik=$vl_act_cleunik and int_cleunik=$vl_int_cleunik and action_cleunik=$vl_action_cleunik and choix_cleunik=$vl_ancien_choix_cleunik;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vf_c_action=='ajouter':
    $sql_req = "INSERT INTO _graal set act_cleunik=$vl_act_cleunik,int_cleunik=$vl_int_cleunik,action_cleunik=$vl_action_cleunik,choix_cleunik=$vl_choix_cleunik,blocnotebrut='$vl_blocnotebrut',portee=$vl_portee,principal=$vl_principal";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vf_c_action=='modifier':
    $sql_req = "UPDATE _graal set blocnotebrut='$vl_blocnotebrut',choix_cleunik=$vl_choix_cleunik,principal=$vl_principal";
    $sql_req.=" where act_cleunik=$vl_act_cleunik and int_cleunik=$vl_int_cleunik and action_cleunik=$vl_action_cleunik and choix_cleunik=$vl_ancien_choix_cleunik;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vf_c_action=='inverser_principal':
		if ($vl_principal==1) {$vl_principal=2;} else {$vl_principal=1;}
    $sql_req = "UPDATE _graal set principal=$vl_principal";
    $sql_req.=" where act_cleunik=$vl_act_cleunik and int_cleunik=$vl_int_cleunik and action_cleunik=$vl_action_cleunik and choix_cleunik=$vl_ancien_choix_cleunik;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vf_c_action=='??????':
    exit;
    break;    
} 
_graal_ferme_connexion();
echo $vf_c_echo;       
?>
