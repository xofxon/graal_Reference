<?php
function fa_brik_menulist_param_taxes($vv_flex="1",$vv_actif="1",$vv_id="ml_param_taxes",$vv_observer,$vv_except=""){
  $sql_req = "SELECT taxes_cleunik,denomination,actif FROM _param_taxes where actif in ($vv_actif)";
  if ($vv_except!='') {$sql_req.=" and taxes_cleunik not in($vv_except)";}
  $sql_req.=" order by denomination;";
  $sql_result = _graal_requete_bd($sql_req);
  $vl_e_nombre=mysql_num_rows($sql_result);
  if ($vv_observer==true) {
    $vv_brik="<menulist sizetopopup='none' onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex='$vv_flex' id='$vv_id' observes='broadcaster_01' _graal_nombre='$vl_e_nombre'><menupopup>";
  } else {
    $vv_brik="<menulist sizetopopup='none' onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex='$vv_flex' id='$vv_id' _graal_nombre='$vl_e_nombre'><menupopup>";
  }
  
  if ($vl_e_nombre == 0){
    $vv_brik.="<menuitem value='Aucun compte de taxes !!!' _graal_cleunik='-2' label='Aucun compte de taxes !!!' selected='true'/>";
  } else {
    while ($row = mysql_fetch_assoc($sql_result)){
      if ($row['actif']==2) {
        $classe="obsolete";
      } else {
        $classe="";
      }
      $vv_brik.="<menuitem class='.$classe.' value='" .fa_remplace_quotes(fa_ent_xml($row['denomination'])). "' _graal_cleunik='".$row['taxes_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['denomination']))."' selected='true'/>";
    }
  }
  $vv_brik.="</menupopup></menulist>";
  _graal_libere_requete_bd($sql_result);
  return $vv_brik; 
}
?>
