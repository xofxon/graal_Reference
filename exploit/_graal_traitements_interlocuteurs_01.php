<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik=intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_c_genreacteur=fa_recup_param('genreacteur','tousss');
$vl_c_type=fa_recup_param('type','1');  //  1 Normal,2 Choix,3 Critere
$vl_e_genreacteur=intval(fa_recup_param('vl_e_genreacteur','0'));
$vl_e_choix_cleunik=intval(fa_recup_param('vl_e_choix_cleunik','0'));
$vl_e_critere_cleunik=intval(fa_recup_param('vl_e_critere_cleunik','0'));
$vl_c_quoi=fa_recup_param('vl_c_quoi','');
$vl_c_enclair=fa_recup_param('vl_c_enclair','');
$vl_c_code_critere=fa_recup_param('vl_c_code_critere','');
$vl_c_code_choix=fa_recup_param('vl_c_code_choix','');
$vl_c_deno_critere=fa_ent_xml(fa_recup_param('vl_c_deno_critere',''));
$vl_c_deno_choix=fa_ent_xml(fa_recup_param('vl_c_deno_choix',''));
$vl_c_p02=fa_recup_param('p02','');
switch ($vl_c_genreacteur) {
  case "tousss": $vl_c_id_fenetre="Fen_00367";$vl_c_id_inc_interlocuteurs_01="Div_00326";$vl_c_id_inc_interlocuteurs_selection_01="Div_00333";break;  //  Tous les acteurs
  case "favori": $vl_c_id_fenetre="Fen_00367";$vl_c_id_inc_interlocuteurs_01="Div_00326";$vl_c_id_inc_interlocuteurs_selection_01="Div_00333";break;  //  Tous interlocuteurs favoris
  case "110001": $vl_c_id_fenetre="Fen_00368";$vl_c_id_inc_interlocuteurs_01="Div_00327";$vl_c_id_inc_interlocuteurs_selection_01="Div_00334";break;  //  prospects clients
  case "110002": $vl_c_id_fenetre="Fen_00369";$vl_c_id_inc_interlocuteurs_01="Div_00328";$vl_c_id_inc_interlocuteurs_selection_01="Div_00335";break;  //  prospects fournisseurs
  case "110003": $vl_c_id_fenetre="Fen_00370";$vl_c_id_inc_interlocuteurs_01="Div_00329";$vl_c_id_inc_interlocuteurs_selection_01="Div_00336";break;  //  clients
  case "110004": $vl_c_id_fenetre="Fen_00371";$vl_c_id_inc_interlocuteurs_01="Div_00330";$vl_c_id_inc_interlocuteurs_selection_01="Div_00337";break;  //  fournisseurs
  case "110005": $vl_c_id_fenetre="Fen_00372";$vl_c_id_inc_interlocuteurs_01="Div_00331";$vl_c_id_inc_interlocuteurs_selection_01="Div_00338";break;  //  autres acteurs
  case "110006": $vl_c_id_fenetre="Fen_00373";$vl_c_id_inc_interlocuteurs_01="Div_00332";$vl_c_id_inc_interlocuteurs_selection_01="Div_00339";break;  //  acteurs indéterminés
  case "110000": $vl_c_id_fenetre="Fen_00374";$vl_c_id_inc_interlocuteurs_01="Div_00340";$vl_c_id_inc_interlocuteurs_selection_01="Div_00341";break;  //  Entreprise
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
$vl_tc_composants=array($vl_c_id_inc_interlocuteurs_01,$vl_c_id_inc_interlocuteurs_selection_01);
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bdp_100=fa_recup_dico("bdp_100");
$vl_c_bdp_101=fa_recup_dico("bdp_101");
$vl_c_bdp_103=fa_recup_dico("bdp_103");
$vl_c_bdp_104=fa_recup_dico("bdp_104");
$vl_c_bdp_105=fa_recup_dico("bdp_105");
$vl_c_bdp_106=fa_recup_dico("bdp_106");
$vl_c_bdp_107=fa_recup_dico("bdp_107");
$vl_c_bdp_108=fa_recup_dico("bdp_108");
$vl_c_bdp_109=fa_recup_dico("bdp_109");
$vl_c_bdp_110=fa_recup_dico("bdp_110");
$vl_c_bdp_111=fa_recup_dico("bdp_111");
$vl_c_bdp_112=fa_recup_dico("bdp_112");
$vl_c_bdp_113=fa_recup_dico("bdp_113");
$vl_c_bdp_114=fa_recup_dico("bdp_114");
$vl_c_bdp_115=fa_recup_dico("bdp_115");
$vl_c_bdp_116=fa_recup_dico("bdp_116");






$vl_c_dico_00106=fa_recup_dico('dico_00106');
switch ($vl_c_genreacteur) {
  case "tousss": $vl_c_id_t1="Trait_00071";$vl_c_id_t2="Trait_00086";$vl_c_id_t3="Trait_00063";$vl_c_id_t4="Trait_00087";$vl_c_id_t5="Trait_00130";$vl_c_id_t6="Trait_00138";$vl_c_id_t7="Trait_00146";$vl_c_id_t8="Trait_00154";$vl_c_id_t9="Trait_00162";break;  //  Tous les interlocuteurs
  case "110001": $vl_c_id_t1="Trait_00072";$vl_c_id_t2="Trait_00079";$vl_c_id_t3="Trait_00064";$vl_c_id_t4="Trait_00088";$vl_c_id_t5="Trait_00131";$vl_c_id_t6="Trait_00139";$vl_c_id_t7="Trait_00147";$vl_c_id_t8="Trait_00155";$vl_c_id_t9="Trait_00163";break;  //  prospects clients
  case "110002": $vl_c_id_t1="Trait_00073";$vl_c_id_t2="Trait_00080";$vl_c_id_t3="Trait_00065";$vl_c_id_t4="Trait_00089";$vl_c_id_t5="Trait_00132";$vl_c_id_t6="Trait_00140";$vl_c_id_t7="Trait_00148";$vl_c_id_t8="Trait_00156";$vl_c_id_t9="Trait_00164";break;  //  prospects fournisseurs
  case "110003": $vl_c_id_t1="Trait_00074";$vl_c_id_t2="Trait_00081";$vl_c_id_t3="Trait_00066";$vl_c_id_t4="Trait_00090";$vl_c_id_t5="Trait_00133";$vl_c_id_t6="Trait_00141";$vl_c_id_t7="Trait_00149";$vl_c_id_t8="Trait_00157";$vl_c_id_t9="Trait_00165";break;  //  clients
  case "110004": $vl_c_id_t1="Trait_00075";$vl_c_id_t2="Trait_00082";$vl_c_id_t3="Trait_00067";$vl_c_id_t4="Trait_00091";$vl_c_id_t5="Trait_00134";$vl_c_id_t6="Trait_00142";$vl_c_id_t7="Trait_00150";$vl_c_id_t8="Trait_00158";$vl_c_id_t9="Trait_00166";break;  //  fournisseurs
  case "110005": $vl_c_id_t1="Trait_00076";$vl_c_id_t2="Trait_00083";$vl_c_id_t3="Trait_00068";$vl_c_id_t4="Trait_00092";$vl_c_id_t5="Trait_00135";$vl_c_id_t6="Trait_00143";$vl_c_id_t7="Trait_00151";$vl_c_id_t8="Trait_00159";$vl_c_id_t9="Trait_00167";break;  //  autres acteurs
  case "110006": $vl_c_id_t1="Trait_00077";$vl_c_id_t2="Trait_00084";$vl_c_id_t3="Trait_00069";$vl_c_id_t4="Trait_00093";$vl_c_id_t5="Trait_00136";$vl_c_id_t6="Trait_00144";$vl_c_id_t7="Trait_00152";$vl_c_id_t8="Trait_00160";$vl_c_id_t9="Trait_00168";break;  //  acteurs indéterminés
  case "110000": $vl_c_id_t1="Trait_00078";$vl_c_id_t2="Trait_00085";$vl_c_id_t3="Trait_00070";$vl_c_id_t4="Trait_00094";$vl_c_id_t5="Trait_00137";$vl_c_id_t6="Trait_00145";$vl_c_id_t7="Trait_00153";$vl_c_id_t8="Trait_00161";$vl_c_id_t9="Trait_00169";break;  //  Entreprise
}
_graal_requete_charge_libobj($vl_c_id_t1,$vl_e_uti_cleunik);$vl_c_t1=fa_recup_dico("$vl_c_id_t1");
_graal_requete_charge_libobj($vl_c_id_t2,$vl_e_uti_cleunik);$vl_c_t2=fa_recup_dico("$vl_c_id_t2");
_graal_requete_charge_libobj($vl_c_id_t3,$vl_e_uti_cleunik);$vl_c_t3=fa_recup_dico("$vl_c_id_t3");
_graal_requete_charge_libobj($vl_c_id_t4,$vl_e_uti_cleunik);$vl_c_t4=fa_recup_dico("$vl_c_id_t4");
_graal_requete_charge_libobj($vl_c_id_t5,$vl_e_uti_cleunik);$vl_c_t5=fa_recup_dico("$vl_c_id_t5");
_graal_requete_charge_libobj($vl_c_id_t6,$vl_e_uti_cleunik);$vl_c_t6=fa_recup_dico("$vl_c_id_t6");
_graal_requete_charge_libobj($vl_c_id_t7,$vl_e_uti_cleunik);$vl_c_t7=fa_recup_dico("$vl_c_id_t7");
_graal_requete_charge_libobj($vl_c_id_t8,$vl_e_uti_cleunik);$vl_c_t8=fa_recup_dico("$vl_c_id_t8");
_graal_requete_charge_libobj($vl_c_id_t9,$vl_e_uti_cleunik);$vl_c_t9=fa_recup_dico("$vl_c_id_t9");

switch ($vl_c_genreacteur) {
  case "tousss":break;
  case "110001":
  case "110002":
  case "110003":
  case "110004":
  case "110005":
  case "110006":
$chaine_choix_critere=<<<EOT
<menuitem label="$vl_c_bdp_111" oncommand="pf_ouvre_choix_critere('entreprise');" id="bt_sel_critere" />
<menuitem label="$vl_c_bdp_112" oncommand="pf_ouvre_choix_critere('moi');" id="bt_sel_choix" />
<menuitem label="$vl_c_bdp_113" oncommand="pf_enleve_choix_critere();" id="bt_sup_choix" collapsed="true"/>
EOT;
    break;
}


include("_graal_header_winxul.inc.php");
echo <<<END
<window _graal_genreacteur="$vl_c_genreacteur" id="_win_traitements_interlocuteurs_01" title="$vl_c_bdp_109" onload="fa_aa(this);pf_aa_init()" $c_xmlns>
$vl_c_graal_cp00
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_interlocuteurs_traitements_01.js.php");
echo <<<END
<deck id="deck_acteurs" selectedIndex="0" flex="1">
<vbox flex="1">
END;

$vl_c_bloc_arbre_criteres=false;
switch ($vl_c_type) {
  case '1' : // Normal
    $vl_c_invisible_inc_interlocuteurs_selection_01="false";
	include("_graal_inc_interlocuteurs_selection_01.php");
	$vl_c_id_vbox_inc_interlocuteurs_01="bdq_interlocuteur_01";
	$vl_c_id_arbre_inc_interlocuteurs_01="arbre_des_interlocuteurs";
	include("_graal_inc_interlocuteurs_01.php");
    break;
  case '2' : // Choix
  case '3' : // Critère
  case '4' : // Critère (ceux qui n'ont pas un certain choix pour pouvoir l'ajouter)
    $_graal_inc_infos_critere_choix_01="acteurs";
    include("_graal_inc_infos_critere_choix_01.php");
    $vl_c_id_vbox_inc_interlocuteurs_01="bdq_interlocuteur_01";
	$vl_c_id_arbre_inc_interlocuteurs_01="arbre_des_interlocuteurs";
	include("_graal_inc_interlocuteurs_01.php");
    break;
  case '6' : // Sélections de critères "simples"
    $vl_c_infos_adresses="true";$vl_c_infos_sitesweb="true";$collapsed_acteurs="false";$collapsed_00="false";$collapsed_01="false";
    $vl_c_bloc_arbre_criteres=true;
    $vl_c_invisible_inc_interlocuteurs_selection_01="false";
	include("_graal_inc_interlocuteurs_selection_01.php");
	$vl_c_id_vbox_inc_interlocuteurs_01="bdq_interlocuteur_01";
	$vl_c_id_arbre_inc_interlocuteurs_01="arbre_des_interlocuteurs";
	include("_graal_inc_interlocuteurs_01.php");
    echo $vl_bloc_validation_listes;
    break;
}
echo <<<END
<popupset>
  <popup id="pop_selections">
    <menuitem class="menuitem-iconic ai18" id="mi_ouvre_interlo" label="$vl_c_bdp_101" oncommand="pf_interlo_ouvre(1);"/>
    <menuitem class="menuitem-iconic ai15" id="mi_ouvre_interlo" label="$vl_c_bdp_110" oncommand="pf_acteur_ouvre(1);"/>
		<menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','$vl_c_id_arbre_inc_interlocuteurs_01');" />
  </popup>
</popupset>
<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="0" id="ml_traitements" >
<menupopup>
<menuitem value='0' label="$vl_c_bdp_100" selected='true'/>
END;
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t1,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) { echo("<menuitem value='1' label='".$vl_c_t1."' selected='true'/>");}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t2,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) { echo("<menuitem value='2' label='".$vl_c_t2."' selected='true'/>");}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t3,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) { echo("<menuitem value='3' label='".$vl_c_bdp_107."' selected='true'/>");}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t4,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) { echo("<menuitem value='5' label='$vl_c_bdp_108' selected='true'/>");echo("<menuitem value='4' label='".$vl_c_t4."' selected='true'/>");}
echo <<<END
  </menupopup>
</menulist>
<hbox>
  <button tooltiptext ="Exécuter Ctrl+Shift+F5" flex="1" keycode="k-enregistrer" width="40" id="bt_enregistrer" label="Exécuter" crop="end" dir="normal" oncommand="pf_validation()" />
  <button tooltiptext ="$vl_c_bdp_103" collapsed="true" flex="1" id="bt_voir_panier" label="$vl_c_bdp_103" crop="end" dir="normal" oncommand="pf_voir_deck(1)" />
</hbox>
</vbox>
<vbox flex="1">
END;
$vl_c_id_vbox_inc_interlocuteurs_01="bdq_interlocuteur_panier";
$vl_c_id_arbre_inc_interlocuteurs_01="arbre_des_interlocuteurs_panier";
$vl_c_bloc_arbre_criteres=false;
include("_graal_inc_interlocuteurs_01.php");
echo <<<END
  <popupset>
    <popup id="pop_panier">
      <menuitem label="$vl_c_bdp_100" oncommand=""/>
      <menuitem id="mi_ouvre_interlo_panier" label="$vl_c_bdp_101" oncommand="pf_interlo_ouvre(2);"/>
      <menuitem label="$vl_c_bdp_105" oncommand="pf_interlo_supprime();"/>
      <menuitem label="$vl_c_bdp_106" oncommand="pf_panier_enleve();"/>
      <menuitem label="$vl_c_t3" oncommand="pf_valide_danspanier();"/>
      <menuseparator />
      $chaine_choix_critere
      <menuseparator />
			<menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','$vl_c_id_arbre_inc_interlocuteurs_01');" />
END;
echo ('<menuseparator />');
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t5,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t5.'" oncommand="pf_recup_requete(\'ods\');" class="menuitem-iconic ac12" />');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t6,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t6.'" oncommand="pf_recup_requete(\'rdf\');" class="menuitem-iconic ak02" collapsed="true"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t7,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t7.'" oncommand="pf_recup_requete(\'htm\');" class="menuitem-iconic ak03" />');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t8,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t8.'" oncommand="pf_recup_requete(\'xml\');" class="menuitem-iconic ak04" disabled="true"/>');}
echo ('<menuseparator />');
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t9,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t9.'" oncommand="pf_recup_requete(\'xls\');" class="menuitem-iconic ak05" dir="reverse"/>');}
echo <<<END
    </popup>
  </popupset>
  <vbox id="vb_criteres_panier" collapsed="true">
    <_graal_datas id="_graal_ajout_ove_bdc_datas" _graal_genreacteur="$vl_c_genreacteur" _graal_choix_cleunik="" _graal_critere_cleunik="" _graal_critere_qui=""/>
    <hbox>
      <caption label="$vl_c_bdp_114" /><textbox flex="10" id="tb_ajout_critere_denomination" />
      <caption label="$vl_c_bdp_115" /><textbox flex="10" id="tb_ajout_choix_valeur_texte_01"/>
      <toolbarbutton class="al01" id="tob_requete" tooltiptext="$vl_c_bdp_116" oncommand="pf_valide_criteres('ajout');"/>
    </hbox>
  </vbox>
  <hbox>
    <button tooltiptext ="$vl_c_bdp_104" flex="1" id="bt_retour" label="$vl_c_bdp_104" crop="end" dir="normal" oncommand="pf_voir_deck(0)" />
  </hbox>
</vbox>
</deck>
</window>
END;
?>
