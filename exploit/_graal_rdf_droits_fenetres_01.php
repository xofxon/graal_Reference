<?php
include("_graal_header_xml.inc.php");
define('EOL', "\r\n");
$vl_c_dico_00014=fa_recup_dico('dico_00014');
$vl_c_dico_00015=fa_recup_dico('dico_00015');
$vl_e_uti_cleunik=intval(fa_recup_param('vl_e_uti_cleunik','0'));
$vl_e_langue=intval(fa_recup_session('langue_appli','120131'));
//  Fenêtres pour lesquelles, pour un utilisateur donné, on a des droits d'accès aux fenêtres
$sql_req = "SELECT _objets.titre AS titre,_objets_libelle.descriptif AS descriptif,_objets.fen_cleunik as fen_cleunik,_droits_uti_fen.duf_cleunik as duf_cleunik,_droits_uti_fen.duf_acces as acces,_droits_uti_fen.duf_ajout as ajout,_droits_uti_fen.duf_modif as modif,_droits_uti_fen.duf_suppr as suppr FROM _objets,_droits_uti_fen,_objets_libelle WHERE _objets.type_objet=1 and _objets.fen_cleunik=_droits_uti_fen.fen_cleunik and _droits_uti_fen.uti_cleunik=$vl_e_uti_cleunik and _objets.fen_cleunik=_objets_libelle.fen_cleunik and _objets_libelle.langue=$vl_e_langue ORDER BY descriptif;";
$result = _graal_requete_bd($sql_req);
echo(fa_xcree_entete_rdf());
  // boucle de récupération des enregistrements de la requête et génération du contenu RDF
  while ($row = mysql_fetch_assoc($result))
    {
      echo('<RDF:li>'.EOL);
      echo('<RDF:Description>');
      // parseType = indication pour le type des données, utile pour le tri sur la colonne
      echo('<row:duf_cleunik NC:parseType="Integer">'.fa_ent_xml($row['duf_cleunik']).'</row:duf_cleunik>');
      echo('<row:fen_cleunik NC:parseType="Integer">'.fa_ent_xml($row['fen_cleunik']).'</row:fen_cleunik>');
      echo('<row:titre>'.fa_ent_xml($row['titre']).'</row:titre>');
      echo('<row:descriptif>'.fa_ent_xml($row['descriptif']).'</row:descriptif>');
      switch (fa_ent_xml($row['acces']))
      {
        case 1 :
          echo("<row:acces></row:acces>");
          break;
        default :
          echo("<row:acces>$vl_c_dico_00015</row:acces>");
          break;
      }      
      switch (fa_ent_xml($row['ajout']))
      {
        case 1 :
          echo("<row:ajout></row:ajout>");
          break;
        default :
          echo("<row:ajout>$vl_c_dico_00014</row:ajout>");
          break;
      }      
      switch (fa_ent_xml($row['modif']))
      {
        case 1 :
          echo("<row:modif></row:modif>");
          break;
        default :
          echo("<row:modif>$vl_c_dico_00014</row:modif>");
          break;
      }      
      switch (fa_ent_xml($row['suppr']))
      {
        case 1 :
          echo("<row:suppr></row:suppr>");
          break;
        default :
          echo("<row:suppr>$vl_c_dico_00014</row:suppr>");
          break;
      }      

      echo('</RDF:Description>'.EOL);
      echo('</RDF:li>'.EOL);
    }
echo('</RDF:Bag>'.EOL);
echo('</RDF:RDF>'.EOL);
_graal_libere_requete_bd($result);
_graal_ferme_connexion();
?>
