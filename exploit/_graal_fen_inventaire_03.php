<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_c_type=fa_recup_param('type','1');  //  1 Normal,2 Choix,3 Critere
$vl_c_genre=fa_recup_param('genre','0');  //  1 ventes, 2 achats
$vl_e_choix_cleunik=intval(fa_recup_param('vl_e_choix_cleunik','0'));
$vl_e_critere_cleunik=intval(fa_recup_param('vl_e_critere_cleunik','0'));
$vl_c_quoi=fa_recup_param('vl_c_quoi','');
$vl_c_enclair=fa_recup_param('vl_c_enclair','');
$vl_c_code_critere=fa_recup_param('vl_c_code_critere','');
$vl_c_code_choix=fa_recup_param('vl_c_code_choix','');
$vl_c_deno_critere=fa_recup_param('vl_c_deno_critere','');
$vl_c_deno_choix=fa_recup_param('vl_c_deno_choix','');
$vl_c_id_fenetre="Fen_01115";$vl_c_id_article_recherche="Div_00227";
$vl_c_id_inc_infos_critere_choix_01="Div_00344";
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bvh_100=fa_recup_dico("bvh_100");
$vl_c_bvh_101=fa_recup_dico("bvh_101");
$vl_c_bvh_102=fa_recup_dico("bvh_102");
$vl_c_bvh_103=fa_recup_dico("bvh_103");
$vl_c_bvh_104=fa_recup_dico("bvh_104");
$vl_c_bvh_105=fa_recup_dico("bvh_105");
$vl_c_bvh_106=fa_recup_dico("bvh_106");
$vl_c_bvh_107=fa_recup_dico("bvh_107");
$vl_c_bvh_108=fa_recup_dico("bvh_108");
$vl_c_bvh_109=fa_recup_dico("bvh_109");
$vl_c_bvh_110=fa_recup_dico("bvh_110");
$vl_c_bvh_111=fa_recup_dico("bvh_111");
$vl_c_bvh_112=fa_recup_dico("bvh_112");
$vl_c_bvh_113=fa_recup_dico("bvh_113");
$vl_c_bvh_114=fa_recup_dico("bvh_114");
$vl_c_bvh_115=fa_recup_dico("bvh_115");
$vl_c_bvh_116=fa_recup_dico("bvh_116");
$vl_c_bvh_117=fa_recup_dico("bvh_117");
$vl_c_bvh_121=fa_recup_dico("bvh_121");
$vl_c_bvh_122=fa_recup_dico("bvh_122");
$vl_c_bvh_123=fa_recup_dico("bvh_123");
$vl_c_dico_00026=fa_recup_dico("dico_00026");
$vl_c_dico_00046=fa_recup_dico("dico_00046");
$vl_c_dico_00047=fa_recup_dico("dico_00047");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_dico_00018=fa_recup_dico("dico_00018");
$vl_c_dico_00083=fa_recup_dico("dico_00083");
$vl_c_dico_00084=fa_recup_dico("dico_00084");
$vl_c_dico_00085=fa_recup_dico("dico_00085");
$vl_c_dico_00163=fa_recup_dico("dico_00163");
$vl_c_id_t01="Trait_00317";$vl_c_id_t02="Trait_00318";

_graal_requete_charge_libobj($vl_c_id_t01,$vl_e_uti_cleunik);$vl_c_t01=fa_recup_dico("$vl_c_id_t01");
_graal_requete_charge_libobj($vl_c_id_t02,$vl_e_uti_cleunik);$vl_c_t02=fa_recup_dico("$vl_c_id_t02");
include("_graal_header_winxul.inc.php");
$c_id_windows=$vl_c_id_fenetre;
$c_id_windows="";
$vl_tc_composants=array($vl_c_id_fenetre,$vl_c_id_article_recherche,$vl_c_id_article_ventes);
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t01,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];
if ($vl_b_acces==true){
	$vl_complement_arbre_des_articles=('<menuitem label="'.$vl_c_t01.'" oncommand="pf_export_excel_01();" class="menuitem-iconic ak05" dir="reverse"/>');
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t02,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];
if ($vl_b_acces==true){
	$vl_importation_excel=<<<EOT
	<button id="bt_ouvre_csv" flex="1" label="$vl_c_t02" tooltiptext="$vl_c_t02" oncommand="pf_ouvre_csv();" class="menuitem-iconic ak05" dir="reverse" />
	<menulist sizetopopup="none" value="1" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="ml_separateur" class="sans_icone" _graal_nombre="2">
		<menupopup>
			<menuitem value="1" label="$vl_c_bvh_114" tooltiptext="$vl_c_bvh_114" crop="end"/>
          	<menuitem value="2" label="$vl_c_bvh_115" tooltiptext="$vl_c_bvh_115" crop="end"/>
		</menupopup>
	</menulist>
EOT;
}
$vl_c_context_00='<popupset><popup id="pop_art">';
$vl_c_context_00.='<menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\'arbre_des_articles\');" />';
$vl_c_context_00.=$vl_complement_arbre_des_articles;
$vl_c_context_00.='</popup></popupset>';
$ml_depot=fa_brik_menulist_choix(116,1,-1,-1,'','ml_depot',"broadcaster_01",0);
$ml_empla=fa_brik_menulist_choix(117,1,-1,-1,'','ml_empla',"broadcaster_01",0);
echo <<<END
<window id="$c_id_windows" title="$vl_c_bvh_100" onload="fa_aa(this);pf_aa_init()" onunload="pf_aa_ferme();" $c_xmlns>
$vl_c_graal_cp00
END;
include("_graal_visites.inc.php");
include_once("js/_graal_05_dates.js.php");
include_once("js/_graal_01.js.php");
include("js/_graal_inventaire_03.js.php");
include("js/_graal_03.js.php");
$vl_c_type_article_recherche="3";
include("js/_graal_articles_selection_01.js.php");
echo <<<END
$vl_c_context_00
<vbox id="vb_selection">
<hbox>
$ml_tarifs
</hbox>
  <vbox >
END;
switch ($vl_c_type) {
  case '1' : // Normal
    include("_graal_inc_articles_recherche_01.php");
    break;
  case '2' : // Choix
  case '3' : // Critère
    $_graal_inc_infos_critere_choix_01="articles";
    include("_graal_inc_infos_critere_choix_01.php");
    break;
}
echo <<<END
</vbox>
<vbox id="bbb_ove_01" >
<hbox flex="1">
  <groupbox flex="1">
  <hbox>  
  <caption><label value="$vl_c_bvh_104" /></caption>
    <radiogroup id="rdg_etat" onclick="fa_approximatif_bbo();" flex="1">
       <hbox flex="1">
       <radio label="$vl_c_bvh_109" value="1" />
       <spacer flex="1"/>
       <radio label="$vl_c_bvh_110" selected="true" value="2"/>
       <spacer flex="1" />
       <radio label="$vl_c_bvh_111" value="3"/>
       <spacer flex="1" />
       <radio label="$vl_c_bvh_112" value="4"/>

       </hbox>
     </radiogroup>
     </hbox>
  </groupbox>
</hbox>
</vbox>
</vbox>

<vbox id="$vl_c_id_vbox_inc_article_01" flex="2">


<hbox >
<button flex="1" id="bt_saisie" tooltiptext ="$vl_c_bvh_121" label="$vl_c_bvh_121" crop="end" dir="normal" oncommand="pf_saisie();" />
$vl_importation_excel

<hbox flex="1" id="boite_validation_inventaire" collapsed="true">
			<label control="la_dateheureinventaire" value="Inventaire du"/>
			<datepicker type="popup" monthLeadingZero="true" dateLeadingZero="true" observes="broadcaster_01" id="tb_dateheureinventaire"/>
			<label value="à"/>
	  <timepicker is24HourClock="true" id="tb_heu_deb" observes="broadcaster_01"/>
      <spacer/>
      <label value="Prix unitaire de référence"/>
      <menulist sizetopopup="none" class="sans_icone" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' observes="broadcaster_01" flex='1' id='ml_tarif_reference' _graal_nombre='5' value="-5">
        <menupopup>
          <menuitem value='-4' label="$vl_c_dico_00018" tooltiptext="$vl_c_dico_00018"/>
          <menuitem value='-1' label="$vl_c_dico_00083" tooltiptext="$vl_c_dico_00083"/>
          <menuitem value='-3' label="$vl_c_dico_00085" tooltiptext="$vl_c_dico_00085"/>
          <menuitem value='-2' label="$vl_c_dico_00084" tooltiptext="$vl_c_dico_00084"/>
          <menuitem value='-5' label="$vl_c_dico_00163" tooltiptext="$vl_c_dico_00163"/>
        </menupopup>
      </menulist>
      $ml_depot
      $ml_empla
		<button flex="1" id="bt_validation" tooltiptext ="$vl_c_bvh_122" label="$vl_c_bvh_122" crop="end" dir="normal" oncommand="pf_validation();"/>
    </hbox>
</hbox>
  <hbox flex="100" class="overflow_01">
  
  <tree id="arbre_des_articles" enableColumnDrag="true" flex="1" flags="" ref="*" querytype="xml" datasources="" seltype="single" context="pop_art">
  <treecols>
 <treecol id="code" sort="?code" label="$vl_c_bvh_101" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="mnemotech" sort="?mnemotechnique" label="$vl_c_bvh_102" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="art_cleunik"  hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="description" sort="?description" label="$vl_c_bvh_103" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="qte_stock" class="droite" sort="?val_qte_stock" label="$vl_c_bvh_104" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="unite" class="centre" sort="?unite" label="$vl_c_bvh_106" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="dateheure_dermvt" sort="?dateheure_dermvt_tri" label="$vl_c_bvh_105" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="dateheure_dermvt_tri" sort="?dateheure_dermvt_tri" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="val_qte_stock" class="droite" sort="?val_qte_stock" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="dateheure_invent" sort="?dateheure_invent_tri" label="$vl_c_bvh_113" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="dateheure_invent_tri" sort="?dateheure_invent_tri" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="qte_inventaire" class="droite" sort="?val_qte_inventaire" label="$vl_c_bvh_116" collapsed="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="val_qte_inventaire" class="droite" sort="?val_qte_inventaire" label="$vl_c_bvh_116" collapsed="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>

 </treecols>
 <template><query expr="*"/><action>
 <treechildren>

 <treeitem container="true" uri="?" seltype="single">
 <treerow>
 <treecell properties="?properties" label="?code" />
 <treecell properties="?properties" label="?mnemotechnique"/>
 <treecell properties="?properties" label="?art_cleunik"/>
 <treecell properties="?properties" label="?description"/>
 <treecell properties="?properties" label="?qte_stock"/>
 <treecell properties="?properties" label="?unite"/>
 <treecell properties="?properties" label="?dateheure_dermvt"/>
 <treecell properties="?properties" label="?dateheure_dermvt_tri"/>
 <treecell properties="?properties" label="?val_qte_stock"/>
 <treecell properties="?properties" label="?dateheure_invent"/>
 <treecell properties="?properties" label="?dateheure_invent_tri"/>
 <treecell properties="?properties" label="?qte_inventaire"/>

 </treerow>
 </treeitem>
 </treechildren>
 </action></template>
 </tree>
  
  
  </hbox> 

  
  
</vbox>


  </window>
END;
?>
