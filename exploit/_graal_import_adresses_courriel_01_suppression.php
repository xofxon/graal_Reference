<?php
define('EOL', "\r\n");
include("_graal_header_txt.inc.php");
/*
$vl_c_var=fa_recup_param('var','vs_tempo_panier_lig_cleunik');
$vl_t_listecles=fa_recup_session("$vl_c_var",'');
unset($_SESSION["$vl_c_var"]);
*/
$vl_t_listecles=fa_recup_param("vs_tempo_panier_lig_cleunik",'');
$vl_t_listecles=unserialize(stripslashes($vl_t_listecles));
/*
 * Nécessaire pour éviter le blocage du au trop long traitements voir conversation ici http://www.developpez.net/forums/showthread.php?p=3024462#post3024462   
 * Il ne faut plus rien avoir à récupérer, dans ce script, dans les variables de session ou dans les paramètres passés
 */
session_write_close(); 
$vl_e_i=-1;
foreach($vl_t_listecles as $vl_raf) {
  $vl_e_i++;
  $vl_liste.=$vl_t_listecles[$vl_e_i].',';
}
if ($vl_liste!="") {
  $vl_liste=substr($vl_liste, 0, -1);
}
$sql_req = "delete FROM _w_import_courriel_ligne WHERE lig_cleunik IN($vl_liste)";
$vf_c_echo=_graal_exec_requete($sql_req);
if($vf_c_echo=='ok') {$vf_c_echo='ok';}  else {$vf_c_echo='-1-'.$vf_c_echo;}
_graal_ferme_connexion();
?>
