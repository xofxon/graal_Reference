<?php
function stats_rectif_dates($ml_art_03){
	switch ($ml_art_03) {
	  case  1:
	  case  2:
	  case  3:
	  case  5: 
	  case  6: 
	  case  7:
	  case 11:
	  case 12:
	  	break;
	  case  4: 
	  	stats_maj_dates_lignes(9);
	  	stats_maj_dates_lignes(10);
	  	break;
	  case  8:
	  	stats_maj_dates_lignes(8);
	  	break;
	  case  9:
	  	stats_maj_dates_lignes(9);
	  	break;
	  case 10:
	  	stats_maj_dates_lignes(10);
	  	break;
	}
}
function stats_maj_dates_lignes($ml_art_03){
	$sql_req="";
	switch ($ml_art_03) {
		  case  1: $fic_cial="offcli";break;
		  case  2: $fic_cial="cdecli";break;
		  case  3: $fic_cial="livcli";break;
		  case  4: $fic_cial="faccli";break;
		  case  5: $fic_cial="demfou";break;
		  case  6: $fic_cial="cdefou";break;
		  case  7: $fic_cial="recfou";break;
		  case  8: $fic_cial="facfou";
$sql_req=<<<xof
		  	update _facfou_entetes f1 left join _facfou_lignes f2 on f1.commercial_cleunik=f2.commercial_cleunik 
	left join _facfou_lignes_qte f3 on f2.commercial_ligne_cleunik=f3.commercial_ligne_cleunik 
	set f3.dateheure_confirm=f1.date_fact where f3.dateheure_confirm<>f1.date_fact
xof;
		  break;
		  case  9: $fic_cial="faccli";
		  	$sql_req=<<<xof
		  	update _faccli_entetes f1 left join _faccli_lignes f2 on f1.commercial_cleunik=f2.commercial_cleunik 
	left join _faccli_lignes_qte f3 on f2.commercial_ligne_cleunik=f3.commercial_ligne_cleunik 
	set f3.dateheure_confirm=f1.date_fact where f3.dateheure_confirm<>f1.date_fact
xof;
		  break;
		  case 10: $fic_cial="avocli";
		  $sql_req=<<<xof
		  	update _avocli_entetes f1 left join _avocli_lignes f2 on f1.commercial_cleunik=f2.commercial_cleunik 
	left join _avocli_lignes_qte f3 on f2.commercial_ligne_cleunik=f3.commercial_ligne_cleunik 
	set f3.dateheure_confirm=f1.date_avoi where f3.dateheure_confirm<>f1.date_avoi
xof;
		  break;
		  case 11: $fic_cial="retcli";break;
		  case 12: $fic_cial="retfou";break;
	}
	if (trim($sql_req!="")) { 
		$vf_c_echo=_graal_exec_requete($sql_req);
	}
}

