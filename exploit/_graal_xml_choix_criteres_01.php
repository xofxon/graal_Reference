<?php
include("_graal_header_xml.inc.php");
define('EOL', "\r\n");
$vl_e_choix_cleunik=intval(fa_recup_param('vl_e_choix_cleunik','10000167'));
$vl_c_genre=fa_recup_param('genre','graal');
$sql_req = "SELECT f2.choix_couleur,_choix.critere_cleunik AS critere_cleunik,_choix.choix_cleunik AS choix_cleunik,_choix.choix_code AS choix_code,";
$sql_req.= " _choix.choix_valeur_texte_01 AS choix_valeur_texte_01,_choix.choix_valeur_texte_02 AS choix_valeur_texte_02,_choix.choix_actif AS choix_actif,";
$sql_req.= " _choix.choix_portee AS choix_portee ";
$sql_req.= " FROM _choix left join _choix_couleur f2 on f2.choix_cleunik=_choix.choix_cleunik and f2.uti_cleunik= 0 "; 
$sql_req.= " WHERE _choix.choix_cleunik IN ($vl_e_choix_cleunik)"; 
$vl_e_critere_cleunik=0;
$result = _graal_requete_bd($sql_req);
echo(fa_xcree_entete_xml());
$row = mysql_fetch_assoc($result);
echo('<Description>');
echo('<critere_cleunik data="'.fa_ent_xml($row['critere_cleunik']).'"/>');
$vl_e_critere_cleunik=fa_ent_xml($row['critere_cleunik']);
$vl_e_choix_valeur_texte_02=fa_ent_xml($row['choix_valeur_texte_02'])*1;
echo('<choix_cleunik data="'.fa_ent_xml($row['choix_cleunik']).'"/>');
echo('<choix_couleur data="'.fa_ent_xml($row['choix_couleur']).'"/>');
echo('<choix_code data="'.fa_ent_xml($row['choix_code']).'"/>');
echo('<choix_valeur_texte_01 data="'.fa_ent_xml($row['choix_valeur_texte_01']).'"/>');
echo('<choix_valeur_texte_02  data="'.fa_ent_xml($row['choix_valeur_texte_02']).'"/>');
echo('<choix_actif  data="'.fa_ent_xml($row['choix_actif']).'"/>');
echo('<choix_portee  data="'.fa_ent_xml($row['choix_portee']).'"/>');
_graal_libere_requete_bd($result);
$sql_req = '';
switch ($vl_e_critere_cleunik) {
   case 80:    //  Genres d'acteurs
   case 61:    //  Régions 
   case 62:    //  Départements
   case 63:    //  Arrondissements
   case 64:    //  Cantons
   case 65:    //  Communes
   case 11:    //  PCS N1
   case 12:    //  PCS N2
   case 13:    //  PCS N3
   case 14:    //  PCS N4
   case 21:    //  NAF N1
   case 22:    //  NAF N2
   case 23:    //  NAF N3
   case 24:    //  NAF N4
   case 25:    //  NAF N5
    $sql_req = "SELECT count(*) as nombre,typeacteur as typeacteur from _act_choix_fixes where _act_choix_fixes.choix_cleunik = $vl_e_choix_cleunik group by typeacteur";
    break;
  case 60:
/*    Pays 
          On cherche dans 
         - les critères des acteurs
         - les adresses postales des acteurs
         - les adresses postales des interlocuteurs d'acteurs
         - Les adresses des offres de prix client
         - Les adresses des commandes client
         - Les adresses des livraison client
         - Les adresses des factures client
         - Les adresses des demande de prix fournisseur
         - Les adresses des commandes fournisseur
         - Les adresses des réceptions fournisseur
         - Les adresses des factures fournisseur
*/          
    $sql_req="select sum(nombre) as nombre,typeacteur as typeacteur from ( SELECT count(*) as nombre,typeacteur as typeacteur from _act_adresses,_acteurs where _act_adresses.choix_cleunik = $vl_e_choix_cleunik and _act_adresses.act_cleunik=_acteurs.act_cleunik group by typeacteur union SELECT count(*) as nombre,typeacteur as typeacteur from _act_interlo_adresses,_acteurs where _act_interlo_adresses.choix_cleunik = $vl_e_choix_cleunik and _act_interlo_adresses.act_cleunik=_acteurs.act_cleunik group by typeacteur union SELECT count(*) as nombre,typeacteur as typeacteur from _act_choix_fixes where _act_choix_fixes.choix_cleunik = $vl_e_choix_cleunik group by typeacteur union SELECT count(*) as nombre,typeacteur as typeacteur from _offcli_adresses,_offcli_entetes,_acteurs where _offcli_adresses.commercial_cleunik=_offcli_entetes.commercial_cleunik and _offcli_entetes.act_cleunik=_acteurs.act_cleunik and _offcli_adresses.choix_cleunik = $vl_e_choix_cleunik group by typeacteur union SELECT count(*) as nombre,110003 as typeacteur from _cdecli_adresses where _cdecli_adresses.choix_cleunik = $vl_e_choix_cleunik group by typeacteur union SELECT count(*) as nombre,110003 as typeacteur from _livcli_adresses where _livcli_adresses.choix_cleunik = $vl_e_choix_cleunik group by typeacteur     union SELECT count(*) as nombre,110003 as typeacteur from _faccli_adresses where _faccli_adresses.choix_cleunik = $vl_e_choix_cleunik group by typeacteur union SELECT count(*) as nombre,typeacteur as typeacteur from _demfou_adresses,_demfou_entetes,_acteurs where _demfou_adresses.commercial_cleunik=_demfou_entetes.commercial_cleunik and _demfou_entetes.act_cleunik=_acteurs.act_cleunik and _demfou_adresses.choix_cleunik = $vl_e_choix_cleunik group by typeacteur union SELECT count(*) as nombre,110004 as typeacteur from _cdefou_adresses where _cdefou_adresses.choix_cleunik = $vl_e_choix_cleunik group by typeacteur union SELECT count(*) as nombre,110004 as typeacteur from _recfou_adresses where _recfou_adresses.choix_cleunik = $vl_e_choix_cleunik group by typeacteur union SELECT count(*) as nombre,110004 as typeacteur from _facfou_adresses where _facfou_adresses.choix_cleunik = $vl_e_choix_cleunik group by typeacteur ) as toto group by typeacteur;";
    break;
   case 66:    //  Préfixes internationaux des téléphones et fax 
    $sql_req = "select sum(nombre) as nombre,typeacteur as typeacteur from ( SELECT count(*) as nombre,typeacteur from _act_interlo_fax,_acteurs where _act_interlo_fax.prefixe_choix_cleunik = $vl_e_choix_cleunik and _act_interlo_fax.act_cleunik = _acteurs.act_cleunik group by typeacteur union SELECT count(*) as nombre,typeacteur from _act_interlo_tel,_acteurs where _act_interlo_tel.prefixe_choix_cleunik = $vl_e_choix_cleunik and _act_interlo_tel.act_cleunik = _acteurs.act_cleunik group by typeacteur ) as toto group by typeacteur";
    break;
  case 67:
/*   Devise 
        On cherche dans 
         - les acteurs
         - Les offres de prix client
         - Les commandes client
         - Les livraison client
         - Les factures client
         - Les demande de prix fournisseur
         - Les commandes fournisseur
         - Les réceptions fournisseur
         - Les factures fournisseur
*/          
$sql_req=<<<EOT
	select sum(nombre) as nombre,typeacteur as typeacteur from ( SELECT count(*) as nombre,typeacteur as typeacteur from _acteurs where _acteurs.devise = $vl_e_choix_cleunik group by typeacteur 
   union SELECT count(*) as nombre,typeacteur as typeacteur from _offcli_entetes,_acteurs where _offcli_entetes.act_cleunik=_acteurs.act_cleunik and _offcli_entetes.devise=$vl_e_choix_cleunik group by typeacteur 
	 union SELECT count(*) as nombre,110003 as typeacteur from _cdecli_entetes where _cdecli_entetes.devise=$vl_e_choix_cleunik group by typeacteur 
	 union SELECT count(*) as nombre,110003 as typeacteur from _livcli_entetes where _livcli_entetes.devise=$vl_e_choix_cleunik group by typeacteur 
	 union SELECT count(*) as nombre,110003 as typeacteur from _faccli_entetes where _faccli_entetes.devise=$vl_e_choix_cleunik group by typeacteur 
	 union SELECT count(*) as nombre,typeacteur as typeacteur from _demfou_entetes,_acteurs where _demfou_entetes.act_cleunik=_acteurs.act_cleunik and _demfou_entetes.devise=$vl_e_choix_cleunik group by typeacteur 
	 union SELECT count(*) as nombre,110004 as typeacteur from _cdefou_entetes where _cdefou_entetes.devise=$vl_e_choix_cleunik group by typeacteur 
	 union SELECT count(*) as nombre,110004 as typeacteur from _recfou_entetes where _recfou_entetes.devise=$vl_e_choix_cleunik group by typeacteur 
	 union SELECT count(*) as nombre,110004 as typeacteur from _facfou_entetes where _facfou_entetes.devise=$vl_e_choix_cleunik group by typeacteur ) as toto group by typeacteur;
EOT;
    break;
   case 83:    //  Genres de fax 
    $sql_req = "SELECT count(*) as nombre,typeacteur from _act_interlo_fax,_acteurs where _act_interlo_fax.choix_cleunik = $vl_e_choix_cleunik and _act_interlo_fax.act_cleunik = _acteurs.act_cleunik group by typeacteur";
    break;
   case 84:    //  Genres de courriels
    $sql_req = "SELECT count(*) as nombre,typeacteur from _act_interlo_mail,_acteurs where _act_interlo_mail.choix_cleunik = $vl_e_choix_cleunik and _act_interlo_mail.act_cleunik = _acteurs.act_cleunik group by typeacteur";
    break;
   case 82:    //  Genres de téléphones
    $sql_req = "SELECT count(*) as nombre,typeacteur from _act_interlo_tel,_acteurs where _act_interlo_tel.choix_cleunik = $vl_e_choix_cleunik and _act_interlo_tel.act_cleunik = _acteurs.act_cleunik group by typeacteur";
    break;
   case 85:    //  Genres d'adresses internet 
    $sql_req = "SELECT count(*) as nombre,typeacteur from _act_sites,_acteurs where _act_sites.choix_cleunik = $vl_e_choix_cleunik and _act_sites.act_cleunik = _acteurs.act_cleunik group by typeacteur";
    break;  
  case 86:     //  civilités
    $sql_req = "SELECT count(*) as nombre,_acteurs.typeacteur from _act_interlo,_acteurs where _act_interlo.choix_cleunik = $vl_e_choix_cleunik and _act_interlo.act_cleunik = _acteurs.act_cleunik group by _acteurs.typeacteur";
    break;    
   case 81:   //  Genres d'interlocuteurs 
   case 92:   //  Fonctions des interlocuteurs 
    $sql_req = "SELECT count(*) as nombre,_acteurs.typeacteur from _act_interlo_choix_fixes,_acteurs where _act_interlo_choix_fixes.choix_cleunik = $vl_e_choix_cleunik and _act_interlo_choix_fixes.act_cleunik = _acteurs.act_cleunik group by _acteurs.typeacteur";
    break;
   case 94:   //  Genres d'actions 
    $sql_req = "SELECT count(*) as nombre,'action' as typeacteur from _actions where _actions.choix_cleunik = $vl_e_choix_cleunik";
    break;
   case 95:     //  Nature des Relations entre les actions et les interlocuteurs/acteurs 
    $sql_req = "SELECT count(*) as nombre,'action' as typeacteur from _graal where _graal.choix_cleunik = $vl_e_choix_cleunik";
    break;
   case 98:    //  Genres d'adresses postales 
                //  On ne cherche actuellement que dans le fichier des adresses acteurs et des interlocuteurs d'acteurs
    $sql_req="select sum(nombre) as nombre,typeacteur as typeacteur from (
      SELECT count(*) as nombre,typeacteur from _act_adresses,_acteurs where _act_adresses.adr_typecoordonnees & $vl_e_choix_valeur_texte_02 and _act_adresses.act_cleunik = _acteurs.act_cleunik group by typeacteur
      union
      SELECT count(*) as nombre,typeacteur from _act_interlo_adresses,_acteurs where _act_interlo_adresses.adr_typecoordonnees & $vl_e_choix_valeur_texte_02 and _act_interlo_adresses.act_cleunik = _acteurs.act_cleunik group by typeacteur
      )as toto group by typeacteur;";
    break;  
   case 101:  //  Tarifs de vente
   case 127:  //  Tarifs d'achats
    $sql_req = "select 'raf' as typeacteur,((SELECT count(*) as nombre from _art_tarifs where _art_tarifs.tarif_cleunik=$vl_e_choix_cleunik)+ (SELECT count(*) as nombre from _act_compta where _act_compta.tarif_cleunik=$vl_e_choix_cleunik)) as nombre";
    break; 
   case 108:  //  unités de stock
    $sql_req = "SELECT count(*) as nombre,'article' as typeacteur from _art_stock where _art_stock.unite_stock=$vl_e_choix_cleunik";
    break; 
   case 109:  //  unités de vente
    $sql_req = "SELECT 'article' as typeacteur,((SELECT count(*) from _art_ventes where unite_vente=$vl_e_choix_cleunik)+(SELECT count(*) from _cdecli_lignes_qte where qte_unite=$vl_e_choix_cleunik)) as nombre";
    //+(SELECT count(*) from _acteurs_representants where choix_cleunik_droite =$vl_e_choix_cleunik)+(SELECT count(*) from _acteurs_representants where choix_cleunik_gauche =$vl_e_choix_cleunik)
    break; 
   case 110:  //  unités d'achats
    $sql_req = "SELECT count(*) as nombre,'article' as typeacteur from _art_achats where _art_achats.unite_achat=$vl_e_choix_cleunik";
    break; 
  case 114:     //Relations entre acteurs
    $sql_req = " select 'raf' as typeacteur,((SELECT count(*) from _acteurs_relations where choix_cleunik_droite=$vl_e_choix_cleunik)+(SELECT count(*) from _acteurs_relations where choix_cleunik_gauche =$vl_e_choix_cleunik)+(SELECT count(*) from _acteurs_representants where choix_cleunik_droite =$vl_e_choix_cleunik)+(SELECT count(*) from _acteurs_representants where choix_cleunik_gauche =$vl_e_choix_cleunik)) as nombre";
    break;
  case 116:  //  Dépôts
    $sql_req = "SELECT count(*) as nombre,'article' as typeacteur from _art_dep_emp where _art_dep_emp.choix_depot=$vl_e_choix_cleunik";
    break;
  case 117:  //  Emplacements
    $sql_req = "SELECT count(*) as nombre,'article' as typeacteur from _art_dep_emp where _art_dep_emp.choix_empla=$vl_e_choix_cleunik";
    break;
   case 119:  //  unités de réappro
    $sql_req = "SELECT sum(nombre) as nombre,'article' as typeacteur from (SELECT count(*) as nombre from _art_achats where _art_achats.unite_reappro=$vl_e_choix_cleunik union SELECT count(*) as nombre from _art_fournis where _art_fournis.unite_reappro=$vl_e_choix_cleunik) as toto";
    break;
  case 122:     //  Confidentialité des actions
    $sql_req = " SELECT count(*) as nombre,'action' as typeacteur from _actions where _actions.confidentialite =$vl_e_choix_cleunik";
    break;
  case 123:     //  Priorités des actions
    $sql_req = " SELECT count(*) as nombre,'action' as typeacteur from _actions where _actions.priorite =$vl_e_choix_cleunik";
    break;
  case 124:     //  Statuts des actions
    $sql_req = " SELECT count(*) as nombre,'action' as typeacteur from _actions where _actions.statut =$vl_e_choix_cleunik";
    break;
  case 125:     //Relations entre actions
    $sql_req = " select 'raf' as typeacteur,((SELECT count(*) from _graal_act where choix_cleunik_droite=$vl_e_choix_cleunik)+(SELECT count(*) from _graal_act where choix_cleunik_gauche =$vl_e_choix_cleunik)) as nombre";
    break;
   case 128:  //  unités de conditionnement
    $sql_req = "SELECT 'article' as typeacteur,((SELECT count(*) from _art_stock where unite_condi=$vl_e_choix_cleunik)+(SELECT count(*) from _cdecli_lignes_qte where unite_condi=$vl_e_choix_cleunik)) as nombre";
    break;
   case 129: //  Statuts des lignes d'actions commerciales
    $sql_req = "select 'raf' as typeacteur,((SELECT count(*) as nombre from _offcli_lignes where _offcli_lignes.statut=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _cdecli_lignes where _cdecli_lignes.statut=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _livcli_lignes where _livcli_lignes.statut=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _faccli_lignes where _faccli_lignes.statut=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _demfou_lignes where _demfou_lignes.statut=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _cdefou_lignes where _cdefou_lignes.statut=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _recfou_lignes where _recfou_lignes.statut=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _facfou_lignes where _facfou_lignes.statut=$vl_e_choix_cleunik)) as nombre";
    break;
   case 130:  //  Origine des mouvements de stock
    $sql_req = "SELECT count(*) as nombre,'article' as typeacteur from _mouvements_stock where _mouvements_stock.genre_mvt=$vl_e_choix_cleunik";
    break;
   case 131:  //  unités de capacité
    $sql_req = "SELECT count(*) as nombre,'article' as typeacteur from _art_dimensions where _art_dimensions.unite_capacite=$vl_e_choix_cleunik";
    break; 
  case 132:  //  Unités de masse
    $sql_req = "SELECT count(*) as nombre,'article' as typeacteur from _art_dimensions where _art_dimensions.unite_poids=$vl_e_choix_cleunik";
    break; 
  case 133:  //  Unités de volume
  case 134:  //  Unités de surface
  case 135:  //  Unités de longueur
    break;
  case 137: //  Modes de paiement
    $sql_req= " select 'raf' as typeacteur,((SELECT count(*) as nombre from _modereg_det where _modereg_det.mode_paiement =$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _treso_remise where _treso_remise.mode_paiement =$vl_e_choix_cleunik)(SELECT count(*) as nombre from _treso_reglement_cli where mode_paiement = $vl_e_choix_cleunik)+(SELECT count(*) as nombre from _treso_reglement_fou where mode_paiement = $vl_e_choix_cleunik)) as nombre";
    break;
  case 138: //  Types de paiement
    $sql_req = " SELECT count(*) as nombre from _modereg_det where _modereg_det.type_paiement =$vl_e_choix_cleunik";
    break;
	case 139: //  Types de port
	//	à rebrancher, une fois toutes les tables effectivement créées dans la table !!
	//$sql_req = "select 'raf' as typeacteur,((SELECT count(*) as nombre from _offcli_entetes where _offcli_entetes.typpor = _choix.choix_cleunik)+(SELECT count(*) as nombre from _cdecli_entetes where _cdecli_entetes.typpor= _choix.choix_cleunik)+(SELECT count(*) as nombre from _livcli_entetes where _livcli_entetes.typpor= _choix.choix_cleunik)+(SELECT count(*) as nombre from _faccli_entetes where _faccli_entetes.typpor= _choix.choix_cleunik)+(SELECT count(*) as nombre from _demfou_entetes where _demfou_entetes.typpor= _choix.choix_cleunik)+(SELECT count(*) as nombre from _cdefou_entetes where _cdefou_entetes.typpor= _choix.choix_cleunik)+(SELECT count(*) as nombre from _recfou_entetes where _recfou_entetes.typpor= _choix.choix_cleunik)+(SELECT count(*) as nombre from _facfou_entetes where _facfou_entetes.typpor= _choix.choix_cleunik))";
	$sql_req = "select 'raf' as typeacteur,((SELECT count(*) as nombre from _offcli_entetes where _offcli_entetes.typpor = $vl_e_choix_cleunik)+(SELECT count(*) as nombre from _cdecli_entetes where _cdecli_entetes.typpor=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _livcli_entetes where _livcli_entetes.typpor=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _faccli_entetes where _faccli_entetes.typpor=$vl_e_choix_cleunik)) as nombre";
	 break;           
	case 140: //  Modalités de livraison
		//	à rebrancher, une fois toutes les tables effectivement créées dans la table !!
	//$sql_req = "select 'raf' as typeacteur,((SELECT count(*) as nombre from _offcli_entetes where _offcli_entetes.modliv = _choix.choix_cleunik)+(SELECT count(*) as nombre from _cdecli_entetes where _cdecli_entetes.modliv= _choix.choix_cleunik)+(SELECT count(*) as nombre from _livcli_entetes where _livcli_entetes.modliv= _choix.choix_cleunik)+(SELECT count(*) as nombre from _faccli_entetes where _faccli_entetes.modliv= _choix.choix_cleunik)+(SELECT count(*) as nombre from _demfou_entetes where _demfou_entetes.modliv= _choix.choix_cleunik)+(SELECT count(*) as nombre from _cdefou_entetes where _cdefou_entetes.modliv= _choix.choix_cleunik)+(SELECT count(*) as nombre from _recfou_entetes where _recfou_entetes.modliv= _choix.choix_cleunik)+(SELECT count(*) as nombre from _facfou_entetes where _facfou_entetes.modliv= _choix.choix_cleunik)+(SELECT count(*) as nombre from _act_choix_fixes where _act_choix_fixes.choix_cleunik = _choix.choix_cleunik)) $vl_c_operateur_01 0";
	$sql_req = " select 'raf' as typeacteur,((SELECT count(*) as nombre from _offcli_entetes where _offcli_entetes.modliv_bis =$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _cdecli_entetes where _cdecli_entetes.modliv_bis=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _livcli_entetes where _livcli_entetes.modliv_bis=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _faccli_entetes where _faccli_entetes.modliv_bis=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _offcli_entetes where _offcli_entetes.modliv =$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _cdecli_entetes where _cdecli_entetes.modliv=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _livcli_entetes where _livcli_entetes.modliv=$vl_e_choix_cleunik)+(SELECT count(*) as nombre from _faccli_entetes where _faccli_entetes.modliv=$vl_e_choix_cleunik)) $vl_c_operateur_01 0";
	 break;           
	case 145: //  Options de remises en banque
    $sql_req= " select 'raf' as typeacteur,((SELECT count(*) as nombre from _treso_remise where _treso_remise.option_remise =$vl_e_choix_cleunik)) as nombre";
    break;
 case 146: //  Types d'écarts de réglement        
  	$sql_req .= "select 'raf' as typeacteur,((SELECT count(*) as nombre from _treso_reglement_cli where type_ecart = $vl_e_choix_cleunik)+(SELECT count(*) as nombre from _treso_reglement_fou where type_ecart = $vl_e_choix_cleunik)) as nombre";
  	break;
		
   default:  
        switch ($vl_c_genre) {
          case 'graal':
          case 'acteurs':
            //$sql_req = "SELECT count(*) as nombre,typeacteur as typeacteur from _act_choix_fixes where _act_choix_fixes.choix_cleunik = $vl_e_choix_cleunik group by typeacteur";
			$sql_req = "SELECT count(*) as nombre,'110001' as typeacteur from _act_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110001";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110002' as typeacteur from _act_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110002";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110003' as typeacteur from _act_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110003";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110004' as typeacteur from _act_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110004";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110005' as typeacteur from _act_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110005";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110006' as typeacteur from _act_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110006";
            break;
          case 'interlocuteurs':
            //$sql_req = "SELECT count(*) as nombre,typeacteur as typeacteur from _act_interlo_choix_fixes where _act_interlo_choix_fixes.choix_cleunik = $vl_e_choix_cleunik group by typeacteur";
            $sql_req = "SELECT count(*) as nombre,'110000' as typeacteur from _act_interlo_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110000";
			$sql_req.=" UNION ";
          	$sql_req.= "SELECT count(*) as nombre,'110001' as typeacteur from _act_interlo_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110001";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110002' as typeacteur from _act_interlo_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110002";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110003' as typeacteur from _act_interlo_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110003";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110004' as typeacteur from _act_interlo_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110004";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110005' as typeacteur from _act_interlo_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110005";
			$sql_req.=" UNION ";
			$sql_req.= "SELECT count(*) as nombre,'110006' as typeacteur from _act_interlo_choix_fixes where choix_cleunik = $vl_e_choix_cleunik and typeacteur=110006";
			break;
          case 'articles':
            $sql_req = "SELECT count(*) as nombre,'article' as typeacteur from _art_choix_fixes where _art_choix_fixes.choix_cleunik = $vl_e_choix_cleunik";
            break;
          case 'actions':
            $sql_req = "SELECT count(*) as nombre,'action' as typeacteur from _actions_choix_fixes where _actions_choix_fixes.choix_cleunik = $vl_e_choix_cleunik";
            break;
          case 'ged':
            $sql_req = "SELECT count(*) as nombre,'ged' as typeacteur from _documents_choix_fixes where _documents_choix_fixes.choix_cleunik = $vl_e_choix_cleunik";
            break;
          case 'raf':
            break;
        } 
        break;
    break;
}  
	//echo('<requete02 data="'.fa_ent_xml($sql_req).'"/>');
  echo("<choix data='$vl_e_choix_cleunik' />");
  if ($sql_req!='') {
    $result = _graal_requete_bd($sql_req);
    // boucle de récupération des enregistrements de la requête et génération du contenu RDF
    $i=0;
    while ($row = mysql_fetch_assoc($result)) {
      $i++;
	  $nombre=$row['nombre'];
	  //if ($nombre==0) {$nombre="";}
      echo('<nombre_utilisations_'.$i.' data="'.fa_ent_xml($nombre).'"/>');
      echo('<typeacteur_'.$i.' data="'.fa_ent_xml($row['typeacteur']).'"/>');
    }
    _graal_libere_requete_bd($result);
  }
echo('</Description>'.EOL);
_graal_ferme_connexion();
?>
