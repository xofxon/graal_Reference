<?php
_graal_requete_charge_varlib($vl_c_id_inc_actions_relations,$vl_e_uti_cleunik);
$vl_c_bfi_001=fa_recup_dico("bfi_001");
$vl_c_bfi_002=fa_recup_dico("bfi_002");
$vl_c_bfi_003=fa_recup_dico("bfi_003");
$vl_c_bfi_004=fa_recup_dico("bfi_004");
$vl_c_bfi_019=fa_recup_dico("bfi_019");
$vl_c_bfi_020=fa_recup_dico("bfi_020");
$vl_c_bfi_021=fa_recup_dico("bfi_021");
$vl_c_bfi_022=fa_recup_dico("bfi_022");
$vl_c_bfi_023=fa_recup_dico("bfi_023");
$vl_c_bfi_024=fa_recup_dico("bfi_024");
$vl_c_id_fen_relation="Fen_00444";
$vl_c_id_fen_action="Fen_00425";
$vl_c_dico_00106=fa_recup_dico("dico_00106");
if ($vl_c_visu_relation=="oui") {
$vl_c_bouton_voir_relation=<<<EOF
<toolbarbutton id="tb_actionliee_voir" label="$vl_c_bfi_024" tooltiptext="$vl_c_bfi_024" oncommand="pf_ouvre('relation','voir')" observes="broadcaster_01"/>
EOF;
}
$vl_c_context_00='<popupset><popup id="pop_arbre_relations"><menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\'arbre_relations\');" /></popup></popupset>';
echo <<<END
$vl_c_context_00
<vbox flex="1">
<vbox id="bfi_acteurs_relations_01" flex="1">
END;
if ($vl_c_barre_presente_actions_relations=='ok'){
echo <<<END
      <toolbar grippyhidden="true">
				$vl_c_bouton_voir_relation
  		  <toolbarbutton id="tb_actionliee_ouvrir" class="af08" tooltiptext="$vl_c_bfi_022" oncommand="pf_ouvre('relation','liee')" observes="broadcaster_01"/>
        <toolbarbutton class="table-rafraichir" tooltiptext="$vl_c_bfi_019" oncommand="pf_affiche_donnees_relations();"/>
        <toolbarseparator />
        <hbox id="bloc_relations">
END;
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fen_relation,$vl_e_uti_cleunik);
if ($vl_tb_droits[0]!=0){
  if ($vl_tb_droits[1]!=0){
echo <<<END
          <toolbarbutton class="aa01" observes="broadcaster_01" id="tb_relation_01" tooltiptext="$vl_c_bfi_020" oncommand="pf_ouvre('relation','nouveau');"/>
END;
}
echo <<<END
          <toolbarbutton class="aa01" observes="broadcaster_01" id="tb_relation_02" tooltiptext="$vl_c_bfi_021" oncommand="pf_ouvre('relation','ouvrir');" />
END;
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fen_action,$vl_e_uti_cleunik);
if ($vl_tb_droits[0]!=0){
  echo('<toolbarbutton id="tb_action_ajouter" class="am07" tooltiptext="'.$vl_c_bfi_023.'" oncommand="pf_lie_lambda()" observes="broadcaster_01"/>');
}
}
echo <<<END
        </hbox>
        <toolbarseparator />
      </toolbar>
END;
}
echo <<<END
  <tree id="arbre_relations" flex="1" flags="" ref="*" querytype="xml" datasources="" onselect="pf_sel_arbre_relations();" seltype="single" context="pop_arbre_relations" rows="3">
      <treecols>
        <treecol hidden="true" id="tc_action_cleunik_gauche" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tc_choix_cleunik_gauche" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tc_choix_cleunik_droite" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tc_action_cleunik_droite" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_genre_00_gauche" label="Genre gauche 0" sort="?genre_01_gauche" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_qui_gauche_00" label="$vl_c_bfi_002" sort="?qui_gauche_00" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_choix_01_gauche" label="$vl_c_bfi_003" sort="?choix_01_gauche" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_genre_00_droite" label="Genre droite" sort="?genre_01_droite" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_qui_droite" label="$vl_c_bfi_002" sort="?qui_droite" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_choix_01_droite" label="$vl_c_bfi_003" sort="?choix_01_droite" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_genre_01_gauche" label="Genre gauche 1" sort="?genre_01_gauche" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_qui_gauche_01" label="$vl_c_bfi_002" sort="?qui_gauche_01" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_blocnotebrut" label="$vl_c_bfi_001" sort="?blocnotebrut" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_blocnoteriche" ignoreincolumnpicker="true" hidden="true" /><splitter class="tree-splitter" resizeafter="grow"/>
      </treecols>
      <template><query expr="*"/><action>
        <treechildren>
          <treeitem uri="?" seltype="single">
            <treerow>
              <treecell label="?action_cleunik_gauche"/>
              <treecell label="?choix_cleunik_gauche"/>
              <treecell label="?choix_cleunik_droite"/>
              <treecell label="?action_cleunik_droite"/>
              <treecell label="?genre_01_gauche"/>
              <treecell label="?qui_gauche_00"/>
              <treecell label="?choix_01_gauche"/>
              <treecell label="?genre_01_droite"/>
              <treecell label="?qui_droite"/>
              <treecell label="?choix_01_droite"/>
              <treecell label="?genre_01_gauche"/>
              <treecell label="?qui_gauche_01"/>
              <treecell label="?blocnotebrut"/>
              <treecell label="?blocnoteriche"/>
            </treerow>
          </treeitem>
        </treechildren>
      </action></template>
    </tree>
  </vbox>
END;
if ($vl_c_visu_relation=="oui") {
echo <<<END
<splitter/>
  <vbox flex="10">
      <iframe onload="fa_aa(window.graal_iframe_visu_action_relation);event.stopPropagation();" id="graal_iframe_visu_action_relation" src="" flex="1"/>
  </vbox>
END;
}
echo '</vbox>';
?>
