<?php
include("_graal_header_xml.inc.php");
define('EOL', "\r\n");
$vl_c_dico_00010=fa_recup_dico('dico_00010');
$vl_c_dico_00020=fa_recup_dico('dico_00020');
$vl_c_dico_00021=fa_recup_dico('dico_00021');
$vl_c_dico_00022=fa_recup_dico('dico_00022');
$vl_c_dico_00023=fa_recup_dico('dico_00023');
$vl_c_dico_00024=fa_recup_dico('dico_00024');
$vl_c_dico_00025=fa_recup_dico('dico_00025');
$vl_e_act_cleunik=intval(fa_recup_param('vl_e_act_cleunik','10007305'));
$sql_req = "SELECT _acteurs_relations.act_cleunik_gauche as `act_cleunik_gauche`,_acteurs_relations.choix_cleunik_gauche as `choix_cleunik_gauche`,_acteurs_relations.act_cleunik_droite as `act_cleunik_droite`,_acteurs_relations.choix_cleunik_droite as `choix_cleunik_droite`,acteur_gauche.raisonsoc as qui_gauche,acteur_droite.raisonsoc as qui_droite,choix_droite.choix_valeur_texte_01 as choix_01_droite,choix_gauche.choix_valeur_texte_01 as choix_01_gauche,_acteurs_relations.blocnotebrut as `blocnotebrut`,_acteurs_relations.blocnoteriche as `blocnoteriche`,acteur_gauche.typeacteur as `typeacteur_gauche`,acteur_droite.typeacteur as `typeacteur_droite` FROM _acteurs_relations,_acteurs acteur_gauche,_acteurs acteur_droite,_choix choix_droite,_choix choix_gauche where act_cleunik_gauche=$vl_e_act_cleunik and act_cleunik_gauche=acteur_gauche.act_cleunik and act_cleunik_droite=acteur_droite.act_cleunik and choix_droite.choix_cleunik=_acteurs_relations.choix_cleunik_droite and choix_gauche.choix_cleunik=_acteurs_relations.choix_cleunik_gauche
union
SELECT _acteurs_relations.act_cleunik_gauche as `act_cleunik_gauche`,_acteurs_relations.choix_cleunik_gauche as `choix_cleunik_gauche`,_acteurs_relations.act_cleunik_droite as `act_cleunik_droite`,_acteurs_relations.choix_cleunik_droite as `choix_cleunik_droite`,acteur_gauche.raisonsoc as qui_gauche,acteur_droite.raisonsoc as qui_droite,choix_droite.choix_valeur_texte_01 as choix_01_droite,choix_gauche.choix_valeur_texte_01 as choix_01_gauche,_acteurs_relations.blocnotebrut as `blocnotebrut`,_acteurs_relations.blocnoteriche as `blocnoteriche`,acteur_gauche.typeacteur as `typeacteur_gauche`,acteur_droite.typeacteur as `typeacteur_droite` FROM _acteurs_relations,_acteurs acteur_gauche,_acteurs acteur_droite,_choix choix_droite,_choix choix_gauche where act_cleunik_droite=$vl_e_act_cleunik and act_cleunik_gauche=acteur_gauche.act_cleunik and act_cleunik_droite=acteur_droite.act_cleunik and choix_droite.choix_cleunik=_acteurs_relations.choix_cleunik_droite and choix_gauche.choix_cleunik=_acteurs_relations.choix_cleunik_gauche;";
//echo($sql_req);
$result = _graal_requete_bd($sql_req);
echo(fa_xcree_entete_rdf());  
  while ($row = mysql_fetch_assoc($result))
    {
      $vl_c_genreacteur_gauche=$row['typeacteur_gauche'];
      switch ($vl_c_genreacteur_gauche)
        {
          case "110001": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00020)";break;  //  Relations des prospects clients
          case "110002": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00022)";break;  //  Relations des prospects fournisseurs
          case "110003": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00021)";break;  //  Relations des clients
          case "110004": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00023)";break;  //  Relations des fournisseurs
          case "110005": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00024)";break;  //  Relations des autres acteurs
          case "110006": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00025)";break;  //  Relations des acteurs indéterminés
          default : $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00010)";break;
        }
      $vl_c_genreacteur_droite=$row['typeacteur_droite'];
      switch ($vl_c_genreacteur_droite)
        {
          case "110001": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00020)";break;  //  Relations des prospects clients
          case "110002": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00022)";break;  //  Relations des prospects fournisseurs
          case "110003": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00021)";break;  //  Relations des clients
          case "110004": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00023)";break;  //  Relations des fournisseurs
          case "110005": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00024)";break;  //  Relations des autres acteurs
          case "110006": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00025)";break;  //  Relations des acteurs indéterminés
          default : $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00010)";break;
        }

      echo('<RDF:li>'.EOL);
      echo('<RDF:Description>');
      echo('<row:act_cleunik_gauche NC:parseType="Integer">'.fa_ent_xml($row['act_cleunik_gauche']).'</row:act_cleunik_gauche>');
      echo('<row:choix_cleunik_gauche NC:parseType="Integer">'.fa_ent_xml($row['choix_cleunik_gauche']).'</row:choix_cleunik_gauche>');
      echo('<row:choix_cleunik_droite NC:parseType="Integer">'.fa_ent_xml($row['choix_cleunik_droite']).'</row:choix_cleunik_droite>');
      echo('<row:act_cleunik_droite NC:parseType="Integer">'.fa_ent_xml($row['act_cleunik_droite']).'</row:act_cleunik_droite>');
      echo('<row:typeacteur_droite NC:parseType="Integer">'.fa_ent_xml($row['typeacteur_droite']).'</row:typeacteur_droite>');
      echo('<row:qui_gauche_00>'.$vl_c_quigauche.'</row:qui_gauche_00>');
      echo('<row:choix_01_gauche>'.fa_ent_xml($row['choix_01_gauche']).'</row:choix_01_gauche>');
      echo('<row:qui_droite>'.$vl_c_quidroite.'</row:qui_droite>');
      echo('<row:choix_01_droite>'.fa_ent_xml($row['choix_01_droite']).'</row:choix_01_droite>');
      echo('<row:qui_gauche_01>'.$vl_c_quigauche.'</row:qui_gauche_01>');
      echo('<row:blocnotebrut>'.fa_ent_xml($row['blocnotebrut']).'</row:blocnotebrut>');
      echo('<row:blocnoteriche>'.fa_ent_xml($row['blocnoteriche']).'</row:blocnoteriche>');
      echo('</RDF:Description>'.EOL);
      echo('</RDF:li>'.EOL);
    }
  // fin du fichier RDF
  echo('</RDF:Bag>'.EOL);
  echo('</RDF:RDF>'.EOL);
  _graal_libere_requete_bd($result);
  _graal_ferme_connexion();
  ?>
