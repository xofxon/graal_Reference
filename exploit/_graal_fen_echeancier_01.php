<?php
include("_graal_header_xul.inc.php");
include("_graal_fonctions_echeances.php");
$vl_e_uti_cleunik =intval(fa_recup_session("vs_uti_cleunik","0"));
$vl_c_genreacteur=fa_recup_param('genreacteur','tousss');
$vl_c_type=fa_recup_param('type','1');
$vl_c_reglement="non";$vl_c_journal="non";$vl_c_multiple="non";$journal_cleunik="";
switch ($vl_c_type){
	case '1':	//Echéancier factures
		switch ($vl_c_genreacteur){
		  case "tousss": $vl_c_id_fenetre="Fen_00946";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00553";break;  //  Tous les acteurs
		  case "110003": $vl_c_id_fenetre="Fen_00944";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00551";break;  //  clients
		  case "110004": $vl_c_id_fenetre="Fen_00945";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00552";break;  //  fournisseurs
		  default:fa_redirige("acces_interdit");break;
		}
		break;
	case '2':	//Echéancier commandes
		switch ($vl_c_genreacteur){
		  case "tousss": $vl_c_id_fenetre="Fen_00949";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00556";break;  //  Tous les acteurs
		  case "110003": $vl_c_id_fenetre="Fen_00947";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00554";break;  //  clients
		  case "110004": $vl_c_id_fenetre="Fen_00948";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00555";break;  //  fournisseurs
		  default:fa_redirige("acces_interdit");break;
		}
		break;
	case '3':	//Echéancier général
		switch ($vl_c_genreacteur){
		  case "tousss": $vl_c_id_fenetre="Fen_00952";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00559";break;  //  Tous les acteurs
		  case "110003": $vl_c_id_fenetre="Fen_00950";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00557";break;  //  clients
		  case "110004": $vl_c_id_fenetre="Fen_00951";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00558";break;  //  fournisseurs
		  default:fa_redirige("acces_interdit");break;
		}
		break;
	case '5': $vl_c_id_fenetre="Fen_00944";$vl_c_id_fenetre_reglement="Fen_00959";$vl_c_id_tab_echeancier="Div_00563";$vl_c_reglement="oui";$vl_c_journal="oui";$journal_cleunik=-1;break;//	Réglements clients : 1 chèque -> une facture
  	case "8": $vl_c_id_fenetre="Fen_00944";$vl_c_id_fenetre_reglement="Fen_00962";$vl_c_id_tab_echeancier="Div_00564";$vl_c_reglement="oui";$vl_c_journal="oui";break;//  Réglement client 1 virement/traite/LCR/CB... -> une facture		
  	case "C8": $vl_c_id_fenetre="Fen_00947";$vl_c_id_fenetre_reglement="Fen_01144";$vl_c_id_tab_echeancier="Div_00564";$vl_c_reglement="oui";$vl_c_journal="oui";break;//  Réglement client 1 virement/traite/LCR/CB... -> une commande  
	case '7': $vl_c_id_fenetre="Fen_00944";$vl_c_id_fenetre_reglement="Fen_01005";$vl_c_id_tab_echeancier="Div_00563";$vl_c_reglement="oui";$vl_c_journal="oui";$vl_c_multiple="oui";$journal_cleunik=-1;break;//	Réglements clients : 1 chèque -> n factures	
	case "10": $vl_c_id_fenetre="Fen_00944";$vl_c_id_fenetre_reglement="Fen_01006";$vl_c_id_tab_echeancier="Div_00564";$vl_c_reglement="oui";$vl_c_journal="oui";$vl_c_multiple="oui";break;//  Réglement client 1 virement/traite/LCR -> n factures		  
	
	case '12': $vl_c_id_fenetre="Fen_00944";$vl_c_id_fenetre_reglement="Fen_01124";$vl_c_id_tab_echeancier="Div_00563";$vl_c_reglement="oui";$vl_c_journal="oui";break;//	Réglements fournisseurs : 1 chèque -> une facture
	case "15": $vl_c_id_fenetre="Fen_00944";$vl_c_id_fenetre_reglement="Fen_01126";$vl_c_id_tab_echeancier="Div_00564";$vl_c_reglement="oui";$vl_c_journal="oui";break;//  Réglement fournisseurs 1 virement/traite/LCR -> une facture
	case '14': $vl_c_id_fenetre="Fen_00944";$vl_c_id_fenetre_reglement="Fen_01127";$vl_c_id_tab_echeancier="Div_00563";$vl_c_reglement="oui";$vl_c_journal="oui";$vl_c_multiple="oui";break;//	Réglements fournisseurs : 1 chèque -> n factures
	case "17": $vl_c_id_fenetre="Fen_00944";$vl_c_id_fenetre_reglement="Fen_01125";$vl_c_id_tab_echeancier="Div_00564";$vl_c_reglement="oui";$vl_c_journal="oui";$vl_c_multiple="oui";break;//  Réglement fournisseur 1 virement/traite/LCR -> n factures
	
	
	
	case '18':	// Traitements de masse sur Echéancier factures
		switch ($vl_c_genreacteur){
		  case "110003": $vl_c_id_fenetre="Fen_00960";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00561";break;  //  clients
		  case "110004": $vl_c_id_fenetre="Fen_00961";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00562";break;  //  fournisseurs
		  default:fa_redirige("acces_interdit");break;
		}
		break;	
}
switch ($vl_c_type){
	case '1':	//Echéancier factures
	case '2':	//Echéancier commandes
	case '3':	//Echéancier général
	case '18':	// Traitements de masse sur Echéancier factures
		$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
		break;
	case '5': //Réglements clients : 1 chèque -> une facture
	case '8':	//  Réglement client 1 virement/traite/LCR -> une facture
	case 'C8':	//  Réglement client 1 virement/traite/LCR -> une commande
	case '7': //Réglements clients : 1 chèque -> n factures
	case '10'://  Réglement client 1 virement/traite/LCR -> n factures
	case '12': //	Réglements fournisseurs : 1 chèque -> une facture
	case "15": //  Réglement fournisseurs 1 virement/traite/LCR -> une facture
	case '14': //	Réglements fournisseurs : 1 chèque -> n factures
	case "17": //  Réglement fournisseur 1 virement/traite/LCR -> n factures
		$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre_reglement,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre_reglement);
		break;
}	
$ml_journal=fa_brik_menulist_journaux("","ml_journal","",$journal_cleunik,"");
$vl_b_acces=$vl_tb_droits[0];
$vl_b_ajout=$vl_tb_droits[1];
$vl_b_modif=$vl_tb_droits[2];
$vl_b_suppr=$vl_tb_droits[3];
$vl_b_impri=$vl_tb_droits[4];
if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
//if ($vl_b_acces==false) {die($vl_c_id_fenetre." ".$vl_c_id_fenetre_reglement." ".$vl_c_type);}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);
$vl_c_brb_100=fa_recup_dico("brb_100");
$vl_c_brb_101=fa_recup_dico("brb_101");
$vl_c_brb_102=fa_recup_dico("brb_102");
$vl_c_brb_103=fa_recup_dico("brb_103");
$vl_c_brb_104=fa_recup_dico("brb_104");
$vl_c_brb_105=fa_recup_dico("brb_105");
$vl_c_brb_106=fa_recup_dico("brb_106");
$vl_c_brb_107=fa_recup_dico("brb_107");
$vl_c_brb_108=fa_recup_dico("brb_108");
$vl_c_brb_109=fa_recup_dico("brb_109");
$vl_c_brb_110=fa_recup_dico("brb_110");
$vl_c_brb_111=fa_recup_dico("brb_111");
$vl_c_brb_112=fa_recup_dico("brb_112");
$vl_c_brb_113=fa_recup_dico("brb_113");
$vl_c_brb_114=fa_recup_dico("brb_114");
$vl_c_brb_115=fa_recup_dico("brb_115");
$vl_c_brb_116=fa_recup_dico("brb_116");
$vl_c_brb_117=fa_recup_dico("brb_117");
$vl_c_brb_118=fa_recup_dico("brb_118");
$vl_c_brb_119=fa_recup_dico("brb_119");
$vl_c_brb_120=fa_recup_dico("brb_120");
$vl_c_brb_121=fa_recup_dico("brb_121");
$vl_c_brb_122=fa_recup_dico("brb_122");
$vl_c_brb_123=fa_recup_dico("brb_123");
$vl_c_brb_124=fa_recup_dico("brb_124");$vl_c_brb_124="Enlever du panier";
$vl_c_dico_00149=fa_recup_dico('dico_00149');
include("_graal_header_winxul.inc.php");
$vl_tc_composants=array($vl_c_id_fenetre_reglement,$vl_c_id_tab_echeancier);
echo <<<END
<window context="graal_cp00" title="$vl_c_brb_123" id="_win_fen_echeancier" onload="fa_aa(this);pf_aa_init();" onunload="pf_onunload();" flex="1" $c_xmlns>
<broadcasterset><broadcaster id="broadcaster_01" /></broadcasterset>
$vl_c_graal_cp00
END;
include_once("js/_graal_01.js.php");
include("js/_graal_echeancier_01.js.php");
include_once("js/_graal_05_dates.js.php");
echo <<<END
<vbox flex="1" class="overflow_01">
<vbox>
 <hbox flex="1">
	<menulist sizetopopup="none" flex="1" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="brb_ml_typedate" old_oncommand="pf_approximatif();" value="2">
    <menupopup>
      <menuitem label="$vl_c_brb_100" value="1"/>
      <menuitem label="$vl_c_brb_101" value="2"/>
      <menuitem label="$vl_c_brb_102" value="3"/>
    </menupopup>
  </menulist>
END;
$id_pref="";$id_deb="brb_tb_deb";$id_fin="brb_tb_fin";include ("_graal_inc_choix_periodes_01.php");
echo <<<END
</hbox>
</vbox>
<vbox>
<hbox flex="1">
<label value="$vl_c_brb_108"/>
<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="brb_ml_type" old_oncommand="pf_approximatif();" value="1">
    <menupopup>
      <menuitem label="$vl_c_brb_103" value="1"/>
      <menuitem label="$vl_c_brb_104" value="2"/>
      <menuitem label="$vl_c_brb_105" value="3"/>
      <menuitem label="$vl_c_brb_106" value="4"/>
      <menuitem label="$vl_c_brb_107" value="5"/>
			<menuitem label="$vl_c_brb_115" value="6"/>
      <menuitem label="$vl_c_brb_116" value="7"/>
      <menuitem label="$vl_c_brb_117" value="8"/>
			<menuitem label="$vl_c_brb_118" value="9"/>
      <menuitem label="$vl_c_brb_119" value="10"/>
      <menuitem label="$vl_c_brb_120" value="11"/>			
    </menupopup>
  </menulist>
  <textbox flex="2" value="$vl_c_brb_109" id="brb_tb_rechapproxima" oninput="pf_approximatif();"/>
  <hbox flex="2">
	<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="2" id="brb_ml_etat" old_oncommand="pf_approximatif();" value="7">
    <menupopup>
			<menuitem label="$vl_c_brb_122" value="7"/>
      <menuitem label="$vl_c_brb_110" value="1"/>
      <menuitem label="$vl_c_brb_111" value="2"/>
      <menuitem label="$vl_c_brb_112" value="3"/>
      <menuitem label="$vl_c_brb_113" value="4"/>
      <menuitem label="$vl_c_brb_114" value="5"/>
			<menuitem label="$vl_c_brb_121" value="6"/>
    </menupopup>
  </menulist>
	</hbox>
	<keyset id="_graal_ks_02">
    <key id="k-recherche" modifiers="alt" keycode="VK_F3" oncommand="fa_att_set('dk_01','selectedIndex',0);pf_approximatif();"/>
	</keyset>
	<toolbarbutton class="table-rafraichir" id="brb_top_raf01" oncommand="fa_att_set('dk_01','selectedIndex',0);pf_approximatif();"/>
	<toolbarbutton class="ag01" id="brb_graphique" oncommand="fa_att_set('dk_01','selectedIndex',1);pf_deck_graphique();"/>
	<toolbarbutton id="bt_info_fen" class="ab19" label="$vl_c_dico_00149"  crop="end" dir="normal" oncommand="fa_infos_fenetre('$vl_c_win_id')" />
</hbox>
</vbox>
<deck id="dk_01" selectedIndex="0" flex="1">
        <_graal_deck value="Deck n° 1 tableau" orient="vertical">

END;
if ($vl_c_journal=="oui") {
	echo $ml_journal;
}
if ($vl_c_multiple=="oui"){

	echo ('<tabbox flex="1">');
    echo('<tabpanels flex="1" style="border-bottom: 0px solid" >');
       include("_graal_inc_echeancier_01.php");
				$vl_c_context_00='<menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\'arbre_echeancier_panier\');" />';
				$vl_c_menucontext_arbre='<popupset><popup id="menu_contexte_echeancier_panier">'.$vl_c_context_00;
				$vl_c_menucontext_arbre.='<menuitem class="menuitem-iconic" label="'.$vl_c_brb_124.'" oncommand="pf_panier_enleve();"/>';
				$vl_c_menucontext_arbre.='</popup></popupset>';
echo <<<END
<vbox flex="1" class="overflow_01">
$vl_c_menucontext_arbre
  <tree id="arbre_echeancier_panier" flex="1" hidecolumnpicker="false" flags="" ref="*" querytype="xml" datasources="" enableColumnDrag="true" context="menu_contexte_echeancier_panier" seltype="multiple">
    <treecols>
	    <treecol id="tc_echeance_cleunik"  hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_commercial_cleunik"  hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_pc_cleunik"  hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_noligne" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_date_paiement" hidden="true" ignoreincolumnpicker="true" sort="?date_paiement"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_date_echeance" hidden="true" ignoreincolumnpicker="true" sort="?date_echeance"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_date_paiement_clair" label="$vl_c_brb_001" tooltiptext="$vl_c_brb_001" sort="?date_paiement"/><splitter class="tree-splitter" resizeafter="grow"/>
      	<treecol id="tc_date_echeance_clair" label="$vl_c_brb_002" tooltiptext="$vl_c_brb_002" sort="?date_echeance"/><splitter class="tree-splitter" resizeafter="grow"/>
      	<treecol id="tc_libelle" hidden="true" ignoreincolumnpicker="true" sort="?libelle"/><splitter class="tree-splitter" resizeafter="grow"/>
      	<treecol id="tc_montant_du" label="$vl_c_brb_003" tooltiptext="$vl_c_brb_003" sort="?val_montant_du" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
    	<treecol id="tc_montant_paye" label="$vl_c_brb_004" tooltiptext="$vl_c_brb_004" sort="?val_montant_paye" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_montant_regle_treso" label="$vl_c_brb_010" tooltiptext="$vl_c_brb_010" sort="?val_montant_regle_treso" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_montant_restant" label="$vl_c_brb_011" tooltiptext="$vl_c_brb_011" sort="?val_montant_restant" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_devise_du" label="$vl_c_brb_005" tooltiptext="$vl_c_brb_005" sort="?devise_du"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_devise_paye" label="$vl_c_brb_006" tooltiptext="$vl_c_brb_006" sort="?devise_paye"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_taux_de_change" hidden="true" ignoreincolumnpicker="true" sort="?taux_de_change"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_mode_paiement" label="$vl_c_brb_007" tooltiptext="$vl_c_brb_007" sort="?mode_paiement"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_blocnotebrut" label="$vl_c_brb_008" tooltiptext="$vl_c_brb_008" sort="?blocnotebrut"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_dateheurecreation" hidden="true" ignoreincolumnpicker="true" sort="?dateheurecreation"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_dateheuremodif" hidden="true" ignoreincolumnpicker="true" sort="?dateheuremodif"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_etat" label="$vl_c_brb_009" tooltiptext="$vl_c_brb_009" sort="?etat"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_val_montant_du" hidden="true" ignoreincolumnpicker="true" sort="?val_montant_du" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
	    <treecol id="tc_val_montant_paye" hidden="true" ignoreincolumnpicker="true" sort="?val_montant_paye" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_code_document" label="$vl_c_brb_012" tooltiptext="$vl_c_brb_012" sort="?code_document"/><splitter class="tree-splitter" resizeafter="grow"/>
      	<treecol id="tc_nomcommercial" label="$vl_c_brb_013" tooltiptext="$vl_c_brb_013" sort="?nomcommercial"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_val_montant_restant" hidden="true" ignoreincolumnpicker="true" sort="?val_montant_restant" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_date_fact" hidden="true" ignoreincolumnpicker="true" sort="?date_fact"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_date_fact_clair" label="Date de facture" tooltiptext="Date de facture" sort="?date_fact"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_properties_document" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_action_cleunik" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_act_cleunik" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_val_montant_regle_treso" hidden="true" ignoreincolumnpicker="true" sort="?val_montant_regle_treso" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_fichier_echeance" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
    </treecols>
     <template><query expr="*"/><action>
      <treechildren>
        <treeitem uri="?" seltype="single">
          <treerow>
            <treecell label="?echeance_cleunik"/>
            <treecell label="?commercial_cleunik"/>
            <treecell label="?pc_cleunik"/>
            <treecell label="?noligne"/>
            <treecell label="?date_paiement"/>
            <treecell label="?date_echeance"/>
			<treecell label="?date_paiement_clair"/>
            <treecell label="?date_echeance_clair"/>						
            <treecell label="?libelle"/>
            <treecell label="?montant_du"/>
            <treecell label="?montant_paye"/>
			<treecell properties="?properties_paye" label="?montant_regle_treso"/>	
            <treecell properties="?properties_restant" label="?montant_restant"/>
            <treecell label="?devise_du"/>
            <treecell label="?devise_paye"/>
            <treecell label="?taux_de_change"/>
            <treecell properties="?prop_type" label="?mode_paiement"/>
            <treecell label="?blocnotebrut"/>
            <treecell label="?dateheurecreation"/>
            <treecell label="?dateheuremodif"/>
            <treecell label="?etat"/>
            <treecell label="?val_montant_du"/>
            <treecell label="?val_montant_paye"/>
			<treecell properties="?properties_document" label="?code_document"/>
            <treecell properties="?properties_acteur" label="?nomcommercial"/>
			<treecell label="?val_montant_restant"/>
			<treecell label="?date_fact"/>
            <treecell label="?date_fact_clair"/>
			<treecell label="?properties_document"/>
			<treecell label="?action_cleunik"/>
			<treecell label="?act_cleunik"/>	
			<treecell label="?val_montant_regle_treso"/>	
			<treecell label="?fichier_echeance"/>			
          </treerow>
        </treeitem>
      </treechildren>
    </action></template>
  </tree>
	<splitter/>
  <vbox flex="1">
      <iframe onload="fa_aa(window.graal_iframe_visu_reglement);event.stopPropagation();" id="graal_iframe_visu_reglement" src="" flex="1"/>
  </vbox>
</vbox>
</tabpanels>
    <tabs class="tabs-bottom">
       <tab label="Echéances" class="tab-bottom" />
       <tab label="Panier" class="tab-bottom" />
    </tabs>
  </tabbox>


END;
} else {
	echo "<vbox flex='1'>";
	include("_graal_inc_echeancier_01.php");
if ($vl_c_reglement=="oui") {
echo <<<END
<splitter/>
  <vbox flex="1">
      <iframe onload="fa_aa(window.graal_iframe_visu_reglement);event.stopPropagation();" id="graal_iframe_visu_reglement" src="" flex="1"/>
  </vbox>
END;
}
echo "</vbox>";
}
echo <<<END

</_graal_deck>
        <_graal_deck value="Deck n° 2 : représentation graphique">
			
			<tabbox id="tabbox_01" flex="1" orient="vertical" class="overflow_01">
  <tabs id="tab_infogene">
     <tab class="$class_tabedition" id="tab_donnees" linkedpanel="tabpanel_donnees" first-tab="true" label="Données" selected="true"/>
     <tab class="af08" id="tab_graphe" linkedpanel="tabpanel_graphe" label="Paramètres graphe"/>
  </tabs>
  <tabpanels flex="1">
		<tabpanel id="tabpanel_donnnees" flex="1">
			<vbox>
			<vbox>
			<hbox>	
				
				<label value="Regroupé par "/>
        <menulist sizetopopup="none" flex="1" id="ml_art_04" _graal_nombre="5'" value='1'>
          <menupopup>
            <menuitem class='menuitem-non-iconic' value='1' label='jour' />
            <menuitem class='menuitem-non-iconic' value='2' label='semaine'  />
            <menuitem class='menuitem-non-iconic' value='3' label='mois'  />
            <menuitem class='menuitem-non-iconic' value='4' label='trimestre'/>
            <menuitem class='menuitem-non-iconic' value='5' label='année'  />
          </menupopup>
        </menulist>
        <button id="bt_calcul" label="Calculer" onclick="pf_deck_graphique();" />
				<button id="bt_10" label="Voir" tooltiptext="Voir l'histogramme" onclick="pf_dessin()" />
      </hbox>
    </vbox>
     <tree id="arbre_echeancier_graphique" enableColumnDrag="true" flex="1" flags="" ref="*" querytype="xml" datasources="">
       <treecols>
        <treecol id="rang"  label="Rang"  sort="?z00" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="nombre_brut" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="nombre_formatte"  label="Nombre" sort="?z01_tri" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="periode"  label="Période" sort="?z03" sortActive="true" sortDirection="ascending" class="centre"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="z03" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
       </treecols>
       <template><query expr="*"/><action>
         <treechildren>
           <treeitem uri="?" seltype="single">
             <treerow>
               <treecell label="?z00"/>
               <treecell label="?z01_tri"/>
               <treecell label="?z01"/>
               <treecell label="?periode"/>
               <treecell label="?z03"/>
             </treerow>
           </treeitem>
         </treechildren>
       </action></template>
     </tree>
   </vbox>
	 <splitter />
<vbox flex="3">
    <iframe onload="event.stopPropagation();" id="webFrame" flex="3" />
</vbox>
		</tabpanel>
END;
echo ("<tabpanel>");
include("_graal_inc_parametres_graphes_01.php");
echo ("</tabpanel>");
echo <<<END
		</tabpanels>
	</tabbox>		
				
</_graal_deck>
</deck>
</vbox>
</window>
END;
?>
