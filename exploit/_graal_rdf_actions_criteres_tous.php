<?php
include("_graal_header_xml.inc.php");
define('EOL', "\r\n");
$vl_e_action_cleunik=intval(fa_recup_param('vl_action_cleunik','10281'));
$vl_e_uti_cleunik=intval(fa_recup_session('vs_uti_cleunik','0'));
// execution de la requète SQL
$sql_req = "SELECT _actions_choix_fixes.action_cleunik AS action_cleunik,_actions_choix_fixes.choix_cleunik AS choix_cleunik,_choix.critere_cleunik AS critere_cleunik,case _criteres.critere_codechoixpertinent WHEN 1 THEN _choix.choix_code ELSE '' END AS choix_code,_choix.choix_valeur_texte_01 AS choix_valeur_texte_01,_criteres.critere_denomination AS critere_denomination,concat(_utilisateur.prenom,' ',_utilisateur.patronyme) AS prenom_nom FROM _choix, _actions_choix_fixes, _criteres,_utilisateur  WHERE _choix.choix_cleunik = _actions_choix_fixes.choix_cleunik  AND _criteres.critere_cleunik = _actions_choix_fixes.critere_cleunik AND _actions_choix_fixes.action_cleunik IN ($vl_e_action_cleunik) and _utilisateur.uti_cleunik=_actions_choix_fixes.uti_cleunik";
$result = _graal_requete_bd($sql_req);
echo(fa_xcree_entete_rdf());  
while ($row = mysql_fetch_assoc($result)){
  echo('<RDF:li>'.EOL);
  echo('<RDF:Description>');
  // parseType = indication pour le type des données, utile pour le tri sur la colonne
  echo('<row:action_cleunik NC:parseType="Integer">'.fa_ent_xml($row['action_cleunik']).'</row:action_cleunik>');
  echo('<row:choix_cleunik NC:parseType="Integer">'.fa_ent_xml($row['choix_cleunik']).'</row:choix_cleunik>');
  echo('<row:critere_cleunik NC:parseType="Integer">'.fa_ent_xml($row['critere_cleunik']).'</row:critere_cleunik>');
  echo('<row:choix_code>'.fa_ent_xml($row['choix_code']).'</row:choix_code>');
  echo('<row:choix_valeur_texte_01>'.fa_ent_xml($row['choix_valeur_texte_01']).'</row:choix_valeur_texte_01>');
  echo('<row:critere_denomination>'.fa_ent_xml($row['critere_denomination']).'</row:critere_denomination>');
  echo('<row:prenom_nom>'.fa_ent_xml($row['prenom_nom']).'</row:prenom_nom>');
  echo('</RDF:Description>'.EOL);
  echo('</RDF:li>'.EOL);
}
// fin du fichier RDF
echo('</RDF:Bag>'.EOL);
echo('</RDF:RDF>'.EOL);
// fermeture du curseur et de la connexion
_graal_libere_requete_bd($result);
_graal_ferme_connexion();
?>
