<?php
include("_graal_header_xul.inc.php");
$vl_e_genreacteur=intval(fa_recup_param('vl_e_genreacteur','0'));
$vl_c_genre_import=fa_recup_param('vl_c_genre_import','0000');
switch ($vl_e_genreacteur) {
  case "110001": $vl_c_id_fenetre="Fen_00789";break;  //  prospects clients
  case "110002": $vl_c_id_fenetre="Fen_00791";break;  //  prospects fournisseurs
  case "110003": $vl_c_id_fenetre="Fen_00788";break;  //  clients
  case "110004": $vl_c_id_fenetre="Fen_00790";break;  //  fournisseurs
  case "110005": $vl_c_id_fenetre="Fen_00792";break;  //  autres acteurs
  case "110006": $vl_c_id_fenetre="Fen_00793";break;  //  acteurs indéterminés
}
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);
$vl_b_acces=$vl_tb_droits[0];
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=1;
if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_dico_00005=fa_recup_dico('dico_00005');
$vl_c_bqm_100=fa_recup_dico("bqm_100");
$vl_c_bqm_101=fa_recup_dico("bqm_101");
$vl_c_bqm_102=fa_recup_dico("bqm_102");
$vl_c_bqm_103=fa_recup_dico("bqm_103");
$vl_c_bqm_104=fa_recup_dico("bqm_104");
$vl_c_bqm_105=fa_recup_dico("bqm_105");
$vl_c_bqm_106=fa_recup_dico("bqm_106");
$vl_c_bqm_107=fa_recup_dico("bqm_107");
$vl_c_bqm_108=fa_recup_dico("bqm_108");
$vl_c_bqm_109=fa_recup_dico("bqm_109");
$vl_c_bqm_110=fa_recup_dico("bqm_110");
$vl_c_bqm_111=fa_recup_dico("bqm_111");
$vl_c_bqm_112=fa_recup_dico("bqm_112");$vl_c_bqm_112="Modèle 2 (27 colonnes)";
$vl_c_bqm_113=fa_recup_dico("bqm_113");
$vl_c_bqm_114=fa_recup_dico("bqm_114");
$vl_c_bqm_115=fa_recup_dico("bqm_115");
$vl_c_bqm_119=fa_recup_dico("bqm_119");$vl_c_bqm_119="Modèle 3 (31 colonnes)";
$vl_c_bqm_120=fa_recup_dico("bqm_120");$vl_c_bqm_120="Modèle 4 (11 colonnes) (France Prospect) séparateur point virgule";
$vl_c_bqm_121=fa_recup_dico("bqm_121");
$vl_c_bqm_122=fa_recup_dico("bqm_122");
$vl_c_bqm_123=fa_recup_dico("bqm_123");
$vl_c_bqm_124=fa_recup_dico("bqm_124");
$vl_c_bqm_125=fa_recup_dico("bqm_125");
$vl_c_bqm_126=fa_recup_dico("bqm_126");
$vl_c_bqm_127=fa_recup_dico("bqm_127");
$vl_c_bqm_128=fa_recup_dico("bqm_128");
$vl_c_bqm_129=fa_recup_dico("bqm_129");
$vl_c_bqm_130=fa_recup_dico("bqm_130");
$vl_c_bqm_133=fa_recup_dico("bqm_133");
$vl_c_bqm_136=fa_recup_dico("bqm_136");
$vl_c_bqm_137=fa_recup_dico("bqm_137");
$vl_c_bqm_138=fa_recup_dico("bqm_138");
$vl_c_dico_00006=fa_recup_dico("dico_00006");
$vl_c_dico_00013=fa_recup_dico("dico_00013");
$vl_c_dico_00014=fa_recup_dico("dico_00014");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_dico_00149=fa_recup_dico('dico_00149');
switch ($vl_c_genre_import) {
	case "0000":
		fa_redirige("acces_interdit");
		break;
	case "9999":
		$vl_c_import=<<<EOT
<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="1" id="menu_02" observes="broadcaster_01" value="02">
     <menupopup>
      <menuitem id="menu_02_01" label="01 $vl_c_bqm_102" value="01" hidden="true"/>
      <menuitem id="menu_02_02" label="02 $vl_c_bqm_112" value="02" />
      <menuitem id="menu_02_03" label="03 $vl_c_bqm_119" value="03" />
      <menuitem id="menu_02_04" label="04 $vl_c_bqm_120" value="04" />
     </menupopup>
   </menulist>		
EOT;
		break;
case "02":
		$vl_c_import=<<<EOT
<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="1" id="menu_02" observes="broadcaster_01" value="02">
     <menupopup>
      <menuitem id="menu_02_02" label="02 $vl_c_bqm_112" value="02" />
     </menupopup>
   </menulist>		
EOT;
		break;	
	case "03":
		$vl_c_import=<<<EOT
<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="1" id="menu_02" observes="broadcaster_01" value="03">
     <menupopup>
      <menuitem id="menu_02_03" label="03 $vl_c_bqm_119" value="03" />
     </menupopup>
   </menulist>		
EOT;
	case "04":
		$vl_c_import=<<<EOT
<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="1" id="menu_02" observes="broadcaster_01" value="04">
     <menupopup>
      <menuitem id="menu_02_04" label="04 $vl_c_bqm_120" value="04" />
     </menupopup>
   </menulist>
   <button label="Légende" oncommand="pf_sel_deck_arbre(2);" />	
EOT;
		break;
}
switch ($vl_c_genre_import) {
	case "9999":
		$vl_c_legende="";
		break;
case "02":
		$vl_c_legende="";
		break;	
	case "03":
		$vl_c_legende="";
	case "04":
		$vl_c_legende=<<<EOT
 		<vbox flex="1">
 		<button label="Retour" oncommand="pf_sel_deck_arbre(0);" />
		<listbox rows="11">
		<listcols>
	<listcol flex="1" />
	<splitter class="tree-splitter" />
	<listcol flex="1" />
	
      </listcols>
      <listhead><listheader label="Colonne" /><listheader label="Intitulé" /></listhead>
      <listitem><label value="A ( 1)" /><label value="Raison Sociale" /></listitem>
      <listitem><label value="B ( 2)" /><label value="Dirigeant" /></listitem>
      <listitem><label value="C ( 3)" /><label value="Adresse" /></listitem>
      <listitem><label value="D ( 4)" /><label value="Code postal" /></listitem>
      <listitem><label value="E ( 5)" /><label value="Ville" /></listitem>
      <listitem><label value="F ( 6)" /><label value="Téléphone" /></listitem>
      <listitem><label value="G ( 7)" /><label value="Télécopie" /></listitem>
      <listitem><label value="H ( 8)" /><label value="Email" /></listitem>
      <listitem><label value="I ( 9)" /><label value="Code NAF" /></listitem>
      <listitem><label value="I (10)" /><label value="Libellé NAF" /></listitem>
      <listitem><label value="K (11)" /><label value="Rubrique professionnelle" /></listitem>
    </listbox>
    </vbox>
    
			
EOT;
		break;
}




include("_graal_header_winxul.inc.php");
echo <<<END
<window title="$vl_c_bqm_100" onload="fa_aa(this);pf_etat_fen('ini')" onunload="pf_onunload();" $c_xmlns>
$vl_c_graal_cp00 
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_import_acteurs_00.js.php");
include("js/_graal_03.js.php");
echo <<<END
<script type="application/x-javascript" src="js/sha1.js" />
<popupset>
  <popup id="pop_fichier">
    <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_entetes_courriels');" />
    <menuitem label="$vl_c_bqm_129" class="menuitem-iconic al17" oncommand="pf_fichier_supprime();" />
  </popup>
  <popup id="pop_acteurs">
    <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_adresses_courriel');" />
    <menuitem label="$vl_c_bqm_133" class="menuitem-iconic al17" oncommand="pf_acteurs_supprime();" />
  </popup>

</popupset>
<vbox>
  <hbox flex="1">
  $vl_c_import
   <button tooltiptext ="$vl_c_dico_00006 Ctrl+Shift+F6" id="bt_annuler" label="$vl_c_dico_00006" crop="end" dir="normal" oncommand="pf_etat_fen('annuler');" />
   <button id="bt_info_fen" class="ab19" label="$vl_c_dico_00149"  crop="end" dir="normal" oncommand="fa_infos_fenetre('$vl_c_win_id')" />
  </hbox>
  <hbox flex="1">
    <toolbarbutton id="bt_rouvrir" label="$vl_c_bqm_122" class="aa01" tooltiptext="$vl_c_bqm_122"  oncommand="pf_fichier_ouvre(2);"/>
    <toolbarbutton id="bt_selection" label="$vl_c_bqm_101" class="al02" tooltiptext="$vl_c_bqm_101"  oncommand="pf_fichier_ouvre(1);"/>
    <textbox flex="1" id="tb_emplacement"   maxlenght="260"/>
		<label value="$vl_c_bqm_138"/>
		<radiogroup id='rdg_conserver' name='name' value="1" disabled="true">
      <hbox>
        <radio id='ra_conserver_oui' label="$vl_c_dico_00013" value='1' />
        <radio id='ra_conserver_non' label="$vl_c_dico_00014" value='2'/>
       </hbox>
     </radiogroup>
    <toolbarbutton id="bt_exploiter" label="$vl_c_bqm_103" class="ad02" tooltiptext="$vl_c_bqm_103"  oncommand="pf_fichier_exploite();"/>
  </hbox>
</vbox>
	<deck id="deck_arbres" flex="1">
		<pseudo_boite>
  		<iframe id="if_import_acteurs" src="" flex="1"/>
		</pseudo_boite>
<pseudo_boite>
<vbox id="box_boite_outils_xof_01" flex="1">
  <tree id="arbre_entetes_acteurs" flex="1" hidecolumnpicker="false" flags="" ref="*" querytype="xml" datasources="" enableColumnDrag="true" context="pop_fichier">
    <treecols>
      <treecol id="tc_imp_cleunik" hidden="true" sort="?imp_cleunik" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_description" label="$vl_c_bqm_123" sort="?description" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_dateheuremodif" label="$vl_c_bqm_124" sort="?dateheuremodif" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_dateheurecreation" label="$vl_c_bqm_125" sort="?dateheurecreation" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_typeimport" label="$vl_c_bqm_126" sort="?typeimport" /><splitter class="tree-splitter" resizeafter="grow"/>
    </treecols>
    <template><query expr="*"/><action>
      <treechildren>
        <treeitem uri="?" seltype="single">
          <treerow>
            <treecell label="?imp_cleunik"/>
            <treecell label="?description"/>
            <treecell label="?dateheuremodif"/>
            <treecell label="?dateheurecreation"/>
            <treecell label="?typeimport"/>
          </treerow>
        </treeitem>
      </treechildren>
    </action></template>
  </tree>
  <hbox>
    <button flex="1" label="$vl_c_bqm_127" oncommand="pf_sel_deck_arbre(0);" />
    <button flex="1" label="$vl_c_bqm_128" oncommand="pf_fichier_ouvre(3);" />
  </hbox>
</vbox>
</pseudo_boite>
<pseudo_boite>
$vl_c_legende
</pseudo_boite>
</deck>
</window>
END;
?>
