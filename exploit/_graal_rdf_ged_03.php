<?php
header('Content-type: text/xml; charset=utf-8');
header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT"); // Date in the past
require("_graal_fonctions_mysql.php");
$result = _graal_requete_bd($sql_req);
echo(fa_xcree_entete_rdf());
while ($row = mysql_fetch_assoc($result)) {
  echo('<RDF:li>'.EOL);
  echo('<RDF:Description>');
  // parseType = indication pour le type des données, utile pour le tri sur la colonne
  echo('<row:doc_cleunik NC:parseType="Integer">'.fa_ent_xml($row['doc_cleunik']).'</row:doc_cleunik>');
  echo('<row:emplacement>'.fa_ent_xml($row['emplacement']).'</row:emplacement>');
  echo('<row:titre>'.fa_ent_xml($row['titre']).'</row:titre>');
  echo('<row:typedoc>'.fa_ent_xml($row['typedoc']).'</row:typedoc>');
  echo('<row:descriptif_sommaire>'.fa_ent_xml($row['descriptif_sommaire']).'</row:descriptif_sommaire>');
  echo('<row:origine>'.fa_ent_xml($row['origine']).'</row:origine>');
  echo('<row:portee>'.fa_ent_xml($row['portee']).'</row:portee>');
  echo('<row:tailledoc>'.fa_ent_xml($row['tailledoc']).'</row:tailledoc>');
  echo('<row:dateheuremodif>'.fa_ent_xml($row['dateheuremodif']).'</row:dateheuremodif>');
  echo('<row:dateheurecreation>'.fa_ent_xml($row['dateheurecreation']).'</row:dateheurecreation>');
/*
le 8 septembre 2008 
  typedoc    1 -> Liens, 
             2 -> Notes,
             3 -> Documents,
             4 -> Dossier,
             5 -> courriels envoyés,
             6 -> modèles de courriels texte,
             7 -> Flux RSS,
             8 -> requêtes personnelles,
             9 -> images des articles, logos de l'entreprise
            10 -> modèles de courriels HTML,
            11 -> modèles de notes,
            12 -> modèles de notification de lecture,
            13 -> pièces jointes,
            14 -> menus personalisés
           101 -> modèles textes entêtes offres clients,
           102 -> modèles textes pied offres clients,
           111 -> modèles textes entêtes commandes clients,
           112 -> modèles textes pied commandes clients,
           121 -> modèles textes entêtes livraison clients,
           122 -> modèles textes pied livraison clients,
           131 -> modèles textes entêtes facture clients,
           132 -> modèles textes pied facture clients,
           141 -> modèles textes entêtes demandes fournisseur,
           142 -> modèles textes pied demandes fournisseur,
           151 -> modèles textes entêtes commandes fournisseur,
           152 -> modèles textes pied commandes fournisseur,
           900 -> Conditions générales de vente
           901 -> Bloc de désinscription pour emailing html
           902 -> Bloc de désinscription pour emailing texte
*/           
  switch ($row['typedoc']) {
    case 1  : echo('<row:properties>ah05</row:properties>');break;  //  liens
    case 2  : echo('<row:properties>ai02</row:properties>');break;  //  notes  
    case 3  : echo('<row:properties>ai03</row:properties>');break;  //  documents
    case 9  : echo('<row:properties>ab17</row:properties>');break;  //  Images
    default : echo('<row:properties></row:properties>');break;
  }
  echo('</RDF:Description>'.EOL);
  echo('</RDF:li>'.EOL);
}
echo('</RDF:Bag>'.EOL);
echo('</RDF:RDF>'.EOL);
_graal_libere_requete_bd($result);
_graal_ferme_connexion();
?>
