<?php
include("_graal_header_txt.inc.php");
$vf_c_echo="";
$vl_e_art_cleunik=intval(fa_recup_param("vl_art_cleunik","-1"));
$vf_c_action=fa_recup_param("vf_c_action","??????");
$vl_multiple_base=fa_floatval(fa_recup_param("vl_multiple_base",0));
$vl_nbdec_pr=intval(fa_recup_param("vl_nbdec_pr","2"));
$vl_pr=fa_floatval(fa_recup_param("vl_pr",0));

$vl_pr=fa_reel($vl_pr,$vl_nbdec_pr);
switch ($vf_c_action){
  case "supprimer":
    $sql_req = "DELETE FROM _art_fabs WHERE art_cleunik = $vl_e_art_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_e_art_cleunik;} else {$vf_c_echo=-1;}
    break;    
  case "ajouter":
  case "modifier":
    $sql_req="REPLACE INTO _art_fabs set art_cleunik=$vl_e_art_cleunik,multiple_base=$vl_multiple_base,pr=$vl_pr,nbdec_pr=$vl_nbdec_pr;";    
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {
      $vf_c_echo=$vl_e_art_cleunik;
    }
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;
?>
