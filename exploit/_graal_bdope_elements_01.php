<?php 
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_elements_01";
$t_origines_ok[1]="_graal_fen_elements_02";
fa_acces_script();
$vl_e_mini=intval(fa_recup_session('borne_mini','0'));
$vl_e_maxi=intval(fa_recup_session('borne_maxi','0'));
$vf_c_action=fa_recup_param('vf_c_action','??????');
$vl_e_fen_cleunik=intval(fa_recup_param('vl_e_fen_cleunik','0'));
$vl_e_ele_cleunik=intval(fa_recup_param('vl_e_ele_cleunik','0'));
$vl_c_titre=fa_recup_param('vl_c_titre','');
$vl_c_descriptif=fa_recup_param('vl_c_descriptif','');
$vl_c_commentaire=fa_recup_param('vl_c_commentaire','');
$vl_e_type_objet=intval(fa_recup_param('vl_e_type_objet','1'));
$vl_e_langue=120131;  // français par défaut
$vs_e_uti_cleunik=intval(fa_recup_session('vs_uti_cleunik','0'));
if ($vs_e_uti_cleunik==1){
	$vl_e_uti_cleunik=0;
} else {
	$vl_e_uti_cleunik=$vs_e_uti_cleunik;
}
$vf_c_echo='';
switch (TRUE) {
  case $vf_c_action=='??????':
    exit;
    break;    
  case $vf_c_action=='supprimer': 
{
    $sql_req = "DELETE FROM _elements WHERE _elements.ele_cleunik = $vl_e_ele_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
}
  case $vf_c_action=='ajouter':
{
  $vl_e_ele_cleunik=_graal_requete_max("ele_cleunik","_elements");
  {
      $sql_req = "INSERT INTO _elements set fen_cleunik=$vl_e_fen_cleunik,ele_cleunik=$vl_e_ele_cleunik,titre='$vl_c_titre',type_objet=$vl_e_type_objet";
      $vf_c_echo=_graal_exec_requete($sql_req);
      $sql_req = "INSERT INTO _elements_libelle set ele_cleunik=$vl_e_ele_cleunik,descriptif='$vl_c_descriptif',commentaire='$vl_c_commentaire',langue=$vl_e_langue,uti_cleunik=$vl_e_uti_cleunik";
      $vf_c_echo=_graal_exec_requete($sql_req);
  }
  break;
}
  case $vf_c_action=='modifier':
{
  $sql_req = "update _elements set titre='$vl_c_titre',type_objet='$vl_e_type_objet' WHERE _elements.ele_cleunik = $vl_e_ele_cleunik";
  $vf_c_echo=_graal_exec_requete($sql_req);
  $sql_req = "REPLACE INTO _elements_libelle set ele_cleunik=$vl_e_ele_cleunik,descriptif='$vl_c_descriptif',commentaire='$vl_c_commentaire',langue=$vl_e_langue,uti_cleunik=$vl_e_uti_cleunik";
  $vf_c_echo=_graal_exec_requete($sql_req);
  //$vf_c_echo=$sql_req;
  break;
}
} 
_graal_ferme_connexion();
echo $vf_c_echo;       
?>
