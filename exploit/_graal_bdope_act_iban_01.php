<?php
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_act_iban_01";
fa_acces_script();
$vf_c_echo="";
$vf_c_action=fa_recup_param("vf_c_action","??????");
$vl_iban_cleunik=intval(fa_recup_param("vl_iban_cleunik",""));
$vl_act_cleunik=intval(fa_recup_param("vl_act_cleunik",""));
$vl_iban_bic=fa_recup_param("vl_bic","");
$vl_iban_info=fa_recup_param("vl_info","");
$vl_iban_papi=fa_recup_param("vl_papi","");
$vl_iban_pay=intval(fa_recup_param("vl_pays",""));
switch (TRUE){
  case $vf_c_action=="supprimer":
    $sql_req = "DELETE FROM _act_iban WHERE iban_cleunik = $vl_iban_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_iban_cleunik;}  else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="ajouter":
    $vl_iban_cleunik=_graal_requete_max("iban_cleunik","_act_iban");
    $sql_req = "INSERT INTO _act_iban set iban_cleunik=$vl_iban_cleunik,act_cleunik=$vl_act_cleunik,iban_info='$vl_iban_info',iban_papi='$vl_iban_papi',iban_bic='$vl_iban_bic',iban_pay=$vl_iban_pay;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_iban_cleunik;}  else {$vf_c_echo='-1-'.$vf_c_echo;}
    break;
  case $vf_c_action=="modifier":
    $sql_req = "UPDATE _act_iban set iban_info='$vl_iban_info',iban_papi='$vl_iban_papi',iban_bic='$vl_iban_bic',iban_pay=$vl_iban_pay WHERE iban_cleunik=$vl_iban_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_iban_cleunik;}  else {$vf_c_echo='-1-'.$vf_c_echo;}
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;
?>
