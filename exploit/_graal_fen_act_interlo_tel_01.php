<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik =intval(fa_recup_session("vs_uti_cleunik","0"));
$vl_c_genreacteur=fa_recup_param('genreacteur','0');
$vl_e_interlo_cleunik=intval(fa_recup_param("vl_e_interlo_cleunik","-1"));
$vl_e_intel_cleunik=intval(fa_recup_param("vl_e_intel_cleunik","-1"));
$vl_c_tel=fa_recup_param('tel','');
switch ($vl_c_genreacteur){
  case "110000": $vl_c_id_fenetre="Fen_00147";$vl_e_choix_portee="01";break;  //  Téléphones des interlocuteurs des Membres de l'entreprise
  case "110001": $vl_c_id_fenetre="Fen_00149";$vl_e_choix_portee="02";break;  //  Téléphones des interlocuteurs des prospects clients
  case "110002": $vl_c_id_fenetre="Fen_00150";$vl_e_choix_portee="08";break;  //  Téléphones des interlocuteurs des prospects fournisseurs
  case "110003": $vl_c_id_fenetre="Fen_00151";$vl_e_choix_portee="04";break;  //  Téléphones des interlocuteurs des clients
  case "110004": $vl_c_id_fenetre="Fen_00152";$vl_e_choix_portee="16";break;  //  Téléphones des interlocuteurs des fournisseurs
  case "110005": $vl_c_id_fenetre="Fen_00153";$vl_e_choix_portee="32";break;  //  Téléphones des interlocuteurs des autres acteurs
  case "110006": $vl_c_id_fenetre="Fen_00154";$vl_e_choix_portee="64";break;  //  Téléphones des interlocuteurs des acteurs indéterminés
  default:
    die;  
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_b_ajout=0;$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=0;
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_aag_100=fa_recup_dico("aag_100");
$vl_c_aag_101=fa_recup_dico("aag_101");
$vl_c_aag_102=fa_recup_dico("aag_102");
$vl_c_aag_103=fa_recup_dico("aag_103");
$vl_c_aag_104=fa_recup_dico("aag_104");
$vl_c_aag_105=fa_recup_dico("aag_105");
$vl_c_aag_106=fa_recup_dico("aag_106");
$vl_c_aag_107=fa_recup_dico("aag_107");
$vl_c_aag_111=fa_recup_dico("aag_111");
$vl_c_aag_112=fa_recup_dico("aag_112");
$vl_c_dico_00013=fa_recup_dico("dico_00013");
$vl_c_dico_00014=fa_recup_dico("dico_00014");
//  On recherche l'interlocuteur à partir du téléphone
if ($vl_e_intel_cleunik!=-1){
  $sql_req="SELECT _act_interlo_tel.int_cleunik as int_cleunik FROM _act_interlo_tel where _act_interlo_tel.intel_cleunik=$vl_e_intel_cleunik;"; 
  $result=_graal_requete_bd($sql_req);
  $row = mysql_fetch_assoc($result);
  $vl_e_interlo_cleunik=$row['int_cleunik'];
  _graal_libere_requete_bd($result);
}
//  On recherche les informations sur l'acteur et l'interlocuteur 
if ($vl_e_interlo_cleunik!=-1){
  $vl_c_tab=_graal_requete_interlo($vl_e_interlo_cleunik);
  $vl_c_qui=$vl_c_tab[0];
  $vl_e_act_cleunik=$vl_c_tab[1];
}
$ml_tel=fa_brik_menulist_choix(82,1,$vl_e_choix_portee,1,'','ml_tel_00',"broadcaster_01",-9);
$ml_prefixes=fa_brik_menulist_choix(66,1,$vl_e_choix_portee,1,'','ml_prefixe_tel_00',"broadcaster_01",121111);
include("_graal_header_winxul.inc.php"); 
echo <<<END
<window context="graal_cp00" title="$vl_c_aag_100" id="_win_fen_act_interlo_tel" onload="fa_aa(this);pf_aa_init();" $c_xmlns>
$vl_c_graal_cp00
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_act_interlo_tel_01.js.php");
echo <<<END
<broadcasterset>
  <broadcaster id="broadcaster_01" />
</broadcasterset>
<vbox flex="1" class="overflow_01">
  <description>$vl_c_qui</description>
  <vbox flex="0">
	<grid flex="1">
    <columns flex="1">
      <column/>
      <column flex="1"/>
    </columns>
    <rows>
      <row flex= "1">
        <label control="la_prefixe_choix_cleunik" value="$vl_c_aag_105"/>
        $ml_tel
     </row>
    <row flex= "1">
      $ml_prefixes
      <textbox observes="broadcaster_01" id="tb_telformate" value="$vl_c_tel" />
      </row>
		 <row flex="1">
		 <raf></raf>
		 <button observes="broadcaster_01" flex= "1" class="aa04" id="tb_tel_01_verif_deja" tooltiptext="$vl_c_aag_107" label="$vl_c_aag_107" oncommand="pf_verifie_deja_tel_01();"/>
		 </row>
     <row flex= "1">
        <label control="la_infodefaut" value="$vl_c_aag_104"/>
        <radiogroup id='rdg_actif' flex="1" name='name' value="1">
          <hbox>
            <radio observes="broadcaster_01" id='ra_choix_actif_oui' label="$vl_c_dico_00013" value='1'/>
            <radio observes="broadcaster_01" id='ra_choix_actif_non' label="$vl_c_dico_00014" value='2'/>
            <spacer flex="1"/>
           </hbox>
         </radiogroup>
      </row>
      <row flex= "1">
        <label value="$vl_c_aag_111"/>
        <radiogroup id='rdg_portable' flex="1" value="1">
          <hbox>
            
            <radio observes="broadcaster_01" id='ra_portable_non' label="$vl_c_dico_00014" value='1'/>
            <radio observes="broadcaster_01" id='ra_portable_oui' label="$vl_c_dico_00013" value='2'/>
            <spacer flex="1"/>
           </hbox>
         </radiogroup>
      </row>
      <row flex= "1">
        <label value="$vl_c_aag_112"/>
        <radiogroup id='rdg_sms' flex="1" value="1">
          <hbox>
            <radio observes="broadcaster_01" id='ra_sms_non' label="$vl_c_dico_00014" value='1'/>
            <radio observes="broadcaster_01" id='ra_sms_oui' label="$vl_c_dico_00013" value='2'/>
            <spacer flex="1"/>
           </hbox>
         </radiogroup>
      </row>
      <row flex= "1">
        <label control="la_dateheuremodif" value="$vl_c_aag_102"/>
        <label id="tb_dateheuremodif" />
      </row>
      <row flex= "30">
        <label control="la_blocnotebrut" value="$vl_c_aag_103"/>
        <textbox observes="broadcaster_01" id="tb_blocnotebrut" class="extensible" rows="17"/>
      </row>
    </rows>
  </grid>
	</vbox>
  <hbox flex="0" id="boutons_standards"> 
END;
include("_graal_inc_boutons_01.php");
echo("</hbox></vbox></window>");
?>
