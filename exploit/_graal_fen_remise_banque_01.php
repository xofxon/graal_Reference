<?php
include("_graal_header_xul.inc.php");
include("_graal_fonctions_echeances.php");
$vl_e_uti_cleunik =intval(fa_recup_session("vs_uti_cleunik","0"));
$vl_c_id_fenetre="Fen_01083";
$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;
$vl_c_id_tab_echeancier="Div_00551";
$vl_c_genreacteur="110003";
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_b_acces=$vl_tb_droits[0];
$vl_b_ajout=$vl_tb_droits[1];
$vl_b_modif=$vl_tb_droits[2];
$vl_b_suppr=$vl_tb_droits[3];
$vl_b_impri=$vl_tb_droits[4];
if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);
$ml_journal=fa_brik_menulist_journaux("","ml_journal","","-1","");
$ml_journal_remise=fa_brik_menulist_journaux("1","ml_journal_remise","","","-1");
$ml_option_remise=fa_brik_menulist_choix(145,1,-1,-1,'','ml_option_remise',"broadcaster_01",0);
$ml_mode_paiement=fa_brik_menulist_choix(137,1,-1,-1,'','ml_mode_paiement',"broadcaster_01",0);
$vl_c_bsr_100=fa_recup_dico("bsr_100");$vl_c_bsr_100="Date de règlement";
$vl_c_bsr_101=fa_recup_dico("bsr_101");
$vl_c_bsr_102=fa_recup_dico("bsr_102");
$vl_c_bsr_103=fa_recup_dico("bsr_103");
$vl_c_bsr_104=fa_recup_dico("bsr_104");
$vl_c_bsr_105=fa_recup_dico("bsr_105");
$vl_c_bsr_106=fa_recup_dico("bsr_106");$vl_c_bsr_106="Montant réglé";
$vl_c_bsr_107=fa_recup_dico("bsr_107");
$vl_c_bsr_108=fa_recup_dico("bsr_108");
$vl_c_bsr_109=fa_recup_dico("bsr_109");
$vl_c_bsr_110=fa_recup_dico("bsr_110");
$vl_c_bsr_111=fa_recup_dico("bsr_111");
$vl_c_bsr_112=fa_recup_dico("bsr_112");
$vl_c_bsr_113=fa_recup_dico("bsr_113");
$vl_c_bsr_114=fa_recup_dico("bsr_114");
$vl_c_bsr_115=fa_recup_dico("bsr_115");
$vl_c_bsr_116=fa_recup_dico("bsr_116");
$vl_c_bsr_117=fa_recup_dico("bsr_117");
$vl_c_bsr_118=fa_recup_dico("bsr_118");
$vl_c_bsr_119=fa_recup_dico("bsr_119");
$vl_c_bsr_120=fa_recup_dico("bsr_120");
$vl_c_bsr_121=fa_recup_dico("bsr_121");
$vl_c_bsr_122=fa_recup_dico("bsr_122");
$vl_c_bsr_123=fa_recup_dico("bsr_123");
$vl_c_bsr_124=fa_recup_dico("bsr_124");
$vl_c_bsr_125=fa_recup_dico("bsr_125");
$vl_c_bsr_126=fa_recup_dico("bsr_126");
$vl_c_dico_00149=fa_recup_dico('dico_00149');
$vl_c_dico_00005=fa_recup_dico('dico_00005');
$vl_c_dico_00007=fa_recup_dico('dico_00007');

$vl_c_yyy_100=fa_recup_dico("Clé Unique réglement");
  $vl_c_yyy_101=fa_recup_dico("Clé Unique journal");
  $vl_c_yyy_102=fa_recup_dico("Clé unique compte comptable acteur");
  $vl_c_yyy_103=fa_recup_dico("Mode de paiement");
  $vl_c_yyy_104=fa_recup_dico("N° de pièce");
  $vl_c_yyy_105=fa_recup_dico("Référence de la pièce");
  $vl_c_yyy_106=fa_recup_dico("Date/Heure de création");
  $vl_c_yyy_107=fa_recup_dico("Date/Heure de modification");
  $vl_c_yyy_108=fa_recup_dico("Date de réglement");
  $vl_c_yyy_109=fa_recup_dico("Montant réglé");
  $vl_c_yyy_1010=fa_recup_dico("Montant pointé sur facture");
  $vl_c_yyy_1011=fa_recup_dico("Devise du montant payé");
  $vl_c_yyy_1012=fa_recup_dico("Avoir -&gt; -1, Facture -&gt; 1");
  $vl_c_yyy_1013=fa_recup_dico("Genre");
  $vl_c_yyy_1014=fa_recup_dico("Transfert 1-&gt; oui, 2 -&gt; non");
  $vl_c_yyy_1015=fa_recup_dico("Impayé 1-&gt; oui, 2 -&gt; non");
  $vl_c_yyy_1016=fa_recup_dico("Remboursement 1-&gt; oui, 2 -&gt; non");
  $vl_c_yyy_1017=fa_recup_dico("Option remise");
  $vl_c_yyy_1018=fa_recup_dico("Accepté 1-&gt; oui, 2 -&gt; non");
  $vl_c_yyy_1019=fa_recup_dico("Nom de la banque");
  $vl_c_yyy_1020=fa_recup_dico("Domiciliation");
  $vl_c_yyy_1021=fa_recup_dico("Code Etablissement");
  $vl_c_yyy_1022=fa_recup_dico("Code guichet");
  $vl_c_yyy_1023=fa_recup_dico("Numéro de compte");
  $vl_c_yyy_1024=fa_recup_dico("Clé de contrôle");
  $vl_c_yyy_1025=fa_recup_dico("Type de l'écart");
  $vl_c_yyy_1026=fa_recup_dico("Bloc Note brut");
	$vl_c_yyy_1027=fa_recup_dico("Journal");
	$vl_c_yyy_1028=fa_recup_dico("Date de saisie");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_context_00_arbre_panier_remise_banque='<menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\'arbre_panier_remise_banque\');" />';
$vl_c_context_00_arbre_panier_remise_banque.='<menuitem label="Enlever du panier" tooltiptext="Enlever du panier" oncommand="pf_panier_enleve();" />';
$vl_c_menucontext_arbre_panier_remise_banque='<popupset><popup id="menu_contexte_panier_remise_banque">'.$vl_c_context_00_arbre_panier_remise_banque;
$vl_c_menucontext_arbre_panier_remise_banque.='</popup></popupset>';
if ($ml_journal_remise!=""){
	$bouton_valider=<<<EOT
	<button tooltiptext ="$vl_c_dico_00005" keycode="k-enregistrer" flex="1" id="bt_enregistrer" label="$vl_c_dico_00005" orient="horizontal" crop="end" oncommand="pf_validation('enregistrer')" />
EOT;
}
$vl_c_context_annulation=<<<EOT
<menuitem label="Ajouter au panier" tooltiptext="Ajouter au panier" oncommand="pf_panier_ajoute();" />
EOT;
include("_graal_header_winxul.inc.php");
echo <<<END
<window context="graal_cp00" title="$vl_c_bsr_123" id="_win_fen_echeancier" onload="fa_aa(this);pf_aa_init();" onunload="pf_onunload();" flex="1" $c_xmlns>
<broadcasterset><broadcaster id="broadcaster_01" /></broadcasterset>
$vl_c_graal_cp00
END;
include_once("js/_graal_01.js.php");
include("js/_graal_remise_banque_01.js.php");
include_once("js/_graal_05_dates.js.php");
echo <<<END
<vbox flex="1" class="overflow_01">
<vbox>
	<hbox collapsed="true">	
		$ml_journal
	</hbox>
 <hbox flex="1">
	<menulist sizetopopup="none" flex="1" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="bsr_ml_typedate" oncommand="pf_approximatif()" value="4">
    <menupopup>
      <menuitem label="$vl_c_bsr_100" value="1"/>
      <menuitem collapsed="true" label="$vl_c_bsr_101" value="2"/>
      <menuitem collapsed="true" label="$vl_c_bsr_102" value="3"/>
      <menuitem label="$vl_c_bsr_126" value="4"/>
    </menupopup>
  </menulist>
END;
$id_pref="";$id_deb="bsr_tb_deb";$id_fin="bsr_tb_fin";include ("_graal_inc_choix_periodes_01.php");
echo <<<END
</hbox>
</vbox>
<vbox>
<hbox flex="1">
<label value="$vl_c_bsr_108"/>
<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="bsr_ml_type" oncommand="pf_approximatif()" value="4">
    <menupopup>
      <menuitem collapsed="true" label="$vl_c_bsr_103" value="1"/>
      <menuitem collapsed="true" label="$vl_c_bsr_104" value="2"/>
      <menuitem collapsed="true" label="$vl_c_bsr_105" value="3"/>
      <menuitem label="$vl_c_bsr_106" value="4"/>
      <menuitem collapsed="true" label="$vl_c_bsr_107" value="5"/>
		<menuitem collapsed="true" label="$vl_c_bsr_115" value="6"/>
      <menuitem collapsed="true" label="$vl_c_bsr_116" value="7"/>
      <menuitem collapsed="true" label="$vl_c_bsr_117" value="8"/>
		<menuitem collapsed="true" label="$vl_c_bsr_118" value="9"/>
      <menuitem collapsed="true" label="$vl_c_bsr_119" value="10"/>
      <menuitem collapsed="true" label="$vl_c_bsr_120" value="11"/>
		<menuitem label="$vl_c_bsr_124" value="12"/>
		<menuitem label="$vl_c_bsr_125" value="13"/>			
    </menupopup>
  </menulist>
  <textbox flex="2" value="$vl_c_bsr_109" id="bsr_tb_rechapproxima" oninput="pf_approximatif()"/>
  <hbox flex="2" collapsed="true">
	<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="2" id="bsr_ml_etat" oncommand="pf_approximatif()" value="5">
    <menupopup>
			<menuitem label="$vl_c_bsr_122" value="7"/>
      <menuitem label="$vl_c_bsr_110" value="1"/>
      <menuitem label="$vl_c_bsr_111" value="2"/>
      <menuitem label="$vl_c_bsr_112" value="3"/>
      <menuitem label="$vl_c_bsr_113" value="4"/>
      <menuitem label="$vl_c_bsr_114" value="5"/>
			<menuitem label="$vl_c_bsr_121" value="6"/>
    </menupopup>
  </menulist>
	</hbox>
	<keyset id="_graal_ks_02">
    <key id="k-recherche" modifiers="alt" keycode="VK_F3" oncommand="pf_approximatif();"/>
	</keyset>
	<toolbarbutton class="table-rafraichir" id="bsr_top_raf01" oncommand="pf_approximatif();"/>
	<toolbarbutton id="bt_info_fen" class="ab19" label="$vl_c_dico_00149"  crop="end" dir="normal" oncommand="fa_infos_fenetre('$vl_c_id_fenetre')" />
</hbox>
</vbox>
END;
include("_graal_inc_reglements_01.php");
echo <<<END
</vbox>
<splitter/>
<vbox id="raf_pour_arbre_panier_remise_banque" flex="1" class="overflow_01">
<hbox>
	<datepicker type="popup" monthLeadingZero="true" dateLeadingZero="true" id="tb_dat_remise_banque"/>
	$ml_journal_remise
	$ml_option_remise
	$ml_mode_paiement
</hbox>
$vl_c_menucontext_arbre_panier_remise_banque
  <tree id="arbre_panier_remise_banque" flex="10" hidecolumnpicker="false" flags="" ref="*" querytype="xml" datasources="" enableColumnDrag="true" context="menu_contexte_panier_remise_banque" seltype="multiple">
    <treecols>
      <treecol id="tc_reglement_cleunik" hidden="true" ignoreincolumnpicker="true" sort="?reglement_cleunik" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_journal_cleunik" hidden="true" ignoreincolumnpicker="true" sort="?journal_cleunik" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_pc_cleunik" hidden="true" ignoreincolumnpicker="true" sort="?pc_cleunik" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_mode_paiement_clair" label="$vl_c_yyy_103" tooltiptext="$vl_c_yyy_103" sort="?mode_paiement_clair" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_piece" label="$vl_c_yyy_104" tooltiptext="$vl_c_yyy_104" sort="?piece" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_ref_piece" label="$vl_c_yyy_105" tooltiptext="$vl_c_yyy_105" sort="?ref_piece" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_dateheurereglemen" hidden="true" ignoreincolumnpicker="true" sort="?dateheurereglemen" /><splitter class="tree-splitter" resizeafter="grow"/>
	  <treecol id="tc_date_reglement_clair" label="$vl_c_yyy_108" tooltiptext="$vl_c_yyy_108" sort="?dateheurereglemen" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_montant_paye" label="$vl_c_yyy_109" tooltiptext="$vl_c_yyy_109" sort="?val_montant_paye" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_montant_pointe" label="$vl_c_yyy_1010" tooltiptext="$vl_c_yyy_1010" sort="?val_montant_pointe" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_devise_paye_clair" label="$vl_c_yyy_1011" tooltiptext="$vl_c_yyy_1011" sort="?devise_paye_clair" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_genre" label="$vl_c_yyy_1013" tooltiptext="$vl_c_yyy_1013" sort="?genre" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_blocnotebrut" label="$vl_c_yyy_1026" tooltiptext="$vl_c_yyy_1026" sort="?blocnotebrut" /><splitter class="tree-splitter" resizeafter="grow"/>
	  <treecol id="tc_val_montant_paye" hidden="true" ignoreincolumnpicker="true" sort="?_val_montant_paye" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_val_montant_pointe" hidden="true" ignoreincolumnpicker="true" sort="?val_montant_pointe" /><splitter class="tree-splitter" resizeafter="grow"/>
	  <treecol id="tc_journal_clair" label="$vl_c_yyy_1027" tooltiptext="$vl_c_yyy_1027" sort="?journal_clair" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_dateheurecreation" hidden="true" ignoreincolumnpicker="true" sort="?dateheurecreation" /><splitter class="tree-splitter" resizeafter="grow"/>
	  <treecol id="tc_date_creation_clair" label="$vl_c_yyy_1028" tooltiptext="$vl_c_yyy_1028" sort="?dateheurecreation" /><splitter class="tree-splitter" resizeafter="grow"/>
    </treecols>
     <template><query expr="*"/><action>
      <treechildren>
        <treeitem uri="?" seltype="single">
          <treerow>
            <treecell label="?reglement_cleunik"/>
            <treecell label="?journal_cleunik"/>
            <treecell label="?pc_cleunik"/>
            <treecell label="?mode_paiement_clair"/>
            <treecell label="?piece"/>
            <treecell label="?ref_piece"/>
            <treecell label="?dateheurereglemen"/>
			<treecell label="?date_reglement_clair"/>
            <treecell label="?montant_paye"/>
            <treecell label="?montant_pointe"/>
            <treecell label="?devise_paye_clair"/>
            <treecell label="?genre"/>
            <treecell label="?blocnotebrut"/>
			<treecell label="?val_montant_paye"/>
            <treecell label="?val_montant_pointe"/>
			<treecell label="?journal_clair"/>
			<treecell label="?dateheurecreation"/>
			<treecell label="?date_creation_clair"/>
          </treerow>
        </treeitem>
      </treechildren>
    </action></template>
  </tree>
	<hbox>
  		$bouton_valider
		<button flex="1" collapsed="true" id="bt_sortir" label="$vl_c_dico_00007" orient="horizontal" crop="end" oncommand="pf_etat_fen('sortir')" />
	</hbox>
</vbox>

  </window>
END;
?>
