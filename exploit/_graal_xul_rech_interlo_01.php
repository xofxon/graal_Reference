<?php
//  Recherche des interlocuteurs, par interlocuteur, au contraire de _graal_xul_rech_interlo_02.php qui recherche les interlocuteurs par acteur
header('Content-type: application/vnd.mozilla.xul+xml');
header("Cache-Control: no-cache, must-revalidate"); // HTTP/1.1
header("Expires: Mon, 26 Jul 1997 05:00:00 GMT"); // Date in the past
_graal_requete_charge_varlib("Fen_00384",$vl_e_uti_cleunik);
$vl_c_bdu_101=fa_recup_dico("bdu_101");
$vl_c_bdu_102=fa_recup_dico("bdu_102");
$vl_c_bdu_103=fa_recup_dico("bdu_103");
$vl_c_bdu_104=fa_recup_dico("bdu_104");
$vl_c_bdu_105=fa_recup_dico("bdu_105");
$vl_c_bdu_106=fa_recup_dico("bdu_106");
$vl_c_bdu_108=fa_recup_dico("bdu_108");
$vl_c_bdu_109=fa_recup_dico("bdu_109");
$vl_c_bdu_111=fa_recup_dico("bdu_111");
$vl_c_bdu_112=fa_recup_dico("bdu_112");
$vl_c_bdu_113=fa_recup_dico("bdu_113");
$vl_c_bdu_114=fa_recup_dico("bdu_114");
$vl_c_bdu_115=fa_recup_dico("bdu_115");
$vl_c_bdu_116=fa_recup_dico("bdu_116");
$vl_c_bdu_117=fa_recup_dico("bdu_117");
$vl_c_bdu_118=fa_recup_dico("bdu_118");
$vl_c_bdu_119=fa_recup_dico("bdu_119");
$vl_c_bdu_120=fa_recup_dico("bdu_120");$vl_c_bdu_120="Duplication acteur.";
if ($vl_c_presentation_accordeon==1) {
	$vl_accordion='<?xml-stylesheet href="xbl/accordion.css?v=1.0" type="text/css"?>';	
} else {
	$vl_accordion="";
}
$vl_tb_droits_duplication=_graal_requete_droits_fenetre("Fen_00759",$vl_e_uti_cleunik);
$vs_envag=intval(fa_recup_session("vs_envag","0"));
$prop_obsolete="css_0001";
if ($vl_c_actifs==4) {
  $vl_tb_droits_partage=_graal_requete_droits_fenetre("Fen_00644",$vl_e_uti_cleunik);
} else {
  $vl_tb_droits_partage[0]=false;
}
include("_graal_header_winxul.inc.php");
echo $vl_accordion;
echo('<window class="transparent" id="_graal_xul_rech_interlo_01.php" onload="fa_aa(this);" '.$c_xmlns.'>');
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_04.js.php");
include("js/_graal_xul_rech_interlo_01.js.php");
echo <<<END
<vbox flex="1" id="cartevisites_interlocuteur_01" class="overflow_01">
END;
if ($vl_c_presentation_accordeon==1) {
	echo('<accordion id="accordion_01" selectedIndex="0" flex="1" class="overflow_01">');
}
$nb=0;
while ($row = mysql_fetch_assoc($result)) {
  $nb++;
  $act_cleunik=fa_remplace_quotes(fa_ent_xml($row['act_cleunik']));
  $typeacteur=fa_remplace_quotes(fa_ent_xml($row['typeacteur']));
  $civilite=fa_remplace_quotes(fa_ent_xml($row['civilite']));
  $qui=fa_remplace_quotes(fa_ent_xml($row['qui']));
  $raisonsoc=fa_remplace_quotes(fa_ent_xml($row['raisonsoc']));
  $portee=fa_remplace_quotes(fa_ent_xml($row['portee']));
  $interlo_bn=fa_remplace_html_br(fa_ent_xml($row['interlo_bn']));
	$acteur_bn=fa_remplace_html_br(fa_ent_xml($row['acteur_bn']));
  $int_cleunik=$row['int_cleunik'];
  $idpopup_interlo="";$prop_commentaire_interlo="";
  //  Recherche de la fonction de l'interlocuteur
  $sql_req_02 = "SELECT _choix.choix_valeur_texte_01 as fonction from _act_interlo_choix_fixes,_choix where int_cleunik=$int_cleunik and _act_interlo_choix_fixes.critere_cleunik=92 and _choix.choix_cleunik=_act_interlo_choix_fixes.choix_cleunik;"; 
  $result_02 = _graal_requete_bd($sql_req_02);
  $row_02 = mysql_fetch_assoc($result_02);
  $fonction=fa_remplace_quotes(fa_ent_xml($row_02['fonction']));
  _graal_libere_requete_bd($result_02);
  switch ($typeacteur) {
    case "110000": $vl_c_telephone="Trait_00001";$vl_c_sms="Trait_00012";$vl_c_fax="Trait_00019";$vl_c_courtex="Trait_00026";$vl_c_courhtm="Trait_00033";$vl_c_chat="Fen_00696";$vl_c_id_fen_tel="Fen_00147";$vl_c_id_fen_courriel="Fen_00162";break;  //  Interlocuteurs des Membres de l'entreprise
    case "110001": $vl_c_telephone="Trait_00002";$vl_c_sms="Trait_00013";$vl_c_fax="Trait_00020";$vl_c_courtex="Trait_00027";$vl_c_courhtm="Trait_00034";$vl_c_chat="Fen_00696";$vl_c_id_fen_tel="Fen_00149";$vl_c_id_fen_courriel="Fen_00163";break;  //  prospects clients
    case "110002": $vl_c_telephone="Trait_00005";$vl_c_sms="Trait_00014";$vl_c_fax="Trait_00021";$vl_c_courtex="Trait_00028";$vl_c_courhtm="Trait_00035";$vl_c_chat="Fen_00696";$vl_c_id_fen_tel="Fen_00150";$vl_c_id_fen_courriel="Fen_00164";break;  //  prospects fournisseurs
    case "110003": $vl_c_telephone="Trait_00006";$vl_c_sms="Trait_00015";$vl_c_fax="Trait_00022";$vl_c_courtex="Trait_00029";$vl_c_courhtm="Trait_00036";$vl_c_chat="Fen_00696";$vl_c_id_fen_tel="Fen_00151";$vl_c_id_fen_courriel="Fen_00165";break;  //  clients
    case "110004": $vl_c_telephone="Trait_00009";$vl_c_sms="Trait_00016";$vl_c_fax="Trait_00023";$vl_c_courtex="Trait_00030";$vl_c_courhtm="Trait_00037";$vl_c_chat="Fen_00696";$vl_c_id_fen_tel="Fen_00152";$vl_c_id_fen_courriel="Fen_00166";break;  //  fournisseurs
    case "110005": $vl_c_telephone="Trait_00010";$vl_c_sms="Trait_00017";$vl_c_fax="Trait_00024";$vl_c_courtex="Trait_00031";$vl_c_courhtm="Trait_00038";$vl_c_chat="Fen_00696";$vl_c_id_fen_tel="Fen_00153";$vl_c_id_fen_courriel="Fen_00167";break;  //  autres acteurs
    case "110006": $vl_c_telephone="Trait_00011";$vl_c_sms="Trait_00018";$vl_c_fax="Trait_00025";$vl_c_courtex="Trait_00032";$vl_c_courhtm="Trait_00039";$vl_c_chat="Fen_00696";$vl_c_id_fen_tel="Fen_00154";$vl_c_id_fen_courriel="Fen_00168";break;  //  acteurs indéterminés
  }
	//  Présence bouton ajout Téléphones
	$bloc_boutons_tel="";
	$vl_tb_droits_tel=_graal_requete_droits_fenetre($vl_c_id_fen_tel,$vl_e_uti_cleunik);
  if ($vl_tb_droits_tel[1]!=0){
    $bloc_boutons_tel=('<toolbarbutton observes="broadcaster_01" class="aj15" id="tb_tel_01" tooltiptext="'."$vl_c_bdu_113".'"  oncommand="pf_ouvre_tel('."$int_cleunik,-1,$typeacteur".');"/>');
	}
	//	Présence bouton ajout Courriels
	$bloc_boutons_courriels="";
	$vl_tb_droits_cou=_graal_requete_droits_fenetre($vl_c_id_fen_courriel,$vl_e_uti_cleunik);
  if ($vl_tb_droits_cou[1]!=0){
    $bloc_boutons_courriels='<toolbarbutton observes="broadcaster_01" class="al10" id="tb_courriel_01" tooltiptext="'."$vl_c_bdu_114".'"  oncommand="pf_ouvre_courriel('."$int_cleunik,-1,$typeacteur".');"/>';
  }          
  if ($nb&1) {
  	$couleur="rose_01"; //  impair
  } else {
  	$couleur="jaune_01"; //  pair
  }
	if ($vl_c_presentation_accordeon==1) {
		echo("<box label='$qui' class='$couleur'>");
	}
	echo("<vbox class='$couleur'>");
	if (trim($interlo_bn)!="") {
    $idpopup_interlo="interlo-$act_cleunik-$int_cleunik";
		$prop_commentaire_interlo="ah02";
    echo("<popupset><tooltip id='$idpopup_interlo' orient='vertical' style='background-color: #33DD00;'>");
	  echo("<html:div>$interlo_bn</html:div>");	// ne fonctionne que comme cela
    echo("</tooltip></popupset>");
  }
	$idpopup_acteur="";$prop_commentaire_acteur="";
  if (trim($acteur_bn)!="") {
    $idpopup_acteur="acteur-$act_cleunik";
		$prop_commentaire_acteur="ah02";
    echo("<popupset><tooltip id='$idpopup_acteur' orient='vertical' style='background-color: #33DD00;'>");
	  echo("<html:div>$acteur_bn</html:div>");	// ne fonctionne que comme cela
    echo("</tooltip></popupset>");
  }
  echo("<hbox>");
  if ($vl_tb_droits_partage[0]==true) {
    echo ("<toolbarbutton class='ak08' tooltiptext='$vl_c_bdu_108' oncommand='pf_favoris_partager($int_cleunik);'/>");
  }
  if ($vl_c_actifs==4) {
    echo ("<toolbarbutton class='ak09' tooltiptext='$vl_c_bdu_109' oncommand='pf_favoris_enlever($int_cleunik);'/>");
  }
  	$droit_tel=_graal_requete_droits_fenetre($vl_c_telephone,$vl_e_uti_cleunik);
	if ($droit_tel[0]==true) {
    	echo("<toolbarbutton flex='0' class='ai05' tooltiptext='$vl_c_bdu_106' oncommand='pf04_emitel($act_cleunik,$int_cleunik,$vl_action_cleunik,\"raf\",0)'/>");
	}
  
  echo("<label value='$civilite' class='gras'/>");
  echo("<label value='$qui' class='gras vert text-link $prop_commentaire_interlo' tooltip='$idpopup_interlo' onclick='pf_ouvre_interlo($int_cleunik,$act_cleunik,$typeacteur);'/>");
	if (trim($prop_commentaire_interlo)!="") {
		echo("<toolbarbutton class='$prop_commentaire_interlo' tooltip='$idpopup_interlo'/>");
	}
	echo("<toolbarbutton class='af08' id='tb_actions_interlo' tooltiptext='$vl_c_bdu_119'  oncommand='pf_ouvre_actions_interlo($int_cleunik)'/>");
  echo("<label value=' ($fonction)' class='gras'/>");
  $vl_tb_droits_chat=_graal_requete_droits_fenetre($vl_c_chat,$vl_e_uti_cleunik);
  if ($vl_tb_droits_chat[0]!=0) {
    echo("<toolbarbutton class='xx02' id='tb_chat_01' tooltiptext='$vl_c_bdu_111'  oncommand='pf04_emichat($int_cleunik,$vl_action_cleunik)'/>");
  }
	echo $bloc_boutons_tel;
	echo $bloc_boutons_courriels;
  echo("</hbox>");
  echo("<hbox>");
  echo("<label value='$portee :' class='bleu '/>");
  echo("<label value='$raisonsoc' class='bleu gras text-link $prop_commentaire_acteur' tooltip='$idpopup_acteur' onclick='pf_ouvre_acteur($act_cleunik,$typeacteur);'/>");
	if (trim($prop_commentaire_acteur)!="") {
		echo("<toolbarbutton class='$prop_commentaire_acteur' tooltip='$idpopup_acteur'/>");
	}
	if (($vl_tb_droits_duplication[0]==1)&& ($vs_envag!=0)) {
		echo("<toolbarbutton class='ad18' id='tb_duplication_acteur' tooltiptext='$vl_c_bdu_120'  oncommand='pf_duplication_acteur($act_cleunik)'/>");
	}
	echo("<toolbarbutton class='af08' id='tb_actions_acteur' tooltiptext='$vl_c_bdu_118'  oncommand='pf_ouvre_actions_acteur($act_cleunik)'/>");
  echo("</hbox>");
  echo("<hbox flex='1' >");
  $i=0;
  //  Recherche des téléphones de l'interlocuteur
  $sql_req_02 = "SELECT f1.infofavori,f1.blocnotebrut as blocnotebrut,f1.intel_cleunik as intel_cleunik,f1.intel_05 as intel_05, f1.telformate as notel, _choixtel.choix_valeur_texte_01 as genretel,_choixprefixe.choix_code as prefixe from _act_interlo_tel f1,_choix _choixtel,_choix _choixprefixe where f1.int_cleunik=$int_cleunik and _choixtel.choix_cleunik = f1.choix_cleunik and _choixprefixe.choix_cleunik = f1.prefixe_choix_cleunik"; 
  $result_02 = _graal_requete_bd($sql_req_02);
  while ($row_02 = mysql_fetch_assoc($result_02)) {
    if ($i==0) {
      echo("<groupbox><caption class='$couleur'><label value='$vl_c_bdu_101'/></caption>");
      $i=1;
    }
    echo("<hbox flex='1' >");
    $intel=$row_02['intel_cleunik'];
		$tel_bn=fa_remplace_html_br(fa_ent_xml($row_02['blocnotebrut']));
		$intel_05=$row_02['intel_05'];
		$idpopup_tel="";$prop_commentaire_tel="";
		if ($row_02['infofavori']==1){$class_favori="<toolbarbutton class='ag15' tooltiptext='$vl_c_bdu_115'/>";} else {$class_favori="";}
		if (trim($tel_bn)!="") {
	    $idpopup_tel="interlo-$act_cleunik-$int_cleunik-$intel";
			$prop_commentaire_tel="ah02";
	    echo("<popupset><tooltip id='$idpopup_tel' orient='vertical' style='background-color: #33DD00;'>");
		  echo("<html:div>$tel_bn</html:div>");	// ne fonctionne que comme cela
	    echo("</tooltip></popupset>");
	  }
	   $droit_tel=_graal_requete_droits_fenetre($vl_c_telephone,$vl_e_uti_cleunik);
    	if ($droit_tel[0]==true) {
    	echo("<toolbarbutton flex='0' class='ai05' tooltiptext='$vl_c_bdu_106' oncommand='pf04_emitel($act_cleunik,$int_cleunik,$vl_action_cleunik,\"raf\",0)'/>");
			echo("<toolbarbutton flex='0' class='ai06' tooltiptext='$vl_c_bdu_106 SIP' oncommand='pf04_emitel($act_cleunik,$int_cleunik,$vl_action_cleunik,\"sip\",\"$intel_05\")'/>");
			}
    echo("<label tooltip='$idpopup_tel' class='text-link noir' onclick='pf_ouvre_tel($int_cleunik,$intel,$typeacteur);' value='(" .fa_ent_xml($row_02['prefixe']).') ' .fa_remplace_quotes(fa_ent_xml($row_02['notel']))."(".fa_remplace_quotes(fa_ent_xml($row_02['genretel'])).")' />");
		echo $class_favori;
		if (trim($prop_commentaire_tel)!="") {
			echo("<toolbarbutton class='$prop_commentaire_tel' tooltip='$idpopup_tel'/>");
		}
    echo("</hbox>");
  }
  _graal_libere_requete_bd($result_02);
  if ($i==1) {echo("</groupbox>");}
  $i=0;
  //  Recherche des fax
  $sql_req_02 = "SELECT _act_interlo_fax.infofavori,_act_interlo_fax.blocnotebrut as blocnotebrut,_act_interlo_fax.intel_cleunik as intel_cleunik, _act_interlo_fax.telformate as notel, _choixtel.choix_valeur_texte_01 as genretel,_choixprefixe.choix_code as prefixe from _act_interlo_fax,_choix _choixtel,_choix _choixprefixe where _act_interlo_fax.int_cleunik=$int_cleunik and _choixtel.choix_cleunik = _act_interlo_fax.choix_cleunik and _choixprefixe.choix_cleunik = _act_interlo_fax.prefixe_choix_cleunik"; 
  $result_02 = _graal_requete_bd($sql_req_02);
  while ($row_02 = mysql_fetch_assoc($result_02)) {
    if ($i==0) {
      echo("<groupbox><caption class='$couleur'><label value='$vl_c_bdu_102'/></caption>");
      $i=1;
    }
    echo("<hbox flex='1' >");
    $intel=$row_02['intel_cleunik'];
		$tel_bn=fa_remplace_html_br(fa_ent_xml($row_02['blocnotebrut']));
		$idpopup_tel="";$prop_commentaire_tel="";
		if ($row_02['infofavori']==1){$class_favori="<toolbarbutton class='ag15' tooltiptext='$vl_c_bdu_116'/>";} else {$class_favori="";}
		if (trim($tel_bn)!="") {
	    $idpopup_tel="interlo-$act_cleunik-$int_cleunik-$intel";
			$prop_commentaire_tel="ah02";
	    echo("<popupset><tooltip id='$idpopup_tel' orient='vertical' style='background-color: #33DD00;'>");
		  echo("<html:div>$tel_bn</html:div>");	// ne fonctionne que comme cela
	    echo("</tooltip></popupset>");
	  }
    echo("<toolbarbutton disabled='true' class='al03' oncommand='pf_ouvre(3,".$row_02['intel_cleunik'].")'/>");
    echo("<label tooltip='$idpopup_tel' class='text-link noir' onclick='pf_ouvre_fax($int_cleunik,$intel,$typeacteur);' value='(" .fa_ent_xml($row_02['prefixe']).') ' .fa_remplace_quotes(fa_ent_xml($row_02['notel']))."(".fa_remplace_quotes(fa_ent_xml($row_02['genretel'])).")' />");
		echo $class_favori;
		if (trim($prop_commentaire_tel)!="") {
			echo("<toolbarbutton class='$prop_commentaire_tel' tooltip='$idpopup_tel'/>");
		}
    echo("</hbox>");
  }
  _graal_libere_requete_bd($result_02);
  if ($i==1) {echo("</groupbox>");}
  $i=0;
  //  Recherche des courriels
  //  Les conditions sont à affiner (afficher les valides et autorisés et les autres distinctement)
  //  Utiliser un style "barré" pur les interdits
  $sql_req_02 = "SELECT _act_interlo_mail.infofavori,_act_interlo_mail.blocnotebrut as blocnotebrut,_act_interlo_mail.intweb_cleunik as intweb_cleunik, _act_interlo_mail.refweb as courriel,_act_interlo_mail.valide as valide, _choixweb.choix_valeur_texte_01 as genreweb from _act_interlo_mail,_choix _choixweb where _act_interlo_mail.int_cleunik=$int_cleunik and _choixweb.choix_cleunik = _act_interlo_mail.choix_cleunik"; 
  $result_02 = _graal_requete_bd($sql_req_02);
  while ($row_02 = mysql_fetch_assoc($result_02)) {
    if ($i==0) {
      echo("<groupbox><caption class='$couleur'><label value='$vl_c_bdu_103'/></caption>");
      $i=1;
    }
    echo("<hbox flex='1' >");
    $intweb=$row_02['intweb_cleunik'];
		$web_bn=fa_remplace_html_br(fa_ent_xml($row_02['blocnotebrut']));
		$idpopup_web="";$prop_commentaire_web="";
		if ($row_02['infofavori']==1){$class_favori="<toolbarbutton class='ag15' tooltiptext='$vl_c_bdu_117'/>";} else {$class_favori="";}
		if (trim($web_bn)!="") {
	    $idpopup_web="interlo-$act_cleunik-$int_cleunik-$intweb";
			$prop_commentaire_web="ah02";
	    echo("<popupset><tooltip id='$idpopup_web' orient='vertical' style='background-color: #33DD00;'>");
		  echo("<html:div>$web_bn</html:div>");	// ne fonctionne que comme cela
	    echo("</tooltip></popupset>");
	  }
    if ($row_02['valide']==1 or $row_02['valide']==3 ) {
    	$vl_tb_droits_courtex=_graal_requete_droits_fenetre($vl_c_courtex,$vl_e_uti_cleunik);
    	$vl_tb_droits_courhtm=_graal_requete_droits_fenetre($vl_c_courhtm,$vl_e_uti_cleunik);
  
  	if ($vl_tb_droits_courtex[0]!=0) {echo("<toolbarbutton class='ah09' id='tb_courriel_03' tooltiptext='$vl_c_bdu_104'  oncommand='pf04_emimail_texte($intweb,$vl_action_cleunik)'/>");}
  	if ($vl_tb_droits_courhtm[0]!=0) {echo("<toolbarbutton class='aj20' id='tb_courriel_04' tooltiptext='$vl_c_bdu_105'  oncommand='pf04_emimail_html($intweb,$vl_action_cleunik)'/>");}
      echo("<label tooltip='$idpopup_web' class='text-link noir' onclick='pf_ouvre_courriel($int_cleunik,$intweb,$typeacteur);' value='".fa_remplace_quotes(fa_ent_xml($row_02['courriel']))."(".fa_remplace_quotes(fa_ent_xml($row_02['genreweb'])).")' />");
			echo $class_favori;
			if (trim($prop_commentaire_web)!="") {
				echo("<toolbarbutton class='$prop_commentaire_web' tooltip='$idpopup_web'/>");
			}
    } else {
      echo("<label tooltip='$idpopup_web' class='text-link noir $prop_obsolete' flex='1' onclick='pf_ouvre_courriel($int_cleunik,$intweb,$typeacteur);' value='".fa_remplace_quotes(fa_ent_xml($row_02['courriel']))."(".fa_remplace_quotes(fa_ent_xml($row_02['genreweb'])).")' />");
			echo $class_favori;
			if (trim($prop_commentaire_web)!="") {
				echo("<toolbarbutton class='$prop_commentaire_web' tooltip='$idpopup_web'/>");
			}
    }
    echo("</hbox>");
  }
  _graal_libere_requete_bd($result_02);
  if ($i==1) {echo("</groupbox>");}
  $i=0;
  //  Recherche des identifiants de messagerie instantanée
  //  Utiliser un style "barré" pur les interdits
  $sql_req_02 = "SELECT _act_interlo_mesinst.blocnotebrut as blocnotebrut,mesinst_cleunik as mesinst_cleunik, mesinst as mesinst, valide as valide, choix_valeur_texte_01 as type from _act_interlo_mesinst,_choix where int_cleunik=$int_cleunik and choix_cleunik = choix_cleunik_type";
  $result_02 = _graal_requete_bd($sql_req_02);
  while ($row_02 = mysql_fetch_assoc($result_02)) {
    if ($i==0) {
      echo("<groupbox><caption class='$couleur'><label value='$vl_c_bdu_112'/></caption>");
      $i=1;
    }
    echo("<hbox flex='1' >");
    $mesinst=$row_02['mesinst_cleunik'];
		$mesinst_bn=fa_remplace_html_br(fa_ent_xml($row_02['blocnotebrut']));
		$idpopup_mesinst="";$prop_commentaire_mesinst="";
		if (trim($mesinst_bn)!="") {
	    $idpopup_mesinst="interlo-$act_cleunik-$int_cleunik-$mesinst";
			$prop_commentaire_mesinst="ah02";
	    echo("<popupset><tooltip id='$idpopup_mesinst' orient='vertical' style='background-color: #33DD00;'>");
		  echo("<html:div>$mesinst_bn</html:div>");	// ne fonctionne que comme cela
	    echo("</tooltip></popupset>");
	  }
    if ($row_02['valide']==1 or $row_02['valide']==3 ) {
    	$vl_tb_droits_chat=_graal_requete_droits_fenetre($vl_c_chat,$vl_e_uti_cleunik);
  
  	if ($vl_tb_droits_chat[0]!=0) {echo("<toolbarbutton class='xx02' id='tb_chat_02' tooltiptext='$vl_c_bdu_111'  oncommand='pf04_emichat($int_cleunik,$vl_action_cleunik)'/>");}
      echo("<label tooltip='$idpopup_mesinst' class='text-link noir' onclick='pf_ouvre_mesinst($mesinst,$typeacteur);' value='".fa_remplace_quotes(fa_ent_xml($row_02['mesinst']))."' />");
    } else {
      echo("<label tooltip='$idpopup_mesinst' class='text-link noir $prop_obsolete' onclick='pf_ouvre_mesinst($mesinst,$typeacteur);' value='".fa_remplace_quotes(fa_ent_xml($row_02['mesinst']))."' />");
    }
		if (trim($prop_commentaire_mesinst)!="") {
			echo("<toolbarbutton class='$prop_commentaire_mesinst' tooltip='$idpopup_mesinst'/>");
		}
    echo("</hbox>");
  }
  _graal_libere_requete_bd($result_02);



  $xml .='</item>'.EOL;
  if ($i==1) {echo("</groupbox>");}
  $i=0;
  echo('</hbox>'.EOL);
  echo("</vbox>");
	if ($vl_c_presentation_accordeon==1) {
		echo("</box>");
	}
}
if ($vl_c_presentation_accordeon==1) {
	echo("</accordion>");
}
echo <<<END
</vbox>
<spacer flex="0"/>
</window>
END;
?>
