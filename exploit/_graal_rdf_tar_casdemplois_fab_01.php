<?php
include("_graal_header_xml.inc.php");
define('EOL', "\r\n");
$vl_e_tar_cleunik=intval(fa_recup_param('vl_tar_cleunik','10000036'));
$xml='';
$xml .=fa_xcree_entete_xml().EOL;
$sql_req = "select f1.art_cleunik_pere as art_cleunik_pere,f1.art_cleunik_fils as art_cleunik_fils,f1.noligne as noligne,f2.code as code_pere,f2.mnemotechnique as mnemotechnique_pere,f2.description as description_pere,f3.code as code_fils,f3.mnemotechnique as mnemotechnique_fils,f3.description as description_fils from _nomenclatures_fab f1, _article f2, _article f3 where base_valorisation=$vl_e_tar_cleunik and f2.art_cleunik=f1.art_cleunik_pere and f3.art_cleunik=f1.art_cleunik_fils";
$result = _graal_requete_bd($sql_req);
echo(fa_xcree_entete_rdf());  
while ($row = mysql_fetch_assoc($result)) {
  echo('<RDF:li>'.EOL);
  echo('<RDF:Description>');
  echo('<row:art_cleunik_pere NC:parseType="Integer">'.fa_ent_xml($row['art_cleunik_pere']).'</row:art_cleunik_pere>');
  echo('<row:art_cleunik_fils NC:parseType="Integer">'.fa_ent_xml($row['art_cleunik_fils']).'</row:art_cleunik_fils>');
  echo('<row:noligne NC:parseType="Integer">'.fa_ent_xml($row['noligne']).'</row:noligne>');
  echo('<row:description_pere>'.fa_ent_xml($row['description_pere']).'</row:description_pere>');
  echo('<row:code_pere>'.fa_ent_xml($row['code_pere']).'</row:code_pere>');
  echo('<row:mnemotechnique_pere>'.fa_ent_xml($row['mnemotechnique_pere']).'</row:mnemotechnique_pere>');
  echo('<row:description_fils>'.fa_ent_xml($row['description_fils']).'</row:description_fils>');
  echo('<row:code_fils>'.fa_ent_xml($row['code_fils']).'</row:code_fils>');
  echo('<row:mnemotechnique_fils>'.fa_ent_xml($row['mnemotechnique_fils']).'</row:mnemotechnique_fils>');

  echo('</RDF:Description>'.EOL);
  echo('</RDF:li>'.EOL);
}
// fin du fichier RDF
echo('</RDF:Bag>'.EOL);
echo('</RDF:RDF>'.EOL);
_graal_libere_requete_bd($result);
_graal_ferme_connexion();
?>
