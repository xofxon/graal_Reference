<?php
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_act_interlo_mesinst_01";
fa_acces_script();
$vf_c_echo="";
$vf_c_action=fa_recup_param("vf_c_action","??????");
$vl_mesinst_cleunik=fa_recup_param("vl_mesinst_cleunik","");
$vl_int_cleunik=intval(fa_recup_param("vl_int_cleunik",""));
$vl_mesinst=fa_recup_param("vl_mesinst","");
$vl_blocnotebrut=fa_recup_param("vl_blocnotebrut","");
$vl_veuxpasdecontact=intval(fa_recup_param("vl_veuxpasdecontact",""));
$vl_infofavori=intval(fa_recup_param("vl_infofavori",""));
$vl_utilisable=intval(fa_recup_param("vl_utilisable","1"));
$vl_act_cleunik=intval(fa_recup_param("vl_act_cleunik",""));
$vl_choix_cleunik_type=intval(fa_recup_param("vl_choix_cleunik_type",""));
$vl_choix_cleunik_prot=intval(fa_recup_param("vl_choix_cleunik_prot",""));
$vl_valide=intval(fa_recup_param("vl_valide",""));
switch (TRUE){
  case $vf_c_action=="supprimer":
    $sql_req = "DELETE FROM _act_interlo_mesinst WHERE mesinst_cleunik = $vl_mesinst_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_mesinst_cleunik;}  else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="ajouter":
    $vl_e_fen_cleunik=_graal_requete_max("mesinst_cleunik","_act_interlo_mesinst");
    $sql_req = "INSERT INTO _act_interlo_mesinst set mesinst_cleunik=$vl_e_fen_cleunik,int_cleunik=$vl_int_cleunik,mesinst='$vl_mesinst',dateheuremodif=now(),blocnotebrut='$vl_blocnotebrut',veuxpasdecontact=$vl_veuxpasdecontact,infofavori=$vl_infofavori,utilisable=$vl_utilisable,act_cleunik=$vl_act_cleunik,choix_cleunik_type=$vl_choix_cleunik_type,choix_cleunik_prot=$vl_choix_cleunik_prot,valide=$vl_valide,c_uuid=(select uuid());";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_e_fen_cleunik;}  else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="modifier":
    $sql_req = "UPDATE _act_interlo_mesinst set mesinst='$vl_mesinst',dateheuremodif=now(),blocnotebrut='$vl_blocnotebrut',veuxpasdecontact=$vl_veuxpasdecontact,infofavori=$vl_infofavori,utilisable=$vl_utilisable,choix_cleunik_type=$vl_choix_cleunik_type,choix_cleunik_prot=$vl_choix_cleunik_prot,valide=$vl_valide WHERE _act_interlo_mesinst.mesinst_cleunik=$vl_mesinst_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_mesinst_cleunik;}  else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;
?>
