<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik=intval(fa_recup_session("vs_uti_cleunik","0"));
$vl_c_genreaction=fa_recup_param("genreaction","aucune");
$vl_e_doc_cleunik=intval(fa_recup_param("vl_e_doc_cleunik",-1));
$vl_c_dico_00007=fa_recup_dico('dico_00007');
$vl_c_dico_00013=fa_recup_dico('dico_00013');
$vl_c_dico_00014=fa_recup_dico('dico_00014');
$vl_c_dico_00028=fa_recup_dico('dico_00028');
switch ($vl_c_genreaction){
	case "recmail":
		$vl_c_id_fenetre="Fen_00762";$id_inc_actions_recherche="Div_00425";
		break;
	case "recmail_erreur":
		$vl_c_id_fenetre="Fen_00761";$id_inc_actions_recherche="Div_00425";
		$ml_statu_modifi=fa_brik_menulist_choix('124',1,-1,-1,'','ml_statut_action_modi',"",0);
		break;
	case "recmail_erreur_massif":
		$vl_c_id_fenetre="Fen_00761";$id_inc_actions_recherche="Div_00425";
		$ml_statu_modifi=fa_brik_menulist_choix('124',1,-1,-1,'','ml_statut_action_modi',"",0);
		break;
	default:
		fa_redirige("acces_interdit");
    break;
}
$id_inc_courriel="Div_00472";
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_tc_composants=array($id_inc_actions_recherche,$id_inc_courriel);
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bqg_100=fa_recup_dico("bqg_100");
include("_graal_header_winxul.inc.php");
$c_id_windows=$vl_c_id_fenetre;
$vl_c_id_fen_action="Fen_00425";
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fen_action,$vl_e_uti_cleunik);
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=0;
$vl_b_bloc_action_recherche=true;$vl_c_arbre_action="arbre_actions_01";
$voir_bloc_reponse=false;
echo <<<END
<window context="graal_cp00" title="$vl_c_bqg_100 $vl_c_genreaction" id="$c_id_windows" onload="fa_aa(this);pf_aa_init_bem('21');pf08_aa_init();" onunload="pf_onunload();" $c_xmlns>
$vl_c_graal_cp00
<broadcasterset><broadcaster id="broadcaster_01" /></broadcasterset>
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_04.js.php");
include("js/_graal_actions_selection_01.js.php");
include("js/_graal_08_actions.js.php");
include("js/_graal_actions_recmail.js.php");
include ("_graal_inc_actions_recherche_01.php");
include_once("js/_graal_05_dates.js.php");
echo("<splitter/>");

switch ($vl_c_genreaction){
	case "recmail":
		echo("<vbox>");
		include ("_graal_inc_courriel_recus.php");
		echo("</vbox>");
		echo('<hbox id="boutons_standards">'); 
echo <<<END
    <button width="40" flex="1" id="bt_sortir" label="$vl_c_dico_00007" crop="end" dir="normal" oncommand="pf_etat_fen_bem('sortir')" />
  </hbox>
END;
		break;
	case "recmail_erreur":
		echo("<vbox flex='1'>");
		include ("_graal_inc_courriel_recus.php");
echo <<<END
		<splitter/>
		
	
	
    <groupbox flex="1">
			<caption flex="1"><label value="Adresse de courriel"/><textbox id="tb_adresse_courriel" value="" flex="10"/></caption>
			<hbox>
			<label value="Validité de l'adresse ?"/>
        <radiogroup id='rdg_valide' flex="1" value="2">
          <hbox>
            <radio class="af16" dir="reverse" observes="broadcaster_01" id='ra_valide_oui' label="$vl_c_dico_00013" value='1' />
            <radio class="ae15" dir="reverse" observes="broadcaster_01" id='ra_valide_non' label="$vl_c_dico_00014" value='2'/>
            <radio class="af15" dir="reverse" observes="broadcaster_01" id='ra_valide_nsp' label="$vl_c_dico_00028" value='3'/>
            <spacer flex="1"/>
           </hbox>
         </radiogroup>
				 <label value="Commentaire"/>
        <textbox observes="broadcaster_01" id="tb_blocnotebrut"   multiline="true" flex="10"/>
				</hbox>
			<vbox>
				<hbox id="boutons_standards" flex="1">
					<button flex="2" id="bt_action_adresse" oncommand="pf08_traitement_adresse();" label="Modifier les adresses correspondantes"/>
					<label id="la_retour_modif" value="Résultat"/>
    			<button flex="1" id="bt_sortir" label="$vl_c_dico_00007" crop="end" dir="normal" oncommand="pf_etat_fen_bem('sortir')" />
  			</hbox>
				<hbox id="boutons_standards" flex="1">
					<button flex="2" id="bt_action_modifie" oncommand="pf08_traitement_action();" label="Modifier le statut de l'action"/>
    			$ml_statu_modifi
  			</hbox>
			</vbox>
    </groupbox>
		</vbox>
END;
		break;
	case "recmail_erreur_massif":
		echo("<vbox flex='1'>");
echo <<<END

<tree id="arbre_recupera_das_courriel" ignoreincolumnpicker="true" flex="2" flags="" ref="*" querytype="xml" datasources="" seltype="multiple" enableColumnDrag="true" context="pop_recupera">
    <treecols>
      <treecol id="tc_recupera_das_refweb" label="Chaine ressemblant à une adresse de courriel" sort="?refweb"/><splitter class="tree-splitter" resizeafter="grow"/>
    </treecols>
    <template><query expr="*"/><action>
      <treechildren>
        <treeitem uri="?" seltype="single">
          <treerow>
            <treecell label="?refweb"/>
          </treerow>
        </treeitem>
      </treechildren>
    </action></template>
  </tree>
	<splitter/>
    <groupbox flex="1">
			<caption flex="1"><label value="Adresses de courriel"/></caption>
			<hbox>
			<label value="Validité des adresses ?"/>
        <radiogroup id='rdg_valide' flex="1" value="2">
          <hbox>
            <radio class="af16" dir="reverse" observes="broadcaster_01" id='ra_valide_oui' label="$vl_c_dico_00013" value='1' />
            <radio class="ae15" dir="reverse" observes="broadcaster_01" id='ra_valide_non' label="$vl_c_dico_00014" value='2'/>
            <radio class="af15" dir="reverse" observes="broadcaster_01" id='ra_valide_nsp' label="$vl_c_dico_00028" value='3'/>
            <spacer flex="1"/>
           </hbox>
         </radiogroup>
				 <label value="Commentaire"/>
        <textbox observes="broadcaster_01" id="tb_blocnotebrut"   multiline="true" flex="10"/>
				</hbox>
			<vbox>
				<hbox id="boutons_standards" flex="1">
					<button flex="2" id="bt_action_adresse" oncommand="pf08_traitement_adresse();" label="Modifier les adresses sélectionnées"/>
					<label id="la_retour_modif" value="Résultat"/>
    			<button flex="1" id="bt_sortir" label="$vl_c_dico_00007" crop="end" dir="normal" oncommand="pf_etat_fen_bem('sortir')" />
  			</hbox>
				<hbox id="boutons_standards" flex="1">
					<button flex="2" id="bt_action_modifie" oncommand="pf08_traitement_action();" label="Modifier le statut des actions"/>
    			$ml_statu_modifi
  			</hbox>
			</vbox>
    </groupbox>
		</vbox>
END;
		break;
}
echo('</window>');
?>
