<?php
//Devrait être enregistré sous forme _graal_bdope_treso_journal_01.php
include("_graal_header_txt.inc.php");
$vf_c_echo="";
$vf_c_action=fa_recup_param("vf_c_action","??????");
$vl_journal_cleunik=intval(fa_recup_param("vl_journal_cleunik",""));
$vl_code=fa_recup_param("vl_code","");
$vl_nom=fa_recup_param("vl_nom","");
$vl_type=fa_recup_param("vl_type","");
$vl_caisse_oui_non=intval(fa_recup_param("vl_caisse_oui_non",""));
$vl_domiciliation=fa_recup_param("vl_domiciliation","");
$vl_etablissement=fa_recup_param("vl_etablissement","");
$vl_guichet=fa_recup_param("vl_guichet","");
$vl_compte=fa_recup_param("vl_compte","");
$vl_cle=fa_recup_param("vl_cle","");
$vl_compte_comptable=intval(fa_recup_param("vl_compte_comptable",""));
switch (TRUE) {
  case $vf_c_action=="supprimer":
    $sql_req = "DELETE FROM _treso_journal WHERE _treso_journal.journal_cleunik = $vl_journal_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo="ok";} else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="ajouter":
    $vl_journal_cleunik=_graal_requete_max("journal_cleunik","_treso_journal");
    $sql_req = "INSERT INTO _treso_journal set journal_cleunik='$vl_journal_cleunik',code='$vl_code',nom='$vl_nom',type='$vl_type',caisse_oui_non='$vl_caisse_oui_non',domiciliation='$vl_domiciliation',etablissement='$vl_etablissement',guichet='$vl_guichet',compte='$vl_compte',cle='$vl_cle',compte_comptable='$vl_compte_comptable'";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo="ok";} else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="modifier":
    $sql_req = "UPDATE _treso_journal set code='$vl_code',nom='$vl_nom',type='$vl_type',caisse_oui_non='$vl_caisse_oui_non',domiciliation='$vl_domiciliation',etablissement='$vl_etablissement',guichet='$vl_guichet',compte='$vl_compte',cle='$vl_cle',compte_comptable='$vl_compte_comptable' WHERE _treso_journal.journal_cleunik = $vl_journal_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo="ok";} else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;
?>
