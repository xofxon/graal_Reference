<?php
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_act_sites_01";
fa_acces_script();
$vf_c_echo="";
$vf_c_action=fa_recup_param("vf_c_action","??????");
$vl_site_cleunik=fa_recup_param("vl_site_cleunik","");
$vl_refweb=fa_recup_param("vl_refweb","");
//$vl_dateheuremodif=fa_recup_param("vl_dateheuremodif","");
$vl_blocnotebrut=fa_recup_param("vl_blocnotebrut","");
//$vl_blocnotertf=fa_recup_param("vl_blocnotertf","");
//$vl_dateheurevalidite=fa_recup_param("vl_dateheurevalidite","");
$vl_act_cleunik=intval(fa_recup_param("vl_act_cleunik",""));
$vl_choix_cleunik=intval(fa_recup_param("vl_choix_cleunik",""));
switch (TRUE)
{
  case $vf_c_action=="supprimer":
    $sql_req = "DELETE FROM _act_sites WHERE _act_sites.site_cleunik = $vl_site_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_site_cleunik;}  else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="ajouter":
    $vl_e_fen_cleunik=_graal_requete_max("site_cleunik","_act_sites");
    //dateheurevalidite='$vl_dateheurevalidite'
    $sql_req = "INSERT INTO _act_sites set site_cleunik=$vl_e_fen_cleunik,refweb='$vl_refweb',dateheuremodif=now(),blocnotebrut='$vl_blocnotebrut',act_cleunik=$vl_act_cleunik,choix_cleunik=$vl_choix_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_e_fen_cleunik;}  else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="modifier":
    //dateheurevalidite='$vl_dateheurevalidite'
    $sql_req = "UPDATE _act_sites set refweb='$vl_refweb',dateheuremodif=now(),blocnotebrut='$vl_blocnotebrut',choix_cleunik=$vl_choix_cleunik WHERE _act_sites.site_cleunik=$vl_site_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_site_cleunik;}  else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;
?>
