<?php
_graal_requete_charge_varlib($vl_c_id_inc_acteurs_sites,$vl_e_uti_cleunik);
$vl_c_aaz_001=fa_recup_dico("aaz_001");
$vl_c_aaz_002=fa_recup_dico("aaz_002");
$vl_c_aaz_003=fa_recup_dico("aaz_003");
$vl_c_aaz_004=fa_recup_dico("aaz_004");
$vl_c_aaz_005=fa_recup_dico("aaz_005");
$vl_c_aaz_006=fa_recup_dico("aaz_006");
$vl_c_aaz_007=fa_recup_dico("aaz_007");
$vl_c_aaz_008=fa_recup_dico("aaz_008");
$vl_c_aaz_009=fa_recup_dico("aaz_009");
$vl_c_aaz_010=fa_recup_dico("aaz_010");
$vl_c_aaz_011=fa_recup_dico("aaz_011");
echo ('<vbox flex="3" id="aaz_acteurs_sites_01" class="overflow_01">');
if ($vl_c_bloc_sites=="true") {
switch ($vl_c_id_inc_acteurs_sites){
  case "Div_00170": $vl_c_id_fen_site="00000000000";break;  //  Sites de tous les acteurs On considère dans ce cas qu'il n'y a pas de test de gestion des droits
  case "Div_00171": $vl_c_id_fen_site="00000000000";break;  //  Sites des acteurs favoris On considère dans ce cas qu'il n'y a pas de test de gestion des droits
  case "Div_00172": $vl_c_id_fen_site="Fen_00172";break;  //  Sites des prospects clients
  case "Div_00173": $vl_c_id_fen_site="Fen_00173";break;  //  Sites des prospects fournisseurs
  case "Div_00174": $vl_c_id_fen_site="Fen_00174";break;  //  Sites des clients
  case "Div_00175": $vl_c_id_fen_site="Fen_00175";break;  //  Sites des fournisseurs
  case "Div_00176": $vl_c_id_fen_site="Fen_00176";break;  //  Sites des autres acteurs
  case "Div_00177": $vl_c_id_fen_site="Fen_00177";break;  //  Sites des acteurs indéterminés
  case "Div_00178": $vl_c_id_fen_site="Fen_00171";break;  //  Sites de l'Entreprise
  default:
    die;  
}
echo <<<END
      <toolbar grippyhidden="true">
  		  <toolbarbutton class="table-rafraichir" tooltiptext="$vl_c_aaz_004" oncommand="pf_affiche_donnees_sites();"/>
        <toolbarseparator />
        <hbox id="bloc_sites">
          <label value="$vl_c_aaz_005"/>
          <toolbarbutton class="aj09" id="tb_site_03" tooltiptext="$vl_c_aaz_008" oncommand="pf_ouvre('site','atteindre');" />
END;
if ($vl_c_id_fen_site=="000000000") {$vl_tb_droits[0]=1;$vl_tb_droits[1]=1;} else {$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fen_site,$vl_e_uti_cleunik);}
if ($vl_tb_droits[0]!=0){
echo <<<END
          <toolbarbutton class="aj06" observes="broadcaster_01" id="tb_site_02" tooltiptext="$vl_c_aaz_007" oncommand="pf_ouvre('site','ouvrir');" />
END;
if ($vl_tb_droits[1]!=0){
echo <<<END
          <toolbarbutton class="am06" observes="broadcaster_01" id="tb_site_01" tooltiptext="$vl_c_aaz_006" oncommand="pf_ouvre('site','nouveau');"/>
END;
}
}
echo('</hbox><toolbarseparator /></toolbar> ');
}
echo <<<END
<popupset>
	<popup id="pop_sites_des_acteurs">
		<menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_sites_des_acteurs');" />
	</popup>
</popupset>
  <tree context="pop_sites_des_acteurs" id="arbre_sites_des_acteurs" flex="1" hidecolumnpicker="false" flags="" ref="*" querytype="xml" datasources="" onselect="pf_sel_arbre_sites(this.id);" seltype="single" enableColumnDrag="true" >
    <treecols>
      <treecol id="tc_site_cleunik" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_refweb" label="$vl_c_aaz_002" sort="?refweb"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_typedesite" label="$vl_c_aaz_003" sort="?typedesite"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_blocnotebrut" label="$vl_c_aaz_009" sort="?blocnotebrut"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_typeacteur" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_act_cleunik_site" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
		<treecol id="tc_nc_site" label="$vl_c_aaz_010" sort="?nomcommercial" hidden="$vl_c_bloc_sites"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_rs_site" label="$vl_c_aaz_011" sort="?raisonsoc" hidden="$vl_c_bloc_sites"/><splitter class="tree-splitter" resizeafter="grow"/>
    </treecols>
    <template><query expr="*"/><action>
      <treechildren>
        <treeitem uri="?" seltype="single">
          <treerow>
            <treecell label="?site_cleunik"/>
            <treecell label="?refweb" properties="?prop_act"/>
            <treecell label="?typedesite"/>
            <treecell label="?blocnotebrut"/>
            <treecell label="?typeacteur"/>
			<treecell label="?act_cleunik"/>
			<treecell label="?nomcommercial" properties="?prop_act"/>
			<treecell label="?raisonsoc" properties="?prop_act"/>
          </treerow>
        </treeitem>
      </treechildren>
    </action></template>
  </tree>
</vbox>
END;
?>
