<?php
include("_graal_header_xul.inc.php");
$vl_e_cleunik_critere=intval(fa_recup_param('quelnocritere','0'));
$vl_c_codecache="true";
switch ($vl_e_cleunik_critere) {
  case  31 : $vl_c_id_fenetre="Fen_00036";$vl_c_id_graal_inc_choix_criteres_01="Div_00102";$vl_c_codecache='false';$vl_c_codeinactif='true';break; //  Classification des Produits Français (Sections)
  case  32 : $vl_c_id_fenetre="Fen_00035";$vl_c_id_graal_inc_choix_criteres_01="Div_00101";$vl_c_codecache='false';$vl_c_codeinactif='true';break; //Classification des Produits Français (Sous-Sections)
  case  33 : $vl_c_id_fenetre="Fen_00034";$vl_c_id_graal_inc_choix_criteres_01="Div_00100";$vl_c_codecache='false';$vl_c_codeinactif='true';break; //Classification des Produits Français (Divisions)
  case  34 : $vl_c_id_fenetre="Fen_00033";$vl_c_id_graal_inc_choix_criteres_01="Div_00099";$vl_c_codecache='false';$vl_c_codeinactif='true';break; //Classification des Produits Français (Groupes)
  case  35 : $vl_c_id_fenetre="Fen_00032";$vl_c_id_graal_inc_choix_criteres_01="Div_00098";$vl_c_codecache='false';$vl_c_codeinactif='true';break; //Classification des Produits Français (Classes)
  case  36 : $vl_c_id_fenetre="Fen_00031";$vl_c_id_graal_inc_choix_criteres_01="Div_00097";$vl_c_codecache='false';$vl_c_codeinactif='true';break; //Classification des Produits Français (Catégories)
  case  37 : $vl_c_id_fenetre="Fen_00030";$vl_c_id_graal_inc_choix_criteres_01="Div_00096";$vl_c_codecache='false';$vl_c_codeinactif='true';break; //Classification des Produits Français (Sous-Catégories)
  case 101 : $vl_c_id_fenetre="Fen_00356";$vl_c_id_graal_inc_choix_criteres_01="Div_00317";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Tarifs
  case 108 : $vl_c_id_fenetre="Fen_00227";$vl_c_id_graal_inc_choix_criteres_01="Div_00212";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Unités de stock
  case 109 : $vl_c_id_fenetre="Fen_00485";$vl_c_id_graal_inc_choix_criteres_01="Div_00447";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Unités de vente
  case 110 : $vl_c_id_fenetre="Fen_00486";$vl_c_id_graal_inc_choix_criteres_01="Div_00448";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Unités d'achat
  case 116 : $vl_c_id_fenetre="Fen_00228";$vl_c_id_graal_inc_choix_criteres_01="Div_00214";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Dépôts
  case 117 : $vl_c_id_fenetre="Fen_00229";$vl_c_id_graal_inc_choix_criteres_01="Div_00215";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Emplacements
  case 118 : $vl_c_id_fenetre="Fen_00231";$vl_c_id_graal_inc_choix_criteres_01="Div_00217";$vl_c_codecache='true';$vl_c_codeinactif='false';break; //Relations entre articles
  case 119 : $vl_c_id_fenetre="Fen_00234";$vl_c_id_graal_inc_choix_criteres_01="Div_00219";$vl_c_codecache='false';$vl_c_codeinactif='true';break; //Unités de temps
  case 127 : $vl_c_id_fenetre="Fen_00478";$vl_c_id_graal_inc_choix_criteres_01="Div_00444";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Tarifs
  case 128 : $vl_c_id_fenetre="Fen_00487";$vl_c_id_graal_inc_choix_criteres_01="Div_00449";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Unités de conditionnement
  case 130 : $vl_c_id_fenetre="Fen_00563";$vl_c_id_graal_inc_choix_criteres_01="Div_00485";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Origine des mouvements de stock
  
  case 131 : $vl_c_id_fenetre="Fen_00629";$vl_c_id_graal_inc_choix_criteres_01="Div_00498";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Unités de capacité
  case 132 : $vl_c_id_fenetre="Fen_00630";$vl_c_id_graal_inc_choix_criteres_01="Div_00499";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Unités de masse
  case 133 : $vl_c_id_fenetre="Fen_00631";$vl_c_id_graal_inc_choix_criteres_01="Div_00500";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Unités de volume
  case 134 : $vl_c_id_fenetre="Fen_00632";$vl_c_id_graal_inc_choix_criteres_01="Div_00501";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Unités de surface
  case 135 : $vl_c_id_fenetre="Fen_00633";$vl_c_id_graal_inc_choix_criteres_01="Div_00502";$vl_c_codecache='false';$vl_c_codeinactif='false';break; //Unités de longueur
  
  case 1000: $vl_c_id_fenetre="Fen_00138";$vl_c_id_graal_inc_choix_criteres_01="Div_00139";break;  //  Millésimes       (articles seuls)
  case 1001: $vl_c_id_fenetre="Fen_00134";$vl_c_id_graal_inc_choix_criteres_01="Div_00140";break;  //  Couleurs         (articles seuls)
  case 1002: $vl_c_id_fenetre="Fen_00135";$vl_c_id_graal_inc_choix_criteres_01="Div_00141";break;  //  Type de vin      (articles seuls)
  case 1003: $vl_c_id_fenetre="Fen_00136";$vl_c_id_graal_inc_choix_criteres_01="Div_00142";break;  //  Critère disponible  (articles seuls)
  case 1004: $vl_c_id_fenetre="Fen_00137";$vl_c_id_graal_inc_choix_criteres_01="Div_00143";break;  //  Contenants       (articles seuls)
  
  default :
    fa_redirige("acces_interdit");
}
switch ($vl_e_cleunik_critere) {
  case 1000:
  case 1001:
  case 1002:
  case 1003:
  case 1004:
    _graal_requete_charge_varlib("Fen_00335",$vl_e_uti_cleunik);
    $vl_c_bct_100=fa_recup_dico("bct_100");
    $vl_c_bct_101=fa_recup_dico("bct_101");
    $vl_c_bct_102=fa_recup_dico("bct_102");
    $vl_c_bct_103=fa_recup_dico("bct_103");
    $vl_c_bct_104=fa_recup_dico("bct_104");
    _graal_requete_charge_varlib("Div_00310",$vl_e_uti_cleunik);
    $vl_c_bcu_001=fa_recup_dico("bcu_001");
    $vl_c_bcu_002=fa_recup_dico("bcu_002");
    $vl_c_bcu_003=fa_recup_dico("bcu_003");
    $vl_c_bcu_004=fa_recup_dico("bcu_004");
    $vl_c_bcu_005=fa_recup_dico("bcu_005");
    $sql_req = "SELECT critere_code,critere_denomination from _criteres where critere_cleunik=$vl_e_cleunik_critere;"; 
    $result = _graal_requete_bd($sql_req);
    $row = mysql_fetch_assoc($result);
    $critere_code=fa_ent_xml($row['critere_code']);
    $critere_denomination=fa_ent_xml($row['critere_denomination']);
    _graal_libere_requete_bd($result);
$vl_c_complement_01=<<<EOT
    <popupset>
  <popup id="pop_articles">
  <menuitem label="$vl_c_bct_101" oncommand="pf_ouvre('rafraf', 1,'in','choix')" />
  <menuitem label="$vl_c_bct_102" oncommand="pf_ouvre('rafraf', 2,'notin','choix')" />
  <menuitem label="$vl_c_bct_103" oncommand="pf_ouvre('rafraf', 3,'in','critere')" />
  <menuitem label="$vl_c_bct_104" oncommand="pf_ouvre('rafraf', 4,'notin','critere')" />
  </popup>
</popupset>
          <groupbox flex="1">
      <caption><label value="$vl_c_bcu_004" /></caption>
        <button flex="1" id="bt_n01" value="" label="$vl_c_bcu_005" context="pop_articles" oncommand="fa_popup_montre('pop_articles',this)"/>
     </groupbox>
EOT;
    break;
  default:
    break;
}
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=1;
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bbb_100=fa_recup_dico("bbb_100");
$vl_c_bbb_101=fa_recup_dico("bbb_101");
$vl_c_bbb_102=fa_recup_dico("bbb_102");
$vl_c_bbb_103=fa_recup_dico("bbb_103");
$vl_c_bbb_104=fa_recup_dico("bbb_104");
$vl_c_bbb_105=fa_recup_dico("bbb_105");
$vl_c_bbb_106=fa_recup_dico("bbb_106");
$vl_c_dico_00013=fa_recup_dico("dico_00013");
$vl_c_dico_00014=fa_recup_dico("dico_00014");
$gestion_principal="";
switch ($vl_e_cleunik_critere) {
	case 116:
		$complement_00=<<<EOT
		<groupbox flex="1">
		<caption><label value="Dépôt principal" /></caption>
		<radiogroup id='rdg_principal' flex="1" name='name' value="2">
      <hbox>
        <radio observes="broadcaster_01" id='ra_principal_oui' label="$vl_c_dico_00013" value='1' />
        <spacer flex="1"/>
        <radio observes="broadcaster_01" id='ra_principal_non' label="$vl_c_dico_00014" value='2'/>
       </hbox>
     </radiogroup>
     </groupbox>
EOT;
	$gestion_principal=116;
	break;
}
	

include("_graal_header_winxul.inc.php");
$vl_tc_composants=array($vl_c_id_graal_inc_choix_criteres_01);
echo <<<END
<window context="graal_cp00" title="$vl_c_bbb_100" id="_graal_critere_04" onload="fa_aa(this);pf_etat_fen('ini')" $c_xmlns >
$vl_c_graal_cp00
<broadcasterset><broadcaster id="broadcaster_01" /></broadcasterset>
END;
include("_graal_visites.inc.php");
include("_graal_inc_choix_criteres_01.php");
include_once("js/_graal_01.js.php");
include("js/_graal_criteres_04.js.php");
include("js/_graal_06_choix_criteres.js.php");
echo <<<END
<splitter />
<hbox flex="1">
         <vbox flex="1">
    <groupbox id="gp_code" hidden="$vl_c_codecache" >
     <caption><label value="$vl_c_bbb_101" /></caption>
END;
if ($vl_c_codeinactif=='true') { 
  echo('<textbox disabled="'.$vl_c_codeinactif.'" id="tb_choix_code"   />');}
else { echo ('<textbox observes="broadcaster_01" maxlength="50" id="tb_choix_code"   />');} 
echo <<<END
    </groupbox>
    <caption><label value="$vl_c_bbb_102" /></caption>
     <textbox observes="broadcaster_01" id="tb_choix_valeur_texte_01"   />
        <groupbox flex="1">
    <caption><label value="$vl_c_bbb_103" /></caption>
    <radiogroup id='rdg_actif' flex="1" name='name'>
      <hbox>
        <radio observes="broadcaster_01" id='ra_choix_actif_oui' label="$vl_c_bbb_104" value='1' />
        <spacer flex="1"/>
        <radio observes="broadcaster_01" id='ra_choix_actif_non' label="$vl_c_bbb_105" value='2'/>
       </hbox>
     </radiogroup>
  </groupbox>
  $complement_00
  <label id="la_nbutilisations" value="$vl_c_bbb_106" _graal_value="$vl_c_bbb_106"/>
  $vl_c_complement_01
         <spacer flex="2" />
</vbox>
<spacer />
   <vbox >
  <vbox flex="1" id="boutons_standards"> 
END;
include("_graal_inc_boutons_01.php");
echo <<<END
   </vbox>
   </vbox>
</hbox>
 </window>
END;
?>
