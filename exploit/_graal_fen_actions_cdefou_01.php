<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik=intval(fa_recup_session("vs_uti_cleunik","0"));
$vl_c_genreaction=fa_recup_param("genreaction","cdefou");
$vl_c_destination=fa_recup_param("destination","nullepart");
$vl_c_visu=fa_recup_param("visu","non");
$lesquels=fa_recup_param("lesquels","raf");
$vl_e_doc_cleunik=intval(fa_recup_param("vl_e_doc_cleunik",-1));
$vl_c_dico_00005=fa_recup_dico('dico_00005');
$vl_c_dico_00106=fa_recup_dico('dico_00106');
$vl_c_dico_00013=fa_recup_dico('dico_00013');
$vl_c_dico_00014=fa_recup_dico('dico_00014');

$vl_c_id_fenetre="Fen_01131";

$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false||$vl_tb_droits[1]==false) {fa_redirige("acces_interdit");}

$id_inc_actions_recherche="Div_00573";
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=0;
$vl_tc_composants=array($id_inc_actions_recherche);
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);

$id_inc_art_actions_selection="Div_00468";// Onglet de sÃ©lection des actions
$arbre_cdefou="tr_art_lignes_cdefou_01";
$arbre_cdefou_panier="tr_art_lignes_cdefou_01_panier";


$vl_c_bvk_100=fa_recup_dico("bvk_100");
$vl_c_bvk_101=fa_recup_dico("bvk_101");
$vl_c_bvk_102=fa_recup_dico("bvk_102");
$vl_c_bvk_103=fa_recup_dico("bvk_103");
$vl_c_bvk_104=fa_recup_dico("bvk_104");
$vl_c_bvk_105=fa_recup_dico("bvk_105");
$vl_c_bvk_107=fa_recup_dico("bvk_107");
$vl_c_bvk_111=fa_recup_dico("bvk_111");
$vl_c_bvk_112=fa_recup_dico("bvk_112");
$vl_c_bvk_113=fa_recup_dico("bvk_113");$vl_c_bvk_113="Nouvelle date de facturation";
switch ($vl_c_destination){
  case "relfou":
$bloc_changement_dates=<<<EOT
	<groupbox orient="vertical"><label value="$vl_c_bvk_112" />
      <hbox><radiogroup id='rdg_modif_date_expedition' flex="1" value="2">
        <hbox>
          <radio id='ra_modif_date_expedition_oui' label="$vl_c_dico_00013" value='1' observes="broadcaster_01"/>
          <spacer flex="1"/>
          <radio id='ra_modif_date_expedition_non' label="$vl_c_dico_00014" value='2' observes="broadcaster_01"/>
         </hbox>
       </radiogroup>
  		<datepicker type="popup" monthLeadingZero="true" dateLeadingZero="true" observes="broadcaster_01" id="dp_dat_exp"/> 
  	</hbox></groupbox>  
EOT;
  	break;
}  


include("_graal_header_winxul.inc.php");
$c_id_windows=$vl_c_id_fenetre;
$vl_b_acces=true;$vl_c_t05="Exporter vers Microsoft Excel";
$export="";
if ($vl_b_acces==true) {$export.=('<menuitem label="'.$vl_c_t05.'" oncommand="pf_recup_requete(\'xls\');" class="menuitem-iconic ak05" dir="reverse"/>');}
$vl_c_pop_selections="";$vl_c_pop_panier="";
$vl_c_pop_selections.="<popupset><popup id='pop_selections'>";
$vl_c_pop_selections.='<menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\''."$arbre_cdefou".'\');" />';
$vl_c_pop_selections.='<menuseparator/>';
$vl_c_pop_selections.="<menuitem class='menuitem-iconic af08' label='$vl_c_bvk_101' oncommand='pf_action_ouvre(\"$arbre_cdefou\");' />";
$vl_c_pop_selections.='<menuitem class="menuitem-iconic ak11" label="'.$vl_c_bvk_102.'" oncommand="pf_panier_ajoute();" />';
$vl_c_pop_selections.="</popup></popupset>";
$vl_c_pop_panier.="<popupset><popup id='pop_panier'>";
$vl_c_pop_panier.='<menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\''."$arbre_cdefou_panier".'\');" />';
$vl_c_pop_panier.='<menuseparator/>';
$vl_c_pop_panier.="<menuitem class='menuitem-iconic ak12' label='$vl_c_bvk_104' oncommand='pf_panier_enleve();'/>";
$vl_c_pop_panier.=$export;
$vl_c_pop_panier.="</popup></popupset>";
echo <<<END
<window context="graal_cp00" title="$vl_c_bda_100" id="$c_id_windows" onload="fa_aa(this);pf_aa_init_bfp('21')" onunload="pf_onunload();" $c_xmlns>
$vl_c_graal_cp00
<broadcasterset><broadcaster id="broadcaster_01" /></broadcasterset>
$vl_c_pop_selections
$vl_c_pop_panier
END;
$arbre_cdefou="tr_art_lignes_cdefou_01";
$arbre_cdefou_panier="tr_art_lignes_cdefou_01_panier";
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_04.js.php");
include_once("js/_graal_actions_cdefou_01.js.php");
include_once("js/_graal_05_dates.js.php");

$bfp_cp03_hidden="false";
include("_graal_inc_art_actions_selection_01.php");
include("_graal_inc_art_lignes_cdefou_01.php");
echo "<splitter/>";
$arbre_cdefou=$arbre_cdefou_panier;
include("_graal_inc_art_lignes_cdefou_01.php");
echo('<vbox><hbox id="boutons_standards">'); 
echo <<<END
	<progressmeter id="pm_evolution_01" mode="determined" value="0" collapsed="true" flex="1"/>
	<progressmeter id="pm_evolution_02" mode="determined" value="0" collapsed="true" flex="1"/>
	$bloc_changement_dates
	<button tooltiptext ="$vl_c_bvk_107 Ctrl+Shift+F5" keycode="k-enregistrer" flex="1" id="bt_enregistrer" label="$vl_c_bvk_107" orient="horizontal" crop="none" oncommand="pf_validation('enregistrer')" />
    <button flex="1" id="bt_sortir" label="$vl_c_dico_00007" crop="end" dir="normal" oncommand="pf_etat_fen_bem('sortir')" collapsed="true"/>
</hbox></vbox>
END;
echo("</window>");
?>
