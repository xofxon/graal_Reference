<?php
_graal_requete_charge_varlib($vl_c_id_inc_acteurs_representants,$vl_e_uti_cleunik);
$vl_c_bfj_001=fa_recup_dico("bfj_001");
$vl_c_bfj_002=fa_recup_dico("bfj_002");
$vl_c_bfj_003=fa_recup_dico("bfj_003");
$vl_c_bfj_004=fa_recup_dico("bfj_004");
$vl_c_bfj_005=fa_recup_dico("bfj_005");
$vl_c_bfj_006=fa_recup_dico("bfj_006");
$vl_c_bfj_007=fa_recup_dico("bfj_007");
$vl_c_bfj_008=fa_recup_dico("bfj_008");
$vl_c_bfj_009=fa_recup_dico("bfj_009");
$vl_c_bfj_010=fa_recup_dico("bfj_010");
$vl_c_bfj_011=fa_recup_dico("bfj_011");
$vl_c_bfj_012=fa_recup_dico("bfj_012");
$vl_c_bfj_013=fa_recup_dico("bfj_013");
switch ($vl_c_id_inc_acteurs_representants){
  case "Div_00435": $vl_c_id_fen_representant="000000000";break;  //  Tous les acteurs On considère dans ce cas qu'il n'y a pas de test de gestion des droits
  case "Div_00436": $vl_c_id_fen_representant="000000000";break;  //  Acteurs favoris On considère dans ce cas qu'il n'y a pas de test de gestion des droits
  case "Div_00437": $vl_c_id_fen_representant="Fen_00465";break;  //  prospects clients
  case "Div_00438": $vl_c_id_fen_representant="Fen_00466";break;  //  prospects fournisseurs
  case "Div_00439": $vl_c_id_fen_representant="Fen_00467";break;  //  clients
  case "Div_00440": $vl_c_id_fen_representant="Fen_00468";break;  //  fournisseurs
  case "Div_00441": $vl_c_id_fen_representant="Fen_00469";break;  //  autres acteurs
  case "Div_00442": $vl_c_id_fen_representant="Fen_00470";break;  //  acteurs indéterminés
  default:
    fa_redirige("acces_interdit");  
}
echo <<<END
<vbox id="bfj_acteurs_representants_01" flex="3">
END;
if ($vl_c_barre_presente_acteurs_representants=='ok')
{
echo <<<END
      <toolbar grippyhidden="true">
  		  <toolbarbutton class="table-rafraichir" tooltiptext="$vl_c_bfj_005" oncommand="pf_affiche_donnees_representants();"/>
        <toolbarseparator />
        <hbox id="bloc_relations">
END;
if ($vl_c_id_fen_representant=="0000000") {$vl_tb_droits[0]=1;$vl_tb_droits[1]=1;} else {$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fen_representant,$vl_e_uti_cleunik);}
if ($vl_tb_droits[0]!=0)
{
if ($vl_tb_droits[1]!=0)
{
echo <<<END
          <toolbarbutton class="aa01" observes="broadcaster_01" id="tb_representant_01" tooltiptext="$vl_c_bfj_006" oncommand="pf_ouvre('representant','nouveau');"/>
END;
}
echo <<<END
          <toolbarbutton class="aa01" observes="broadcaster_01" id="tb_representant_02" tooltiptext="$vl_c_bfj_007" oncommand="pf_ouvre('representant','ouvrir');" />
          <toolbarbutton class="al05" id="bfj_requete" tooltiptext="$vl_c_bfj_013" collapsed="true" oncommand="pf_valide_requete();"/>
END;
}
echo <<<END
        </hbox>
        <toolbarseparator />
      </toolbar>
END;
}
echo <<<END
  <tree id="arbre_representants" enableColumnDrag="true" flex="1" flags="" ref="*" querytype="xml" datasources="" onselect="pf_sel_arbre_representants();" seltype="single" context="pop_selections_rep">
      <treecols>
        <treecol hidden="true" id="tr_act_cleunik_gauche" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tr_choix_cleunik_gauche" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tr_choix_cleunik_droite" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tr_act_cleunik_droite" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_qui_gauche_00" label="$vl_c_bfj_002" sort="?qui_gauche_00" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_choix_01_gauche" label="$vl_c_bfj_003" sort="?choix_01_gauche" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_qui_droite" label="$vl_c_bfj_002" sort="?qui_droite" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_choix_01_droite" label="$vl_c_bfj_003" sort="?choix_01_droite" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_qui_gauche_01" label="$vl_c_bfj_002" sort="?qui_gauche_01" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_blocnotebrut" label="$vl_c_bfj_001" sort="?blocnotebrut" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_type" label="$vl_c_bfj_009" sort="?type" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_taux" class="droite" label="$vl_c_bfj_010" sort="?taux" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_fixe" class="droite" label="$vl_c_bfj_011" sort="?fixe" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tr_regle" label="$vl_c_bfj_012" sort="?regle"/><splitter class="tree-splitter" resizeafter="grow"/>
      </treecols>
      <template>
			<query expr="*"/>
	    	<action>
        <treechildren>
          <treeitem uri="?" seltype="single">
            <treerow>
              <treecell label="?act_cleunik_gauche"/>
              <treecell label="?choix_cleunik_gauche"/>
              <treecell label="?choix_cleunik_droite"/>
              <treecell label="?act_cleunik_droite"/>
              <treecell label="?qui_gauche_00" properties="?properties_gauche"/>
              <treecell label="?choix_01_gauche"/>
              <treecell label="?qui_droite" properties="?properties_droite"/>
              <treecell label="?choix_01_droite"/>
              <treecell label="?qui_gauche_01" properties="?properties_gauche"/>
              <treecell label="?blocnotebrut"/>
              <treecell label="?type"/>
              <treecell label="?taux"/>
              <treecell label="?fixe"/>
              <treecell label="?regle"/>
            </treerow>
          </treeitem>
        </treechildren>
				</action>
      </template>
    </tree>
  </vbox>
END;
?>
