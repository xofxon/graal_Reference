<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_e_genreacteur=fa_recup_param('vl_e_genreacteur','0');
$vl_e_choix_cleunik=intval(fa_recup_param('vl_e_choix_cleunik','0'));
$vl_e_critere_cleunik=intval(fa_recup_param('vl_e_critere_cleunik','0'));
$vl_c_quoi=fa_recup_param('vl_c_quoi','');
$vl_c_enclair=fa_recup_param('vl_c_enclair','');
$vl_c_code_critere=fa_recup_param('vl_c_code_critere','');
$vl_c_code_choix=fa_recup_param('vl_c_code_choix','');
$vl_c_deno_critere=fa_recup_param('vl_c_deno_critere','');
$vl_c_deno_choix=fa_recup_param('vl_c_deno_choix','');
$vl_c_origine=fa_recup_param('vl_c_origine',"");
$vl_c_proc_retour=fa_recup_param("vl_c_proc_retour","pf_ouvre_acteur_recup");
switch ($vl_e_genreacteur){
  case "tousss": $vl_c_id_fenetre="Fen_00512";$vl_c_id_inc_acteurs_01="Div_00033";$vl_c_id_inc_infos_critere_choix_01="Div_00344";$vl_c_id_inc_acteurs_selection_01="Div_00040";break;  //  Tous
  case "110001": $vl_c_id_fenetre="Fen_00274";$vl_c_id_inc_acteurs_01="Div_00035";$vl_c_id_inc_infos_critere_choix_01="Div_00344";$vl_c_id_inc_acteurs_selection_01="Div_00042";break;  //  prospects clients
  case "110002": $vl_c_id_fenetre="Fen_00275";$vl_c_id_inc_acteurs_01="Div_00036";$vl_c_id_inc_infos_critere_choix_01="Div_00344";$vl_c_id_inc_acteurs_selection_01="Div_00043";break;  //  prospects fournisseurs
  case "110003": $vl_c_id_fenetre="Fen_00276";$vl_c_id_inc_acteurs_01="Div_00032";$vl_c_id_inc_infos_critere_choix_01="Div_00344";$vl_c_id_inc_acteurs_selection_01="Div_00044";break;  //  clients
  case "110004": $vl_c_id_fenetre="Fen_00277";$vl_c_id_inc_acteurs_01="Div_00037";$vl_c_id_inc_infos_critere_choix_01="Div_00344";$vl_c_id_inc_acteurs_selection_01="Div_00045";break;  //  fournisseurs
  case "110005": $vl_c_id_fenetre="Fen_00278";$vl_c_id_inc_acteurs_01="Div_00038";$vl_c_id_inc_infos_critere_choix_01="Div_00344";$vl_c_id_inc_acteurs_selection_01="Div_00046";break;  //  autres acteurs
  case "110006": $vl_c_id_fenetre="Fen_00279";$vl_c_id_inc_acteurs_01="Div_00039";$vl_c_id_inc_infos_critere_choix_01="Div_00344";$vl_c_id_inc_acteurs_selection_01="Div_00047";break;  //  acteurs indéterminés
  case "listes": $vl_c_id_fenetre="Fen_00660";$vl_c_id_inc_acteurs_01="Div_00510";break;  //  Acteurs pour vérification existence approximative sur nom commercial ou raisons sociale 
  case "transp": $vl_c_id_fenetre="Fen_00695";$vl_c_id_inc_acteurs_01="Div_00514";$vl_c_id_inc_acteurs_selection_01="Div_00515";break;  //  Transporteurs
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bcf_101=fa_recup_dico("bcf_101");
$vl_c_bcf_102=fa_recup_dico("bcf_102");
$vl_c_bcf_103=fa_recup_dico("bcf_103");
$vl_c_dico_00007=fa_recup_dico("dico_00007");
include("_graal_header_winxul.inc.php");
switch ($vl_c_origine) {
  case "critere":
    $vl_tc_composants=array($vl_c_id_inc_acteurs_01,$vl_c_id_inc_infos_critere_choix_01);
    break;
  case "selection":
  case "transp":
    $vl_tc_composants=array($vl_c_id_inc_acteurs_01,$vl_c_id_inc_acteurs_selection_01);
    break;
  case "listes":
    $vl_tc_composants=array($vl_c_id_inc_acteurs_01);
    break;
}
echo <<<END
<window context="graal_cp00" title="$vl_c_bcf_101" id="_graal_fen_acteurs_selection" onload="fa_aa(this);pf_aa_init()" $c_xmlns>
$vl_c_graal_cp00
<popupset>
  <popup id="pop_selections">
  <menuitem class="menuitem-iconic ai15" label="$vl_c_bcf_103" oncommand="pf_acteur_ouvre();" />
  </popup>
</popupset>
END;
include("_graal_visites.inc.php");
include("js/_graal_01.js.php");
switch ($vl_c_origine) {
  case "listes": 
    include("js/_graal_acteurs_selection_liste.js.php");
    $vl_c_id_vbox_inc_acteurs_01='aai_acteurs_01';
    $vl_c_id_arbre_inc_acteurs_01='arbre_des_acteurs';
    $vl_c_menucontext_01="pop_selections";
    include("_graal_inc_acteurs_01.php");
    echo('<button width="40" id="bt_sortir" label="'.$vl_c_dico_00007.'" crop="end" dir="normal" oncommand="pf_etat_fen(\'sortir\');" />');
    break;
  case "critere":
    include("js/_graal_acteurs_selection_criteres.js.php");
    include("_graal_inc_infos_critere_choix_01.php");
    $vl_c_id_vbox_inc_acteurs_01='aai_acteurs_01';
    $vl_c_id_arbre_inc_acteurs_01='arbre_des_acteurs';
    include("_graal_inc_acteurs_01.php");
    break;
  case "selection":
  case "transp":
    include("js/_graal_acteurs_selection_selection.js.php");
    $vl_c_infos_adresses="true";$vl_c_infos_sitesweb="true";
    echo('<vbox id="vb_tableau" flex="1">');
    include("_graal_inc_acteurs_selection_01.php");
    $vl_c_id_vbox_inc_acteurs_01='aai_acteurs_01';
    $vl_c_id_arbre_inc_acteurs_01='arbre_des_acteurs';
    include("_graal_inc_acteurs_01.php");
    echo('</vbox>');
    echo('<hbox id="bt_renvoyer_valeur">');
    echo('<button width="40" flex="1" id="bt_enregistrer" label="'.$vl_c_bcf_102.'" crop="end" dir="normal" oncommand="pf_etat_fen(\'renvoyer\');" />');
    echo('<button width="40" flex="1" id="bt_sortir" label="'.$vl_c_dico_00007.'" crop="end" dir="normal" oncommand="pf_etat_fen(\'sortir\');" />');
    echo('</hbox>');

    break;
}
echo <<<END
  <splitter/>
</window>
END;
?>
