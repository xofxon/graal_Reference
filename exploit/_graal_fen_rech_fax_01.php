<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_c_genreacteur=fa_recup_param('genreacteur','0');
$vl_c_reftel=fa_recup_param('reftel','azertyuiop');
$vl_c_p02=fa_recup_param('p02','');
$vl_c_fonction_retour=fa_recup_param('vl_c_fonction_retour','pf_retour_fenetre_fax');
$vl_e_int_cleunik=intval(fa_recup_param('vl_e_int_cleunik',-1));
$vl_e_act_cleunik=intval(fa_recup_param('vl_e_act_cleunik',-1));
$vl_c_type_recherche="normal";$vl_c_cache_id_bloc_sel_rech_fax="false";
if ($vl_e_int_cleunik!=-1){$vl_c_type_recherche="interl";$vl_c_cache_id_bloc_sel_rech_fax="true";}
if ($vl_e_act_cleunik!=-1){$vl_c_type_recherche="acteur";$vl_c_cache_id_bloc_sel_rech_fax="true";}
switch ($vl_c_genreacteur){
  case "tousss": $vl_c_id_fenetre="Fen_00305";$vl_c_id_inc_inc_rech_fax="Div_00279";break;  //Tous les acteurs
  case "110000": $vl_c_id_fenetre="Fen_00306";$vl_c_id_inc_inc_rech_fax="Div_00280";break; //  Entreprise
  case "110001": $vl_c_id_fenetre="Fen_00307";$vl_c_id_inc_inc_rech_fax="Div_00281";break; //  Prospects Clients
  case "110002": $vl_c_id_fenetre="Fen_00308";$vl_c_id_inc_inc_rech_fax="Div_00282";break; //  Prospects Fournisseurs
  case "110003": $vl_c_id_fenetre="Fen_00309";$vl_c_id_inc_inc_rech_fax="Div_00283";break; //  Clients
  case "110004": $vl_c_id_fenetre="Fen_00310";$vl_c_id_inc_inc_rech_fax="Div_00284";break; //  Fournisseurs
  case "110005": $vl_c_id_fenetre="Fen_00311";$vl_c_id_inc_inc_rech_fax="Div_00285";break; //  Autres
  case "110006": $vl_c_id_fenetre="Fen_00312";$vl_c_id_inc_inc_rech_fax="Div_00286";break; //  Indéterminés
  case "plusie": $vl_c_id_fenetre="Fen_00305";$vl_c_id_inc_inc_rech_fax="Div_00279";break; //	Un fax particulier
}
$vl_tc_composants=array($vl_c_id_inc_inc_rech_fax);
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bcl_100=fa_recup_dico("bcl_100");
$vl_c_bcl_101=fa_recup_dico("bcl_101");
$vl_c_bcl_102=fa_recup_dico("bcl_102");
$vl_c_bcl_103=fa_recup_dico("bcl_103");
$vl_c_bcl_104=fa_recup_dico("bcl_104");
$vl_c_bcl_105=fa_recup_dico("bcl_105");$vl_c_bcl_105="Renvoyer le numéro sélectionné";
$vl_c_dico_00007=fa_recup_dico("dico_00007");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_dico_00107=fa_recup_dico("dico_00107");
include("_graal_header_winxul.inc.php");
echo <<<END
<window context="graal_cp00" _graal_genreacteur="$vl_c_genreacteur" title="$vl_c_bcl_100" id="_graal_fen_rech_fax_01" onload="fa_aa(this);pf_etat_fen('ini')" onunload="pf_onunload();" $c_xmlns>
$vl_c_graal_cp00
<popupset>
  <popup id="pop_selections">
    <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_des_fax_interlo_act');" />
    <menuitem class="menuitem-iconic ai15" id="mi_ouvre_acteur" label="$vl_c_bcl_103" oncommand="pf_acteur_ouvre();"/>
    <menuitem class="menuitem-iconic ai18" id="mi_ouvre_interlo" label="$vl_c_bcl_101" oncommand="pf_interlo_ouvre();"/>
    <menuitem class="menuitem-iconic al03" id="mi_ouvre_fax" label="$vl_c_bcl_104" oncommand="pf_interlo_ouvre_fax();"/>
    <menuitem class="menuitem-iconic ai06" id="mi_fax_interlo" collapsed="true" label="$vl_c_bcl_104" oncommand="pf_interlo_fax();"/>		
  </popup>
</popupset>
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_rech_fax_01.js.php");
include("_graal_inc_rech_fax_01.php");
echo <<<END
<hbox>
<button flex="1" collapsed="true" id="bt_sortir" label="$vl_c_dico_00007" crop="end" dir="normal" oncommand="pf_etat_fen('sortir')" />
<hbox collapsed="true" id="bt_renvoyer_valeur" flex="1">
  <button width="40" flex="1" id="bt_enregistrer" label="$vl_c_bcl_105" crop="end" dir="normal" oncommand="pf_etat_fen('renvoyer');" />
</hbox>
</hbox>
</window>
END;
?>
