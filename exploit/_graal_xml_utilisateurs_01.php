<?php
include("_graal_header_xml.inc.php");
error_reporting(E_ALL ^ E_NOTICE ^ E_WARNING);  //  Pour éviter les warnings éventuels générés par simplexml_load_string
define('EOL', "\r\n");
$vl_e_uti_cleunik=intval(fa_recup_param('uti_cleunik','0'));
$sql_req = "SELECT _utilisateur.uti_cleunik as uti_cleunik,_utilisateur.prenom AS prenom,_utilisateur.patronyme AS patronyme,_utilisateur.codealphanum15 as codealphanum15,_utilisateur.dateheurevalidite as dateheurevalidite,_utilisateur.borne_mini as borne_mini,_utilisateur.borne_maxi as borne_maxi,_utilisateur.identifiant as identifiant,_utilisateur.blocnotebrut as blocnotebrut,_utilisateur.c_uuid as uuid,_utilisateur.langue_appli as langue,_utilisateur.css as css,_utilisateur.couleurfocus as couleurfocus,concat_ws(' ',_act_interlo.prenom,_act_interlo.patronyme) as interlo,_utilisateur.actif as actif,_utilisateur.param_environ as param_environ,_act_interlo.int_cleunik as int_cleunik,_utilisateur.genre as genre FROM _utilisateur left join _act_interlo using (int_cleunik) where uti_cleunik=$vl_e_uti_cleunik";
$result = _graal_requete_bd($sql_req);
fa_xcree_entete_xml();
$row = mysql_fetch_assoc($result);
if (is_null($row['param_environ'])==false) {
  $vl_c_xml=simplexml_load_string($row['param_environ']);
  $selection_article=fa_ent_xml($vl_c_xml->selection_article->attributes());
  $selection_acteur=fa_ent_xml($vl_c_xml->selection_acteur->attributes());
	if (isset($vl_c_xml->window_background_color)){$vl_c_window_background_color=$vl_c_xml->window_background_color->attributes();}else{$vl_c_window_background_color='#dfd9f5';}
	if (isset($vl_c_xml->focus_background_color)){$vl_c_focus_background_color=$vl_c_xml->focus_background_color->attributes();}else{$vl_c_focus_background_color='#80FF80';}
	if (isset($vl_c_xml->focus_color)){$vl_c_focus_color=$vl_c_xml->focus_color->attributes();}else{$vl_c_focus_color='red';}
	if (isset($vl_c_xml->police_generale)){$police_generale=$vl_c_xml->police_generale->attributes();}else{$police_generale='Verdana, Geneva, sans-serif';}
	if (isset($vl_c_xml->table_ligne_selectionnee_color)){$table_ligne_selectionnee_color=$vl_c_xml->table_ligne_selectionnee_color->attributes();}else{$table_ligne_selectionnee_color='#ff6060';}
	if (isset($vl_c_xml->table_ligne_impaire_color)){$table_ligne_impaire_color=$vl_c_xml->table_ligne_impaire_color->attributes();}else{$table_ligne_impaire_color='#ffffc0';}
	if (isset($vl_c_xml->table_ligne_paire_color)){$table_ligne_paire_color=$vl_c_xml->table_ligne_paire_color->attributes();}else{$table_ligne_paire_color='#ffe0e0';}
	if (isset($vl_c_xml->selection_interlocuteur)){$selection_interlocuteur=$vl_c_xml->selection_interlocuteur->attributes();}else{$selection_interlocuteur='1';}
	if (isset($vl_c_xml->selection_telephone)){$selection_telephone=$vl_c_xml->selection_telephone->attributes();}else{$selection_telephone='1';}						
	if (isset($vl_c_xml->selection_fax)){$selection_fax=$vl_c_xml->selection_fax->attributes();}else{$selection_fax='1';}
	if (isset($vl_c_xml->selection_courriel)){$selection_courriel=$vl_c_xml->selection_courriel->attributes();}else{$selection_courriel='1';}
	if (isset($vl_c_xml->selection_postale)){$selection_postale=$vl_c_xml->selection_postale->attributes();}else{$selection_postale='1';}
	if (isset($vl_c_xml->selection_geophysique)){$selection_geophysique=$vl_c_xml->selection_geophysique->attributes();}else{$selection_geophysique='1';}
	if (isset($vl_c_xml->selection_site)){$selection_site=$vl_c_xml->selection_site->attributes();}else{$selection_site='1';}
	if (isset($vl_c_xml->selection_note)){$selection_note=$vl_c_xml->selection_note->attributes();}else{$selection_note='1';}
	if (isset($vl_c_xml->selection_document)){$selection_document=$vl_c_xml->selection_document->attributes();}else{$selection_document='1';}
	if (isset($vl_c_xml->selection_pseudodocument)){$selection_pseudodocument=$vl_c_xml->selection_pseudodocument->attributes();}else{$selection_pseudodocument='1';}
	if (isset($vl_c_xml->activite_background_color)){$activite_background_color=$vl_c_xml->activite_background_color->attributes();}else{$activite_background_color='#80FF80';}
	if (isset($vl_c_xml->page_accueil)){$page_accueil=$vl_c_xml->page_accueil->attributes();}else{$page_accueil='0';}
	
	if (isset($vl_c_xml->vl_selart_nbcaracrech)){$vl_selart_nbcaracrech=$vl_c_xml->vl_selart_nbcaracrech->attributes();}else{$vl_selart_nbcaracrech='3';}
	if (isset($vl_c_xml->vl_selact_nbcaracrech)){$vl_selact_nbcaracrech=$vl_c_xml->vl_selact_nbcaracrech->attributes();}else{$vl_selact_nbcaracrech='3';}	
	if (isset($vl_c_xml->vl_selint_nbcaracrech)){$vl_selint_nbcaracrech=$vl_c_xml->vl_selint_nbcaracrech->attributes();}else{$vl_selint_nbcaracrech='3';}
	if (isset($vl_c_xml->vl_seltel_nbcaracrech)){$vl_seltel_nbcaracrech=$vl_c_xml->vl_seltel_nbcaracrech->attributes();}else{$vl_seltel_nbcaracrech='3';}		
	if (isset($vl_c_xml->vl_selfax_nbcaracrech)){$vl_selfax_nbcaracrech=$vl_c_xml->vl_selfax_nbcaracrech->attributes();}else{$vl_selfax_nbcaracrech='3';}
	if (isset($vl_c_xml->vl_selmel_nbcaracrech)){$vl_selmel_nbcaracrech=$vl_c_xml->vl_selmel_nbcaracrech->attributes();}else{$vl_selmel_nbcaracrech='3';}	
	if (isset($vl_c_xml->vl_selpos_nbcaracrech)){$vl_selpos_nbcaracrech=$vl_c_xml->vl_selpos_nbcaracrech->attributes();}else{$vl_selpos_nbcaracrech='3';}
	if (isset($vl_c_xml->vl_selgeo_nbcaracrech)){$vl_selgeo_nbcaracrech=$vl_c_xml->vl_selgeo_nbcaracrech->attributes();}else{$vl_selgeo_nbcaracrech='3';}		
	if (isset($vl_c_xml->vl_selweb_nbcaracrech)){$vl_selweb_nbcaracrech=$vl_c_xml->vl_selweb_nbcaracrech->attributes();}else{$vl_selweb_nbcaracrech='3';}
	if (isset($vl_c_xml->vl_seldoc_nbcaracrech)){$vl_seldoc_nbcaracrech=$vl_c_xml->vl_seldoc_nbcaracrech->attributes();}else{$vl_seldoc_nbcaracrech='3';}	
	if (isset($vl_c_xml->vl_selnot_nbcaracrech)){$vl_selnot_nbcaracrech=$vl_c_xml->vl_selnot_nbcaracrech->attributes();}else{$vl_selnot_nbcaracrech='3';}
	if (isset($vl_c_xml->vl_sellie_nbcaracrech)){$vl_sellie_nbcaracrech=$vl_c_xml->vl_sellie_nbcaracrech->attributes();}else{$vl_sellie_nbcaracrech='3';}		
	if (isset($vl_c_xml->gesdoc_ml_zone)){$gesdoc_ml_zone=$vl_c_xml->gesdoc_ml_zone->attributes();}else{$gesdoc_ml_zone='1';}
	if (isset($vl_c_xml->aut_crypte_docs)){$aut_crypte_docs=$vl_c_xml->aut_crypte_docs->attributes();}else{$aut_crypte_docs='2';}
	if (isset($vl_c_xml->vl_modele_recherche_articles)){$vl_modele_recherche_articles=$vl_c_xml->vl_modele_recherche_articles->attributes();}else{$vl_modele_recherche_articles='1';}
	if (isset($vl_c_xml->vl_selaction_nbcaracrech)){$vl_selaction_nbcaracrech=$vl_c_xml->vl_selaction_nbcaracrech->attributes();}else{$vl_selaction_nbcaracrech='4';}	
	if (isset($vl_c_xml->vl_selection_action)){$vl_selection_action=$vl_c_xml->vl_selection_action->attributes();}else{$vl_selection_action='2';}
	if (isset($vl_c_xml->gesacteurs_ml_zone)){$gesacteurs_ml_zone=$vl_c_xml->gesacteurs_ml_zone->attributes();}else{$gesacteurs_ml_zone='1';}
	if (isset($vl_c_xml->gesinterlo_ml_zone)){$gesinterlo_ml_zone=$vl_c_xml->gesinterlo_ml_zone->attributes();}else{$gesinterlo_ml_zone='1';}
	if (isset($vl_c_xml->gesactions_ml_zone)){$gesactions_ml_zone=$vl_c_xml->gesactions_ml_zone->attributes();}else{$gesactions_ml_zone='1';}
	if (isset($vl_c_xml->vl_selection_action_fenetre)){$vl_selection_action_fenetre=$vl_c_xml->vl_selection_action_fenetre->attributes();}else{$vl_selection_action_fenetre='1';}			
}


	$sql_req_01 = "SELECT duf_acces FROM _droits_uti_fen where uti_cleunik=$vl_e_uti_cleunik and fen_cleunik=10000053;";
	$result_01 = _graal_requete_bd($sql_req_01);
	if (mysql_num_rows($result_01) == 0) {
		$rdg_admin=2;
	} else {
		$row_01 = mysql_fetch_assoc($result_01);
		$vl_e_duf_cleunik=$row_01['duf_acces'];
		if ($vl_e_duf_cleunik==1){$rdg_admin=1;} else {$rdg_admin=2;}
	}

echo('<Description>');
echo('<uti_cleunik data="'.fa_ent_xml($row['uti_cleunik']).'"/>');
echo('<int_cleunik data="'.fa_ent_xml($row['int_cleunik']).'"/>');
echo('<prenom data="'.fa_ent_xml($row['prenom']).'"/>');
echo('<patronyme data="'.fa_ent_xml($row['patronyme']).'"/>');
echo('<codealphanum15 data="'.fa_ent_xml($row['codealphanum15']).'"/>');
echo('<dateheurevalidite data="'.fa_ent_xml($row['dateheurevalidite']).'"/>');
echo('<borne_mini  data="'.fa_ent_xml($row['borne_mini']).'"/>');
echo('<borne_maxi  data="'.fa_ent_xml($row['borne_maxi']).'"/>');
echo('<identifiant  data="'.fa_ent_xml($row['identifiant']).'"/>');
//echo('<motdepasse  data="'.fa_ent_xml($row['motdepasse']).'"/>');
echo('<motdepasse  data="Ceci est un mot de passe totalement fictif et bidon"/>');
echo('<blocnotebrut  data="'.fa_ent_xml($row['blocnotebrut']).'"/>');
echo('<uuid  data="'.fa_ent_xml($row['uuid']).'"/>');
echo('<langue  data="'.fa_ent_xml($row['langue']).'"/>');
echo('<genre  data="'.fa_ent_xml($row['genre']).'"/>');
echo('<css  data="'.fa_ent_xml($row['css']).'"/>');
echo('<window_background_color data="'.fa_ent_xml($vl_c_window_background_color).'"/>');
echo('<focus_background_color data="'.fa_ent_xml($vl_c_focus_background_color).'"/>');
echo('<focus_color data="'.fa_ent_xml($vl_c_focus_color).'"/>');

echo('<interlo data="'.fa_ent_xml($row['interlo']).'"/>');
echo('<actif data="'.fa_ent_xml($row['actif']).'"/>');
echo('<selection_article data="'.$selection_article.'"/>');
echo('<selection_acteur data="'.$selection_acteur.'"/>');
echo('<selection_interlocuteur data="'.$selection_interlocuteur.'"/>');

echo('<police_generale data="'.$police_generale.'"/>');
echo('<table_ligne_selectionnee_color data="'.$table_ligne_selectionnee_color.'"/>');
echo('<table_ligne_impaire_color data="'.$table_ligne_impaire_color.'"/>');
echo('<table_ligne_paire_color data="'.$table_ligne_paire_color.'"/>');
echo('<selection_interlocuteur data="'.$selection_interlocuteur.'"/>');
echo('<selection_telephone data="'.$selection_telephone.'"/>');
echo('<selection_fax data="'.$selection_fax.'"/>');
echo('<selection_courriel data="'.$selection_courriel.'"/>');
echo('<selection_postale data="'.$selection_postale.'"/>');
echo('<selection_geophysique data="'.$selection_geophysique.'"/>');
echo('<selection_site data="'.$selection_site.'"/>');
echo('<selection_note data="'.$selection_note.'"/>');
echo('<selection_pseudodocument data="'.$selection_pseudodocument.'"/>');
echo('<selection_document data="'.$selection_document.'"/>');
echo('<activite_background_color data="'.$activite_background_color.'"/>');
echo('<page_accueil data="'.$page_accueil.'"/>');

echo('<vl_selart_nbcaracrech data="'.$vl_selart_nbcaracrech.'"/>');
echo('<vl_selact_nbcaracrech data="'.$vl_selact_nbcaracrech.'"/>');
echo('<vl_selint_nbcaracrech data="'.$vl_selint_nbcaracrech.'"/>');
echo('<vl_seltel_nbcaracrech data="'.$vl_seltel_nbcaracrech.'"/>');
echo('<vl_selfax_nbcaracrech data="'.$vl_selfax_nbcaracrech.'"/>');
echo('<vl_selmel_nbcaracrech data="'.$vl_selmel_nbcaracrech.'"/>');
echo('<vl_selpos_nbcaracrech data="'.$vl_selpos_nbcaracrech.'"/>');
echo('<vl_selgeo_nbcaracrech data="'.$vl_selgeo_nbcaracrech.'"/>');
echo('<vl_selweb_nbcaracrech data="'.$vl_selweb_nbcaracrech.'"/>');
echo('<vl_seldoc_nbcaracrech data="'.$vl_seldoc_nbcaracrech.'"/>');
echo('<vl_selnot_nbcaracrech data="'.$vl_selnot_nbcaracrech.'"/>');
echo('<vl_sellie_nbcaracrech data="'.$vl_sellie_nbcaracrech.'"/>');
echo('<gesdoc_ml_zone data="'.$gesdoc_ml_zone.'"/>');
echo('<gesacteurs_ml_zone data="'.$gesacteurs_ml_zone.'"/>');
echo('<gesinterlo_ml_zone data="'.$gesinterlo_ml_zone.'"/>');
echo('<gesactions_ml_zone data="'.$gesactions_ml_zone.'"/>');
echo('<rdg_admin data="'.$rdg_admin.'"/>');
echo('<vl_modele_recherche_articles data="'.$vl_modele_recherche_articles.'"/>');
echo('<vl_selaction_nbcaracrech data="'.$vl_selaction_nbcaracrech.'"/>');
echo('<vl_selection_action data="'.$vl_selection_action.'"/>');
echo('<aut_crypte_docs data="'.$aut_crypte_docs.'"/>');
echo('<vl_selection_action_fenetre data="'.$vl_selection_action_fenetre.'"/>');
_graal_libere_requete_bd($result);
switch ($page_accueil){
	case "0":$page_accueil_titre="Page par défaut";break;
	case "post_it":$page_accueil_titre="Post it";break;
	default:
		$sql_req = "SELECT titre FROM _documents WHERE doc_cleunik =$page_accueil"; 
		$result = _graal_requete_bd($sql_req);
		$row = mysql_fetch_assoc($result);
		$page_accueil_titre=fa_ent_xml($row['titre']);
		_graal_libere_requete_bd($result);
		break;
}
echo('<page_accueil_titre data="'.$page_accueil_titre.'"/>');
echo('</Description>'.EOL);
_graal_ferme_connexion();
?>
