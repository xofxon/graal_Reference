<?php
switch ($vl_c_action) {
	case "dupliquer":
if ($vs_envag!=0){
	$question=<<<EOT
	vf_c_base=fa_mlget('ml_base_destination');
	if (!confirm("Confirmez-vous cette la duplication vers "+vf_c_base+"?")) {return;}
EOT;
	$bloc_validation=<<<EOT
	vl_c_donnees+="&vl_base_destination="+fa_value_get('ml_base_destination')+".";
EOT;
} else {
	$question=<<<EOT
	if (!confirm("Confirmez-vous cette la duplication de cet acteur ?")) {return;}
EOT;
}
$bloc_retour=<<<EOT
//alert(vl_datas)
	vl_datas = vl_datas.split("|");
	if (vl_datas[0]!="-1") {
  		if (vl_datas[1]!="pasouvre") {
    		window.opener.pf_retour_dupliq(vl_datas[0]);
  		} else {
  			alert("Bien dupliquÃ© dans "+vf_c_base+".");
		}
  	} else {
    	alert("Erreur(s)->"+stream);
  	}
		window.close();
EOT;
		break;
	case "changer_genre":
		$question=<<<EOT
	if (!confirm("Confirmez-vous ce changement de genre ?")) {return;}
EOT;
		$bloc_retour=<<<EOT
		window.opener.pf_retour_changer_genre(vl_datas);
		window.close();
EOT;
		break;
}
echo <<<END
<script type="application/x-javascript"><![CDATA[
const _c_script_bdope_act='_graal_bdope_acteurs_01.php';
var vf_c_action;
var vf_c_base="";
function pf_aa_init(){
  fa_grise_non("bt_enregistrer");
  fa_focusdonne("ml_typeacteurs");
}
function pf_etat_fen(vv_quoi){
  vf_c_action=vv_quoi;
  switch(vv_quoi) {
    case "modifier":
      fa_grise_oui("bt_sortir");
      fa_grise_non("bt_enregistrer");
      break;
    case "sortir":
		  window.close();
      break;
  }
}
function pf_fin_requete(stream) {
  var vl_datas = stream;
	$bloc_retour
  
}
function pf_validation(vv_quoi){
	$question
  var vl_c_donnees="";
  vl_c_donnees+="vl_typeacteur="+fa_enc(fa_mlget("ml_typeacteurs"))+"&";
  vl_c_donnees+="vl_act_cleunik=$vl_e_act_cleunik&";
  vl_c_donnees+="vf_c_action=$vl_c_action&";
  $bloc_validation
  fa_xmlhttprequest_txt(_c_script_bdope_act,vl_c_donnees,pf_fin_requete);
}
]]></script>
END;
?>
