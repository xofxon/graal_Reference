<?php
include("_graal_var_portee.php");
echo <<<END
<script type="application/x-javascript"><![CDATA[
/*
****************************************************************************************
**********  Fenêtre de gestion des pseudo-documents (liens internet ou autres)  ********
****************************************************************************************
*/
var vf_e_doc_cleunik;
var vf_c_action;
var vf_c_url_arbre;
var vf_c_genre;
var vf_c_requete_en_cours;
var vf_c_script_edite="_graal_xml_doc_01.php";
var vf_c_script_bdope_doc="_graal_bdope_pseudo_doc_01.php?genre=$vl_c_genre&portee_cleunik=$vl_e_portee_cleunik&";
const vf_c_script_meta='_graal_das_metatag_keyword_03.php?genre=description&';
var vl_c_script_titre='_graal_xml_balises_01.php?';       
var vf_c_url_alimente_table='_graal_das_doc_01.php?';
const vf_c_script_critere_ged_entreprise='_graal_das_ged_criteres_entreprise.php?';
const vf_c_script_critere_ged_lesmiens='_graal_das_ged_criteres_lesmiens.php?';
const vf_c_script_critere_ged_lesautres='_graal_das_ged_criteres_lesautres.php?';
const vf_c_script_critere_ged_tous='_graal_das_ged_criteres_tous.php?';
const vf_c_fen_criteres='_graal_fen_ged_criteres.php?'
const vf_c_script_favoris='_graal_bdope_ged_favoris_01.php?';
const c_fen_commentaires='_graal_fen_documents_commentaires_01.php?genreacteur=tousss&genredoc=pse&';
const c_iframe_commentaires_menu='_graal_fen_iframe_documents_commentaires_01.php?vl_doc_cleunik=';
const c_fen_selection_doc='_graal_fen_ged_01.php?genreged=tousss&quelsdocs=docs&retour=oui&';
const c_fen_selection_notes='_graal_fen_ged_01.php?genreged=tousss&quelsdocs=notes&retour=oui&';
const c_fen_selection_pseudodocs='_graal_fen_ged_01.php?genreged=tousss&quelsdocs=pseudodocs&retour=oui&';
const c_script_connecte="_graal_bdope_doc_connexions.php?";
const c_das_connecte='_graal_rech_ged_03.php?sortie=das&vl_e_doc_cleunik_pere=';
const c_script_liens="_graal_fen_pseudodocs_01.php?genre=$vl_c_genre&quelsdocs=unlien&";
const c_script_notes="_graal_fen_note_01.php?genre=$vl_c_genre&quelsdocs=unenot_acteur&";
const c_fen_selection_dossiers='_graal_fen_ged_01.php?genreged=tousss&quelsdocs=dossiers&retour=oui&';
const c_bdope_dossiers='_graal_bdope_note_01.php?vf_c_action=insere_dans_dossier&type_insertion_dossier=pseudo_doc&vf_e_doc_cleunik=';
const lstn_grise = { 
	willRebuild : function(event){},
	didRebuild  : function(event){fa_grise_fenetre("","non");} 
};
function pf_action(vv_quoi){
  var vl_c_param=null;
  switch (vv_quoi){
    case 'atteindre' :
      fa_ouvre(fa_value_get('tb_emplacement'),0,0)
      return;
      break;
    case 'droits' :
      if (vf_e_doc_cleunik!=0){
        fa_ouvre("_graal_fen_droits_01.php?vl_c_genredoc=Pseud&vl_e_doc_cleunik="+vf_e_doc_cleunik,400,400)
      } else {
        alert('Vous ne pouvez pas gérer les droits de cette manière !!');
      }
      break;
    case 'meta_description':
      s="vl_c_url="+fa_enc(fa_value_get('tb_emplacement'))+"&";
      vf_c_requete_en_cours=vv_quoi;
      fa_xmlhttprequest_xml(vf_c_script_meta,s,pf_affiche_metas);
      break;
    case 'recup_titre':
      var url=fa_value_get('tb_emplacement')
      vl_c_param="vl_c_url="+fa_enc(url);
      vf_c_requete_en_cours=vv_quoi;
      fa_xmlhttprequest_xml(vl_c_script_titre,vl_c_param,pf_affiche_metas);
      break;
    case 'favoris_ajout':
      vl_c_param="vf_c_action=ajouter&vf_c_quoi=1&vl_doc_cleunik="+vf_e_doc_cleunik+"&raf_random="+Math.random()+"&";
      fa_xmlhttprequest_txt(vf_c_script_favoris,vl_c_param,pf_action_fin_01,'');
      break;
    case 'favoris_supprimer':
      vl_c_param="vf_c_action=supprimer&vf_c_quoi=1&vl_doc_cleunik="+vf_e_doc_cleunik+"&raf_random="+Math.random()+"&";
      fa_xmlhttprequest_txt(vf_c_script_favoris,vl_c_param,pf_action_fin_01,'');
      break;
    case 'dossier_ajouter':
    	fa_ouvre(c_fen_selection_dossiers,1000,800);
      break;
  }
}
function pf_action_fin_01(vv_message) {
  alert(vv_message)
}
function pf_affiche_commentaire(vl_commentaire_cleunik) {
  var vl_c_param='&raf_random='+Math.random()+'&';
  vl_c_param+='vf_e_doc_cleunik='+vf_e_doc_cleunik+'&';
  vl_c_param+='vf_e_commentaire_cleunik='+vl_commentaire_cleunik+'&';
  vl_c_param+='genreacteur=favori&';
  fa_ouvre(c_fen_commentaires+vl_c_param,800,650)
}
function pf_affiche_datas(stream){
  var vl_c_datas=stream;
  pf_raz_fiche()
  vf_e_doc_cleunik=fa_xml_get(vl_c_datas,'doc_cleunik');
  fa_value_set('tb_emplacement',fa_xml_get(vl_c_datas,'emplacement'));
  fa_value_set('tb_titre',fa_xml_get(vl_c_datas,'titre'));
  fa_value_set('tb_descriptif_sommaire',fa_xml_get(vl_c_datas,'descriptif_sommaire'));
  fa_value_set("la_dateheurecreation",fa_xml_get(vl_c_datas,'dateheurecreation'));
  fa_value_set("la_dateheuremodif",fa_xml_get(vl_c_datas,'dateheuremodif'));
  fa_value_set("tb_origine",fa_xml_get(vl_c_datas,'origine'));
	fa_att_set("tab_criteres","label","$vl_c_aab_137"+fa_xml_get(vl_c_datas,'nombre_criteres'));
	fa_att_set("tab_commentaires","label","$vl_c_aab_139"+fa_xml_get(vl_c_datas,'nombre_commentaires'));
	fa_att_set("tab_connexions","label","$vl_c_aab_145"+fa_xml_get(vl_c_datas,'nombre_connexions'));
  pf_affiche_donnees_criteres();
  pf_affiche_iframe_commentaires();
	pf_affiche_donnees_connexions();
}
function pf_affiche_donnees_connexions() {
  var vl_c_param=c_das_connecte+vf_e_doc_cleunik+'&raf_random='+Math.random()+'&'
  fa_das("arbre_des_connexions",vl_c_param);
}
function pf_affiche_donnees_criteres(){
  pf_affiche_donnees_criteres_entreprise();
  pf_affiche_donnees_criteres_lesautres();
  pf_affiche_donnees_criteres_lesmiens();
  pf_affiche_donnees_criteres_tous();
}
function pf_affiche_donnees_criteres_entreprise() {
  var vl_c_param=vf_c_script_critere_ged_entreprise+"vl_e_doc_cleunik="+vf_e_doc_cleunik+"&raf_random="+Math.random()+"&";
  fa_das("criteres_des_ged_entreprise",vl_c_param);
}
function pf_affiche_donnees_criteres_lesautres() {
  var vl_c_param=vf_c_script_critere_ged_lesautres+"vl_e_doc_cleunik="+vf_e_doc_cleunik+"&raf_random="+Math.random();
  fa_das("criteres_des_ged_lesautres",vl_c_param);
}
function pf_affiche_donnees_criteres_lesmiens() {
  var vl_c_param=vf_c_script_critere_ged_lesmiens+"vl_e_doc_cleunik="+vf_e_doc_cleunik+"&raf_random="+Math.random();
  fa_das("criteres_des_ged_lesmiens",vl_c_param);
}
function pf_affiche_donnees_criteres_tous() {
  var vl_c_param=vf_c_script_critere_ged_tous+"vl_e_doc_cleunik="+vf_e_doc_cleunik+"&raf_random="+Math.random();
  fa_das("criteres_des_ged_tous",vl_c_param);
}
function pf_affiche_iframe_commentaires() {
  fa_att_set("if_commentaires_doc","src",c_iframe_commentaires_menu+vf_e_doc_cleunik+"&raf_random="+Math.random()+"&");
}
function pf_affiche_metas(stream){
var vl_c_datas;
vl_c_datas = stream;
try{
  if (fa_xml_get(vl_c_datas,'nombre')==0){
    switch (vf_c_requete_en_cours){
      case 'meta_description':
        alert('Il n\'y a pas, a priori, de description exploitable sur cette page.');
        break;
      case 'recup_titre':
        alert('Il n\'y a pas, a priori, de titre exploitable sur cette page.');
        break;
      default:
        alert('Rien d\'exploitable mais le cas-'+vf_c_requete_en_cours+'- n\'est pas géré !!!(c\'est une erreur de programmation ...');  
        break;
    }
    return;
  }
  switch (vf_c_requete_en_cours) {
    case 'recup_titre':
      fa_gid('tb_titre').value=fa_xml_get(vl_c_datas,'titre')
      break;
    case 'meta_description':
      fa_value_set('tb_descriptif_sommaire',fa_xml_get(vl_c_datas,'description'));
      break;
    default:
      alert('Le cas-'+vf_c_requete_en_cours+'- n\'est pas géré !!!(c\'est une erreur de programmation ...');
      break;  
  }
}
catch (e) {}
}
function pf_alimente_defaut(){}
function pf_alimente_table(){
  var param='quelsdocs='+fa_gid("_graal_fen_pseudodocs_01").getAttribute("_graal_lesquels");
  param+='&vs_typedoc='+fa_gid("_graal_fen_pseudodocs_01").getAttribute("_graal_typedoc");
  param+="&raf01="+Math.random();
  fa_grise_fenetre("","oui");
  fa_das("arbre_des_docs",vf_c_url_alimente_table+param);
}
function pf_cache_tab(){
  var vl_tab=fa_gid("vb_tableau");
  if(vl_tab.hidden == true){vl_tab.hidden=false;}else {vl_tab.hidden=true;}
}
function pf_connecte(vv_quoi_01){
  switch (vv_quoi_01) {
    case 'doc':
      vf_c_retour="connexion";
      fa_ouvre(c_fen_selection_doc,1000,800);
      break;
		case 'note':
      vf_c_retour="connexion";
      fa_ouvre(c_fen_selection_notes,1000,800);
      break;
		case 'pseudodocs':
      vf_c_retour="connexion";
      fa_ouvre(c_fen_selection_pseudodocs,1000,800);
      break;
  }
}
function pf_deconnecte(vv_quoi_01){
  switch (vv_quoi_01) {
    case 'doc':
		case 'note':
		case 'pseudodocs':
      var rowIndex=fa_cui("arbre_des_connexions");if(rowIndex == -1){alert("$vl_c_00001");return;}
      if (confirm("Confirmez-vous la suppression de cette connexion ?")==false) {return;}
      var s ="vf_c_action=deconnecter&vl_e_doc_cleunik_gauche="+fa_enc(vf_e_doc_cleunik)+"&vl_e_doc_cleunik_droite="+fa_cell_get("arbre_des_connexions",rowIndex,"arbre_des_connexions_doc_cleunik");
      fa_xmlhttprequest_txt(c_script_connecte,s,pf_affiche_donnees_connexions);
      break;
  }
}
function pf_etat_fen(vv_quoi) {
   vf_c_action=vv_quoi;
   switch(vv_quoi) {
     case "ini":
	 fa_badl("arbre_des_docs",lstn_grise);
       fa_grise_non("bt_ajouter");
       fa_grise_non("bt_annuler");
       fa_grise_non("bt_detailler");
       fa_grise_oui("bt_enregistrer");
       fa_grise_oui("bt_modifier");
       fa_grise_non("bt_sortir");
       fa_grise_oui("bt_supprimer");
       fa_grise_groupe_oui('broadcaster_01');
       switch ("$vl_e_doc_cleunik") {
        case "A" : pf_alimente_table();break;
        case "-1":pf_etat_fen("ajouter");break;
        default:
          vf_e_doc_cleunik=$vl_e_doc_cleunik;
          fa_grise_oui("bt_ajouter");
          fa_xmlhttprequest_xml(vf_c_script_edite,"vl_e_doc_cleunik=$vl_e_doc_cleunik&",pf_affiche_datas);
       }
       break;
     case "selectionner":  //   à affiner, en fonction des droits
       if ("$vl_c_tab_hidden"=="false") {
				 var rowIndex = fa_cui("arbre_des_docs");if(rowIndex == -1){return;}
			 }
			 fa_grise_oui("bt_ajouter");
       fa_grise_non("bt_annuler");
       fa_grise_oui("bt_detailler");
       fa_grise_oui("bt_enregistrer");
       fa_grise_non("bt_modifier");
       fa_grise_oui("bt_sortir");
       fa_grise_non("bt_supprimer");
       fa_grise_groupe_oui('broadcaster_01');
       break;
     case "modifier":
       fa_grise_non("bt_enregistrer");
       fa_grise_oui("bt_modifier");
       fa_grise_oui("bt_supprimer");
       fa_grise_groupe_non('broadcaster_01');
       fa_ro_oui("tb_emplacement");
       fa_focusdonne('tb_titre');
       break;
     case "ajouter":
       fa_grise_oui("bt_ajouter");
       fa_grise_non("bt_annuler");
       fa_grise_oui("bt_detailler");
       fa_grise_non("bt_enregistrer");
       fa_grise_oui("bt_modifier");
       fa_grise_non("bt_sortir");
       fa_grise_oui("bt_supprimer");
       pf_raz_fiche();
       pf_alimente_defaut();
       fa_cache_oui("tab_criteres");fa_cache_oui("tab_commentaires");fa_cache_oui("tab_connexions");
       fa_gid("tab_infogene").selectedIndex=0;
       fa_grise_groupe_non('broadcaster_01');
       fa_grise_oui("menu_02");
       fa_ro_non("tb_emplacement");
       fa_focusdonne("tb_emplacement");
       break;
     case "annuler":
       fa_grise_non("bt_ajouter");
       fa_grise_oui("bt_annuler");
       fa_grise_non("bt_detailler");
       fa_grise_oui("bt_enregistrer");
       fa_grise_oui("bt_modifier");
       fa_grise_non("bt_sortir");
       fa_grise_oui("bt_supprimer");
       fa_cache_non("tab_criteres");fa_cache_non("tab_commentaires");fa_cache_non("tab_connexions");
       pf_raz_fiche();
       fa_grise_groupe_oui('broadcaster_01');
       fa_focusdonne('arbre_des_docs');
       switch ("$vl_e_doc_cleunik") {
        case "A" : pf_alimente_table();break;
        case "-1":pf_etat_fen("ajouter");break;
        default:
          vf_e_doc_cleunik=$vl_e_doc_cleunik;
          fa_grise_oui("bt_ajouter");
          fa_xmlhttprequest_xml(vf_c_script_edite,"vl_e_doc_cleunik=$vl_e_doc_cleunik&",pf_affiche_datas);
       }
       break;
     case "sortir":
       window.close(); //  Ne fonctionne que si cette fenetre est une fenetre appellée dans la même fenêtre
     break;   
 default:
 break;
}
  }
function pf_fin_requete(stream){
  var vl_datas = stream;
  if (window.opener!=null) {window.opener.pf_affiche_donnees_ged();}
  switch (vf_c_action) {
    case "ajouter":
      vf_e_doc_cleunik=vl_datas;
      vf_c_action="modifier";
      fa_cache_non("tab_criteres");fa_cache_non("tab_commentaires");fa_cache_non("tab_connexions");
      fa_grise_non("menu_02");
      break;
    case 'modifier':
      pf_raz_fiche();
      pf_alimente_table();
      pf_etat_fen('annuler');
      break;
    case 'supprimer':
      pf_raz_fiche();
      pf_etat_fen('annuler');
      pf_etat_fen("sortir");
      break;
    default :
      alert('gestion mal gérée');
  }
}
function pf_maj_rss(){
  s='vf_c_quelsdocs=leurnot';
  fa_xmlhttprequest_txt('_graal_rss_pseudosliens_01.php',s,'');
  s='vf_c_quelsdocs=menot';
  fa_xmlhttprequest_txt('_graal_rss_pseudosliens_01.php',s,'');
}
function pf_ouvre(vv_quoi_01,vv_quoi_02) {
  var vl_c_param;
  vl_c_param="typedoc=1&vl_e_doc_cleunik="+vf_e_doc_cleunik+'&vl_c_titre='+fa_enc(fa_value_get("tb_titre"))+"&vl_c_lien="+fa_enc(fa_value_get("tb_emplacement"))+"&+genrecritere=";
  switch (vv_quoi_01) {
    case "critere_entreprise":
      vl_c_param+='entreprise';
      fa_ouvre(vf_c_fen_criteres+vl_c_param,800,600)
      break;
    case "critere_lesmiens":
      vl_c_param+='moi';
      fa_ouvre(vf_c_fen_criteres+vl_c_param,800,600)
      break;
    case "commentaires":
      vl_c_param='vf_e_doc_cleunik='+vf_e_doc_cleunik+'&';
      vl_c_param+='vf_e_commentaire_cleunik=-1&';
      vl_c_param+='genreacteur=favori&';
      fa_ouvre(c_fen_commentaires+vl_c_param,800,650)
      break;
  }
}
function pf_ouvre_ged() {
  var rowIndex = fa_cui("arbre_des_connexions");
  if(rowIndex == -1){return;}
  var vl_e_doc_cleunik=fa_cell_get("arbre_des_connexions",rowIndex,"arbre_des_connexions_doc_cleunik")
  var vl_e_portee=fa_cell_get("arbre_des_connexions",rowIndex,"arbre_des_connexions_rattachement")
  var vl_c_param="doc_cleunik="+vl_e_doc_cleunik+"&";
  vl_c_param+="portee_cleunik="+vl_e_portee+"&";
  switch (fa_cell_get("arbre_des_connexions",rowIndex,"arbre_des_connexions_portee")) {
    case "$vl_e_articl":vl_c_param+="genre=articl&";break;
    case "$vl_e_action":vl_c_param+="genre=action&";break;
    case "$vl_e_interl":vl_c_param+="genre=interl&";break;
    case "$vl_e_acteur":vl_c_param+="genre=acteur&";break;
    case "$vl_e_utilis":vl_c_param+="genre=utilis&";break;
    case "$vl_e_entrep":vl_c_param+="genre=entrep&";break;
  }
  switch (fa_cell_get("arbre_des_connexions",rowIndex,"arbre_des_connexions_typedoc")) {
    case '1': fa_ouvre(c_script_liens+vl_c_param,800,300);break;
    case '2': fa_ouvre(c_script_notes+vl_c_param,800,600);break;
    case '3': //  Documents
    case '13':  //  Pièces jointes
      switch (fa_cell_get("arbre_des_connexions",rowIndex,"arbre_des_connexions_portee")) {
        case "$vl_e_articl":vl_c_param+="quelsdocs=undoc_articl&";break;
        case "$vl_e_action":vl_c_param+="quelsdocs=undoc_action&";break;
        case "$vl_e_interl":vl_c_param+="quelsdocs=undoc_interl&";break;
        case "$vl_e_acteur":vl_c_param+="quelsdocs=undoc_acteur&";break;
        case "$vl_e_utilis":vl_c_param+="quelsdocs=undoc_utilis&";break;
        case "$vl_e_entrep":vl_c_param+="quelsdocs=undoc_entrep&";break;
        default:vl_c_param+="quelsdocs=undoc&";break;
      }
		pf07_ouvre_doc("genre=$vl_c_genre&"+vl_c_param);			
  }
}
function pf_raz_fiche(){
  vf_e_doc_cleunik=0;
  fa_value_set("tb_emplacement","");
  fa_value_set("tb_titre","");
  fa_value_set("tb_descriptif_sommaire","");
  fa_value_set("tb_origine","");
  fa_value_set("la_dateheurecreation","");
  fa_value_set("la_dateheuremodif","");
  fa_value_set("criteres_des_ged_entreprise","");
  fa_ds("criteres_des_ged_lesautres","");
  fa_ds("criteres_des_ged_lesmiens","");
  fa_ds("criteres_des_ged_tous","");
	fa_att_set("tab_criteres","label","$vl_c_aab_137");
	fa_att_set("tab_commentaires","label","$vl_c_aab_139");
	fa_att_set("tab_connexions","label","$vl_c_aab_145");
}
function pf_retour_fenetre_docs(vv_t_tableau_cleunik,vv_t_tableau_nom) {
  vl_e_nb_sel=vv_t_tableau_cleunik.length;
  if (vl_e_nb_sel!=0) {
    switch (vf_c_retour) {
      case "connexion":
        fa_xmlhttprequest_xml(c_script_connecte,"vf_c_action=connecter&vl_e_doc_cleunik_gauche="+vf_e_doc_cleunik+"&vl_e_doc_cleunik_droite="+vv_t_tableau_cleunik[0]+"&",pf_affiche_donnees_connexions);
        break;
    }
  }
}
function pf_retour_fenetre_dossiers(vv_t_tableau_cleunik) {
  var vl_e_nb_sel=vv_t_tableau_cleunik.length;
  if (vl_e_nb_sel!=0) {
	for(var i=0;i<vl_e_nb_sel;i++){                      /* loop 'em */
      var vl_c_donnees=vv_t_tableau_cleunik[i]+"&cleunik_insertion_dossier="+fa_enc(vf_e_doc_cleunik)+"&label_insertion_dossier="+fa_value_get("tb_emplacement")+"("+fa_enc(fa_value_get("tb_titre"))+")";
      fa_xmlhttprequest_txt(c_bdope_dossiers+vl_c_donnees,"",pf_retour_fenetre_dossiers_fin);
    }
  }
}
function pf_retour_fenetre_dossiers_fin(stream){
	alert(stream)
}
function pf_retour_fenetre_notes(vv_t_tableau_cleunik,vv_t_tableau_nom) {
  vl_e_nb_sel=vv_t_tableau_cleunik.length;
  if (vl_e_nb_sel!=0) {
    switch (vf_c_retour) {
      case "connexion":
        fa_xmlhttprequest_xml(c_script_connecte,"vf_c_action=connecter&vl_e_doc_cleunik_gauche="+vf_e_doc_cleunik+"&vl_e_doc_cleunik_droite="+vv_t_tableau_cleunik[0]+"&",pf_affiche_donnees_connexions);
        break;
    }
  }
}
function pf_retour_fenetre_pseudodocs(vv_t_tableau_cleunik,vv_t_tableau_nom) {
  vl_e_nb_sel=vv_t_tableau_cleunik.length;
  if (vl_e_nb_sel!=0) {
    switch (vf_c_retour) {
      case "connexion":
        fa_xmlhttprequest_xml(c_script_connecte,"vf_c_action=connecter&vl_e_doc_cleunik_gauche="+vf_e_doc_cleunik+"&vl_e_doc_cleunik_droite="+vv_t_tableau_cleunik[0]+"&",pf_affiche_donnees_connexions);
        break;
    }
  }
}
function pf_sel_ligne(vv_objet) {
  if(fa_est_grise("bt_detailler")==true){return};
  var arbre = fa_gid(vv_objet);
  var rowIndex = arbre.currentIndex;
  if(rowIndex == -1){return;}
  vf_e_doc_cleunik=arbre.view.getCellText( rowIndex ,arbre.columns.getNamedColumn("doc_cleunik"));
  s ="vl_e_doc_cleunik="+fa_enc(vf_e_doc_cleunik)+"&";
  fa_xmlhttprequest_xml(vf_c_script_edite,s,pf_affiche_datas);
}
function pf_validation(vv_quoi){
  var s;
  switch(vv_quoi){
    case "enregistrer":
      if (vf_e_doc_cleunik==0){
        if (fa_value_get("tb_emplacement")==''){alert('Votre saisie n\'a pas de sens!');fa_focusdonne("tb_emplacement");return;}
        pf_verification_nom();
        return;
      }
      vf_c_action="modifier"
      break;
    case "ajouter":
      vf_c_action="ajouter";
      break;
    case "supprimer":
      if(confirm("Confirmez-vous la suppression de ce lien ?")== false) return;
      vf_c_action="supprimer";
      break;
  }     
  vf_c_requete_en_cours=vf_c_action;
  s="";
  s +="vf_e_doc_cleunik="+fa_enc(vf_e_doc_cleunik)+"&";
  s +="vf_c_emplacement="+fa_enc(fa_value_get("tb_emplacement"))+"&";
  s +="vf_c_titre="+fa_enc(fa_value_get("tb_titre"))+"&";
  s +="vf_c_descriptif_sommaire="+fa_enc(fa_value_get("tb_descriptif_sommaire"))+"&";
  s +="vf_c_origine="+fa_enc(fa_value_get("tb_origine"))+"&";
  s +="vf_c_action="+fa_enc(vf_c_action)+"&";
  fa_xmlhttprequest_txt(vf_c_script_bdope_doc,s,pf_fin_requete);
}
function pf_verification_nom(){
  var s ="vf_c_action=verifier_nom&vf_c_emplacement="+fa_enc(fa_value_get("tb_emplacement"))+"&";
  vf_c_action="verifier_nom";
  vf_c_requete_en_cours="vérifier";
  fa_xmlhttprequest_txt(vf_c_script_bdope_doc,s,pf_verification_nom_fin);
}
function pf_verification_nom_fin(stream){
  var vl_c_data=stream;
  if (vl_c_data=='0') {pf_validation("ajouter");return;}
  if(confirm("Ce pseudo-document est déjà présent. Désirez-vous l'ajouter ?")== false) return;
  pf_validation("ajouter");
}
]]></script>
END;
?>
