<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
/*
********************************************************************************************************************************
**********  Fenêtre des importations APISOFT (_import_apisoft_fen_importation_01.php)                             ********
********************************************************************************************************************************
*/
const _c_url_prepa_client="_import_apisoft_recup_pays.php";
const _c_url_prepa_fourni="_import_apisoft_recup_pays.php";
const _c_url_prepa_articl="_import_apisoft_article_prepa_00.php";
const _c_url_impor_client="_import_apisoft_client_frla_01.php";
const _c_url_impor_repres="_import_apisoft_representant_01.php";
const _c_url_impor_transp="_import_apisoft_transporteur_frla_01.php";
const _c_url_impor_articl="_import_apisoft_article_frla_01.php";
const _c_url_impor_famart="_import_apisoft_article_familles_01.php";
const _c_url_impor_fourni="_import_apisoft_fournisseur_frla_01.php";
const _c_url_impor_fitaxe="_import_apisoft_taxes_frla_01.php";
const _c_url_impor_fitaxe_para="_import_apisoft_taxes_para_frla_01.php";
const _c_url_impor_ficaav="_import_apisoft_categories_comptables_01.php";
const _c_url_impor_secgeo="_import_apisoft_secteurs_geographiques_01.php";
const _c_url_impor_famill="_import_apisoft_familles_01.php";
const _c_url_impor_fictar="_import_apisoft_tarifs_01.php";
const _c_url_impor_tarifs="_import_apisoft_tarifs_articles_frla_02.php";
const _c_url_impor_nomenc="_import_apisoft_nomenc_fab_articles_01.php";
const _c_url_assoc_pays="_import_apisoft_fen_assocations_pays.php";
const _c_url_prepa_devises="_import_apisoft_recup_devises.php";
const _c_url_assoc_devises="_import_apisoft_fen_assocations_devises.php";
const _c_url_impor_tarifs_particuliers="_import_apisoft_tarifs_articles_particuliers_frla_01.php";
const _c_url_impor_unites="_import_apisoft_unitesmesure_01.php";
const _c_url_prepa_orimou="_import_apisoft_recup_orimou.php";
const _c_url_assoc_orimou="_import_apisoft_fen_assocations_orimou.php";
const _c_url_impor_mouvements_stocks="_import_apisoft_mouvements_stocks_frla_01.php?";
const _c_url_import_modreg="_import_apisoft_recup_modereg.php?";
const _c_url_import_comptes_compta_articles="_import_apisoft_comptes_comptables_articles_01.php?";
const _c_url_import_compta_articles="_import_apisoft_compta_articles_01.php?";
const _c_url_import_rep_tiers="_import_apisoft_representantsdestiers_01.php?";
const _c_url_import_libelle_fournisseurs="_import_apisoft_libelles_tarifs_fournisseurs_01.php?";
const _c_url_recup_dep_emp="_import_apisoft_recup_article_dep_emp_frla.php?";
const _c_url_article_dep_emp="_import_apisoft_article_depot_emplacement_frla_01.php";
function pf_etat_fen(vv_quoi){
  switch(vv_quoi) {
    case "ini":
      break;
    case "sortir":
      window.close();  //  Ne fonctionne que si c'est une nouvelle fenêtre
      break;   
    default:
      break;
  }
}
function pf_importation(vv_quoi) {
  var s="";
  var vl_c_fic_tiers,vl_c_fic_artic;
  var vl_c_base_origine="$vl_c_base_origine";
  var vl_c_base_destination="$vl_c_base_destination";
  var vl_e_civilite_defaut;
  var vl_e_mail_defaut;
  var vl_e_fax_defaut;
  var vl_e_tel_defaut;
  var vl_e_portable_defaut;
  var vl_e_pays_defaut;
	fa_att_set("_graal_trad_objets_01","wait-cursor","true");
  fa_grise_fenetre("","oui");
  switch(vv_quoi) {
    case '1': //  Importation du fichier client
      vl_c_fic_tiers="client";
      vl_e_genre_acteur_defaut=fa_value_get("ml_genres_00");
      vl_e_civilite_defaut=fa_value_get("ml_civilite_00");
      vl_e_mail_defaut=fa_value_get("ml_courriel_00");
      vl_e_fax_defaut=fa_value_get("ml_fax_00");
      vl_e_tel_defaut=fa_value_get("ml_tel_00");
      vl_e_portable_defaut=fa_value_get("ml_por_00");
      vl_e_indicatif_tel_defaut=fa_value_get("ml_prefixe_tel_00");
      vl_e_indicatif_fax_defaut=fa_value_get("ml_prefixe_fax_00");
      vl_e_indicatif_por_defaut=fa_value_get("ml_prefixe_por_00");
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      s +="vl_e_civilite_defaut="+vl_e_civilite_defaut+"&";
      s +="vl_e_mail_defaut="+vl_e_mail_defaut+"&";
      s +="vl_e_fax_defaut="+vl_e_fax_defaut+"&";
      s +="vl_e_tel_defaut="+vl_e_tel_defaut+"&";
      s +="vl_e_portable_defaut="+vl_e_portable_defaut+"&";
      s +="vl_e_genre_acteur_defaut="+vl_e_genre_acteur_defaut+"&";
      s +="vl_e_indicatif_fax_defaut="+vl_e_indicatif_fax_defaut+"&";
      s +="vl_e_indicatif_tel_defaut="+vl_e_indicatif_tel_defaut+"&";
      s +="vl_e_indicatif_por_defaut="+vl_e_indicatif_por_defaut+"&";
      s +="vl_e_critere_cleunik_secteur_geo="+fa_value_get("ml_secteurs_geo_00")+"&";
      s +="vl_e_critere_cleunik_famille="+fa_value_get("ml_familles_cli_00")+"&";
      s +="vl_e_critere_cleunik_site="+fa_value_get("ml_site_00")+"&";
      //alert(s)
      fa_xmlhttprequest_txt(_c_url_impor_client,s,pf_importation_retour);
      //fa_ouvre(_c_url_impor_client+"?"+s);
      break;
    case '2': //  Importation du fichier fournisseurs
      vl_c_fic_tiers="fournisseur";
      vl_e_genre_acteur_defaut=fa_mlget("ml_genres_01");
      vl_e_civilite_defaut=fa_mlget("ml_civilite_01");
      vl_e_mail_defaut=fa_mlget("ml_courriel_01");
      vl_e_fax_defaut=fa_mlget("ml_fax_01");
      vl_e_tel_defaut=fa_mlget("ml_tel_01");
      vl_e_portable_defaut=fa_mlget("ml_por_01");
      vl_e_indicatif_tel_defaut=fa_mlget("ml_prefixe_tel_01");
      vl_e_indicatif_fax_defaut=fa_mlget("ml_prefixe_fax_01");
      vl_e_indicatif_por_defaut=fa_mlget("ml_prefixe_por_01");
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      s +="vl_e_civilite_defaut="+vl_e_civilite_defaut+"&";
      s +="vl_e_mail_defaut="+vl_e_mail_defaut+"&";
      s +="vl_e_fax_defaut="+vl_e_fax_defaut+"&";
      s +="vl_e_tel_defaut="+vl_e_tel_defaut+"&";
      s +="vl_e_portable_defaut="+vl_e_portable_defaut+"&";
      s +="vl_e_genre_acteur_defaut="+vl_e_genre_acteur_defaut+"&";
      s +="vl_e_indicatif_fax_defaut="+vl_e_indicatif_fax_defaut+"&";
      s +="vl_e_indicatif_tel_defaut="+vl_e_indicatif_tel_defaut+"&";
      s +="vl_e_indicatif_por_defaut="+vl_e_indicatif_por_defaut+"&";
      s +="vl_e_critere_cleunik_famille="+fa_mlget("ml_familles_fou_00")+"&";
      s +="vl_e_critere_cleunik_site="+fa_value_get("ml_site_01")+"&";
      //alert(s)
      //fa_xmlhttprequest_txt(_c_url_impor_fourni,s,pf_importation_retour);
      fa_ouvre(_c_url_impor_fourni+"?"+s);
      break;
    case '3': //  Importation du fichier transporteurs
      vl_c_fic_tiers="transporteur";
      vl_e_genre_acteur_defaut=fa_mlget("ml_genres_02");
      vl_e_civilite_defaut=fa_mlget("ml_civilite_02");
      vl_e_mail_defaut=fa_mlget("ml_courriel_02");
      vl_e_fax_defaut=fa_mlget("ml_fax_02");
      vl_e_tel_defaut=fa_mlget("ml_tel_02");
      vl_e_portable_defaut=fa_mlget("ml_por_02");
      vl_e_indicatif_tel_defaut=fa_mlget("ml_prefixe_tel_02");
      vl_e_indicatif_fax_defaut=fa_mlget("ml_prefixe_fax_02");
      vl_e_indicatif_por_defaut=fa_mlget("ml_prefixe_por_02");
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      s +="vl_e_civilite_defaut="+vl_e_civilite_defaut+"&";
      s +="vl_e_mail_defaut="+vl_e_mail_defaut+"&";
      s +="vl_e_fax_defaut="+vl_e_fax_defaut+"&";
      s +="vl_e_tel_defaut="+vl_e_tel_defaut+"&";
      s +="vl_e_portable_defaut="+vl_e_portable_defaut+"&";
      s +="vl_e_genre_acteur_defaut="+vl_e_genre_acteur_defaut+"&";
      s +="vl_e_indicatif_fax_defaut="+vl_e_indicatif_fax_defaut+"&";
      s +="vl_e_indicatif_tel_defaut="+vl_e_indicatif_tel_defaut+"&";
      s +="vl_e_indicatif_por_defaut="+vl_e_indicatif_por_defaut+"&";
      fa_xmlhttprequest_txt(_c_url_impor_transp,s,pf_importation_retour);
      break;
    case '4': //  Importation du fichier représentants
      vl_c_fic_tiers="representant";
      vl_e_genre_acteur_defaut=fa_mlget("ml_genres_03");
      vl_e_civilite_defaut=fa_mlget("ml_civilite_03");
      vl_e_mail_defaut=fa_mlget("ml_courriel_03");
      vl_e_fax_defaut=fa_mlget("ml_fax_03");
      vl_e_tel_defaut=fa_mlget("ml_tel_03");
      vl_e_portable_defaut=fa_mlget("ml_por_03");
      vl_e_indicatif_tel_defaut=fa_mlget("ml_prefixe_tel_03");
      vl_e_indicatif_fax_defaut=fa_mlget("ml_prefixe_fax_03");
      vl_e_indicatif_por_defaut=fa_mlget("ml_prefixe_por_03");
      vl_e_pays_defaut="60000";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      s +="vl_e_civilite_defaut="+vl_e_civilite_defaut+"&";
      s +="vl_e_mail_defaut="+vl_e_mail_defaut+"&";
      s +="vl_e_fax_defaut="+vl_e_fax_defaut+"&";
      s +="vl_e_tel_defaut="+vl_e_tel_defaut+"&";
      s +="vl_e_portable_defaut="+vl_e_portable_defaut+"&";
      s +="vl_e_pays_defaut="+vl_e_pays_defaut+"&";
      s +="vl_e_genre_acteur_defaut="+vl_e_genre_acteur_defaut+"&";
      s +="vl_e_indicatif_fax_defaut="+vl_e_indicatif_fax_defaut+"&";
      s +="vl_e_indicatif_tel_defaut="+vl_e_indicatif_tel_defaut+"&";
      s +="vl_e_indicatif_por_defaut="+vl_e_indicatif_por_defaut+"&";
      fa_xmlhttprequest_txt(_c_url_impor_repres,s,pf_importation_retour);
      break;
    case '5': //  Importation du fichier articles
      vl_c_fic_artic="article";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_artic="+vl_c_fic_artic+"&";
      s +="vl_e_famille="+fa_value_get("ml_familles_art_00")+"&";
      s +="vl_e_type="+fa_value_get("ml_types_art_00")+"&";
      fa_xmlhttprequest_txt(_c_url_impor_articl,s,pf_importation_retour);
      break;
    case '6': //  Importation du fichier des taxes
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_impor_fitaxe,s,pf_importation_retour);
      break;
    case '7': //  Importation du fichier des catégories d'achat vente
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_impor_ficaav,s,pf_importation_retour);
      break;
    case '8': //  Importation du fichier des dénominations des tarifs
      s +="vl_c_base_origine="+vl_c_base_origine+"&vl_c_base_destination="+vl_c_base_destination+"&vl_e_critere_cleunik=101&";
      fa_xmlhttprequest_txt(_c_url_impor_fictar,s,pf_importation_retour);
      break;
    case '9': //  Importation du fichier des tarifs des articles
      s +="vl_c_base_origine="+vl_c_base_origine+"&vl_c_base_destination="+vl_c_base_destination+"&vl_e_critere_cleunik=101&";
      fa_xmlhttprequest_txt(_c_url_impor_tarifs,s,pf_importation_retour);
      //fa_ouvre(_c_url_impor_tarifs+"?"+s)
      break;
    case '10': //  Importation du fichier des nomenclatures d'articles
      s +="vl_c_base_origine="+vl_c_base_origine+"&vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_impor_nomenc,s,pf_importation_retour);
      break;
    case '11': //  Importation du fichier des tarifs particuliers des articles
      s +="vl_c_base_origine="+vl_c_base_origine+"&vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_impor_tarifs_particuliers,s,pf_importation_retour);
      break;
    case '12': //  Importation du fichier des unités
      s +="vl_c_base_origine="+vl_c_base_origine+"&vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_impor_unites,s,pf_importation_retour);
      break;
    case '13': //  Importation du fichier mouvements de stock
      s +="vl_c_base_origine="+vl_c_base_origine+"&vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_impor_mouvements_stocks,s,pf_importation_retour);
      break;
    case '14': //  Importation du fichier des modes de règlement
      s +="vl_c_base_origine="+vl_c_base_origine+"&vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_import_modreg,s,pf_importation_retour);
      break;
    case '15': //  Importation des comptes comptables articles
      s +="vl_c_base_origine="+vl_c_base_origine+"&vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_import_comptes_compta_articles,s,pf_importation_retour);
      break;
    case '16': //  Importation du fichier des comptes comptables des articles
      s +="vl_c_base_origine="+vl_c_base_origine+"&vl_c_base_destination="+vl_c_base_destination+"&";
      //fa_xmlhttprequest_txt(_c_url_import_compta_articles,s,pf_importation_retour);
      fa_ouvre(_c_url_import_compta_articles+s);
      break;
    case '17': //  Rattachement des représentants aux clients
      vl_c_fic_tiers="client";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      fa_xmlhttprequest_txt(_c_url_import_rep_tiers,s,pf_importation_retour);
      break;
	case '18': //  Importation uniquement des critères familles d'article à partir du fichier articles
      vl_c_fic_artic="article";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_artic="+vl_c_fic_artic+"&";
      s +="vl_e_famille="+fa_mlget("ml_familles_art_00")+"&";
      fa_xmlhttprequest_txt(_c_url_impor_famart,s,pf_importation_retour);
      break;
    case '19': //  Importation du fichier des taxes parafiscales
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_impor_fitaxe_para,s,pf_importation_retour);
      break;
    case '20': //  Importation du fichier des libellés et tarifs fournisseurs
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_import_libelle_fournisseurs,s,pf_importation_retour);
      break;
    case '21': //  Récupération ds dépôts et emplacements
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_recup_dep_emp,s,pf_importation_retour);
      break;
     case '22': //  Maj partie article concernée par dépôts emplacements
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_article_dep_emp,s,pf_importation_retour);
      break;
      
      
      
      default:
      alert("Erreur de programmation !!!->'"+vv_quoi+"'<-!!!");
      
  }
}

function pf_importation_critere(vv_id){
  var s="";
  var vl_c_base_origine=fa_value_get("c_base_ori");
  var vl_c_base_destination=fa_value_get("c_base_des");
	fa_att_set("_graal_trad_objets_01","wait-cursor","true");
  fa_grise_fenetre("","oui");
  switch (vv_id) {
    case 'ml_secteurs_geo_00':  // Secteurs géographiques des Clients
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="quoi=SecteurGeo&";
      s +="qui=clients&";
      s +="vl_e_critere_cleunik="+fa_mlget("ml_secteurs_geo_00");
      fa_xmlhttprequest_txt(_c_url_impor_secgeo,s,pf_importation_retour);
      break;
    case "ml_familles_cli_00":  // Familles des Clients
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="quoi=FamilleClient&";
      s +="qui=clients&";
      s +="vl_e_critere_cleunik="+fa_mlget("ml_familles_cli_00");
      fa_xmlhttprequest_txt(_c_url_impor_famill,s,pf_importation_retour);
      break;
    case "ml_familles_fou_00":  // Familles des fournisseurs
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="quoi=FamilleFou&";
      s +="qui=fournis&";
      s +="vl_e_critere_cleunik="+fa_mlget("ml_familles_fou_00");
      fa_xmlhttprequest_txt(_c_url_impor_famill,s,pf_importation_retour);
      break;
 }
}
function pf_importation_retour(stream){
	fa_att_rem("_graal_trad_objets_01","wait-cursor");
	fa_grise_fenetre("","non");
	var vl_datas = stream;
	if (vl_datas=='ok') 
	  alert("C'est toubon...");
	else
	  {fa_erreur(vl_datas);}
}
function pf_ouvre_devise_apisoft() {
  fa_ouvre(_c_url_assoc_devises,800,800)
}
function pf_ouvre_orimou_apisoft() {
  fa_ouvre(_c_url_assoc_orimou,800,800)
}
function pf_ouvre_pays_apisoft() {
  fa_ouvre(_c_url_assoc_pays,800,800)
}
function pf_preparation(vv_quoi){
  var s="",vl_c_fic_tiers,vl_e_traitement;
  var vl_c_base_origine=fa_gid("c_base_ori").value;
  var vl_c_base_destination=fa_gid("c_base_des").value;
  switch(vv_quoi) {
    case '1': //  Préparation Correspondances des pays d adresses de livraison et de facturation pour les clients
      vl_c_fic_tiers="client";
      vl_e_traitement="1";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_client,s,pf_preparation_retour);
      break;
    case '2': //  Préparation Correspondances des pays pour les fournisseurs
      vl_c_fic_tiers="fournisseur";
      vl_e_traitement="2";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_fourni,s,pf_preparation_retour);
      break;
    case '3': //  Préparation Correspondances des familles pour les fournisseurs
      vl_c_fic_tiers="fournisseur";
      vl_e_traitement="3";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_fourni,s,pf_preparation_retour);
      break;
    case '4': //  Préparation Millésimes pour les articles
      vl_e_traitement="1";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_articl,s,pf_preparation_retour);
      break;
    case '5': //  Préparation Couleurs pour les articles
      vl_e_traitement="2";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_articl,s,pf_preparation_retour);
      break;
    case '6': //  Préparation Types pour les articles
      vl_e_traitement="7";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      s +="vl_e_critere_cleunik="+fa_mlget("ml_types_art_00")+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_articl,s,pf_preparation_retour);
      break;
    case '7': //  Préparation Conditionnements pour les articles
      vl_e_traitement="4";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_articl,s,pf_preparation_retour);
      break;
    case '8': //  Préparation Contenants pour les articles
      vl_e_traitement="5";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_articl,s,pf_preparation_retour);
      break;
    case '9' :  // Familles des articles
      vl_e_traitement="6";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_e_critere_cleunik="+fa_mlget("ml_familles_art_00")+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_articl,s,pf_preparation_retour);
      break;
    case '10': //  Préparation Correspondances des devises clients
      vl_c_fic_tiers="client";
      vl_e_traitement="1";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_devises,s,pf_preparation_retour);
      break;
    case '11': //  Préparation Correspondances des devises fournisseurs 
      vl_c_fic_tiers="fournisseur";
      vl_e_traitement="1";
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      s +="vl_c_fic_tiers="+vl_c_fic_tiers+"&";
      s +="vl_e_traitement="+vl_e_traitement+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_devises,s,pf_preparation_retour);
      break;
    case '12': //  Préparation Correspondances des origines des mouvements de stock 
      s +="vl_c_base_origine="+vl_c_base_origine+"&";
      s +="vl_c_base_destination="+vl_c_base_destination+"&";
      fa_xmlhttprequest_txt(_c_url_prepa_orimou,s,pf_preparation_retour);
      break;

    default:
      alert("Erreur de programmation !!!->'"+vv_quoi+"'<-!!!");
  }
}
function pf_preparation_retour(stream)
{
var vl_datas = stream;
if (vl_datas=='ok') 
  alert("C'est toubon...");
else
  {fa_erreur(vl_datas);}
}
]]></script>
END;
