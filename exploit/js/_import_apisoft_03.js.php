<?php
echo <<<END
/*
********************************************************************************************************************************
**********  Fenêtre des importations des documents commerciaux (_import_apisoft_fen_importation_03.php)                             ********
********************************************************************************************************************************
*/
<script type="application/x-javascript"><![CDATA[
const _c_url_impor_doc="_import_apisoft_actions_commerciales_01.php";
const _c_url_prepa_pays="_import_apisoft_recup_pays.php";
const _c_url_assoc_pays="_import_apisoft_fen_assocations_pays.php";
const _c_url_prepa_devises="_import_apisoft_recup_devises.php";
const _c_url_assoc_devises="_import_apisoft_fen_assocations_devises.php";
function pf_etat_fen(vv_quoi){
  switch(vv_quoi)  {
    case "ini":
      break;
    case "sortir":
      window.close();  //  Ne fonctionne que si c'est une nouvelle fenêtre
      break;   
    default:
      break;
  }
}
function pf_importation(vv_quoi){
  var param="";
  var vl_c_base_origine=fa_value_get("c_base_ori");
  var vl_c_base_destination=fa_value_get("c_base_des");
  switch(vv_quoi) {
    case 'cdecli': //  Commandes clients
    case 'livcli': //  Livraisons clients
    case 'faccli': //  Factures clients
    case 'avocli':	//	Avoirs clients
    case 'cdefou': //  Commandes fournisseurs
    case 'recfou': //  Réceptions fournisseurs
    case 'facfou': //  Factures fournisseurs
      param +="vl_c_base_origine="+vl_c_base_origine+"&";
      param +="vl_c_base_destination="+vl_c_base_destination+"&";
      param +="vl_c_type_doc="+vv_quoi+"&";
      param +="raf_random="+Math.random()+"&";
			fa_att_set("_graal_trad_objets_01","wait-cursor","true");
      fa_grise_fenetre("","oui");
			fa_xmlhttprequest_txt(_c_url_impor_doc,param,pf_importation_retour);
      break;
    default:
      alert("Erreur de programmation !!!->'"+vv_quoi+"'<-!!!");
  }
}
function pf_importation_retour(stream){
  var vl_datas = stream;
	fa_att_rem("_graal_trad_objets_01","wait-cursor");
  alert(vl_datas);
	fa_grise_fenetre("","non");
}
function pf_ouvre_devises_apisoft() {
  fa_ouvre(_c_url_assoc_devises,800,800)
}
function pf_ouvre_pays_apisoft() {
  fa_ouvre(_c_url_assoc_pays,800,800)
}
function pf_recup_devises(vv_quoi){
  var param="";
  var vl_c_base_origine=fa_value_get("c_base_ori");
  var vl_c_base_destination=fa_value_get("c_base_des");
  param +="vl_c_base_origine="+vl_c_base_origine+"&";
  param +="vl_c_base_destination="+vl_c_base_destination+"&";
  switch(vv_quoi) {
    case 'cdecli': //  Commandes clients
      param +="vl_c_fic_tiers=entetecdeclient&";
      break;
    case 'livcli': //  Livraisons clients
      param +="vl_c_fic_tiers=enteteblclient&";
      break;
    case 'faccli': //  Factures clients
    case 'avocli': //  Avoirs clients
      param +="vl_c_fic_tiers=entetefacture&";
      break;
    case 'cdefou': //  Commandes fournisseurs
      param +="vl_c_fic_tiers=entetecdefournisseur&";
      break;
    case 'recfou': //  Réception fournisseurs
      param +="vl_c_fic_tiers=entetereceptionfournisseur&";
      break;
    case 'facfou': //  Factures fournisseur
      param +="vl_c_fic_tiers=entetefacturefournisseur&";
      break;

    default:
      alert("Erreur de programmation !!!->'"+vv_quoi+"'<-!!!");
      return;
  }
  fa_xmlhttprequest_txt(_c_url_prepa_devises,param,pf_importation_retour);
}
function pf_recup_pays(vv_quoi){
  var param="";
  var vl_c_base_origine=fa_value_get("c_base_ori");
  var vl_c_base_destination=fa_value_get("c_base_des");
  param +="vl_c_base_origine="+vl_c_base_origine+"&";
  param +="vl_c_base_destination="+vl_c_base_destination+"&";
  param +="vl_e_traitement=3&";
  switch(vv_quoi) {
    case 'cdecli': //  Commandes clients
      param +="vl_c_fic_tiers=entetecdeclient&";
      break;
    case 'livcli': //  Livraisons clients
      param +="vl_c_fic_tiers=enteteblclient&";
      break;
    case 'faccli': //  Factures clients
    case 'avocli': //  Avoirs clients
      param +="vl_c_fic_tiers=entetefacture&";
      break;
    case 'cdefou': //  Commandes fournisseurs
      param +="vl_c_fic_tiers=entetecdefournisseur&";
      break;
    case 'recfou': //  Réception fournisseurs
      param +="vl_c_fic_tiers=entetereceptionfournisseur&";
      break;
    case 'facfou': //  Factures fournisseur
      param +="vl_c_fic_tiers=entetefacturefournisseur&";
      break;

    default:
      alert("Erreur de programmation !!!->'"+vv_quoi+"'<-!!!");
      return;
  }
  fa_xmlhttprequest_txt(_c_url_prepa_pays,param,pf_importation_retour);
}

]]></script>
END;
