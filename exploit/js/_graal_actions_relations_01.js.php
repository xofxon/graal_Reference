<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
const vf_c_script_bdope_fen="_graal_bdope_actions_relations_01.php";
const vf_c_script_interlo_relation='_graal_xml_actions_relations_01.php';
var vf_c_action;
var vf_e_choix_cleunik_gauche="$vl_e_choix_cleunik_gauche",vf_e_choix_cleunik_droite="$vl_e_choix_cleunik_droite";
function pf_aa_init(){
  var vl_c_param;
  var raf_random=Math.random();
  var i;
  fa_grise_non("bt_supprimer");
  fa_grise_non("bt_modifier");
  fa_grise_oui("bt_enregistrer");
  fa_grise_oui("bt_annuler");
	fa_mlsel("ml_rel_gauche",vf_e_choix_cleunik_gauche);
	fa_mlsel("ml_rel_droite",vf_e_choix_cleunik_droite);
  vl_c_param="";
  vl_c_param+="vl_action_cleunik_gauche=$vl_e_action_cleunik_gauche&";
  vl_c_param+="vl_action_cleunik_droite=$vl_e_action_cleunik_droite&";
  vl_c_param+="vl_choix_cleunik_gauche=$vl_e_choix_cleunik_gauche&";
  vl_c_param+="vl_choix_cleunik_droite=$vl_e_choix_cleunik_droite&";
  vl_c_param+="raf_random="+raf_random+"&";
  fa_xmlhttprequest_xml(vf_c_script_interlo_relation,vl_c_param,pf_alimente_blocnote);
  fa_focusdonne("tb_blocnotebrut");
}

function pf_alimente_blocnote(stream){
var vl_c_datas = stream;
fa_value_set("tb_blocnotebrut",fa_xml_get(vl_c_datas,'blocnotebrut'));
}
function pf_etat_fen(vv_quoi)
  {
  vf_c_action=vv_quoi;
  switch(vv_quoi) {
    case "modifier":
      fa_grise_oui("bt_supprimer");
      fa_grise_oui("bt_modifier");
      fa_grise_oui("bt_sortir");
      fa_grise_non("bt_annuler");
      fa_grise_non("bt_enregistrer");
      break;
    case "sortir":
      try { window.opener.pf_affiche_donnees_relations()} catch (e) {}
      window.close();
      break;
  }
  }
function pf_fin_requete(stream){
  var vl_datas = stream;
  if (vl_datas=="-1"){alert(vl_datas);}
  pf_etat_fen('sortir');
}
function pf_validation(vv_quoi){
  var vl_c_donnees;
    switch(vv_quoi){
      case "enregistrer":
        vl_c_donnees="";
        vl_c_donnees+="vl_action_cleunik_gauche=$vl_e_action_cleunik_gauche&";
        vl_c_donnees+="vl_action_cleunik_droite=$vl_e_action_cleunik_droite&";
        vl_c_donnees+="vl_choix_cleunik_gauche="+$vl_e_choix_cleunik_gauche+"&";
        vl_c_donnees+="vl_choix_cleunik_droite="+$vl_e_choix_cleunik_droite+"&";
        vl_c_donnees+="vf_c_action=supprimer&";
        fa_xmlhttprequest_txt(vf_c_script_bdope_fen,vl_c_donnees,"")
        vl_c_donnees="";
        vl_c_donnees+="vl_action_cleunik_gauche=$vl_e_action_cleunik_gauche&";
        vl_c_donnees+="vl_action_cleunik_droite=$vl_e_action_cleunik_droite&";
        vl_c_donnees+="vl_choix_cleunik_gauche="+fa_enc(fa_mlget("ml_rel_gauche","_graal_cleunik"))+"&";
        vl_c_donnees+="vl_choix_cleunik_droite="+fa_enc(fa_mlget("ml_rel_droite","_graal_cleunik"))+"&";
        vl_c_donnees+="vl_blocnotebrut="+fa_enc(fa_value_get("tb_blocnotebrut"))+"&";
        vl_c_donnees+="vf_c_action=ajouter&";
        break;
      case "supprimer":
          Check = confirm("Confirmez-vous la suppression de cet élément ?");
          if(Check == false) return;
          vl_c_donnees+="vf_c_action=supprimer&";
        break;
    }
  fa_xmlhttprequest_txt(vf_c_script_bdope_fen,vl_c_donnees,pf_fin_requete);
}
]]></script>
END;
?>
