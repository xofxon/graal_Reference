<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
const vf_c_script_bdope_fen="_graal_bdope_act_representants_01.php";
const vf_c_script_representant='_graal_xml_act_representants_02.php?';
var vf_c_action;
const vf_e_act_cleunik_gauche=$vl_e_act_cleunik_gauche,vf_e_act_cleunik_droite=$vl_e_act_cleunik_droite,vf_e_choix_cleunik_gauche=$vl_e_choix_cleunik_gauche,vf_e_choix_cleunik_droite=$vl_e_choix_cleunik_droite;
function pf_aa_init(){
  var vl_c_param;
  fa_sep("tb_taux");
  fa_sep("tb_montant");
  pf_etat_fen("ini");
  fa_mlsel("ml_rel_gauche",vf_e_choix_cleunik_gauche);
  fa_mlsel("ml_rel_droite",vf_e_choix_cleunik_droite);
  vl_c_param="";
  vl_c_param+="vl_act_cleunik_gauche="+vf_e_act_cleunik_gauche+"&";
  vl_c_param+="vl_act_cleunik_droite="+vf_e_act_cleunik_droite+"&"
  vl_c_param+="vl_choix_cleunik_gauche="+vf_e_choix_cleunik_gauche+"&"
  vl_c_param+="vl_choix_cleunik_droite="+vf_e_choix_cleunik_droite+"&"
  vl_c_param+="raf_random="+Math.random()+"&";
  fa_xmlhttprequest_xml(vf_c_script_representant,vl_c_param,pf_alimente_blocnote);
}
function pf_alimente_blocnote(stream){
var vl_c_datas = stream;
  fa_value_set("tb_blocnotebrut",fa_xml_get(vl_c_datas,'blocnotebrut'));
  fa_mlsel("ml_commission_typ",fa_xml_get(vl_c_datas,'commission_typ'),"value");
  fa_mlsel("ml_commission_regle",fa_xml_get(vl_c_datas,'commission_regle'),"value");
  fa_value_set("tb_taux",fa_xml_get(vl_c_datas,'commission_taux'));
  fa_value_set("tb_montant",fa_xml_get(vl_c_datas,'commission_fixe'));
  fa_focusdonne("tb_blocnotebrut");
}
function pf_etat_fen(vv_quoi){
  vf_c_action=vv_quoi;
  switch(vv_quoi) {
    case "ini":
      fa_grise_non("bt_supprimer");
      fa_grise_non("bt_modifier");
      fa_grise_oui("bt_enregistrer");
      fa_grise_oui("bt_annuler");
      fa_grise_groupe_oui('broadcaster_01');
      break;
    case "modifier":
      fa_grise_oui("bt_supprimer");
      fa_grise_oui("bt_modifier");
      fa_grise_oui("bt_sortir");
      fa_grise_non("bt_annuler");
      fa_grise_non("bt_enregistrer");
      fa_grise_groupe_non('broadcaster_01');
      break;
    case "annuler":
      fa_grise_non("bt_supprimer");
      fa_grise_non("bt_modifier");
      fa_grise_oui("bt_enregistrer");
      fa_grise_oui("bt_annuler");
      fa_grise_non("bt_sortir");
      fa_grise_groupe_oui('broadcaster_01');
      break;
    case "sortir":
      window.close();
      break;
  }
}
function pf_fin_requete(stream){
  var vl_datas = stream;
  if (vl_datas!="-1") {} else {alert(vl_datas);}
  if (window.opener!=null) {try {window.opener.pf_affiche_donnees_representants();} catch(e){}}
  pf_etat_fen('sortir');
}
function pf_validation(vv_quoi){
  var vl_c_donnees="";
  vl_c_donnees+="vl_act_cleunik_gauche="+vf_e_act_cleunik_gauche+"&";
  vl_c_donnees+="vl_act_cleunik_droite="+vf_e_act_cleunik_droite+"&";
  vl_c_donnees+="vl_choix_cleunik_gauche="+vf_e_choix_cleunik_gauche+"&";
  vl_c_donnees+="vl_choix_cleunik_droite="+vf_e_choix_cleunik_droite+"&";
  switch(vv_quoi){
    case "enregistrer":
      vl_c_donnees+="vl_blocnotebrut="+fa_enc(fa_value_get("tb_blocnotebrut"))+"&";
      vl_c_donnees+="vl_commission_typ="+fa_enc(fa_value_get("ml_commission_typ"))+"&";
      vl_c_donnees+="vl_commission_taux="+fa_enc(fa_value_get("tb_taux"))+"&";
      vl_c_donnees+="vl_commission_fixe="+fa_enc(fa_value_get("tb_montant"))+"&";
      vl_c_donnees+="vl_commission_regle="+fa_enc(fa_value_get("ml_commission_regle"))+"&";
      vl_c_donnees+="vf_c_action=modifier&";
      break;
    case "supprimer":
        Check = confirm("Confirmez-vous la suppression de cet élément ?");
        if(Check == false) return;
        vl_c_donnees+="vf_c_action=supprimer&";
      break;
  }
  fa_xmlhttprequest_txt(vf_c_script_bdope_fen,vl_c_donnees,pf_fin_requete);
}
]]></script>
END;
?>
