<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
const _c_url_alimente_table_01="_graal_das_param_categories_compta_01.php";
const _c_script_edite="_graal_xml_param_categories_compta_01.php";
const _c_script_bdope_fen="_graal_bdope_param_categories_compta_01.php";
const c_script_pc="_graal_fen_rech_param_pc_01.php?";
const c_script_taxe="_graal_fen_rech_param_taxes_01.php?";
const c_c_script_fen_traitements_acteurs='_graal_traitements_acteurs_01.php?p02=$vl_c_id_fenetre&';
var vf_c_action,vf_catcompta_cleunik=-2,vf_e_utilisations=0;
function pf_affiche_datas(stream){
  var vl_c_datas=stream;
  vf_catcompta_cleunik=fa_xml_get(vl_c_datas,"catcompta_cleunik");
  fa_value_set("tb_code",fa_xml_get(vl_c_datas,"code"));
  fa_value_set("tb_intitule",fa_xml_get(vl_c_datas,"intitule"));
  fa_value_set("tb_dateheuremodification",fa_xml_get(vl_c_datas,"dateheuremodification"));
  fa_value_set("tb_dateheurecreation",fa_xml_get(vl_c_datas,"dateheurecreation"));
  vf_e_utilisations=fa_xml_get(vl_c_datas,"utilisations");

  fa_value_set("tb_code_vente_port",fa_xml_get(vl_c_datas,"code_vente_port"));
  fa_att_set("tb_code_vente_port","compte_vente_port",fa_xml_get(vl_c_datas,'compte_vente_port'));
  fa_value_set("tb_intitule_vente_port",fa_xml_get(vl_c_datas,"intitule_vente_port"));
  fa_value_set("tb_code_achat_port",fa_xml_get(vl_c_datas,"code_achat_port"));
  fa_att_set("tb_code_achat_port","compte_achat_port",fa_xml_get(vl_c_datas,'compte_achat_port'));
  fa_value_set("tb_intitule_achat_port",fa_xml_get(vl_c_datas,"intitule_achat_port"));

  fa_value_set("tb_code_vente_divers",fa_xml_get(vl_c_datas,"code_vente_divers"));
  fa_att_set("tb_code_vente_divers","compte_vente_divers",fa_xml_get(vl_c_datas,'compte_vente_divers'));
  fa_value_set("tb_intitule_vente_divers",fa_xml_get(vl_c_datas,"intitule_vente_divers"));
  fa_value_set("tb_code_achat_divers",fa_xml_get(vl_c_datas,"code_achat_divers"));
  fa_att_set("tb_code_achat_divers","compte_achat_divers",fa_xml_get(vl_c_datas,'compte_achat_divers'));
  fa_value_set("tb_intitule_achat_divers",fa_xml_get(vl_c_datas,"intitule_achat_divers"));
  
  fa_value_set("tb_code_taxes_vente_port",fa_xml_get(vl_c_datas,"code_taxe_vente_port"));
  fa_att_set("tb_code_taxes_vente_port","compte_taxes_vente_port",fa_xml_get(vl_c_datas,'taxes_vente_port'));
  fa_value_set("tb_intitule_taxes_vente_port",fa_xml_get(vl_c_datas,"denomination_vente_port"));
  fa_value_set("tb_code_taxes_vente_divers",fa_xml_get(vl_c_datas,"code_taxe_vente_divers"));
  fa_att_set("tb_code_taxes_vente_divers","compte_taxes_vente_divers",fa_xml_get(vl_c_datas,'taxes_vente_divers'));
  fa_value_set("tb_intitule_taxes_vente_divers",fa_xml_get(vl_c_datas,"denomination_vente_divers"));
  
  fa_value_set("tb_code_taxes_achat_port",fa_xml_get(vl_c_datas,"code_taxe_achat_port"));
  fa_att_set("tb_code_taxes_achat_port","compte_taxes_achat_port",fa_xml_get(vl_c_datas,'taxes_achat_port'));
  fa_value_set("tb_intitule_taxes_achat_port",fa_xml_get(vl_c_datas,"denomination_achat_port"));
  fa_value_set("tb_code_taxes_achat_divers",fa_xml_get(vl_c_datas,"code_taxe_achat_divers"));
  fa_att_set("tb_code_taxes_achat_divers","compte_taxes_achat_divers",fa_xml_get(vl_c_datas,'taxes_achat_divers'));
  fa_value_set("tb_intitule_taxes_achat_divers",fa_xml_get(vl_c_datas,"denomination_achat_divers"));
}
function pf_aa_init(){
  fa_grise_oui("bt_supprimer");
  fa_grise_oui("bt_modifier");
  fa_grise_oui("bt_enregistrer");
  fa_grise_oui("bt_annuler");
  fa_grise_groupe_oui("broadcaster_01");
  pf_raz_fiche();
  pf_alimente_table("arbre_categories_compta");
}
function pf_alimente_defaut(){
  fa_value_set("tb_code","");
  fa_value_set("tb_intitule","");
  fa_value_set("tb_dateheuremodification","");
  fa_value_set("tb_dateheurecreation","");
  fa_value_set("tb_code_vente_port","");
  fa_att_set("tb_code_vente_port","compte_vente_port",-1);
  fa_value_set("tb_intitule_vente_port","");
  fa_value_set("tb_code_achat_port","");
  fa_att_set("tb_code_achat_port","compte_achat_port",-1);
  fa_value_set("tb_intitule_achat_port","");
  fa_value_set("tb_code_vente_divers","");
  fa_att_set("tb_code_vente_divers","compte_vente_divers",-1);
  fa_value_set("tb_intitule_vente_divers","");
  fa_value_set("tb_code_achat_divers","");
  fa_att_set("tb_code_achat_divers","compte_achat_divers",-1);
  fa_value_set("tb_intitule_achat_divers","");
  fa_value_set("tb_code_taxes_vente_port","");
  fa_att_set("tb_code_taxes_vente_port","compte_taxes_vente_port",-1);
  fa_value_set("tb_intitule_taxes_vente_port","");
  fa_value_set("tb_code_taxes_vente_divers","");
  fa_att_set("tb_code_taxes_vente_divers","compte_taxes_vente_divers",-1);
  fa_value_set("tb_intitule_taxes_vente_divers","");
  
  fa_value_set("tb_code_taxes_achat_port","");
  fa_att_set("tb_code_taxes_achat_port","compte_taxes_achat_port",-1);
  fa_value_set("tb_intitule_taxes_achat_port","");
  fa_value_set("tb_code_taxes_achat_divers","");
  fa_att_set("tb_code_taxes_achat_divers","compte_taxes_achat_divers",-1);
  fa_value_set("tb_intitule_taxes_achat_divers","");
}
function pf_alimente_table(vv_qui){
  fa_das(vv_qui,_c_url_alimente_table_01+"?raf="+Math.random());
}
function pf_etat_fen(vv_quoi){
  vf_c_action=vv_quoi;
  switch(vv_quoi) {
    case "selectionner":
      var i=fa_cui("arbre_categories_compta");if(i==-1){return;}
      if (vf_e_utilisations==0 && vf_catcompta_cleunik>0) {fa_grise_non("bt_supprimer");} else {fa_grise_oui("bt_supprimer");}
      fa_grise_non("bt_modifier");
      fa_grise_oui("bt_enregistrer");
      fa_grise_oui("bt_ajouter");
      fa_grise_oui("bt_detailler");
      fa_grise_oui("bt_sortir");
      fa_grise_non("bt_annuler");
      break;
    case "modifier":
    fa_grise_oui("bt_supprimer");
    fa_grise_oui("bt_modifier");
    fa_grise_oui("bt_ajouter");
    fa_grise_oui("bt_detailler");
    fa_grise_oui("bt_sortir");
    fa_grise_non("bt_annuler");
    fa_grise_non("bt_enregistrer");
    fa_grise_groupe_non("broadcaster_01");
    fa_focusdonne("tb_code")
    break;
    case "ajouter":
    fa_grise_oui("bt_supprimer");
    fa_grise_oui("bt_modifier");
    fa_grise_oui("bt_ajouter");
    fa_grise_oui("bt_detailler");
    fa_grise_oui("bt_sortir");
    fa_grise_non("bt_annuler");
    fa_grise_non("bt_enregistrer");
    fa_grise_groupe_non("broadcaster_01");
    pf_raz_fiche();
    pf_alimente_defaut();
    fa_focusdonne("tb_code")
    break;
    case "annuler":
    fa_grise_oui("bt_modifier");
    fa_grise_oui("bt_annuler");
    fa_grise_oui("bt_supprimer");
    fa_grise_oui("bt_enregistrer");
    fa_grise_non("bt_sortir");
    fa_grise_non("bt_ajouter");
    fa_grise_non("bt_detailler");
    fa_grise_groupe_oui("broadcaster_01");
    pf_raz_fiche();
    break;
    case "sortir":
    window.close();
    break;
    default:
    break;
  }
  }
function pf_fin_requete(stream){
  var vl_datas = stream;
  if (vl_datas=="ok") {pf_alimente_table("arbre_categories_compta");} else {alert(vl_datas)}
  pf_etat_fen("annuler");
}
function pf_ouvre(vv_quoi) {
	var vl_c_param;
  
  switch (vv_quoi) {
    case "pc_vente_port":
      fa_ouvre(c_script_pc+"vl_c_quellerecherche=pc_vente_port&",600,350);
      break;
    case "pc_achat_port":
      fa_ouvre(c_script_pc+"vl_c_quellerecherche=pc_achat_port&",600,350);
      break;
    case "pc_vente_divers":
      fa_ouvre(c_script_pc+"vl_c_quellerecherche=pc_vente_divers&",600,350);
      break;
    case "pc_achat_divers":
      fa_ouvre(c_script_pc+"vl_c_quellerecherche=pc_achat_divers&",600,350);
      break;
    case "pc_taxe_vente_port":
      fa_ouvre(c_script_taxe+"vl_c_quellerecherche=pc_taxe_vente_port&",600,350);
      break;
    case "pc_taxe_vente_divers":
      fa_ouvre(c_script_taxe+"vl_c_quellerecherche=pc_taxe_vente_divers&",600,350);
      break;
	case "pc_taxe_achat_port":
      fa_ouvre(c_script_taxe+"vl_c_quellerecherche=pc_taxe_achat_port&",600,350);
      break;
    case "pc_taxe_achat_divers":
      fa_ouvre(c_script_taxe+"vl_c_quellerecherche=pc_taxe_achat_divers&",600,350);
      break;
    case 'acteurs_concernes':
    	vl_c_param='genreacteur=tousss&';
    	vl_c_param+='type=7&';
    	vl_c_param+="vl_catcompta_cleunik="+fa_enc(vf_catcompta_cleunik)+"&";
    	vl_c_param+="vl_intitule_categorie_fiscale="+fa_enc(fa_value_get("tb_intitule"))+"&";
     	fa_ouvre(c_c_script_fen_traitements_acteurs+vl_c_param,1000,800);
     	break;
  }
}

function pf_raz_fiche(){
  vf_catcompta_cleunik=-2;
  fa_value_set("tb_code","");
  fa_value_set("tb_intitule","");
  fa_value_set("tb_dateheuremodification","");
  fa_value_set("tb_dateheurecreation","");
  fa_value_set("tb_code_vente_port","");
  fa_att_set("tb_code_vente_port","compte_vente_port",-1);
  fa_value_set("tb_intitule_vente_port","");
  fa_value_set("tb_code_achat_port","");
  fa_att_set("tb_code_achat_port","compte_achat_port",-1);
  fa_value_set("tb_intitule_achat_port","");
  fa_value_set("tb_code_vente_divers","");
  fa_att_set("tb_code_vente_divers","compte_vente_divers",-1);
  fa_value_set("tb_intitule_vente_divers","");
  fa_value_set("tb_code_achat_divers","");
  fa_att_set("tb_code_achat_divers","compte_achat_divers",-1);
  fa_value_set("tb_intitule_achat_divers","");
  fa_value_set("tb_code_taxes_vente_port","");
  fa_att_set("tb_code_taxes_vente_port","compte_taxes_vente_port",-1);
  fa_value_set("tb_intitule_taxes_vente_port","");
  fa_value_set("tb_code_taxes_vente_divers","");
  fa_att_set("tb_code_taxes_vente_divers","compte_taxes_vente_divers",-1);
  fa_value_set("tb_intitule_taxes_vente_divers","");
  fa_value_set("tb_code_taxes_achat_port","");
  fa_att_set("tb_code_taxes_achat_port","compte_taxes_achat_port",-1);
  fa_value_set("tb_intitule_taxes_achat_port","");
  fa_value_set("tb_code_taxes_achat_divers","");
  fa_att_set("tb_code_taxes_achat_divers","compte_taxes_achat_divers",-1);
  fa_value_set("tb_intitule_taxes_achat_divers","");
}
function pf_retour_param_pc(vl_e_pc_cleunik,vl_c_code,vl_c_intitule,vv_quoi) {
  switch (vv_quoi) {
    case "pc_vente_port":
      fa_value_set("tb_code_vente_port",vl_c_code);
      fa_att_set("tb_code_vente_port","compte_vente_port",vl_e_pc_cleunik);
      fa_value_set("tb_intitule_vente_port",vl_c_intitule);
      break;
    case "pc_achat_port":
      fa_value_set("tb_code_achat_port",vl_c_code);
      fa_att_set("tb_code_achat_port","compte_achat_port",vl_e_pc_cleunik);
      fa_value_set("tb_intitule_achat_port",vl_c_intitule);
      break;
    case "pc_vente_divers":
      fa_value_set("tb_code_vente_divers",vl_c_code);
      fa_att_set("tb_code_vente_divers","compte_vente_divers",vl_e_pc_cleunik);
      fa_value_set("tb_intitule_vente_divers",vl_c_intitule);
      break;
    case "pc_achat_divers":
      fa_value_set("tb_code_achat_divers",vl_c_code);
      fa_att_set("tb_code_achat_divers","compte_achat_divers",vl_e_pc_cleunik);
      fa_value_set("tb_intitule_achat_divers",vl_c_intitule);
      break;
    case "pc_taxe_vente_port":
      fa_value_set("tb_code_taxes_vente_port",vl_c_code);
      fa_att_set("tb_code_taxes_vente_port","compte_taxes_vente_port",vl_e_pc_cleunik);
      fa_value_set("tb_intitule_taxes_vente_port",vl_c_intitule);
      break;
    case "pc_taxe_vente_divers":
      fa_value_set("tb_code_taxes_vente_divers",vl_c_code);
      fa_att_set("tb_code_taxes_vente_divers","compte_taxes_vente_divers",vl_e_pc_cleunik);
      fa_value_set("tb_intitule_taxes_vente_divers",vl_c_intitule);
      break;
    case "pc_taxe_achat_port":
      fa_value_set("tb_code_taxes_achat_port",vl_c_code);
      fa_att_set("tb_code_taxes_achat_port","compte_taxes_achat_port",vl_e_pc_cleunik);
      fa_value_set("tb_intitule_taxes_achat_port",vl_c_intitule);
      break;
    case "pc_taxe_achat_divers":
      fa_value_set("tb_code_taxes_achat_divers",vl_c_code);
      fa_att_set("tb_code_taxes_achat_divers","compte_taxes_achat_divers",vl_e_pc_cleunik);
      fa_value_set("tb_intitule_taxes_achat_divers",vl_c_intitule);
      break;
  }
}

function pf_sel_ligne(vv_qui){
  if(fa_est_grise("bt_detailler")==true){return}
  var i=fa_cui(vv_qui);if(i==-1){return;}
  var s ="catcompta_cleunik="+fa_cell_get(vv_qui,i,"tc_catcompta_cleunik")+"&";
  fa_xmlhttprequest_xml(_c_script_edite,s,pf_affiche_datas);
}
function pf_validation(vv_quoi) {
  var vl_c_donnees;
  vl_c_donnees="";
  vl_c_donnees+="vl_catcompta_cleunik="+fa_enc(vf_catcompta_cleunik)+"&";
  vl_c_donnees+="vl_code="+fa_enc(fa_value_get("tb_code"))+"&";
  vl_c_donnees+="vl_intitule="+fa_enc(fa_value_get("tb_intitule"))+"&";
  vl_c_donnees+="vl_compte_vente_port="+fa_enc(fa_att_get("tb_code_vente_port","compte_vente_port"))+"&";
  vl_c_donnees+="vl_compte_vente_divers="+fa_enc(fa_att_get("tb_code_vente_divers","compte_vente_divers"))+"&";
  vl_c_donnees+="vl_compte_achat_port="+fa_enc(fa_att_get("tb_code_achat_port","compte_achat_port"))+"&";
  vl_c_donnees+="vl_compte_achat_divers="+fa_enc(fa_att_get("tb_code_achat_divers","compte_achat_divers"))+"&";
  vl_c_donnees+="vl_taxes_vente_port="+fa_enc(fa_att_get("tb_code_taxes_vente_port","compte_taxes_vente_port"))+"&";
  vl_c_donnees+="vl_taxes_vente_divers="+fa_enc(fa_att_get("tb_code_taxes_vente_divers","compte_taxes_vente_divers"))+"&";
  vl_c_donnees+="vl_taxes_achat_port="+fa_enc(fa_att_get("tb_code_taxes_achat_port","compte_taxes_achat_port"))+"&";
  vl_c_donnees+="vl_taxes_achat_divers="+fa_enc(fa_att_get("tb_code_taxes_achat_divers","compte_taxes_achat_divers"))+"&";
  switch(vv_quoi) {
    case "enregistrer":
      if (vf_catcompta_cleunik!=-2)
        {vl_c_donnees+="vf_c_action=modifier&";}
      else
        {vl_c_donnees+="vf_c_action=ajouter&";}
      break;
    case "supprimer":
        if(confirm("Confirmez-vous la suppression de cet élément ?")==false) return;
        vl_c_donnees+="vf_c_action=supprimer&";
      break;
  }
  fa_xmlhttprequest_txt(_c_script_bdope_fen,vl_c_donnees,pf_fin_requete);
}
]]></script>
END;
?>
