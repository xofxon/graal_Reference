<?php
$vl_mess_00003=fa_recup_session('mess_00003','');
$vl_mess_00004=fa_recup_session('mess_00004','');
$vl_mess_00005=fa_recup_session('mess_00005','');
$vl_mess_00006=fa_recup_session('mess_00006','');
_graal_requete_charge_varlib($vl_c_id_inc_acteurs_corpus,$vl_e_uti_cleunik);
$vl_c_bap_029js=fa_recup_dico_js("bap_029");
$vl_c_bap_030js=fa_recup_dico_js("bap_030");
$vl_c_bap_031js=fa_recup_dico_js("bap_031");
$vl_c_bap_032js=fa_recup_dico_js("bap_032");
$vl_c_bap_033js=fa_recup_dico_js("bap_033");
$vl_c_aai_135js=fa_recup_dico_js("aai_135");
$vl_c_aai_136js=fa_recup_dico_js("aai_136");
$vl_c_aai_137js=fa_recup_dico_js("aai_137");
$vl_c_aai_138js=fa_recup_dico_js("aai_138");
if ($vl_tb_droits_duplication[0]==1) {
	$bloc_duplication=<<<EOT
	case 'dupliquer':
		vl_c_param="vf_c_action=dupliquer&vl_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
		fa_ouvre("_graal_fen_act_duplication.php?"+vl_c_param,400,140);
	  break;
EOT;
}
if ($vl_tb_droits_changements[0]==1) {
	$bloc_changements=<<<EOT
	case 'changer_genre':
		vl_c_param="vf_c_action=changer_genre&vl_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
		fa_grise_fenetre("","oui");
		fa_ouvre("_graal_fen_act_duplication.php?"+vl_c_param,400,100);
	  break;
EOT;
}
$vf_c_script_das_lignes_01="_graal_das_art_lignes_faccli_02.php?";
$vf_c_script_das_lignes_03="_graal_das_art_lignes_faccli_03.php?";
echo <<<END
<script type="application/x-javascript"><![CDATA[
var vf_e_act_cleunik,vf_e_interlo_cleunik,vf_e_intel_cleunik,vf_c_action,vf_e_courriel_cleunik,vf_e_genreacteur,vf_e_mesinst_cleunik,vf_e_nb_adresses_courriels;
var vf_e_act_cleunik_droite,vf_e_act_cleunik_gauche,vf_e_choix_cleunik_droite,vf_e_choix_cleunik_gauche;
var vf_c_url_alimente_table="",vf_e_nombre_utilisations=0,vf_tab_act_cleunik=[];
const vf_c_script_bdope_fen='_graal_bdope_acteurs_01.php';
const vf_c_script_edite='_graal_xml_acteurs_01.php?';
const vf_c_script_critere_act_entreprise='_graal_das_acteurs_criteres_entreprise.php?';
const vf_c_script_critere_act_lesmiens='_graal_das_acteurs_criteres_lesmiens.php?';
const vf_c_script_critere_act_lesautres='_graal_das_acteurs_criteres_lesautres.php?';
const vf_c_script_critere_act_tous='_graal_das_acteurs_criteres_tous.php?';
const vf_c_script_adrpost_act='_graal_das_acteurs_adresses_01.php?sortie=xul&';
const vf_c_script_sites_act='_graal_das_act_sites_01.php?vf_c_genre=A&';
const vf_c_script_act='_graal_rech_acteurs_01.php?';
const vf_c_script_interlo='_graal_xml_acteurs_interlo_01.php?';
const vf_c_script_favoris='_graal_bdope_act_favoris_01.php';
const vf_c_script_relations='_graal_das_acteurs_relations_01.php?';
const vf_c_script_representants='_graal_das_acteurs_representants_01.php?';
const vf_c_script_art_four='_graal_das_art_fournis_01.php?';
const vf_c_script_art_cli='_graal_das_art_client_01.php?';
const vf_c_script_rib='_graal_das_act_rib_01.php?';
const vf_c_script_iban='_graal_das_act_iban_01.php?';
const vf_c_fen_interlo_tel="_graal_fen_act_interlo_tel_01.php?";
const vf_c_fen_interlo_fax="_graal_fen_act_interlo_fax_01.php?";
const vf_c_fen_interlo_mail="_graal_fen_act_interlo_mail_01.php?";
const vf_c_fen_interlo_mesinst="_graal_fen_act_interlo_mesinst_01.php?";
const vf_c_fen_site="_graal_fen_act_sites_01.php?";
const vf_c_fen_adr="_graal_fen_act_adresses_01.php?";
const vf_c_fen_adr_02="_graal_fen_act_adresses_02.php?";
const vf_c_fen_relations="_graal_fen_act_relation_01.php?";
const vf_c_fen_relations_fiche="_graal_fen_act_relation_02.php?";
const vf_c_fen_representant="_graal_fen_act_representant_01.php?";
const vf_c_fen_representant_fiche="_graal_fen_act_representant_02.php?";
const vf_c_fen_art_acteur='_graal_fen_art_acteur_01.php?';
const vf_c_fen_criteres='_graal_fen_act_criteres.php?';
const vf_c_fen_rib="_graal_fen_act_rib_01.php?";
const vf_c_fen_iban="_graal_fen_act_iban_01.php?";
const vf_c_script_ged='_graal_rech_ged_01.php?sortie=das&vl_c_actifs=0&vl_c_type=1&vl_c_qui=999999&';
const vf_c_fen_pseudosliens="_graal_fen_pseudodocs_01.php?quelsdocs=unlien_acteur&genre=acteur&";
const vf_c_fen_notes="_graal_fen_note_01.php?quelsdocs=unenot_acteur&genre=acteur&";
const vf_c_script_rdf_tarifs_particulier_achats='_graal_das_acteurs_tarifs_particulier_achats.php?';
const vf_c_script_rdf_tarifs_particulier_ventes='_graal_das_acteurs_tarifs_particulier_ventes.php?';
const vf_c_fen_art_tarifs='_graal_fen_art_tarifs_01.php?';
const vf_c_fen_stat='_graal_fen_graphiques_stat_01.php?genre=article_un&';
const c_fen_interlo_simple_01='_graal_fen_act_interlo_simple_01.php?';
const c_fen_interlo_simple_02='_graal_fen_act_interlo_simple_02.php?';
const c_fen_interlo_simple_03='_graal_fen_act_interlo_simple_03.php?';
const c_script_favoris_partage_acteurs='_graal_fen_favoris_partage_01.php?vf_c_type_favori=6&';
const c_script_pc="_graal_fen_rech_param_pc_01.php?vl_c_quellerecherche=uncompte_acteur&";
const c_script_fen_visu_acteurs="_graal_fen_rech_acteurs.php?vl_e_genreacteur=listes&vl_c_origine=listes&";
const vf_c_script_var='_graal_cree_variable_session_tempo.php?var=vs_tempo_panier_acteur';
const vf_c_script_bdope_panier='_graal_bdope_paniers_01.php';
const c_script_creat_auto_pc="_graal_xml_numerotation_03.php?";
const _c_url_alimente_table_echeancier="_graal_das_echeancier_01.php?";
const _c_url_alimente_table_reglements="_graal_das_treso_reglement_01.php?";
const vf_c_script_fen_echeance="_graal_fen_echeance_01.php?";
const c_script_actions_acteurs="_graal_das_acteurs_types_actions_01.php?vl_e_act_cleunik=";
const vf_c_script_fen_action_echeancier='_graal_fen_actions_02.php?';
var vf_e_nb_sites=0,vf_nb_actions=0,vf_e_nb_criteres=0,vf_e_nb_ged=0,vf_e_nb_adrpos=0,vf_e_nb_relations=0,vf_e_nb_lignes_vendues=0;
var vf_e_nb_rib=0,vf_e_nb_iban=0,vf_e_nb_art_acteur=0,vf_e_nb_art_tarifs=0,vf_e_nb_facfou=0,vf_e_nb_faccli=0;
const c_fen_selection_dossiers='_graal_fen_ged_01.php?genreged=tousss&quelsdocs=dossiers&retour=oui&';
const c_bdope_dossiers='_graal_bdope_note_01.php?vf_c_action=insere_dans_dossier&type_insertion_dossier=acteur&vf_e_doc_cleunik=';
const lstn_grise_ged_actions = {
	willRebuild : function(event){},
	didRebuild  : function(event){pf_grise_fenetre_non();fa_brl("arbre_des_ged",lstn_grise_ged_actions);}
};
const lstn_grise_acteurs= {
	willRebuild : function(event){},
	didRebuild  : function(event){fa_grise_fenetre("","non");}
};

function pf_aa_init() {
	fa_grise_oui("ml_langue");
  fa_sep("tb_encours_autorise");
  fa_sep("tb_remise_taux");
  fa_sep("tb_escompte_taux");
  fa_sep("tb_montant_port");
  fa_sep("tb_seuil_franco");
  fa_sep("tb_commande_mini");
  fa_badl("$vl_c_id_arbre_inc_acteurs_01",lstn_grise_acteurs);
  if ("$vl_act_cleunik"=='-1') {
    pf_approximatif();
    fa_ael("bao_ml_qui","ValueChange",po_change_menu);
    po_change_menu();
    vf_e_genreacteur="$vl_c_genreacteur";
    var vl_e_nombre=fa_gid("ml_typeacteurs").itemCount;
    for(var i=0;i<vl_e_nombre;i++){
      fa_gid("ml_typeacteurs").selectedIndex=i;
      if (vf_e_genreacteur==fa_mlget("ml_typeacteurs")) {break;}
    }
    switch (vf_e_genreacteur){
      case "1": case "2": case "3": case "4": case "5": case "6": case "7": case "8":
        fa_cache_oui("portee");
        break;
      case "9":
        fa_cache_non("portee");
        break;
    }
    pf_gere_onglet_compta(fa_mlget("ml_typeacteurs"));
		fa_focusdonne("aai_tb_rechapproxima");
  } else {
    pf_sel_acteur($vl_act_cleunik,"$vl_c_genreacteur");
		fa_focusdonne("bt_detailler");
  }
  fa_att_set("groupe_onglet_principal","selectedPanel","tabpanel_edition");
  pf_grise_boutons_interlo();
  fa_grise_oui("bt_modifier");
  fa_grise_oui("bt_supprimer");
  fa_grise_oui("bt_enregistrer");
  fa_grise_oui("bt_annuler");
  fa_grise_oui("ml_typeacteurs");
  fa_grise_groupe_oui('broadcaster_01');
  pf_aa_init_bem('21');
  fa05_sel_date('21','histo_cial_01_tb_deb','histo_cial_01_tb_fin');
  fa05_sel_date('21','histo_cial_02_tb_deb','histo_cial_02_tb_fin');
  fa_att_set("arbre_relations","context","pop_selections_lie");
  fa_att_set("arbre_representants","context","pop_selections_rep");
  fa_att_set("arbre_art_clients","context","pop_arbre_art_clients");
}
function pf_action(vv_quoi){
  var vl_c_param;
  switch (vv_quoi) {
		$bloc_changements
  	$bloc_duplication
    case 'favoris_ajout':
      vl_c_param="vf_c_action=ajouter&vf_c_quoi=1&vl_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
      fa_xmlhttprequest_xml(vf_c_script_favoris,vl_c_param,pf_action_fin_01,'');
      break;
    case 'favoris_supprimer':
      vl_c_param="vf_c_action=supprimer&vf_c_quoi=1&vl_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
      fa_xmlhttprequest_xml(vf_c_script_favoris,vl_c_param,pf_action_fin_02,'');
      break;
    case 'favoris_supprimer_table':
      vl_c_param="vf_c_action=supprimer&vf_c_quoi=1&vl_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
      fa_xmlhttprequest_xml(vf_c_script_favoris,vl_c_param,pf_action_fin_03,'');
      break;
	case 'dossier_ajouter':
    	fa_ouvre(c_fen_selection_dossiers,1000,800);
      break;
  }
}
function pf_action_fin_01(stream) {
  var vl_datas = stream;
  if (vl_datas!="-1") { alert("$vl_mess_00003");} else {alert("$vl_mess_00005");}
}
function pf_action_fin_02(stream) {
  var vl_datas = stream;
  if (vl_datas!="-1") { alert("$vl_mess_00004");} else {alert("$vl_mess_00006");}
}
function pf_action_fin_03(stream) {
  var vl_datas = stream;
  if (vl_datas!="-1") { pf_approximatif();alert("$vl_mess_00004");} else {alert("$vl_mess_00006");}
}
function pa_affiche_datas_spe_procli(stream) {
  var vl_c_datas = stream;
  fa_value_set("la_uuid",fa_xml_get(vl_c_datas,'uuid'));
  fa_value_set("tb_mnemotechnique",fa_xml_get(vl_c_datas,'mnemotechnique'));
}
function pf_affiche_donnees_adresses() {
  var vl_c_param=vf_c_script_adrpost_act+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&vf_c_genre=A&'";
  fa_att_set("if_adressespostales","src",vl_c_param);
}
function pf_affiche_donnees_art_four() {
  var vl_c_param=vf_c_script_art_four+"vl_e_act_cleunik="+vf_e_act_cleunik+"&vl_e_art_cleunik=-1&raf_random="+Math.random()+"&";
  fa_das("arbre_art_fournisseurs",vl_c_param);
}
function pf_affiche_donnees_art_cli() {
  var vl_c_param=vf_c_script_art_cli+"vl_e_act_cleunik="+vf_e_act_cleunik+"&vl_e_art_cleunik=-1&raf_random="+Math.random()+"&";
  fa_das("arbre_art_clients",vl_c_param);
}
function pf_affiche_donnees_criteres_entreprise() {
  var vl_c_param=vf_c_script_critere_act_entreprise+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
  fa_das("criteres_des_acteurs_entreprise",vl_c_param);
}
function pf_affiche_donnees_criteres_lesautres() {
  var vl_c_param=vf_c_script_critere_act_lesautres+"act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random();
  fa_das("criteres_des_acteurs_lesautres",vl_c_param);
}
function pf_affiche_donnees_criteres_lesmiens() {
  var vl_c_param=vf_c_script_critere_act_lesmiens+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random();
  fa_das("criteres_des_acteurs_lesmiens",vl_c_param);
}
function pf_affiche_donnees_criteres_tous() {
  var vl_c_param=vf_c_script_critere_act_tous+"act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random();
  fa_das("criteres_des_acteurs_tous",vl_c_param);
}
function pf_affiche_donnees_ged() {
  var vl_c_param=vf_c_script_ged+'vl_e_portee_cleunik='+vf_e_act_cleunik+'&raf_random='+Math.random()+'&';
  fa_das("arbre_des_ged",vl_c_param);
}
function pf_affiche_donnees_ged_actions() {
	fa_badl("arbre_des_ged",lstn_grise_ged_actions);
	fa_grise_fenetre("","oui");
  var vl_c_param=vf_c_script_ged+'vl_e_portee_cleunik='+vf_e_act_cleunik+'&raf_random='+Math.random()+'&vl_e_tout=1&';
  fa_das("arbre_des_ged",vl_c_param);
}
function pf_affiche_donnees_iban_cli() {
  var vl_c_param=vf_c_script_iban+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
  fa_das("arbre_iban_cli",vl_c_param);
}
function pf_affiche_donnees_iban_fou() {
  var vl_c_param=vf_c_script_iban+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
  fa_das("arbre_iban_fou",vl_c_param);
}
function pf_affiche_donnees_interlo() {
	if (vf_e_nb_adresses_courriels<200) {
	  var vl_c_param="vl_c_liste_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
  	fa_xmlhttprequest_xml(vf_c_script_interlo,vl_c_param,pf_alimente_arbre_interlos,'');
	}
}
function pf_affiche_donnees_interlo_force() {
  var vl_c_param="vl_c_liste_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
  fa_xmlhttprequest_xml(vf_c_script_interlo,vl_c_param,pf_alimente_arbre_interlos,'');
}
function pf_affiche_donnees_histo_01() {
	var vl_c_url_alimente_table='&vl_c_dateheuredebut='+fa_enc(fa_date_formate(fa_value_get("histo_cial_01_tb_deb"),"AAAAMMJJ"));
	vl_c_url_alimente_table+='&vl_c_dateheurefin='+fa_enc(fa_date_formate(fa_value_get("histo_cial_01_tb_fin"),"AAAAMMJJ"));
  var vl_c_param="$vf_c_script_das_lignes_01"+vl_c_url_alimente_table+"&vl_act_cleunik="+vf_e_act_cleunik+"&statut=-1&limit=-1raf_random="+Math.random()+"&";
  fa_das("tr_histo_cial_01",vl_c_param);
}
function pf_affiche_donnees_histo_02() {
	var vl_c_url_alimente_table='&vl_c_dateheuredebut='+fa_enc(fa_date_formate(fa_value_get("histo_cial_02_tb_deb"),"AAAAMMJJ"));
	vl_c_url_alimente_table+='&vl_c_dateheurefin='+fa_enc(fa_date_formate(fa_value_get("histo_cial_02_tb_fin"),"AAAAMMJJ"));
  var vl_c_param="$vf_c_script_das_lignes_03"+vl_c_url_alimente_table+"&vl_act_cleunik="+vf_e_act_cleunik+"&statut=-1&limit=-1raf_random="+Math.random()+"&";
  fa_das("tr_histo_cial_02",vl_c_param);
}

function pf_affiche_donnees_reglement(){
	var vl_c_param=_c_url_alimente_table_reglements+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&genreacteur="+fa_mlget("ml_typeacteurs")+"&";
  fa_das("arbre_reglements",vl_c_param);
}
function pf_affiche_donnees_relations() {
  var vl_c_param=vf_c_script_relations+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&vf_c_genre=A&'";
  fa_das("arbre_relations",vl_c_param);
}
function pf_affiche_donnees_representants() {
  var vl_c_param=vf_c_script_representants+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&vf_c_genre=A&'";
  fa_das("arbre_representants",vl_c_param);
}
function pf_affiche_donnees_rib_cli() {
  var vl_c_param=vf_c_script_rib+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
  fa_das("arbre_rib_cli",vl_c_param);
}
function pf_affiche_donnees_rib_fou() {
  var vl_c_param=vf_c_script_rib+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
  fa_das("arbre_rib_fou",vl_c_param);
}
function pf_affiche_donnees_sites() {
  var vl_c_param=vf_c_script_sites_act+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&";
  fa_das("arbre_sites_des_acteurs",vl_c_param);
}
function pf_affiche_donnees_tarif_particulier_achat() {
  var vl_c_param=vf_c_script_rdf_tarifs_particulier_achats+"vl_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&actif="+fa_value_get("ml_tpa_actif")+"&";
  fa_das("arbre_tarif_particulier_achat",vl_c_param);
}
function pf_affiche_donnees_tarif_particulier_vente() {
  var vl_c_param=vf_c_script_rdf_tarifs_particulier_ventes+"vl_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random()+"&actif="+fa_value_get("ml_tpv_actif")+"&";
  fa_das("arbre_tarif_particulier_vente",vl_c_param);
}
function pf_affiche_donnees_tresorerie(){
	var vl_c_param=_c_url_alimente_table_echeancier+"vl_e_act_cleunik="+vf_e_act_cleunik+"&raf_random="+Math.random();
  fa_das("arbre_echeancier",vl_c_param);
}
function pf_alimente_arbre_interlos(xml) {
  fa_vide_arbre("fils_arbre_interlo");
  pf_parcours_fichier_xml_interlo(xml.documentElement,fa_gid("fils_arbre_interlo"));
}
function pf_alimente_table() {
  switch (fa_value_get("bao_ml_qui")) {
    case "000000": case "110001": case "110003": case "110002": case "110004": case "110005": case "110006":
      fa_cache_oui("portee");
      break;
    case "999999": case "888888":
      fa_cache_non("portee");
      break;
  }
  fa_grise_fenetre("","oui");
  fa_das("arbre_des_acteurs",vf_c_url_alimente_table);
}
function pf_approximatif() {
  var raf_random=Math.random();
  if ( fa_value_get("aai_tb_rechapproxima") == "" ) {return;}
  var item=fa_gid("bao_ml_actif").selectedItem;
  vf_c_url_alimente_table=vf_c_script_act+'sortie=das&vl_c_limit='+fa_enc(fa_value_get("bao_tb_limit"))+'&vl_c_recherche='+fa_enc(fa_value_get("aai_tb_rechapproxima"))+'&vl_c_zone='+fa_value_get("aai_ml_zone")+'&vl_c_type='+fa_value_get("aai_ml_type")+'&vl_c_qui='+fa_value_get("bao_ml_qui")+'&raf_random='+raf_random+'&vl_c_actifs='+fa_value_get("bao_ml_actif")+'&vl_e_panier='+item.getAttribute("_graal_cleunik")+"&";
  pf_alimente_table();
}
function pf_cache_onglets(vv_quoi) {
  switch (vv_quoi) {
    case "oui":
      fa_cache_oui("tab_articles");fa_cache_oui("tab_interlos");fa_cache_oui("tab_actions");fa_cache_oui("tab_criteres");
      fa_cache_oui("tab_adresses_postales");fa_cache_oui("tab_sites");fa_cache_oui("tab_relations");fa_cache_oui("tab_ged");fa_cache_oui("tab_compta");
      fa_cache_oui("tab_act_client");fa_cache_oui("tab_act_fourni");fa_cache_oui("tab_spe_procli");
      break;
    case "non":
      fa_cache_non("tab_articles");fa_cache_non("tab_interlos");fa_cache_non("tab_actions");fa_cache_non("tab_criteres");fa_cache_non("tab_adresses_postales");
      fa_cache_non("tab_sites");fa_cache_non("tab_relations");fa_cache_non("tab_ged");
      pf_gere_onglet_compta(fa_mlget("ml_typeacteurs"));
      break;
  }
}
function pf_cache_tab(){
  var vl_tab=fa_gid("vb_tableau");
  if(vl_tab.hidden == true){vl_tab.hidden=false;}else {vl_tab.hidden=true;}
}
function pf_etat_fen(vv_quoi){
  vf_c_action=vv_quoi;
  var vl_portee;
  switch(vv_quoi) {
    case "ini":
      break;
    case "selectionner":
			if ("$vl_act_cleunik"=='-1') {
				var rowIndex = fa_cui("arbre_des_acteurs");
				if(rowIndex == -1){return;}
			}
      fa_grise_non("bt_modifier");
      if (vf_e_nombre_utilisations==0) {fa_grise_non("bt_supprimer");}else{fa_grise_oui("bt_supprimer");}
      fa_grise_oui("bt_detailler");
      fa_grise_oui("bt_ajouter");
      fa_grise_oui("bt_enregistrer");
      fa_grise_non("bt_annuler");
      fa_grise_oui("ml_typeacteurs");
      break;
    case "modifier":
      fa_grise_oui("bt_modifier");
      fa_grise_oui("bt_supprimer");
      fa_grise_oui("bt_detailler");
      fa_grise_oui("bt_ajouter");
      fa_grise_non("bt_enregistrer");
      fa_grise_non("bt_annuler");
      fa_grise_groupe_non('broadcaster_01');
      fa_grise_oui("ml_typeacteurs");
		pf_grise_boutons_interlo();
      fa_focusdonne('tb_raisonsoc');
      break;
    case "ajouter":
      fa_grise_oui("bt_modifier");
      fa_grise_oui("bt_supprimer");
      fa_grise_oui("bt_detailler");
      fa_grise_oui("bt_ajouter");
      fa_grise_non("bt_enregistrer");
      fa_grise_non("bt_annuler");
      pf_cache_onglets("oui");
      pf_raz_fiche();
      fa_gid("tab_infogene").selectedIndex=0;
      fa_grise_groupe_non('broadcaster_01');
      fa_grise_oui("ml_typeacteurs");
      fa_cache_non("bt_verifnom");
      fa_focusdonne('tb_raisonsoc');
      break;
    case "annuler":
      pf_raz_fiche()
      fa_grise_oui("bt_modifier");
      fa_grise_oui("bt_supprimer");
      fa_grise_non("bt_detailler");
      fa_grise_non("bt_ajouter");
      fa_grise_oui("bt_enregistrer");
      fa_grise_oui("bt_annuler");
      fa_grise_oui("ml_typeacteurs");
      fa_cache_oui("bt_verifnom");
      fa_cache_oui("bt_voirnoms");
      pf_cache_onglets("non");
      fa_gid("tab_infogene").selectedIndex=0;
      fa_grise_groupe_oui('broadcaster_01');
 			if ("$vl_act_cleunik"=='-1') {
				fa_focusdonne('arbre_des_acteurs');
			} else {
				pf_sel_acteur($vl_act_cleunik,"$vl_c_genreacteur");
				fa_focusdonne("bt_detailler");
			}
      break;
    case "sortir":
      window.close();  //  Ne fonctionne que si c'est une nouvelle fenêtre
      break;
    default:
      break;
}
  }
function pf_favoris_partager_acteurs() {
  var vl_c_param;
  vl_c_param="vf_e_cleunik="+vf_e_act_cleunik+"&";
  vl_c_param+="raf_random="+Math.random()+"&";
  fa_ouvre(c_script_favoris_partage_acteurs+vl_c_param,500,60);
}

function pf_ged_ajout(vv_quoi_01) {
  var vl_c_param='portee_cleunik='+vf_e_act_cleunik+'&doc_cleunik=-1&'
  switch (vv_quoi_01){
    case "ged_lien":
      fa_ouvre(vf_c_fen_pseudosliens+vl_c_param,800,300);
      break;
    case "ged_note":
      fa_ouvre(vf_c_fen_notes+vl_c_param,1100,500);
      break;
    case "ged_doc":
			pf07_ouvre_doc("quelsdocs=undoc_acteur&genre=acteur&"+vl_c_param);
      break;
  }
}
function pf_gere_onglet_compta(vv_type) {
  var toto="",id_panel="";
  toto=fa_gid("tab_infogene").selectedItem;
  id_panel=toto.id;
  fa_cache_oui("tab_compta");
  fa_cache_oui("tab_spe_procli");
  fa_cache_oui("tab_act_client");
  fa_cache_oui("tab_act_fourni");
  fa_cache_oui("ligne_tarif_fou");
  fa_cache_oui("ligne_tarif_cli");
  switch (vv_type) {
    case "110001": // Prospects Client
      fa_cache_non("tab_spe_procli");
      fa_cache_non("tab_act_client");
	  fa_cache_non("tab_compta");
      fa_cache_non("ligne_tarif_cli");
      if ((id_panel=="tab_act_client") || (id_panel=="tab_act_fourni")) {fa_gid("tab_infogene").selectedIndex=0;}
      break;
    case "110002": // Prospects fournisseurs
      fa_cache_non("tab_compta");
      fa_cache_non("tab_act_fourni");
	  fa_cache_non("ligne_tarif_fou");
      if ((id_panel=="tab_spe_procli") || (id_panel=="tab_act_client") || (id_panel=="tab_act_fourni")) {fa_gid("tab_infogene").selectedIndex=0;}
      break;
    case "110003"://  Clients
      fa_cache_non("tab_compta");
      fa_cache_non("tab_act_client");
      fa_cache_non("ligne_tarif_cli");
      if ((id_panel=="tab_act_fourni") || (id_panel=="tab_spe_procli") ) {fa_gid("tab_infogene").selectedIndex=0;}
      break;
    case "110004": // Fournisseurs
      fa_cache_non("tab_compta");
      fa_cache_non("tab_act_fourni");
      fa_cache_non("ligne_tarif_fou");
      if ((id_panel=="tab_compta") || (id_panel="tab_act_fourni")) {fa_gid("tab_infogene").selectedIndex=0;}
      break;
    default:
      if ((id_panel=="tab_compta") || (id_panel=="tab_spe_procli") || (id_panel=="tab_act_client") || (id_panel=="tab_act_fourni")) {fa_gid("tab_infogene").selectedIndex=0;}
  }
}
function pf_grise_boutons_interlo() {
  //fa_grise_oui("tb_interlo_01");fa_grise_oui("tb_interlo_03");
	fa_grise_oui("tb_interlo_02");
  fa_grise_oui("tb_tel_01");fa_grise_oui("tb_tel_02");
  //fa_grise_oui("tb_tel_03");fa_grise_oui("tb_tel_04");
  fa_grise_oui("tb_fax_01");fa_grise_oui("tb_fax_02");
  //fa_grise_oui("tb_fax_03");
  fa_grise_oui("tb_courriel_01");fa_grise_oui("tb_courriel_02");
  //fa_grise_oui("tb_courriel_03");fa_grise_oui("tb_courriel_04");
  //fa_grise_oui("tb_chat_01");
  fa_grise_oui("tb_mesinst_01");fa_grise_oui("tb_mesinst_02");
}
function pf_ouvre_retour_pc(stream){
  var vl_c_datas = stream;
  fa_value_set("tb_code",fa_xml_get(vl_c_datas,'code'));
  fa_att_set("tb_code","pc_cleunik",fa_xml_get(vl_c_datas,'pc_cleunik'));
  fa_value_set("tb_intitule",fa_value_get("tb_nomcommercial"));
  alert("Le compte "+fa_xml_get(vl_c_datas,'code')+" a été créé.\\n Il faut enregistrer l'acteur pour le rattacher.");
}
function pf_ouvre(vv_quoi_01,vv_quoi_02) {
  var vl_c_param,i;
  vl_c_param="genreacteur="+fa_mlget("ml_typeacteurs")+"&";
  switch (vv_quoi_01){
  		case "action":
			var rowIndex = fa_cui("arbre_echeancier");if(rowIndex == -1){return;}
			var vl_c_donnees="vf_e_action_cleunik="+fa_enc(fa_cell_get("arbre_echeancier",rowIndex,"tc_action_cleunik"))+"&vf_c_action=modifier&genreaction=jenesaispas&";
			fa_ouvre(vf_c_script_fen_action_echeancier+vl_c_donnees,1000,600);
			break;
  			break;
		case "echeance_solde":
			var rowIndex = fa_cui("arbre_echeancier");if(rowIndex == -1){return;}
			var prop_doc=fa_cell_get("arbre_echeancier",rowIndex,"tc_properties_document");
			if (prop_doc=='ai14'){
				var vl_c_type="cli";
			} else {
				var vl_c_type="fou";
			}
			var param='&echeance_cleunik='+fa_enc(fa_cell_get("arbre_echeancier",rowIndex,"tc_echeance_cleunik"))+'&type='+vl_c_type+'&genre=solde';
  		fa_ouvre(vf_c_script_fen_echeance+param,600,600);
			break;
		case "echeance_modif":
			var prop_doc=fa_cell_get("arbre_echeancier",rowIndex,"tc_properties_document");
			if (prop_doc=='ai14'){
				var vl_c_type="cli";
			} else {
				var vl_c_type="fou";
			}
			var param='&echeance_cleunik='+fa_enc(fa_cell_get("arbre_echeancier",rowIndex,"tc_echeance_cleunik"))+'&type='+vl_c_type+'&genre=modif';
  		fa_ouvre(vf_c_script_fen_echeance+param,600,600);
			break;
		case "pc":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+="vl_nomcommercial="+fa_enc(fa_value_get("tb_nomcommercial"))+"&";
          vl_c_param+="vl_codealphanum15="+fa_enc(fa_value_get("tb_codealphanum15"))+"&";
          fa_xmlhttprequest_xml(c_script_creat_auto_pc,vl_c_param,pf_ouvre_retour_pc);
          break;
        case "ouvrir":
          fa_ouvre(c_script_pc,600,350);
          break;
      }
      break;
    case "adresse":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_adr_cleunik=-1&vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          fa_ouvre(vf_c_fen_adr+vl_c_param,600,350);
          break;
      }
      break;
	case "adresse_etrange_02":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_adr_cleunik=-1&vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          fa_ouvre(vf_c_fen_adr_02+vl_c_param,600,350);
          break;
      }
      break;
    case "art_client":
      vl_c_param+='vl_e_type='+fa_mlget("ml_typeacteurs")+'&';
      vl_c_param+='vl_c_genre=acteur&';
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_art_cleunik=-1&';
          vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          fa_ouvre(vf_c_fen_art_acteur+vl_c_param,1000,650);
          break;
        case "ouvrir":
          var i=fa_cui("arbre_art_clients");if(i==-1){return;}
          vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          vl_c_param+='vl_e_art_cleunik='+fa_cell_get("arbre_art_clients",i,"art_cleunik_client")+'&';
          vl_c_param+='vl_e_art_acteur_cleunik='+fa_cell_get("arbre_art_clients",i,"art_acteur_cleunik_client")+'&';
          fa_ouvre(vf_c_fen_art_acteur+vl_c_param,1000,400);
          break;
      }
      break;
    case "art_fournis":
      vl_c_param+='vl_e_type='+fa_mlget("ml_typeacteurs")+'&';
      vl_c_param+='vl_c_genre=acteur&';
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_art_cleunik=-1&';
          vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          fa_ouvre(vf_c_fen_art_acteur+vl_c_param,1000,650);
          break;
        case "ouvrir":
          i=fa_cui("arbre_art_fournisseurs");
          if(i==-1){return;}
          vl_c_param+='vl_e_art_cleunik='+fa_cell_get("arbre_art_fournisseurs",i,"art_cleunik_fournis")+'&';
          vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          vl_c_param+='vl_e_art_acteur_cleunik='+fa_cell_get("arbre_art_fournisseurs",i,"art_acteur_cleunik_fournis")+'&';
          fa_ouvre(vf_c_fen_art_acteur+vl_c_param,1000,400);
          break;
      }
      break;
    case "chat":
      switch (vv_quoi_02) {
        case "nouveau":
          pf04_emichat(vf_e_interlo_cleunik);
          break;
      }
      break;

    case "courriel":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_intweb_cleunik=-1&vl_e_interlo_cleunik='+fa_enc(vf_e_interlo_cleunik)+"&";
          fa_ouvre(vf_c_fen_interlo_mail+vl_c_param,700,600);
          break;
        case "ouvrir":
          vl_c_param+='vl_e_intweb_cleunik='+fa_enc(vf_e_courriel_cleunik)+"&";
          fa_ouvre(vf_c_fen_interlo_mail+vl_c_param,700,600);
          break;
        case "envoyer_texte":
          pf04_emimail_texte(vf_e_courriel_cleunik);
          break;
        case "envoyer_html":
        //alert(vf_e_courriel_cleunik)
          pf04_emimail_html(vf_e_courriel_cleunik);
          break;
      }
      break;
    case "critere_entreprise":
      vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&genrecritere=entreprise&vl_c_raisonsoc='+fa_enc(fa_value_get("tb_raisonsoc"))+"&";
      fa_ouvre(vf_c_fen_criteres+vl_c_param,800,600);
      break;
    case "critere_lesmiens":
      vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&genrecritere=moi&vl_c_raisonsoc='+fa_enc(fa_value_get("tb_raisonsoc"))+"&";
      fa_ouvre(vf_c_fen_criteres+vl_c_param,800,600);
      break;
    case "fax":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_tel_cleunik=-1&vl_e_interlo_cleunik='+fa_enc(vf_e_interlo_cleunik)+"&";
          break;
        case "ouvrir":
          vl_c_param+='vl_e_intel_cleunik='+fa_enc(vf_e_intel_cleunik)+"&";
          break;
        default : exit;
      }
      fa_ouvre(vf_c_fen_interlo_fax+vl_c_param,400,400);
      break;
    case "iban_cli":
    case "iban_fou":
      var vl_e_iban_cleunik=0;
      vl_c_param+="genreiban="+fa_gid("ml_iban").selectedItem.value+"&";
      switch (vv_quoi_02){
        case "nouveau":
          vl_c_param+='vl_e_iban_cleunik=-1&vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          fa_ouvre(vf_c_fen_iban+vl_c_param,800,120);
          break;
        case "ouvrir":
          switch (vv_quoi_01){
            case "iban_cli":
              i=fa_cui("arbre_iban_cli");if(i==-1){return;}
              vl_e_iban_cleunik=fa_cell_get("arbre_iban_cli",i,"tc_iban_cleunik_cli");
              break;
            case "iban_fou":
              i=fa_cui("arbre_iban_fou");if(i==-1){return;}
              vl_e_iban_cleunik=fa_cell_get("arbre_iban_fou",i,"tc_iban_cleunik_fou");
              break;
          }
          vl_c_param+='vl_e_iban_cleunik='+fa_enc(vl_e_iban_cleunik)+"&vl_e_act_cleunik="+vf_e_act_cleunik+'&';
          fa_ouvre(vf_c_fen_iban+vl_c_param,800,120);
          break;
        }
      break;
    case "interlo":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_interlo_cleunik=-1&';
          break;
        case "ouvrir":
          vl_c_param+='vl_e_interlo_cleunik='+fa_enc(vf_e_interlo_cleunik)+"&";
          break;
      }
      vl_c_param+='vl_e_act_cleunik='+fa_enc(vf_e_act_cleunik)+'&';
      fa_ouvre_interlo(vl_c_param);
      break;
    case "intsimp01":
      vl_c_param+='vl_e_act_cleunik='+fa_enc(vf_e_act_cleunik)+'&genreacteur='+fa_enc(fa_mlget("ml_typeacteurs"))+"&";
      fa_ouvre(c_fen_interlo_simple_01+vl_c_param,1024,580);
      break;
    case "intsimp02":
      vl_c_param+='vl_e_act_cleunik='+fa_enc(vf_e_act_cleunik)+'&genreacteur='+fa_enc(fa_mlget("ml_typeacteurs"))+"&";
      fa_ouvre(c_fen_interlo_simple_02+vl_c_param,1024,630);
      break;
    case "intsimp03":
      vl_c_param+='vl_e_act_cleunik='+fa_enc(vf_e_act_cleunik)+"&";
      fa_ouvre(c_fen_interlo_simple_03+vl_c_param,1024,630);
      break;
    case "mesinst":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_act_cleunik='+fa_enc(vf_e_act_cleunik)+'vl_e_mesinst_cleunik=-1&vl_e_interlo_cleunik='+fa_enc(vf_e_interlo_cleunik)+"&";
          fa_ouvre(vf_c_fen_interlo_mesinst+vl_c_param,600,600);
          break;
        case "ouvrir":
          vl_c_param+='vl_e_mesinst_cleunik='+fa_enc(vf_e_mesinst_cleunik)+"&";
          fa_ouvre(vf_c_fen_interlo_mesinst+vl_c_param,600,350);
          break;
      }
      break;
    case "relation":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_act_cleunik_gauche='+vf_e_act_cleunik+'&qui_acteurs_recherche=09&';
          fa_ouvre(vf_c_fen_relations+vl_c_param,800,650);
          break;
        case "nouveau_transporteur":
          vl_c_param+='vl_e_act_cleunik_gauche='+vf_e_act_cleunik+'&qui_acteurs_recherche=12&';
          fa_ouvre(vf_c_fen_relations+vl_c_param,800,650);
          break;

        case "ouvrir":
          pf_sel_arbre_relations();var i=fa_cui("arbre_relations");if(i==-1){return;}
          vl_c_param+='vl_e_act_cleunik_droite='+vf_e_act_cleunik_droite+'&vl_e_choix_cleunik_droite='+vf_e_choix_cleunik_droite+'&vl_e_choix_cleunik_gauche='+vf_e_choix_cleunik_gauche+'&vl_e_act_cleunik_gauche='+vf_e_act_cleunik_gauche+'&';
          fa_ouvre(vf_c_fen_relations_fiche+vl_c_param,600,250);
          break;
        case "qui":
          pf_sel_arbre_relations();var i=fa_cui("arbre_relations");if(i==-1){return;}
          if (vf_e_act_cleunik_droite==vf_e_act_cleunik) {
          	fa_ouvre_acteur(vf_e_act_cleunik_gauche);
          } else {
          	fa_ouvre_acteur(vf_e_act_cleunik_droite);
          }
          break;
      }
      break;
    case "representant":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_act_cleunik_gauche='+vf_e_act_cleunik+'&';
          fa_ouvre(vf_c_fen_representant+vl_c_param,800,650);
          break;
        case "ouvrir":
          pf_sel_arbre_representants();var i=fa_cui("arbre_representants");if(i==-1){return;}
          vl_c_param+='vl_e_act_cleunik_droite='+vf_e_rep_act_cleunik_droite+'&vl_e_choix_cleunik_droite='+vf_e_rep_choix_cleunik_droite+'&vl_e_choix_cleunik_gauche='+vf_e_rep_choix_cleunik_gauche+'&vl_e_act_cleunik_gauche='+vf_e_rep_act_cleunik_gauche+'&';
          fa_ouvre(vf_c_fen_representant_fiche+vl_c_param,600,260);
          break;
        case "qui":
          pf_sel_arbre_representants();var i=fa_cui("arbre_representants");if(i==-1){return;}
          if (vf_e_rep_act_cleunik_droite==vf_e_act_cleunik) {
          fa_ouvre_acteur(vf_e_rep_act_cleunik_gauche);
          } else {
          fa_ouvre_acteur(vf_e_rep_act_cleunik_droite);
          }
          break;
      }
      break;
    case "rib_cli":
    case "rib_fou":
    switch (vv_quoi_02){
      case "nouveau":
        vl_c_param+='vl_e_rib_cleunik=-1&vl_e_act_cleunik='+vf_e_act_cleunik+'&';
        fa_ouvre(vf_c_fen_rib+vl_c_param,800,180);
        break;
      case "ouvrir":
        switch (vv_quoi_01){
          case "rib_cli":
            i=fa_cui("arbre_rib_cli");if(i==-1){return;}
            vf_e_rib_cleunik=fa_cell_get("arbre_rib_cli",i,"tc_rib_cleunik_cli");
            break;
          case "rib_fou":
            i=fa_cui("arbre_rib_fou");if(i==-1){return;}
            vf_e_rib_cleunik=fa_cell_get("arbre_rib_fou",i,"tc_rib_cleunik_fou");
            break;
        }
        vl_c_param+='vl_e_rib_cleunik='+fa_enc(vf_e_rib_cleunik)+"&vl_e_act_cleunik="+vf_e_act_cleunik+'&';
        fa_ouvre(vf_c_fen_rib+vl_c_param,800,180);
        break;
      }
      break;
    case "site":
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_site_cleunik=-1&vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          fa_ouvre(vf_c_fen_site+vl_c_param,600,600);
          break;
        case "ouvrir":
          i=fa_cui("arbre_sites_des_acteurs");if(i==-1){return;}
          vl_c_param+='vl_e_site_cleunik='+fa_enc(fa_cell_get("arbre_sites_des_acteurs",i,"tc_site_cleunik"))+'&vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          fa_ouvre(vf_c_fen_site+vl_c_param,600,600);
          break;
        case "atteindre":
          i=fa_cui("arbre_sites_des_acteurs");if(i==-1){return;}
          vl_c_param=fa_cell_get("arbre_sites_des_acteurs",i,"tc_refweb");
					var vl_c_http=vl_c_param.substr(0,4);
					vl_c_http=vl_c_http.toLowerCase();
					if (vl_c_http!="http") {vl_c_param="http://"+vl_c_param;}
          fa_ouvre(vl_c_param,0,0);
          break;
      }
      break;
    case "stats":
      switch (fa_mlget("ml_typeacteurs")) {
        case "110003" :vl_c_param="genre=client_un&";break;
        case "110001" :vl_c_param="genre=procli_un&";break;
        case "110004" :vl_c_param="genre=fourni_un&";break;
        case "110002" :vl_c_param="genre=profou_un&";break;
      }
      vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&';
      fa_ouvre(vf_c_fen_stat+vl_c_param);
      break;
    case "tarif_particulier_achat":
      vl_c_param+='vl_e_type=110004&';
      vl_c_param+='vl_c_genre=2&';
      vl_c_param+='vl_c_origine=acteur&';
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_art_cleunik=-1&';
          vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          vl_c_param+='vl_e_tar_cleunik=0&';
          fa_ouvre(vf_c_fen_art_tarifs+vl_c_param,1000,650);
          break;
        case "ouvrir":
          i=fa_cui("arbre_tarif_particulier_achat");if(i==-1){return;}
          vl_c_param+='vl_e_art_cleunik='+fa_cell_get("arbre_tarif_particulier_achat",i,"tc_art_cleunik_particulier_achat")+'&';
          vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          vl_c_param+='vl_e_tar_cleunik='+fa_cell_get("arbre_tarif_particulier_achat",i,"tc_tar_cleunik_particulier_achat")+'&';
          fa_ouvre(vf_c_fen_art_tarifs+vl_c_param,1000,400);
          break;
      }
      break;
    case "tarif_particulier_vente":
      vl_c_param+='vl_e_type=110003&';
      vl_c_param+='vl_c_genre=1&';
      vl_c_param+='vl_c_origine=acteur&';
      switch (vv_quoi_02) {
        case "nouveau":
          vl_c_param+='vl_e_art_cleunik=-1&';
          vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          vl_c_param+='vl_e_tar_cleunik=0&';
          fa_ouvre(vf_c_fen_art_tarifs+vl_c_param,800,800);
          break;
        case "ouvrir":
          i=fa_cui("arbre_tarif_particulier_vente");if(i==-1){return;}
          vl_c_param+='vl_e_art_cleunik='+fa_cell_get("arbre_tarif_particulier_vente",i,"tc_art_cleunik_particulier_vente")+'&';
          vl_c_param+='vl_e_act_cleunik='+vf_e_act_cleunik+'&';
          vl_c_param+='vl_e_tar_cleunik='+fa_cell_get("arbre_tarif_particulier_vente",i,"tc_tar_cleunik_particulier_vente")+'&';
          fa_ouvre(vf_c_fen_art_tarifs+vl_c_param,800,400);
          break;
      }
      break;
    case "telephone":
      switch (vv_quoi_02) {
        case "telephoner":
          pf04_emitel(vf_e_act_cleunik,vf_e_interlo_cleunik,0,'raf',0);
          return;
          break;
        case "nouveau":
          vl_c_param+='vl_e_tel_cleunik=-1&vl_e_interlo_cleunik='+fa_enc(vf_e_interlo_cleunik)+"&";
          break;
        case "ouvrir":
          vl_c_param+='vl_e_intel_cleunik='+fa_enc(vf_e_intel_cleunik)+"&";
          break;
        default : return;
      }
      fa_ouvre(vf_c_fen_interlo_tel+vl_c_param,500,480);
      break;
  }
}
function pf_parcours_fichier_xml_interlo(noeudxml,xulnode){
  var treeItem = fa_crexul("treeitem");
  var treeRow  = fa_crexul("treerow");
  var treeCell_01 = fa_crexul("treecell");
  var treeCell_02 = fa_crexul("treecell");
	var treeCell_03 = fa_crexul("treecell");
  treeCell_01.setAttribute("label",noeudxml.getAttribute("label"));
  treeCell_01.setAttribute("properties",noeudxml.getAttribute("properties"));
  treeCell_01.setAttribute("value",noeudxml.getAttribute("_graal_genre"));
  treeCell_02.setAttribute("value",noeudxml.getAttribute("_graal_cleunik"));
  treeCell_02.setAttribute("label",noeudxml.getAttribute("_graal_genre"));
	treeCell_03.setAttribute("value",noeudxml.getAttribute("_graal_int_cleunik"));
  treeRow.appendChild(treeCell_01);
  treeRow.appendChild(treeCell_02);
  treeRow.appendChild(treeCell_03);
  treeItem.appendChild(treeRow);
  xulnode.appendChild(treeItem);
  if(noeudxml.hasChildNodes){                                                           /* encore des noeuds à lire ?*/
    for(var i=0;i<noeudxml.childNodes.length;i++){                                      /* bouclons */
      if(noeudxml.childNodes[i].nodeType==1){                                           /* On ne lit que les éléments */
        if(!fa_est_conteneur(treeItem)){ fa_nouvelle_branche(treeItem); }               /* Il y a des enfants, on crèe une nouvelle branche */
        pf_parcours_fichier_xml_interlo(noeudxml.childNodes[i],treeItem.childNodes[1]); /* parcours récursif */
      }
    }
  }
}

function pf_raz_fiche() {
	fa_att_set("tab_interlos","label","$vl_c_aai_105");
	fa_att_set("tab_actions","label","$vl_c_aai_115");
	fa_att_set("tab_criteres","label","$vl_c_aai_103");
	fa_att_set("tab_ged","label","$vl_c_aai_114");
	fa_att_set("tab_sites","label","$vl_c_aai_107");
	fa_att_set("tab_adresses_postales","label","$vl_c_aai_104");
	fa_att_set("tab_relations","label","$vl_c_aai_108");
	fa_att_set("tab_articles","label","$vl_c_aai_138");
  vf_e_act_cleunik=-1;
  vf_e_nombre_utilisations=0;
  fa_value_set("la_uuid","");
  fa_value_set("tb_mnemotechnique","");
  fa_value_set("la_dateheurevalidite","");
  fa_value_set("la_dateheuremodif","");
  fa_value_set("la_dateheurecreation","");
  fa_value_set("tb_blocnotebrut","");
  fa_value_set("tb_codealphanum15","");
  fa_value_set("tb_raisonsoc","");
  fa_value_set("tb_nomcommercial","");
  fa_value_set("tb_siret","");
  fa_value_set("tb_encours_autorise","");

  fa_value_set('rdg_acteur_actif',"1");
  fa_vide_arbre("fils_arbre_interlo");
  fa_vide_arbre_bis('criteres_des_acteurs_entreprise');
  fa_vide_arbre_bis('criteres_des_acteurs_lesautres');
  fa_vide_arbre_bis('criteres_des_acteurs_lesmiens');
  fa_vide_arbre_bis('criteres_des_acteurs_tous');
  fa_vide_arbre_bis('arbre_art_fournisseurs');
  fa_vide_arbre_bis('arbre_des_ged');
  fa_vide_arbre_bis('arbre_iban_cli');
  fa_vide_arbre_bis('arbre_iban_fou');
  fa_vide_arbre_bis('arbre_relations');
  fa_vide_arbre_bis('arbre_rib_cli');
  fa_vide_arbre_bis('arbre_rib_fou');
  fa_vide_arbre_bis('arbre_sites_des_acteurs');
  fa_vide_arbre_bis('arbre_actions_01');
  fa_vide_arbre_bis('arbre_representants');
  fa_vide_arbre_bis('tr_histo_cial_01');
  fa_vide_arbre_bis('tr_histo_cial_02');
  fa_vide_arbre_bis('arbre_echeancier');
  fa_vide_arbre_bis('arbre_reglements');
  fa_att_set("if_adressespostales","src","");
  fa_att_set("graal_iframe_visu_action","src","");
  fa_value_set("tb_tva","");
  fa_value_set("tb_code","");
  fa_value_set("tb_intitule","");
  fa_att_set("tb_code","pc_cleunik","-1");
  fa_cache_oui("bfj_requete");
  	fa_value_set("tb_montant_port",0);
	fa_value_set("tb_seuil_franco",0);
	fa_value_set("tb_commande_mini",0);

	fa_value_set("ml_remise_type",1);
	fa_value_set("ml_remise_genr",1);
	fa_value_set("ml_escompte_type",1);
	fa_value_set("ml_remise_natu",1);
	fa_value_set("ml_categorie_compta",1);
	fa_value_set("ml_assujetti_tpf",1);
	fa_sel_index("ml_modereglement",1);

	fa_value_set("tb_remise_taux",0);
	fa_value_set("tb_escompte_taux",0);
}
function pf_retour_changer_genre(vv_retour){
	fa_grise_fenetre("","non");
	if ("$vl_act_cleunik"=='-1') {
    pf_approximatif();
		pf_etat_fen("annuler");
	} else {
		pf_etat_fen('sortir');
	}
}
function pf_retour_dupliq(vv_retour){
	fa_grise_fenetre("","non");
	if (confirm("$vl_c_aai_136js")) {
		fa_ouvre_acteur(vv_retour);
	}
}
function pf_retour_fenetre_dossiers(vv_t_tableau_cleunik) {
  var vl_e_nb_sel=vv_t_tableau_cleunik.length;
  if (vl_e_nb_sel!=0) {
	for(var i=0;i<vl_e_nb_sel;i++){                      /* loop 'em */
      var vl_c_donnees=vv_t_tableau_cleunik[i]+"&cleunik_insertion_dossier="+fa_enc(vf_e_act_cleunik)+"&label_insertion_dossier="+fa_enc(fa_value_get("tb_raisonsoc"));
      fa_xmlhttprequest_txt(c_bdope_dossiers+vl_c_donnees,"",pf_retour_fenetre_dossiers_fin);
    }
  }
}
function pf_retour_fenetre_dossiers_fin(stream){
	alert(stream)
}
function pf_retour_param_pc(vl_e_pc_cleunik,vl_c_code,vl_c_intitule) {
  fa_value_set("tb_code",vl_c_code);
  fa_att_set("tb_code","pc_cleunik",vl_e_pc_cleunik);
  fa_value_set("tb_intitule",vl_c_intitule);
}
function pf_sel_acteur(vv_acteur,vv_type) {
  vf_e_act_cleunik=vv_acteur;
  var s =fa_enc("act_cleunik")+"="+fa_enc(vf_e_act_cleunik)+"&";
  fa_xmlhttprequest_xml(vf_c_script_edite,s,aai_pa_affiche_datas,vv_type);
}
function pf_sel_acteur_suite(vv_type) {
  fa_das("ml_genre_action_rech",c_script_actions_acteurs+fa_enc(vf_e_act_cleunik)+"&raf_random="+Math.random()+"&");
  fa_vide_arbre_bis('criteres_des_acteurs_entreprise');
  fa_vide_arbre_bis('criteres_des_acteurs_lesautres');
  fa_vide_arbre_bis('criteres_des_acteurs_lesmiens');
  fa_vide_arbre_bis('criteres_des_acteurs_tous');
  fa_vide_arbre_bis('arbre_art_fournisseurs');
  fa_vide_arbre_bis('arbre_des_ged');
  fa_vide_arbre_bis('arbre_iban_cli');
  fa_vide_arbre_bis('arbre_iban_fou');
  fa_vide_arbre_bis('arbre_relations');
  fa_vide_arbre_bis('arbre_rib_cli');
  fa_vide_arbre_bis('arbre_rib_fou');
  fa_vide_arbre_bis('arbre_sites_des_acteurs');
  fa_vide_arbre_bis('arbre_actions_01');
  fa_vide_arbre_bis('arbre_representants');
  fa_vide_arbre_bis('tr_histo_cial_01');
  fa_vide_arbre_bis('tr_histo_cial_02');
  fa_vide_arbre_bis('arbre_echeancier');
  fa_vide_arbre_bis('arbre_reglements');
  fa_att_set("if_adressespostales","src","");
  fa_att_set("graal_iframe_visu_action","src","");
  if (vf_e_nb_actions!=0){
  	if (vf_e_nb_actions<150) {
  		pf_approximatif_bem();
  	}
  }
  if (vf_e_nb_criteres!=0){pf_affiche_donnees_criteres_entreprise();pf_affiche_donnees_criteres_lesmiens();pf_affiche_donnees_criteres_lesautres();pf_affiche_donnees_criteres_tous();}
  if (vf_e_nb_adrpos!=0){pf_affiche_donnees_adresses();}
  //pf_affiche_donnees_interlo(); Déplacée dans aai_pa_affiche_datas car conditionnée au nombre d'adresses de courriel de l'acteur
  if (vf_e_nb_sites!=0){pf_affiche_donnees_sites();}
  if (vf_e_nb_relations!=0){pf_affiche_donnees_relations();pf_affiche_donnees_representants();}
  if (vf_e_nb_ged!=0){pf_affiche_donnees_ged();}
  pf_gere_onglet_compta(vv_type);
  fa_cache_oui("tb_action_ajouter_offcli");
  fa_cache_oui("tb_action_ajouter_cdecli");
  fa_cache_oui("tb_action_ajouter_livcli");
  fa_cache_oui("tb_action_ajouter_retcli");
  fa_cache_oui("tb_action_ajouter_faccli");
  fa_cache_oui("tb_action_ajouter_avocli");
  fa_cache_oui("tb_action_ajouter_avofin");
  fa_cache_oui("tb_action_ajouter_demfou");
  fa_cache_oui("tb_action_ajouter_cdefou");
  fa_cache_oui("tb_action_ajouter_recfou");
  fa_cache_oui("tb_action_ajouter_retfou");
  fa_cache_oui("tb_action_ajouter_facfou");
  switch (vv_type) {
    case "110001":  //  proscpects clients
      spe_sel_datas_spe_procli(vf_e_act_cleunik);
      fa_cache_non("tb_action_ajouter_offcli");
      break;
    case "110002":  //  Prospects Fournisseurs
      fa_cache_non("tb_action_ajouter_demfou");
      break;
    case "110003":  //  Clients
    if (vf_e_nb_lignes_vendues!=0){pf_affiche_donnees_histo_01();pf_affiche_donnees_histo_02();}
      if (vf_e_nb_rib!=0){pf_affiche_donnees_rib_cli();}
      if (vf_e_nb_iban!=0){pf_affiche_donnees_iban_cli();}
      if (vf_e_nb_art_acteur!=0){pf_affiche_donnees_art_cli();}
      spe_sel_datas_spe_client(vf_e_act_cleunik);
      if (vf_e_nb_art_tarifs!=0){pf_affiche_donnees_tarif_particulier_vente();}
	  //if (vf_e_nb_faccli!=0){pf_affiche_donnees_tresorerie();pf_affiche_donnees_reglement();}	//	commenté car il faut aussi afficher les règlements sur commandes (France lampes le 16 septembre 2010)
	  pf_affiche_donnees_tresorerie();
      pf_affiche_donnees_reglement();
	  fa_cache_non("tb_action_ajouter_offcli");
      fa_cache_non("tb_action_ajouter_cdecli");
      fa_cache_non("tb_action_ajouter_livcli");
      fa_cache_non("tb_action_ajouter_retcli");
      fa_cache_non("tb_action_ajouter_faccli");
      fa_cache_non("tb_action_ajouter_avocli");
		  fa_cache_non("tb_action_ajouter_avofin");
      break;
    case "110004":  //  Fournisseurs
      if (vf_e_nb_rib!=0){pf_affiche_donnees_rib_fou();}
      if (vf_e_nb_iban!=0){pf_affiche_donnees_iban_fou();}
      if (vf_e_nb_art_acteur!=0){pf_affiche_donnees_art_four();}
      if (vf_e_nb_art_tarifs!=0){pf_affiche_donnees_tarif_particulier_achat();}
      if (vf_e_nb_facfou!=0){pf_affiche_donnees_tresorerie();pf_affiche_donnees_reglement();}
      fa_cache_non("tb_action_ajouter_demfou");
      fa_cache_non("tb_action_ajouter_cdefou");
      fa_cache_non("tb_action_ajouter_recfou");
      fa_cache_non("tb_action_ajouter_retfou");
      fa_cache_non("tb_action_ajouter_facfou");
      break;
    default:
      fa_cache_oui("tb_action_ajouter_offcli");
      fa_cache_oui("tb_action_ajouter_cdecli");
      fa_cache_oui("tb_action_ajouter_livcli");
      fa_cache_oui("tb_action_ajouter_retcli");
      fa_cache_oui("tb_action_ajouter_faccli");
      fa_cache_oui("tb_action_ajouter_avocli");
		  fa_cache_oui("tb_action_ajouter_avofin");
      fa_cache_oui("tb_action_ajouter_demfou");
      fa_cache_oui("tb_action_ajouter_cdefou");
      fa_cache_oui("tb_action_ajouter_recfou");
      fa_cache_oui("tb_action_ajouter_retfou");
      fa_cache_oui("tb_action_ajouter_facfou");
      break;
  }
}
function pf_sel_arbre_adresses() {}
function pf_sel_arbre_art_fournis() {}
function pf_sel_arbre_ged() {}
function pf_sel_arbre_iban_cli() {}
function pf_sel_arbre_iban_fou() {}
function pf_sel_arbre_interlo() {
	var i=fa_cui("arbre_interlo");if(i==-1){return;}
  var vl_c_genre=fa_cell_get("arbre_interlo",i,"arbre_interlo_col02") //  Genre
  vf_e_interlo_cleunik=fa_cell_val("arbre_interlo",i,"arbre_interlo_col03"); //  int_cleunik
	//if(fa_est_grise("bt_enregistrer")==true) {return};
  pf_grise_boutons_interlo();
/*
 * on peut toujours créer un interlocuteur
 *
*/
  fa_grise_non("tb_interlo_01");//  On peut créer un interlocuteur
  fa_grise_non("tb_interlo_03");//  On peut créer un interlocuteur simplifié
  switch (vl_c_genre) {
    case "":
      return;
      break;
    case "0": // Acteurs
      break;
    case "1": // Interlocuteurs
      fa_grise_non("tb_interlo_02");//  On peut modifier un interlocuteur
      fa_grise_non("tb_tel_01");//  On peut ajouter un téléphone
      fa_grise_non("tb_fax_01");//  on peut ajouter un fax
      fa_grise_non("tb_courriel_01");//  on peut ajouter un courriel
      fa_grise_non("tb_mesinst_01");//  on peut ajouter un identifiant de messagerie instantannée
      fa_grise_non("tb_chat_01"); //  On peut chatter
      fa_grise_non("tb_tel_03");//  on peut téléphoner
      vf_e_interlo_cleunik=fa_cell_val("arbre_interlo",i,"arbre_interlo_col02"); //  cleunik
      break;
    case "2": // Téléphones
      fa_grise_non("tb_tel_02");//  on peut modifier un téléphone
      fa_grise_non("tb_tel_03");//  on peut téléphoner
      fa_grise_non("tb_tel_04");//  on peut envoyer un SMS (à développer)
      vf_e_intel_cleunik=fa_cell_val("arbre_interlo",i,"arbre_interlo_col02"); //  cleunik
      break;
    case "3": // Fax
      fa_grise_non("tb_fax_02");//  on peut modifier un fax
      fa_grise_non("tb_fax_03");//  on peut faxer ( à développer)
      vf_e_intel_cleunik=fa_cell_val("arbre_interlo",i,"arbre_interlo_col02"); //  cleunik
      break;
    case "4": // Courriels
      fa_grise_non("tb_courriel_02");//  on peut modifier un courriel
      fa_grise_non("tb_courriel_03");//  on peut envoyer un courriel texte (si on a un compte)
      fa_grise_non("tb_courriel_04");//  on peut envoyer un courriel texte (si on a un compte)
      vf_e_courriel_cleunik=fa_cell_val("arbre_interlo",i,"arbre_interlo_col02"); //  cleunik
    //  on peut envoyer un courriel texte(si on a un compte)
    //  on peut envoyer un courriel html(si on a un compte) (à développer)
      break;
    case "5": // Messagerie instantanée
      fa_grise_non("tb_mesinst_02");//  on peut modifier un identifiant de messagerie instantané
      vf_e_mesinst_cleunik=fa_cell_val("arbre_interlo",i,"arbre_interlo_col02"); //  cleunik
      break;
  }
}
function pf_sel_arbre_relations() {
  var i=fa_cui("arbre_relations");if(i==-1){return;}
  vf_e_act_cleunik_droite=fa_cell_get("arbre_relations",i,"tc_act_cleunik_droite");//  Clé unique acteur droite
  vf_e_act_cleunik_gauche=fa_cell_get("arbre_relations",i,"tc_act_cleunik_gauche");//  Clé unique acteur gauche
  vf_e_choix_cleunik_droite=fa_cell_get("arbre_relations",i,"tc_choix_cleunik_droite");//  Clé unique du choix de la relation
  vf_e_choix_cleunik_gauche=fa_cell_get("arbre_relations",i,"tc_choix_cleunik_gauche");//  Clé unique du choix de la relation
}
function pf_sel_arbre_representants() {
  var i=fa_cui("arbre_representants");if(i==-1){return;}
  vf_e_rep_act_cleunik_droite=fa_cell_get("arbre_representants",i,"tr_act_cleunik_droite");//  Clé unique acteur droite
  vf_e_rep_act_cleunik_gauche=fa_cell_get("arbre_representants",i,"tr_act_cleunik_gauche");//  Clé unique acteur gauche
  vf_e_rep_choix_cleunik_droite=fa_cell_get("arbre_representants",i,"tr_choix_cleunik_droite");//  Clé unique du choix de la relation
  vf_e_rep_choix_cleunik_gauche=fa_cell_get("arbre_representants",i,"tr_choix_cleunik_gauche");//  Clé unique du choix de la relation
}
function pf_sel_arbre_rib_cli() {}
function pf_sel_arbre_rib_fou() {}
function pf_sel_arbre_sites() {}
function pf_sel_ligne()  {
  if(fa_est_grise("bt_detailler")==true) {return};
  var rowIndex = fa_cui("arbre_des_acteurs");if(rowIndex == -1){return;}
  var vl_acteur=fa_cell_get("arbre_des_acteurs",rowIndex,"act_cleunik");
  if (vf_e_act_cleunik==vl_acteur){return;}
  pf_sel_acteur(vl_acteur,fa_cell_get("arbre_des_acteurs",rowIndex,"typeacteur"));
}
function pf_telecharge(){
	pf07_telecharge();
}
function pf_validation(vv_quoi){
    var vl_c_donnees,typeacteur,tarif_cleunik;
    vl_c_donnees="";
    vl_c_donnees+="vl_act_cleunik="+fa_enc(vf_e_act_cleunik)+"&";
    vl_c_donnees+="vl_codealphanum15="+fa_enc(fa_value_get("tb_codealphanum15"))+"&";
    vl_c_donnees+="vl_raisonsoc="+fa_enc(fa_value_get("tb_raisonsoc"))+"&";
    vl_c_donnees+="vl_nomcommercial="+fa_enc(fa_value_get("tb_nomcommercial"))+"&";
    vl_c_donnees+="vl_siret="+fa_enc(fa_value_get("tb_siret"))+"&";
    vl_c_donnees+="vl_blocnotebrut="+fa_enc(fa_value_get("tb_blocnotebrut"))+"&";
//    vl_c_donnees+="vl_dateheurevalidite="+fa_enc(fa_value_get("tb_dateheurevalidite"))+"&";
    typeacteur=fa_mlget("ml_typeacteurs");
    vl_c_donnees+="vl_typeacteur="+fa_enc(typeacteur)+"&";
    vl_c_donnees+="vl_mnemotechnique="+fa_enc(fa_value_get("tb_mnemotechnique"))+"&";
    vl_c_donnees+="vl_modegestion="+fa_enc(fa_mlget("ml_mode"))+"&";
    vl_c_donnees+="vl_devise="+fa_enc(fa_mlget("ml_devise"))+"&";
		vl_c_donnees+="vl_langue="+fa_enc(fa_mlget("ml_langue"))+"&";
    vl_c_donnees+="vl_tva="+fa_enc(fa_value_get("tb_tva"))+"&";
    vl_c_donnees+="vl_actif="+fa_enc(fa_value_get('rdg_acteur_actif'))+"&";
    vl_c_donnees+="vl_encours_autorise="+fa_enc(fa_value_get("tb_encours_autorise"))+"&";
    switch (typeacteur) {
      case "110001":  //  prospects clients
      case "110003":  //  clients
        tarif_cleunik=fa_mlget("ml_tarif_cli");
        break;
      case "110002":  //  prospects fournisseurs
      case "110004":  //  fournisseurs
        tarif_cleunik=fa_mlget("ml_tarif_fou");
        break;
    }
    vl_c_donnees+="vl_tarif="+fa_enc(tarif_cleunik)+"&";
    vl_c_donnees+="vl_remise_taux="+fa_enc(fa_value_get("tb_remise_taux"))+"&";
    vl_c_donnees+="vl_remise_type="+fa_enc(fa_value_get("ml_remise_type"))+"&";
    vl_c_donnees+="vl_remise_genr="+fa_enc(fa_value_get("ml_remise_genr"))+"&";
    vl_c_donnees+="vl_escompte_taux="+fa_enc(fa_value_get("tb_escompte_taux"))+"&";
    vl_c_donnees+="vl_escompte_type="+fa_enc(fa_value_get("ml_escompte_type"))+"&";
    vl_c_donnees+="vl_remise_natu="+fa_enc(fa_value_get("ml_remise_natu"))+"&";
    vl_c_donnees+="vl_modereglement="+fa_enc(fa_mlget("ml_modereglement"))+"&";
    vl_c_donnees+="vl_pc_cleunik="+fa_enc(fa_att_get("tb_code","pc_cleunik"))+"&";
    vl_c_donnees+="vl_catcompta_cleunik="+fa_enc(fa_mlget("ml_categorie_compta"))+"&";
    vl_c_donnees+="vl_assujetti_tpf="+fa_enc(fa_value_get("ml_assujetti_tpf"))+"&";
    vl_c_donnees+="vl_montant_port="+fa_enc(fa_value_get("tb_montant_port"))+"&";
    vl_c_donnees+="vl_seuil_franco="+fa_enc(fa_value_get("tb_seuil_franco"))+"&";
    vl_c_donnees+="vl_commande_mini="+fa_enc(fa_value_get("tb_commande_mini"))+"&";
    switch(vv_quoi) {
      case "enregistrer":
        if (vf_e_act_cleunik!=-1)
          {vl_c_donnees+="vf_c_action=modifier&";vf_c_action="modification";}
        else
          {vl_c_donnees+="vf_c_action=ajouter&";vf_c_action="ajout"}
        break;
      case "supprimer":
          Check = confirm("$vl_c_aai_135js");
          if(Check == false) return;
          vl_c_donnees+="vf_c_action=supprimer&"
          vf_c_action="suppression";
        break;
    }
		fa_grise_fenetre("","oui");
    fa_xmlhttprequest_txt(vf_c_script_bdope_fen,vl_c_donnees,pf_validation_fin_requete);
}
function pf_validation_fin_requete(stream){
  var vl_datas = stream;
  if (vl_datas!="-1"){
      switch (vf_c_action){
        case "ajout":
          vf_e_act_cleunik=vl_datas;
          //  On valide aussi les specif client ou prospect
          switch (fa_mlget("ml_typeacteurs")){
              case "110001":  //  Prospects client
                spe_validation_spe_procli(vf_e_act_cleunik);
                break;
              case "110003":  //  Clients
                spe_validation_spe_client(vf_e_act_cleunik);
                break;
              default:
                break;
          }
          var s =fa_enc("act_cleunik")+"="+fa_enc(vf_e_act_cleunik)+"&";
          fa_cache_oui("bt_verifnom");fa_cache_oui("bt_voirnoms");
          pf_cache_onglets("non");
          pf_etat_fen("modifier");
          fa_xmlhttprequest_xml(vf_c_script_edite,s,aai_pa_affiche_datas,fa_mlget("ml_typeacteurs"));
          break;
        case "modification":
          switch (fa_mlget("ml_typeacteurs")) {
            case "110001":  //  Prospects client
              spe_validation_spe_procli(vf_e_act_cleunik);
              break;
            case "110003":  //  Clients
              spe_validation_spe_client(vf_e_act_cleunik);
              break;
            default:
              break;
          }
          var vl_e_act_cleunik=vf_e_act_cleunik;
          var vl_le_typeacteurs=fa_mlget("ml_typeacteurs");
          try {
            if (window.opener==null) {
              pf_etat_fen("annuler");
              pf_sel_acteur(vl_e_act_cleunik,vl_le_typeacteurs);
            } else {
              pf_etat_fen("sortir");
            }
          } catch (e) {
		        pf_etat_fen("annuler");
		        pf_sel_acteur(vl_e_act_cleunik,vl_le_typeacteurs);
	        }
          break;
        case "suppression":
          alert("$vl_c_aai_137js")
          try {
            if (window.opener==null) {pf_etat_fen("annuler");} else {pf_etat_fen("sortir");}
          } catch (e) {
		        pf_etat_fen("annuler");
	        }
          break;
      }
    }
  else {
    alert(vl_datas);
    pf_etat_fen("annuler");
  }
	fa_grise_fenetre("","non");
}

function pf_valide_requete() {
  var vl_titre_requete=prompt("$vl_c_bap_032js");
  if(vl_titre_requete==null) {alert("$vl_c_bap_033js");return;}
  var vl_c_donnees="";
  vl_c_donnees+="vl_panier_titre="+fa_enc(vl_titre_requete)+"&";
  vl_c_donnees+="vl_c_action=ajouter_lie_representant&";
  vl_c_donnees+="vl_act_cleunik="+vf_e_act_cleunik+"&";
  fa_xmlhttprequest_txt(vf_c_script_bdope_panier,vl_c_donnees,pf_valide_requete_fin);
}
function pf_valide_requete_fin(stream) {
  alert(stream);
}
function pf_verifie_nom(){
  vf_tab_act_cleunik=[];
  fa_cache_oui("bt_voirnoms");
  fa_att_set("bt_voirnoms","label","$vl_c_bap_029js");
  vl_c_donnees="vl_act_cleunik=-1&";
  vl_c_donnees+="vl_raisonsoc="+fa_enc(fa_value_get("tb_raisonsoc"))+"&";
  vl_c_donnees+="vl_nomcommercial="+fa_enc(fa_value_get("tb_nomcommercial"))+"&";
  vl_c_donnees+="vf_c_action=verifier_noms&"
  fa_xmlhttprequest_txt(vf_c_script_bdope_fen,vl_c_donnees,pf_verifie_nom_fin);
	//fa_ouvre(vf_c_script_bdope_fen+"?"+vl_c_donnees);
}
function pf_verifie_nom_fin(stream){
  var vl_c_tab=stream.split(',');
  vf_tab_act_cleunik=vl_c_tab.slice(1);
  var vl_e_nombre=vf_tab_act_cleunik.length
  switch (vl_e_nombre) {
    case 0:fa_att_set("bt_voirnoms","label","$vl_c_bap_030js");break;
    case 1:fa_att_set("bt_voirnoms","label","$vl_c_bap_031js");break;
    default:fa_att_set("bt_voirnoms","label","$vl_c_bap_029js ("+vl_e_nombre+")");break;
  }
  fa_cache_non("bt_voirnoms");
}
function pf_voir_nom() {
  if (vf_tab_act_cleunik.length==0) {
    alert("$vl_c_bap_030js");return;
  } else {
    if (vf_tab_act_cleunik.length==1) {
    	fa_ouvre_acteur(vf_tab_act_cleunik[0]);
    } else {
      fa_xmlhttprequest_txt(vf_c_script_var,'vl_t_listecles='+fa_jsarray2php_00(vf_tab_act_cleunik),pf_voir_nom_fin);
    }
  }
}
function pf_voir_nom_fin() {
  fa_ouvre(c_script_fen_visu_acteurs,1000,400);
}
]]></script>
END;
?>
