<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
const _c_url_alimente_table_01="_graal_das_uni_par_con_01.php";
const _c_script_edite="_graal_xml_uni_par_con_01.php";
const _c_script_bdope_fen="_graal_bdope_uni_par_con_01.php";
var vf_c_action;
function pf_affiche_datas(stream){
  var vl_c_datas=stream;
  fa_value_set("tb_stock",fa_xml_get(vl_c_datas,"stock"));
  fa_value_set("tb_conditionnement",fa_xml_get(vl_c_datas,"conditionnement"));
  fa_value_set("tb_relation",fa_xml_get(vl_c_datas,"relation"));
  fa_value_set("tb_qte",fa_xml_get(vl_c_datas,"qte"));
  fa_att_set("tb_qte","_graal_con_choix_cleunik",fa_xml_get(vl_c_datas,"con_choix_cleunik"));
  fa_att_set("tb_qte","_graal_uni_choix_cleunik",fa_xml_get(vl_c_datas,"uni_choix_cleunik"));
  fa_att_set("tb_qte","_graal_art_cleunik",fa_xml_get(vl_c_datas,"art_cleunik"));
}
function pf_aa_init(){
  fa_grise_oui("bt_supprimer");
  fa_grise_oui("bt_modifier");
  fa_grise_oui("bt_enregistrer");
  fa_grise_oui("bt_annuler");
  fa_grise_groupe_oui("broadcaster_01");
  pf_raz_fiche();
  pf_alimente_table("arbre_unite_par_conditionnement");
}
function pf_alimente_defaut(){
}
function pf_alimente_table(vv_qui){
  fa_das(vv_qui,_c_url_alimente_table_01+"?raf="+Math.random());
}
function pf_etat_fen(vv_quoi){
  vf_c_action=vv_quoi;
  switch(vv_quoi) {
    case "selectionner":
      var i=fa_cui("arbre_unite_par_conditionnement");if(i==-1){return;}
      fa_grise_non("bt_supprimer");
      fa_grise_non("bt_modifier");
      fa_grise_oui("bt_enregistrer");
      fa_grise_oui("bt_ajouter");
      fa_grise_oui("bt_detailler");
      fa_grise_oui("bt_sortir");
      fa_grise_non("bt_annuler");
      break;
    case "modifier":
    fa_grise_oui("bt_supprimer");
    fa_grise_oui("bt_modifier");
    fa_grise_oui("bt_ajouter");
    fa_grise_oui("bt_detailler");
    fa_grise_oui("bt_sortir");
    fa_grise_non("bt_annuler");
    fa_grise_non("bt_enregistrer");
    fa_grise_groupe_non("broadcaster_01");
    fa_focusdonne("tb_qte")
    break;
    case "ajouter":
    fa_grise_oui("bt_supprimer");
    fa_grise_oui("bt_modifier");
    fa_grise_oui("bt_ajouter");
    fa_grise_oui("bt_detailler");
    fa_grise_oui("bt_sortir");
    fa_grise_non("bt_annuler");
    fa_grise_non("bt_enregistrer");
    fa_grise_groupe_non("broadcaster_01");
    pf_raz_fiche();
    pf_alimente_defaut();
    fa_focusdonne("tb_qte")
    break;
    case "annuler":
    fa_grise_oui("bt_modifier");
    fa_grise_oui("bt_annuler");
    fa_grise_oui("bt_supprimer");
    fa_grise_oui("bt_enregistrer");
    fa_grise_non("bt_sortir");
    fa_grise_non("bt_ajouter");
    fa_grise_non("bt_detailler");
    fa_grise_groupe_oui("broadcaster_01");
    pf_raz_fiche();
    break;
    case "sortir":
    window.close();
    break;
    default:
    break;
  }
  }
function pf_fin_requete(stream)
{
  var vl_datas = stream;
  if (vl_datas=="ok") {pf_alimente_table("arbre_unite_par_conditionnement");} else {alert(vl_datas)}
  pf_etat_fen("annuler");
}
function pf_raz_fiche(){
}
function pf_sel_ligne(vv_qui){
  if(fa_est_grise("bt_detailler")==true){return}
  switch (vv_qui) {
      case "arbre_unite_par_conditionnement":
        var s="";
        var i=fa_cui(vv_qui);if(i==-1){return;}
        s +="con_choix_cleunik="+fa_cell_get(vv_qui,i,"tc_con_choix_cleunik")+"&";
        s +="uni_choix_cleunik="+fa_cell_get(vv_qui,i,"tc_uni_choix_cleunik")+"&";
        s +="art_cleunik="+fa_cell_get(vv_qui,i,"tc_art_cleunik")+"&";
        fa_xmlhttprequest_xml(_c_script_edite,s,pf_affiche_datas);
      break;
      case "un_autre_arbre":
      break;
    }
}
function pf_validation(vv_quoi) {
    var vl_c_donnees;
    var vl_e_ele_cleunik;
    vl_e_ele_cleunik=fa_gid("_win_fen_uni_par_con").getAttribute("_cleunik_encours");
    vl_c_donnees="";
    vl_c_donnees+="vl_art_cleunik="+fa_enc(fa_gid("tb_qte").getAttribute("_graal_art_cleunik"))+"&";
    vl_c_donnees+="vl_con_choix_cleunik="+fa_enc(fa_gid("tb_qte").getAttribute("_graal_con_choix_cleunik"))+"&";
    vl_c_donnees+="vl_uni_choix_cleunik="+fa_enc(fa_gid("tb_qte").getAttribute("_graal_uni_choix_cleunik"))+"&";
    vl_c_donnees+="vl_qte="+fa_enc(fa_value_get("tb_qte"))+"&";
    switch(vv_quoi) {
      case "enregistrer":
        if (vl_e_ele_cleunik!=-1)
          {vl_c_donnees+="vf_c_action=modifier&";}
        else
          {vl_c_donnees+="vf_c_action=ajouter&";}
        break;
      case "supprimer":
          if(confirm("Confirmez-vous la suppression de cet élément ?")==false) return;
          vl_c_donnees+="vf_c_action=supprimer&";
        break;
    }
    fa_xmlhttprequest_txt(_c_script_bdope_fen,vl_c_donnees,pf_fin_requete);
}


]]></script>
END;
?>
