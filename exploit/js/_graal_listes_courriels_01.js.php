<?php
$vl_c_bnp_105=fa_recup_dico("bnp_105");
echo <<<END
<script type="application/x-javascript"><![CDATA[
const vf_c_url_arbre="_graal_das_listes_courriels_01.php?quellecouleur=$quellecouleur&";
const c_script_bdope_listes="_graal_bdope_listes_courriels_01.php?quellecouleur=$quellecouleur&";
function pf_alimente_defaut(){}
function pf_alimente_table(){
  fa_das("arb_listes_courriels",vf_c_url_arbre+'&raf01='+Math.random())
}
function pf_etat_fen(vv_quoi){
   var vl_e_rowIndex;
   vf_c_action=vv_quoi;
   switch(vv_quoi) {
     case "ini":
       fa_grise_oui("bt_modifier");
       fa_grise_oui("bt_supprimer");
       fa_grise_oui("bt_enregistrer");
       fa_grise_oui("bt_annuler");
       fa_grise_groupe_oui('broadcaster_01');
       pf_alimente_table();
       break;
     case "selectionner":
      vl_e_rowIndex=fa_cui("arb_listes_courriels");if(vl_e_rowIndex == -1){return;}
     fa_grise_non("bt_supprimer");
     fa_grise_non("bt_modifier");
     fa_grise_oui("bt_detailler");
     fa_grise_non("bt_annuler");
     fa_grise_oui("bt_sortir");
     fa_grise_oui("bt_enregistrer");
     fa_grise_groupe_oui('broadcaster_01');
     break;
     case "annuler":
       fa_grise_non("bt_detailler");
       fa_grise_non("bt_ajouter");
       fa_grise_oui("bt_modifier");
       fa_grise_oui("bt_supprimer");
       fa_grise_oui("bt_enregistrer");
       fa_grise_oui("bt_annuler");
       pf_raz_fiche();
       fa_grise_groupe_oui('broadcaster_01');
       break;
     case "ajouter":
       fa_grise_oui("bt_supprimer");
       fa_grise_oui("bt_modifier");
       fa_grise_oui("bt_ajouter");
       fa_grise_oui("bt_detailler");
       fa_grise_non("bt_annuler");
       fa_grise_oui("bt_sortir");
       fa_grise_non("bt_enregistrer");
       pf_raz_fiche();
       pf_alimente_defaut();
       fa_grise_groupe_non('broadcaster_01');
       fa_focusdonne("tb_refweb");
       break;
     case "modifier":
       fa_grise_oui("bt_supprimer");
       fa_grise_oui("bt_modifier");
       fa_grise_oui("bt_ajouter");
       fa_grise_oui("bt_detailler");
       fa_grise_non("bt_annuler");
       fa_grise_oui("bt_sortir");
       fa_grise_non("bt_enregistrer");
       fa_grise_groupe_non('broadcaster_01');
       fa_focusdonne("tb_refweb");
       break;
     case "sortir":
     window.close();
     break;   
}
}
function pf_raz_fiche(){
  fa_value_set('tb_refweb','');
  fa_gid("ml_types_elements").selectedIndex=0;
}
function pf_sel_ligne(vv_objet){
  if (fa_est_grise("bt_detailler")==true) {return};
  var rowIndex = vv_objet.currentIndex;
  if(rowIndex == -1){return;}
  fa_value_set('tb_refweb',vv_objet.view.getCellText( rowIndex ,vv_objet.columns.getNamedColumn("z02")));
  var vl_e_type=vv_objet.view.getCellText( rowIndex ,vv_objet.columns.getNamedColumn("z03"));
	fa_mlsel("ml_types_elements",vl_e_type,"value");
}
function pf_validation(vv_quoi){
  var s;
  switch(vv_quoi) {
    case "enregistrer":
      s ="vl_c_action="+fa_enc(vf_c_action)+"&";
      s +="vl_c_refweb="+fa_enc(fa_value_get('tb_refweb'))+"&"
      s +="vl_e_type="+fa_gid("ml_types_elements").selectedItem.value+"&";
      break;
    case "supprimer":
      Check = confirm("$vl_c_bnp_105");
      if(Check == false) return;
      s ="vl_c_action=supprimer&";
      s +="vl_c_refweb="+fa_enc(fa_value_get('tb_refweb'))+"&";
      break;
  }
  fa_xmlhttprequest_txt(c_script_bdope_listes,s,pf_validation_fin);       
}
function pf_validation_fin(stream){
  var vl_datas = stream;
  if (vl_datas=='ok') {pf_alimente_table();}else{fa_erreur(vl_datas)}
  pf_etat_fen('annuler');
}

]]></script>
END;
