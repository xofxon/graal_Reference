<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
var vf_c_url_alimente_table;
const vf_c_script_recherche='_graal_rech_courriel_01.php?var=vs_tempo_panier_courriel&';
const vf_c_script_fen_acteur="_graal_fen_acteurs_01.php?genreacteur=";
const c_fen_interlo_mail="_graal_fen_act_interlo_mail_01.php?";
const lstn_grise = {
	willRebuild : function(event){}, 
	didRebuild  : function(event){
		fa_grise_non("aao_tb_rechapproxima");fa_ro_non("aao_tb_rechapproxima");
		fa_att_rem("_graal_fen_rech_courriel_01","wait-cursor","true");
		fa_grise_non("tb_rafraichir_table");
		fa_grise_fenetre(event,"non");
	} 
};
function pf_alimente_table(){
  switch (fa_value_get("aao_ml_qui")){
    case "9":fa_cache_non("portee");break;
    default: fa_cache_oui("portee");break;
  }
	fa_grise_oui("aao_tb_rechapproxima");fa_ro_oui("aao_tb_rechapproxima");
	fa_att_set("_graal_fen_rech_courriel_01","wait-cursor","true");
	fa_grise_oui("tb_rafraichir_table");
	fa_grise_fenetre("","oui");
	fa_das("$vl_c_nom_arbre_courriel_select",vf_c_url_alimente_table+"&sortie=das&");
}
function pf_acteur_ouvre() {
  var rowIndex = fa_cui("$vl_c_nom_arbre_courriel_select");if(rowIndex == -1){return;}
  var param=fa_cell_get("$vl_c_nom_arbre_courriel_select",rowIndex,"typeacteur")+"&act_cleunik="+fa_cell_get("$vl_c_nom_arbre_courriel_select",rowIndex,"act_cleunik")+"&";
  fa_ouvre(vf_c_script_fen_acteur+param,1200,800);
}
function pf_approximatif(vv_origine) {
	if (vv_origine!="tb_rafraichir_table") {
  	if (fa_value_get("rdg_immediat")==2) {return;}
  }
  var vl_c_texte=fa_value_get("aao_tb_rechapproxima");
  if ( vl_c_texte == "" ){return;}
	fa_grise_fenetre("","oui");
	fa_att_set("_graal_fen_rech_courriel_01","cursor-wait");
  var item=fa_gid("aao_ml_actif").selectedItem;  
  vf_c_url_alimente_table =vf_c_script_recherche+'operat_genre='+fa_value_get("aao_ml_operat_genre")+'&raisonsoc='+fa_enc(vl_c_texte)+'&typeacteur='+fa_value_get("aao_ml_qui")+'&quoi='+fa_value_get("aao_ml_zone")+'&vl_c_actifs='+fa_value_get("aao_ml_actif")+'&vl_e_panier='+item.getAttribute("_graal_cleunik")+'&vl_e_limit='+fa_value_get("aao_tb_limit")+'&&raf='+Math.random()+"&";
  var vl_c_valide="";
  if (fa_att_get("ra_valide_oui","checked")) {vl_c_valide+="1,";}
  if (fa_att_get("ra_valide_non","checked")) {vl_c_valide+="2,";}
  if (fa_att_get("ra_valide_nsp","checked")) {vl_c_valide+="3,";}
  var vl_c_veuxpasdemail="";
  if (fa_att_get("ra_veuxpasdemail_oui","checked")) {vl_c_veuxpasdemail+="1,";}
  if (fa_att_get("ra_veuxpasdemail_non","checked")) {vl_c_veuxpasdemail+="2,";}
  if (fa_att_get("ra_veuxpasdemail_nsp","checked")) {vl_c_veuxpasdemail+="3,";}
  vf_c_url_alimente_table+="vl_c_veuxpasdemail="+fa_enc(vl_c_veuxpasdemail)+"&";
  vf_c_url_alimente_table+="vl_c_valide="+fa_enc(vl_c_valide)+"&";
  pf_alimente_table();
}
function pf_courriel_ouvre() {
  var vl_c_arbre="$vl_c_nom_arbre_courriel_select";
  var i=fa_cui(vl_c_arbre);if(i==-1){return;}
  var vl_c_param="genreacteur="+fa_cell_get(vl_c_arbre,i,"typeacteur")+"&vl_e_intweb_cleunik="+fa_cell_get(vl_c_arbre,i,"intweb_cleunik");
  fa_ouvre(c_fen_interlo_mail+vl_c_param,700,600);
}
function pf_emimail(vv_quoi) {
  var vl_c_arbre="$vl_c_nom_arbre_courriel_select";
  var i=fa_cui(vl_c_arbre);if(i==-1){return;}
  switch (vv_quoi) {
    case "texte":
      pf04_emimail_texte(fa_cell_get(vl_c_arbre,i,"intweb_cleunik"));
      break;
    case "html":
      pf04_emimail_html(fa_cell_get(vl_c_arbre,i,"intweb_cleunik"));
      break;
  }
}
function pf_etat_fen(vv_quoi){
  switch (vv_quoi){
		case "ini":
			fa_att_set("$vl_c_nom_arbre_courriel_select",'context','pop_selections');
		  fa_att_set("$vl_c_nom_arbre_courriel_select",'onselect','pf_sel_ligne();');
		  fa_check("ra_veuxpasdemail_oui");
		  fa_check("ra_veuxpasdemail_non");
		  fa_check("ra_veuxpasdemail_nsp");
		  fa_check("ra_valide_oui");
		  fa_check("ra_valide_non");
		  fa_check("ra_valide_nsp");
			fa_badl("$vl_c_nom_arbre_courriel_select",lstn_grise);
		  pf_approximatif();
		  po_change_menu();
			break;
		case "sortir":
			window.close();
			break;
	}
}
function pf_export_excel_01(){
	var vl_c_nom_fichier_xls=prompt("Nom du fichier","essai.xls");
	var vl_c_url="";
	vl_c_url=vf_c_url_alimente_table;
	vl_c_url+='&sortie=excel_01';
	vl_c_url+="&vl_c_nom_fichier_xls="+fa_enc(vl_c_nom_fichier_xls)+"&vl_c_id_rech_courriel=$vl_c_id_rech_courriel&";
	fa_ouvre(vl_c_url);
}
function pf_interlo_ouvre() {
  var vl_c_arbre="$vl_c_nom_arbre_courriel_select";
  var i=fa_cui(vl_c_arbre);if(i==-1){return;}
  var vl_c_param="genreacteur="+fa_cell_get(vl_c_arbre,i,"typeacteur")+"&vl_e_interlo_cleunik="+fa_cell_get(vl_c_arbre,i,"int_cleunik");
  vl_c_param+='&vl_e_act_cleunik='+fa_cell_get(vl_c_arbre,i,"act_cleunik")+"&";
  fa_ouvre_interlo(vl_c_param);
}
function pf_onunload(){
	fa_brl("$vl_c_nom_arbre_courriel_select",lstn_grise);
}
function pf_sel_ligne() {
  var vl_c_arbre="$vl_c_nom_arbre_courriel_select";
  var i=fa_cui(vl_c_arbre);if(i==-1){return;}
  fa_grise_oui("pop_cour_tex"); 
  fa_grise_oui("pop_cour_htm");
  var vl_c_type_acteur=fa_cell_get(vl_c_arbre,i,"typeacteur");
  switch (vl_c_type_acteur) {
    case "110000": if ($vl_tb_droits_courtex_entrep[0]==1) {fa_grise_non("pop_cour_tex");};if ($vl_tb_droits_courhtm_entrep[0]==1) {fa_grise_non("pop_cour_htm");};break; //  Entreprise
    case "110001": if ($vl_tb_droits_courtex_procli[0]==1) {fa_grise_non("pop_cour_tex");};if ($vl_tb_droits_courhtm_procli[0]==1) {fa_grise_non("pop_cour_htm");};break; //  Prospects Clients
    case "110002": if ($vl_tb_droits_courtex_profou[0]==1) {fa_grise_non("pop_cour_tex");};if ($vl_tb_droits_courhtm_profou[0]==1) {fa_grise_non("pop_cour_htm");};break; //  Prospects Fournisseurs
    case "110003": if ($vl_tb_droits_courtex_client[0]==1) {fa_grise_non("pop_cour_tex");};if ($vl_tb_droits_courhtm_client[0]==1) {fa_grise_non("pop_cour_htm");};break; //  Clients
    case "110004": if ($vl_tb_droits_courtex_fourni[0]==1) {fa_grise_non("pop_cour_tex");};if ($vl_tb_droits_courhtm_fourni[0]==1) {fa_grise_non("pop_cour_htm");};break; //  Fournisseurs
    case "110005": if ($vl_tb_droits_courtex_autrac[0]==1) {fa_grise_non("pop_cour_tex");};if ($vl_tb_droits_courhtm_autrac[0]==1) {fa_grise_non("pop_cour_htm");};break; //  Autres
    case "110006": if ($vl_tb_droits_courtex_actind[0]==1) {fa_grise_non("pop_cour_tex");};if ($vl_tb_droits_courhtm_actind[0]==1) {fa_grise_non("pop_cour_htm");};break; //  Indéterminés
  }
}

]]></script>
END;
?>
