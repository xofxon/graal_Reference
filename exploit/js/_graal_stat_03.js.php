<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
var vf_c_url_alimente_table="_graal_das_stat_07.php?vl_e_art_cleunik=-1&";
const c_fen_stat='_graal_fen_graphiques_stat_01.php?';
const lstn_grise= { 
	willRebuild : function(event){},
	didRebuild  : function(event){pf_grise_fenetre_non();} 
};
function pf_acteur_ouvre(){
  var rowIndex = fa_cui("arbre_des_stats_cial_07");if(rowIndex == -1){return;}
  var vl_act_cleunik=fa_cell_get("arbre_des_stats_cial_07",rowIndex,"cleunik_reference");
  if (vl_act_cleunik==""){return;}
  fa_ouvre_acteur(fa_cell_get("arbre_des_stats_cial_07",rowIndex,"cleunik_reference")+"&"+"genreacteur="+fa_cell_get("arbre_des_stats_cial_07",rowIndex,"typeacteur"))
}
function pf_acteur_ouvre_stats(){
  var vl_c_param="";
  var rowIndex = fa_cui("arbre_des_stats_cial_07");if(rowIndex == -1){return;}
  var vl_act_cleunik=fa_cell_get("arbre_des_stats_cial_07",rowIndex,"cleunik_reference");
  if (vl_act_cleunik==""){return;}
	var typeacteur=fa_cell_get("arbre_des_stats_cial_07",rowIndex,"typeacteur");
	switch (typeacteur) {
    case "110003" :vl_c_param="genre=client_un&";break; 
    case "110001" :vl_c_param="genre=procli_un&";break;
    case "110004" :vl_c_param="genre=fourni_un&";break;
    case "110002" :vl_c_param="genre=profou_un&";break;
  }
	vl_c_param+='vl_e_act_cleunik='+vl_act_cleunik+'&';
  fa_ouvre(c_fen_stat+vl_c_param);
}
function pf_calcule(){
  var vl_c_param="";
  vl_c_param=vf_c_url_alimente_table+"raf_random="+Math.random()+"&";
  vl_c_param+="ml_panier_acteurs_01="+fa_mlget("ml_panier_acteurs_01")+"&";
      vl_c_param+="ml_art_02="+fa_value_get("ml_art_02")+"&";
      vl_c_param+="ml_art_03="+fa_value_get("ml_art_03")+"&";
      vl_c_param+="date_deb="+fa_value_get("ml_annee")+"&";
      fa_grise_fenetre("","oui");
      fa_das("arbre_des_stats_cial_07",vl_c_param);
}
function pf_calcule_excel(){
  var vl_c_param="";
  vl_c_param=vf_c_url_alimente_table+"raf_random="+Math.random()+"&";
      vl_c_param+="ml_art_02="+fa_value_get("ml_art_02")+"&";
      vl_c_param+="ml_art_03="+fa_value_get("ml_art_03")+"&";
      vl_c_param+="date_deb="+fa_value_get("ml_annee")+"&";
      vl_c_param+="sortie=xls&";
      fa_ouvre(vl_c_param);
}
function pf_change_menu(vv_qui) {
  var vo_list = fa_gid(vv_qui);
  var vo_item = vo_list.selectedItem;
	fa_att_set(vv_qui,"class",vo_item.getAttribute("class"));
}

function pf_couleur(num, color){
  fa_gid("colorpicker" + num).hidePopup();
  fa_gid("tb_0" + num).value =color;
  fa_gid("tb_0" + num).inputField.style.backgroundColor=color; 
}
function pf_dessin(){
  var vl_donnes="";
  var vl_affichage="";
  var vl_noms="";
   var wTree = fa_gid("arbre_des_stats_cial_07");
			var nb=fa_cl("arbre_des_stats_cial_07");
      for(var i=0;i<nb;i++){
        vl_donnes+=parseFloat(fa_dec(fa_se(wTree.view.getCellText( i ,wTree.columns["nombre_brut"] ))))+';';
        vl_affichage+=parseFloat(fa_dec(fa_se(wTree.view.getCellText( i ,wTree.columns["nombre_formatte"] ))))+';';
        vl_noms+=wTree.view.getCellText( i ,wTree.columns["periode"] )+';';
       }
  fa_value_set("datas",vl_affichage);  
  lien='_graal_svg_histo_01.php?large='+fa_enc(fa_value_get("large"));
  lien=lien+'&haut='+fa_enc(fa_value_get("haut"));
  lien=lien+'&titre='+fa_enc(fa_value_get("titre"));
  lien=lien+'&donnees='+fa_enc(vl_donnes);
  lien=lien+'&noms='+fa_enc(vl_noms);
  lien=lien+'&type='+fa_enc(fa_value_get("type"));
  lien=lien+'&col1='+fa_enc(fa_value_get("tb_01"));
  lien=lien+'&col2='+fa_enc(fa_value_get("tb_02"));
  lien=lien+'&col3='+fa_enc(fa_value_get("tb_03"));
  lien=lien+'&col4='+fa_enc(fa_value_get("tb_04"));
  fa_att_set("webFrame","src",lien);
}
function pf_init(){
  fa_badl('arbre_des_stats_cial_07',lstn_grise);
}
function pf_grise_fenetre_non(){
	fa_grise_fenetre("","non");
}
function pf_ouvre_stat(vv_arbre) {
  var rowIndex=0,vl_e_art_cleunik=-1,vl_c_param=""; 
  switch (vv_arbre) {
    case "arbre_des_stats_cial_07_art_tous":
      rowIndex=fa_cui("arbre_des_stats_cial_07_art_tous");if(rowIndex == -1){return;}
      vl_e_art_cleunik=fa_cell_get("arbre_des_stats_cial_07_art_tous",rowIndex,"art_cleunik")
      vl_c_param=vf_c_fen_stat_art_un+'vl_e_art_cleunik='+vl_e_art_cleunik+'&';
      switch (fa_value_get("ml_art_03")) {
        case 0: vl_c_param+='cial=offcli';break;
        case 1: vl_c_param+='cial=cdecli';break;
        case 2: vl_c_param+='cial=livcli';break;
        case 3: vl_c_param+='cial=faccli';break;
        case 4: vl_c_param+='cial=demfou';break;
        case 5: vl_c_param+='cial=cdefou';break;
        case 6: vl_c_param+='cial=recfou';break;
        case 7: vl_c_param+='cial=facfou';break;
      }
      break;
    case "arbre_des_stats_cial_07_act_tous":
      rowIndex=fa_cui("arbre_des_stats_cial_07_act_tous");if(rowIndex == -1){return;}
      vl_e_act_cleunik=fa_cell_get("arbre_des_stats_cial_07_act_tous",rowIndex,"act_cleunik")
      vl_c_param=vf_c_fen_stat_act_un+'vl_e_act_cleunik='+vl_e_act_cleunik+'&';
      switch (fa_cell_get("arbre_des_stats_cial_07_act_tous",rowIndex,"typeacteur")) {
        case "110003" :vl_c_param+="genre=client_un&";break; 
        case "110001" :vl_c_param+="genre=procli_un&";break;
        case "110004" :vl_c_param+="genre=fourni_un&";break;
        case "110002" :vl_c_param+="genre=profou_un&";break;
      }
      break;
    default:
      return;
  }
  fa_ouvre(vl_c_param)
}
$vl_c_recup_requete
function pf_onunload(){
	fa_brl("arbre_des_stats_cial_07",lstn_grise);
}
]]></script>
END;
?>
