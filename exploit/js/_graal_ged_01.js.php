<?php
$vl_mess_00003=fa_recup_session('mess_00003','');
$vl_mess_00004=fa_recup_session('mess_00004','');
$vl_mess_00005=fa_recup_session('mess_00005','');
$vl_mess_00006=fa_recup_session('mess_00006','');
if ($vl_c_voir_doc=="oui") {
$pf_sel_arbre_ged=<<<EOT
function pf_sel_arbre_ged(){
	var rowIndex = fa_cui("arbre_des_ged");
	if(rowIndex == -1){return;}
	var vl_e_doc_cleunik=fa_cell_get("arbre_des_ged",rowIndex,"doc_cleunik");
	pf07_voir_iframe_doc(vl_e_doc_cleunik,"ifr_doc");
}
EOT;
} else {
$pf_sel_arbre_ged=<<<EOT
function pf_sel_arbre_ged(){}
EOT;
}
$pf_ged_ajout=<<<EOT
function pf_ged_ajout(vv_quoi_01) {}
EOT;
if ($vl_c_genreged=="cgv"||$vl_c_genreged=="palett"||$vl_c_genreged=="filigrane"){
$pf_ged_ajout=<<<EOT
function pf_ged_ajout(vv_quoi_01) {
  var vl_c_param='portee_cleunik=0&doc_cleunik=-1&';
  switch (vv_quoi_01){
    case "ged_doc":
			pf07_ouvre_doc("quelsdocs=$vl_c_genreged&genre=entrep&"+vl_c_param);
      break;
  }
}
EOT;
$sel_date='fa05_sel_date("21","bem_tb_deb","bem_tb_fin");';	// ad vitam
} else {
	$sel_date='fa05_sel_date("1","bem_tb_deb","bem_tb_fin");';	//	aujourd'hui
}
echo <<<END
<script type="application/x-javascript"><![CDATA[
var vf_c_url_alimente_table,vf_valeur="";
var vf_c_renvoyer=false;
const vf_c_script_act="_graal_rech_ged_01.php?selection=$vl_c_selection&";
const c_script_favoris_partage='_graal_fen_favoris_partage_01.php?vf_c_type_favori=3&';
const lstn_grise = {
	willRebuild : function(event){}, 
	didRebuild  : function(event){fa_grise_fenetre(event,"non");} 
};
function pf_aa_ferme() {
  if (vf_c_renvoyer==true) {
    var vl_t_tableau=[];
    var vl_e_nb_sel;
    vl_t_tableau=fa_lignes_selectionnees("arbre_des_ged");
    vl_e_nb_sel=vl_t_tableau.length;
    if (vl_e_nb_sel!=0) {
      var vl_t_doc_cleunik=[];
      var vl_t_doc_nom=[];
      var vl_t_doc_titre=[];
      for(i=0;i<vl_e_nb_sel;i++) {
        vl_t_doc_cleunik[i]=fa_cell_get("arbre_des_ged",vl_t_tableau[i],"doc_cleunik");
        vl_t_doc_nom[i]=fa_cell_get("arbre_des_ged",vl_t_tableau[i],"emplacement");
        vl_t_doc_titre[i]=fa_cell_get("arbre_des_ged",vl_t_tableau[i],"titre");
      }
      switch ("$vl_c_quelsdocs") { 
        case "notes" :
          window.opener.pf_retour_fenetre_notes(vl_t_doc_cleunik,vl_t_doc_nom,vl_t_doc_titre);
          break;
        case "docs" :
          window.opener.pf_retour_fenetre_docs(vl_t_doc_cleunik,vl_t_doc_nom,vl_t_doc_titre);
          break;
		case "pseudodocs" :
          window.opener.pf_retour_fenetre_pseudodocs(vl_t_doc_cleunik,vl_t_doc_nom,vl_t_doc_titre);
          break;
        case "dossiers" :
          window.opener.pf_retour_fenetre_dossiers(vl_t_doc_cleunik,vl_t_doc_nom,vl_t_doc_titre);
          break;
      }  
    }
  }
}
function pf_affiche_donnees_ged() {
  pf07_approximatif();
}
function pf_favoris_partager() {
  var vl_c_param;
  var rowIndex = fa_cui("arbre_des_ged");if(rowIndex == -1){return;}
  vl_c_param="vf_e_cleunik="+fa_cell_get("arbre_des_ged",rowIndex,"doc_cleunik")+"&";
  vl_c_param+="raf_random="+Math.random()+"&";
  fa_ouvre(c_script_favoris_partage+vl_c_param,500,60);
}
$pf_ged_ajout
$pf_sel_arbre_ged
]]></script>
END;
?>
