<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
var vf_c_url_alimente_table;
const vf_c_script_sites_act='_graal_das_act_sites_01.php?sortie=das&';
const vf_c_script_fen_acteur="_graal_fen_acteurs_01.php?genreacteur=";
const vf_c_fen_site="_graal_fen_act_sites_01.php?";
const lstn_grise = { 
	willRebuild : function(event){fa_grise_oui("aai_tb_rechapproxima");fa_ro_oui("aai_tb_rechapproxima");fa_grise_fenetre(event,"oui");},
	didRebuild  : function(event){fa_grise_non("aai_tb_rechapproxima");fa_ro_non("aai_tb_rechapproxima");fa_grise_fenetre(event,"non");} 
};
//  Affectations
function pf_acteur_ouvre() {
  var rowIndex = fa_cui("arbre_sites_des_acteurs");if(rowIndex == -1){return;}
  var param=fa_cell_get("arbre_sites_des_acteurs",rowIndex,"tc_typeacteur")+"&act_cleunik="+fa_cell_get("arbre_sites_des_acteurs",rowIndex,"tc_act_cleunik_site")+"&";
  fa_ouvre(vf_c_script_fen_acteur+param,1000,800);
}
function pf_alimente_table() {
  switch (fa_value_get("aao_ml_qui")){
    case "9":
      fa_cache_non("portee");
      break;
    default:
      fa_cache_oui("portee");
      break;
  }
  fa_das("arbre_sites_des_acteurs",vf_c_url_alimente_table);
}
function pf_approximatif(){
    var vl_e_typeacteur=0;
    var vl_c_texte=fa_value_get("aai_tb_rechapproxima");
		fa_grise_oui("aai_tb_rechapproxima");fa_ro_oui("aai_tb_rechapproxima");
		fa_grise_fenetre("","oui"); 
    item=fa_gid("bao_ml_actif").selectedItem;  
    vf_c_url_alimente_table =vf_c_script_sites_act+'vf_c_genre=B&listecles=&vl_c_recherche='+fa_enc(vl_c_texte)+'&vl_e_typeacteur='+fa_value_get("bao_ml_qui")+'&vl_c_zone='+fa_value_get("aai_ml_zone")+'&vl_c_type='+fa_value_get("aai_ml_type")+'&vl_c_actifs='+fa_value_get("bao_ml_actif")+'&vl_e_panier='+item.getAttribute("_graal_cleunik")+"&limit="+fa_value_get("bao_tb_limit")+"&";
    pf_alimente_table();
}
function pf_atteindre_site() {
	var vl_c_param,i;
	i=fa_cui("arbre_sites_des_acteurs");if(i==-1){return;}
	vl_c_param=fa_cell_get("arbre_sites_des_acteurs",i,"tc_refweb");
	var vl_c_http=vl_c_param.substr(0,4);
	vl_c_http=vl_c_http.toLowerCase();
	if (vl_c_http!="http") {vl_c_param="http://"+vl_c_param;}
  fa_ouvre(vl_c_param,0,0);
}
function pf_etat_fen(vv_quoi){
   var vl_portee;
   switch(vv_quoi) {
     case "ini":
       fa_att_rem("arbre_sites_des_acteurs","onselect");
       fa_att_set("arbre_sites_des_acteurs","context","pop_selections");
				fa_badl("arbre_sites_des_acteurs",lstn_grise);
       fa_ael("bao_ml_qui","ValueChange",po_change_menu);
       po_change_menu();
       pf_approximatif()
       break;
     case "sortir":
       window.close();  //  Ne fonctionne que si c'est une nouvelle fenÃªtre
     break;   
	}
 }
function pf_onunload(){
	fa_brl("arbre_sites_des_acteurs",lstn_grise);	
}
function pf_site_ouvre() {
	var vl_c_param,i;
	i=fa_cui("arbre_sites_des_acteurs");if(i==-1){return;}
	vl_c_param="genreacteur="+fa_enc(fa_cell_get("arbre_sites_des_acteurs",i,"tc_typeacteur"))+"&";
  vl_c_param+='vl_e_site_cleunik='+fa_enc(fa_cell_get("arbre_sites_des_acteurs",i,"tc_site_cleunik"))+'&vl_e_act_cleunik='+fa_cell_get("arbre_sites_des_acteurs",i,"tc_act_cleunik_site")+'&';
  fa_ouvre(vf_c_fen_site+vl_c_param,600,600);
}
]]></script>
END;
?>
