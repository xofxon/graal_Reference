<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
const c_das_journaux="_graal_das_journaux_02.php?type=$vl_c_type&";
var vf_c_action,vf_c_export;
const lstn_grise = { 
	willRebuild : function(event){},
	didRebuild  : function(event){fa_grise_fenetre("","non");} 
};
function pf_aa_init() {
  fa05_sel_date("6","bbo_tb_deb","bbo_tb_fin");
  fa_badl("arbre_des_ecritures",lstn_grise);
}
function pf_alimente_defaut() {}
function pf_approximatif() {
	var vl_c_url_alimente_table="";
	vl_c_url_alimente_table=c_das_journaux+'?&raf_random='+Math.random();
	vl_c_url_alimente_table+='&vl_c_dateheuredebut='+fa_enc(fa_date_formate(fa_value_get("bbo_tb_deb"),"AAAAMMJJ"));
	vl_c_url_alimente_table+='&vl_c_dateheurefin='+fa_enc(fa_date_formate(fa_value_get("bbo_tb_fin"),"AAAAMMJJ"));
	vl_c_url_alimente_table+='&vl_journal_cleunik='+fa_mlget("ml_journal_remise");
	vl_c_url_alimente_table+='&vl_c_format_date='+fa_enc(fa_value_get("rdg_formatdate"));
	vf_c_export=vl_c_url_alimente_table+"&sortie=sql";
	fa_grise_fenetre("","oui");
	fa_das("arbre_des_ecritures",vl_c_url_alimente_table);
}
function pf_etat_fen(vv_quoi) {
  vf_c_action=vv_quoi;
  switch(vv_quoi) {
    case "sortir":
      window.close();
      break;
    default:
      break;
  }
  }
function pf_onunload(){
}
function pf_export_excel_01(vv_quoi){
	var vl_c_nom_fichier_xls=prompt("Nom du fichier","banques.xls");
	var vl_c_url="";
	vl_c_url=c_das_journaux+'?&raf_random='+Math.random();
	vl_c_url+='&vl_c_dateheuredebut='+fa_enc(fa_date_formate(fa_value_get("bbo_tb_deb"),"AAAAMMJJ"));
	vl_c_url+='&vl_c_dateheurefin='+fa_enc(fa_date_formate(fa_value_get("bbo_tb_fin"),"AAAAMMJJ"));
	vl_c_url+='&vl_journal_cleunik='+fa_mlget("ml_journal_remise");
	vl_c_url+='&sortie=excel_01';
	vl_c_url+='&vl_c_nature_export='+vv_quoi;
	vl_c_url+="&vl_c_nom_fichier_xls="+fa_enc(vl_c_nom_fichier_xls)+"&";
	fa_ouvre(vl_c_url);
}

function pf_recup_sql(vv_quoi){
	fa_xmlhttprequest_txt(vf_c_export,"",pf_recup_sql_fin,vv_quoi);
}
function pf_recup_sql_fin(stream,vv_quoi){
	switch (vv_quoi){
		case "ods":fa_exporte_requete_vers_ods(stream);break;
		case "rdf":fa_exporte_requete_vers_rdf(stream);break;
		case "htm":fa_exporte_requete_vers_htm(stream);break;
		case "xml":fa_exporte_requete_vers_xml(stream);break;
		case "xls":fa_exporte_requete_vers_xls(stream);break;
	}
}
]]></script>
END;
?>
