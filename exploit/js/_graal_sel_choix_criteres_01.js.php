<?php
$vl_mess_00010=fa_recup_dico_js('mess_00010','');
$vl_mess_00012=fa_recup_dico_js('mess_00012','');
switch ($vl_e_domaine){
	case $vl_e_acteur:
		$vf_c_script_critere_potentiel="_graal_das_criteres_potentiels_acteurs.php?portee=$vl_e_portee&genrecritere=$vl_c_genrecritere&genreacteur=$vl_c_genre&";
	  	$vf_c_script_nouveaux_criteres="_graal_fen_criteres_acteurs.php?fausseportee=$vl_e_portee&portee=$vl_e_portee&";
	  	$vf_c_script_nouveaux_choix="_graal_fen_choix_criteres_acteurs.php?portee=$vl_e_portee&";
	  	$vf_c_script_choix="_graal_das_choix_critere_01.php?vl_c_nombre=acteurs&vl_c_etat=1&";
		break;	
	case $vl_e_interl:
		$vf_c_script_critere_potentiel="_graal_das_criteres_potentiels_interlos.php?portee=$vl_e_portee&genrecritere=$vl_c_genrecritere&genreacteur=$vl_c_genre&";
	  	$vf_c_script_nouveaux_criteres="_graal_fen_criteres_interlocuteurs.php?fausseportee=$vl_e_portee&portee=$vl_e_portee&";
	  	$vf_c_script_nouveaux_choix="_graal_fen_choix_criteres_interlocuteurs.php?portee=$vl_e_portee&";
	  	$vf_c_script_choix="_graal_das_choix_critere_01.php?vl_c_nombre=interlocuteurs&vl_c_etat=1&";
		break;
	case $vl_e_articl:
		$vf_c_script_critere_potentiel="_graal_das_criteres_potentiels_articles.php?portee=$vl_e_portee&genrecritere=$vl_c_genrecritere&genreacteur=$vl_c_genre&";
	  	$vf_c_script_nouveaux_criteres="_graal_fen_criteres_articles.php?fausseportee=$vl_e_portee&portee=$vl_e_portee&";
	  	$vf_c_script_nouveaux_choix="_graal_fen_choix_criteres_articles.php?portee=$vl_e_portee&";
	  	$vf_c_script_choix="_graal_das_choix_critere_01.php?vl_c_nombre=articles&vl_c_etat=1&";
		break;		  
}

echo <<<END
<script type="application/x-javascript"><![CDATA[
var vf_e_critere_cleunik,vf_e_choix_cleunik,vf_e_critere_cleunik,vf_e_choix_cleunik,vf_e_critere_codechoixpertinent;
const vf_c_script_critere_potentiel="$vf_c_script_critere_potentiel";
const vf_c_script_choix="$vf_c_script_choix";
const vf_c_fen_stats_fr="_graal_fen_stats_fr_02.php?quelnocritere=";
const vf_c_script_nouveaux_criteres="$vf_c_script_nouveaux_criteres";
const vf_c_script_nouveaux_choix="$vf_c_script_nouveaux_choix";
const vf_c_script_langues="_graal_fen_critere_01.php?";
function pf_aa_init() {
  pf_affiche_criteres_potentiel();
}
function pf_affiche_criteres_potentiel(){
  var vl_c_param=vf_c_script_critere_potentiel+"raf_random="+Math.random();
  fa_das("arb_criteres",vl_c_param);
}
function pf_affiche_choix_criteres_potentiel() {
  var vl_c_param=vf_c_script_choix+"vl_c_critere_cleunik="+vf_e_critere_cleunik+"&raf_random="+Math.random()+"&vl_c_position="+fa_value_get("rdg_position")+"&";
  fa_das("arb_choix_criteres",vl_c_param);
}
function pf_etat_fen(vv_quoi){
  var vl_portee;
  switch(vv_quoi) {
    case "ini":
      break;
    case "sortir":
      window.close();  //  Ne fonctionne que si c'est une nouvelle fenêtre
      break;   
    default:
      break;
  }
}
function pf_fin_requete(stream) {
  var vl_datas = stream;
  if (vl_datas=="ok") {
      pf_affiche_criteres();
      pf_affiche_choix_criteres_potentiel();
    } 
  else {
    alert(vl_datas);
    pf_etat_fen("annuler");
    }
}
function pf_nouveaux_choix() {
  switch (vf_e_critere_cleunik) {
    case "A"  : return;break;
    case "59" : fa_ouvre(vf_c_script_langues+"quelnocritere=59",600,400);break; 
    case "60" : fa_ouvre(vf_c_script_langues+"quelnocritere=60",600,400);break;
    default   : 
    fa_ouvre(vf_c_script_nouveaux_choix+"critere_cleunik="+vf_e_critere_cleunik+"&per="+vf_e_critere_codechoixpertinent,1000,600);break;
  }
}
function pf_nouveaux_criteres() {
  fa_ouvre(vf_c_script_nouveaux_criteres,1000,600)
}
function pf_ouvre_criteres_particuliers() {
  var vl_c_param="";
  var vl_te_act_cleunik=[];
  vl_te_act_cleunik[0]="-1";  //  ne sert qu'à ne pas planter: a priori, il faut au moins 2 dimensions pour être considéré comme un tableau
  vl_te_act_cleunik[1]="$vl_e_act_cleunik";
  vl_c_param+=vf_c_fen_stats_fr+fa_gid("ml_criteres_particuliers").selectedItem.getAttribute("_graal_cleunik_critere")+"&vl_te_act_cleunik="+vl_te_act_cleunik+"&";
  vl_c_param+="genrecritere=$vl_c_genrecritere&genreacteur=$vl_c_genreacteur&";
  fa_ouvre(vl_c_param,600,400)
}
function pf_raz_fiche() {}

function pf_renvoie() {
  var vl_e_critere_cleunik=0,vl_e_choix_cleunik=0,vl_c_critere_denomination="",vl_c_choix_valeur_texte_01="";
  var rowIndex=fa_cui('arb_criteres');
  vl_e_critere_cleunik=fa_cell_get("arb_criteres",rowIndex,"critere_cleunik");
  vl_c_critere_denomination=fa_cell_get("arb_criteres",rowIndex,"critere_denomination");
  rowIndex =fa_cui('arb_choix_criteres');
  vl_e_choix_cleunik=fa_cell_get("arb_choix_criteres",rowIndex,"choix_cleunik");
  vl_c_choix_valeur_texte_01=fa_cell_get("arb_choix_criteres",rowIndex,"choix_valeur_texte_01");
  window.opener.pf_ouvre_choix_critere_recup(vf_e_critere_cleunik,vf_e_choix_cleunik,vl_c_critere_denomination,vl_c_choix_valeur_texte_01);
  close();
}
function pf_sel_arbre_criteres() {
  var rowIndex =fa_cui('arb_criteres');if(rowIndex == -1){return;}
  var vl_e_choix_multiples;
  vf_e_choix_cleunik=0;
  vf_e_critere_cleunik=fa_cell_get("arb_criteres",rowIndex,"critere_cleunik");  //  Clé unique critère
  vl_e_choix_multiples=fa_cell_get("arb_criteres",rowIndex,"critere_choixmultiples");  //  Si choix multiple ?
  vf_e_critere_codechoixpertinent=fa_cell_get("arb_criteres",rowIndex,"critere_codechoixpertinent");  //  Si code choix pertinent ?
  if (vf_e_critere_codechoixpertinent==2) {fa_cache_oui("choix_code");} else {fa_cache_non("choix_code");}
  if (vl_e_choix_multiples==1) {fa_att_set("arb_choix_criteres",'seltype', 'multiple');} else {fa_att_set("arb_choix_criteres",'seltype', 'single');} 
  pf_affiche_choix_criteres_potentiel();
}
function pf_sel_arbre_choix() {
  var rowIndex =fa_cui('arb_choix_criteres');if(rowIndex == -1){return;}
  vf_e_choix_cleunik=fa_cell_get("arb_choix_criteres",rowIndex,"choix_cleunik");  //  Clé unique choix
}

]]></script>
END;
?>
