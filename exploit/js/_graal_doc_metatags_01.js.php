<?php
echo <<<END
<script type="application/x-javascript"><![CDATA[
var vf_e_doc_cleunik;
const vf_c_script_meta='_graal_das_metatag_keyword_03.php?genre=keyword&';
const vf_c_script_bdope_fen="_graal_bdope_metatags_01.php?typedoc=$vl_e_typedoc&";
const vf_e_critere_cleunik=120;
function pf_alimente_table() {
  var vl_c_param=vf_c_script_meta+'vl_c_url='+fa_gid("_graal_doc_metatags_01").getAttribute("_graal_url")+"&raf_random="+Math.random();
  fa_das("arbre_metatags",vl_c_param);
}
function pf_etat_fen(vv_quoi){
  vf_c_action=vv_quoi;
  switch(vv_quoi) {
    case "ini":
      vf_e_doc_cleunik=fa_gid("_graal_doc_metatags_01").getAttribute("_graal_cleunik");
      pf_alimente_table();
      break;
    case "sortir":
      window.close();
      break;   
  }
}
function pf_fin_requete(stream){
  var vl_c_datas = stream;
  alert(vl_c_datas)
  window.opener.pf_affiche_criteres_ged();
  pf_etat_fen('sortir');
}
function pf_validation(vv_quoi) {
  var vl_t_tableau=[];
  var vl_e_nb_sel;
  var vl_c_donnees="";
  var t1="";
  vl_t_tableau=fa_lignes_selectionnees("arbre_metatags");
  vl_e_nb_sel=vl_t_tableau.length;
  switch (vl_e_nb_sel) {
    case 0:
      return;
      break;
    default:
      //  On initialise le tableau des geds avec une dimension inutile sinon cela plante quand on n'a qu'un seule dimension
      for(i=0;i<vl_e_nb_sel;i++) {
        t1+=fa_cell_get("arbre_metatags",vl_t_tableau[i],"tag")+',';
      }
      t1=t1.substring(0,t1.length-1)
      vl_c_donnees+="genrecritere="+fa_gid("_graal_doc_metatags_01").getAttribute("_graal_genre_critere")+"&";
      vl_c_donnees+="vl_doc_cleunik="+vf_e_doc_cleunik+"&";
      vl_c_donnees+="vl_critere_cleunik="+vf_e_critere_cleunik+"&";
      vl_c_donnees+="vf_c_action=enregistrer_kilometre&"
      vl_c_donnees+="t1="+fa_enc(window.btoa(t1))+"&";
      break;
  }
  fa_xmlhttprequest_txt(vf_c_script_bdope_fen,vl_c_donnees,pf_fin_requete);
//  fa_ouvre(vf_c_script_bdope_fen+vl_c_donnees)
}
]]></script>
END;
?>
