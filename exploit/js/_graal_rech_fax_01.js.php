<?php
switch ($vl_c_type_recherche) {
	case "normal":
	$pf_approximatif=<<<EOT
	fa_grise_fenetre("","oui");
	fa_grise_oui("bcl_tb_rechapproxima");fa_ro_oui("bcl_tb_rechapproxima");
  	var vl_c_texte=fa_value_get("bcl_tb_rechapproxima");
  	item=fa_gid("bao_ml_actif").selectedItem;
  	vf_c_url_alimente_table =vf_c_script_recherche+'?listecles=&raisonsoc='+fa_enc(vl_c_texte)+'&typeacteur='+fa_value_get("bcl_ml_qui")+'&quoi='+fa_value_get("bcl_ml_zone");
  	vf_c_url_alimente_table+='&vl_c_actifs='+fa_value_get("bao_ml_actif")+'&vl_e_panier='+item.getAttribute("_graal_cleunik")+'&vl_e_limit='+fa_value_get("bcl_tb_limit")+"&";
  	pf_alimente_table();
EOT;
	break;
	case "interl":
		$pf_approximatif=<<<EOT
	fa_grise_fenetre("","oui");
  	vf_c_url_alimente_table =vf_c_script_recherche+"?vl_c_type_requete=2&vl_e_int_cleunik=$vl_e_int_cleunik&";
  	pf_alimente_table();
EOT;
	break;
	case "acteur":
		$pf_approximatif=<<<EOT
	fa_grise_fenetre("","oui");
  	vf_c_url_alimente_table =vf_c_script_recherche+"?vl_c_type_requete=3&vl_e_act_cleunik=$vl_e_act_cleunik&";
  	pf_alimente_table();
EOT;
	break;
}
echo <<<END
<script type="application/x-javascript"><![CDATA[
var vf_c_url_alimente_table;
const vf_c_script_recherche='_graal_das_rech_fax_01.php';
const vf_c_script_fen_acteur="_graal_fen_acteurs_01.php?genreacteur=";
const c_fen_interlo_fax="_graal_fen_act_interlo_fax_01.php?";
const lstn_grise = { 
	willRebuild : function(event){fa_grise_oui("bcl_tb_rechapproxima");fa_ro_oui("bcl_tb_rechapproxima");fa_grise_fenetre(event,"oui");},
	didRebuild  : function(event){fa_grise_non("bcl_tb_rechapproxima");fa_ro_non("bcl_tb_rechapproxima");fa_grise_fenetre(event,"non");} 
};
function pf_acteur_ouvre() {
  var vl_c_arbre="arbre_des_fax_interlo_act";
  var i=fa_cui(vl_c_arbre);if(i==-1){return;}
  var vl_c_param=fa_cell_get(vl_c_arbre,i,"typeacteur")+'&act_cleunik='+fa_cell_get(vl_c_arbre,i,"act_cleunik")+"&";
  fa_ouvre(vf_c_script_fen_acteur+vl_c_param,1000,600);
}
function pf_alimente_table(){
  switch (fa_value_get("bcl_ml_qui")) {
    case "9":fa_cache_non("portee");break;
    default:
      fa_cache_oui("portee");
      break;
  }
	fa_das("arbre_des_fax_interlo_act",vf_c_url_alimente_table);
}
function pf_approximatif(){
$pf_approximatif
}
function pf_etat_fen(vv_quoi) {
	switch (vv_quoi) {
		case "ini":
			fa_focusdonne('bcl_tb_rechapproxima');
			switch ("$vl_c_p02"){
				case "Fen_01026":
				case "Fen_01027":
				case "emifax":
					fa_cache_non('bt_renvoyer_valeur');
					break;
				default:
					break;
			}
			fa_badl("arbre_des_fax_interlo_act",lstn_grise);
		  pf_approximatif();
			break;
		case "sortir":
			window.close();
			break;
		case "renvoyer":
			var rowIndex = fa_cui("arbre_des_fax_interlo_act");if(rowIndex == -1){return;}
  			var vl_e_intel_cleunik=fa_cell_get("arbre_des_fax_interlo_act",rowIndex,"intel_cleunik");
  			if (window.opener!=null) {
      		try {
         		window.opener.$vl_c_fonction_retour(vl_e_intel_cleunik);
        		 window.close();
		      } catch(e) {
		         alert(e)
		      }
		    }
			break;
	}
}
function pf_interlo_ouvre() {
  var vl_c_arbre="arbre_des_fax_interlo_act";
  var i=fa_cui(vl_c_arbre);if(i==-1){return;}
  var vl_c_param="genreacteur="+fa_cell_get(vl_c_arbre,i,"typeacteur")+"&vl_e_interlo_cleunik="+fa_cell_get(vl_c_arbre,i,"int_cleunik");
  vl_c_param+='&vl_e_act_cleunik='+fa_cell_get(vl_c_arbre,i,"act_cleunik")+"&";
  fa_ouvre_interlo(vl_c_param);
}
function pf_interlo_ouvre_fax() {
  var vl_c_arbre="arbre_des_fax_interlo_act";
  var i=fa_cui(vl_c_arbre);if(i==-1){return;}
  var vl_c_param="genreacteur="+fa_cell_get(vl_c_arbre,i,"typeacteur")+"&";
  vl_c_param+='&vl_e_intel_cleunik='+fa_cell_get(vl_c_arbre,i,"intel_cleunik")+"&";
  fa_ouvre(c_fen_interlo_fax+vl_c_param,800,410);
}
function pf_onunload(){
	fa_brl("arbre_des_fax_interlo_act",lstn_grise);	
}
]]></script>
END;
