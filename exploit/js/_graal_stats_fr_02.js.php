<?php
$constant_n1=0;
$constant_n2=0;
$constant_n3=0;
$constant_n4=0;
$constant_n5=0;
$constant_n6=0;
$constant_n7=0;
switch ($vl_e_cleunik_critere) {
  case 11: //Professions et Catégories Socio-professionnelles
    $constant_n1 = 11;				     //	Clé unik du niveau 1 des Professions et Catégories Socioprofessionnelles (source INSEE)
    $constant_n2 = 12;				     //	Clé unik du niveau 2 des Professions et Catégories Socioprofessionnelles (source INSEE)
    $constant_n3 = 13;				     //	Clé unik du niveau 3 des Professions et Catégories Socioprofessionnelles (source INSEE)
    $constant_n4 = 14;				     //	Clé unik du niveau 4 des Professions et Catégories Socioprofessionnelles (source INSEE)
    $niv_max=3;
    $vl_c_script_bdope_fen="_graal_bdope_act_criteres_01.php";
    break;
  case 21: //Nomenclature d'activités Françaises
    $constant_n1 = 21;				     //	Clé unik du niveau 1 des NAF-Nomenclatures d'Activités Française (source INSEE)
    $constant_n2 = 22;				     //	Clé unik du niveau 2 des NAF-Nomenclatures d'Activités Française (source INSEE)
    $constant_n3 = 23;				     //	Clé unik du niveau 3 des NAF-Nomenclatures d'Activités Française (source INSEE)
    $constant_n4 = 24;				   //	Clé unik du niveau 4 des NAF-Nomenclatures d'Activités Française (source INSEE)
    $constant_n5 = 25;				//	Clé unik du niveau 5 des NAF-Nomenclatures d'Activités Française (source INSEE)
    $niv_max=4;
    $vl_c_script_bdope_fen="_graal_bdope_act_criteres_01.php";
    break;  
  case 31: //Classification des Produits Français
    $constant_n1 = 31;				//	Clé unik du niveau 1 des CPF-Classification des produits Francaise (source INSEE)
    $constant_n2 = 32;				//	Clé unik du niveau 2 des CPF-Classification des produits Francaise (source INSEE)
    $constant_n3 = 33;				//	Clé unik du niveau 3 des CPF-Classification des produits Francaise (source INSEE)
    $constant_n4 = 34;				//	Clé unik du niveau 4 des CPF-Classification des produits Francaise (source INSEE)
    $constant_n5 = 35;				//	Clé unik du niveau 5 des CPF-Classification des produits Francaise (source INSEE)
    $constant_n6 = 36;				//	Clé unik du niveau 6 des CPF-Classification des produits Francaise (source INSEE)
    $constant_n7 = 37;				//	Clé unik du niveau 7 des CPF-Classification des produits Francaise (source INSEE)
    $niv_max=6;
    $vl_c_script_bdope_fen="_graal_bdope_art_criteres_01.php";
    break;  
  case 41: //Catégories Juridiques
    $constant_n1 = 41;					//	Clé unik du niveau 1 des CJ-Catégories juridiques (source INSEE)
    $constant_n2 = 42;					//	Clé unik du niveau 2 des CJ-Catégories juridiques (source INSEE)
    $constant_n3 = 43;					//	Clé unik du niveau 3 des CJ-Catégories juridiques (source INSEE)
    $niv_max=2;
    $vl_c_script_bdope_fen="_graal_bdope_act_criteres_01.php";
    break;  
  case 51: //Nomenclatures Econimiques de Synthèse
    $constant_n1 = 51;				//	Clé unik du niveau 1 des NES-nomenclatures économiques de synthèse (source INSEE)
    $constant_n2 = 52;				//	Clé unik du niveau 2 des NES-nomenclatures économiques de synthèse (source INSEE)
    $constant_n3 = 53;				//	Clé unik du niveau 3 des NES-nomenclatures économiques de synthèse (source INSEE)
    $niv_max=2;
    $vl_c_script_bdope_fen="_graal_bdope_act_criteres_01.php";
    break;  
}
echo <<<END
<script type="application/x-javascript"><![CDATA[
const constant_critere_cleunik_pere=$vl_e_cleunik_critere;
const constant_niveau_max=$niv_max;
const constant_te_act_cleunik=new Array($vl_te_act_cleunik);
const vf_c_script_bdope_fen="$vl_c_script_bdope_fen?genrecritere=$vl_c_genrecritere&genreacteur=$vl_e_genreacteur";
const vf_tc_php=new Array("_graal_das_stats_fr_01.php", "_graal_das_stats_fr_02.php", "_graal_das_stats_fr_02.php", "_graal_das_stats_fr_02.php", "_graal_das_stats_fr_02.php", "_graal_das_stats_fr_02.php", "_graal_das_stats_fr_02.php");
const vf_tc_nomliste=new Array("list_01","list_02","list_03","list_04","list_05","list_06","list_07");
const vf_tc_champs_01=new Array("tb_01","tb_02","tb_03","tb_04","tb_05","tb_06","tb_07");
const vf_tc_champs_02=new Array("tbc_01","tbc_02","tbc_03","tbc_04","tbc_05","tbc_06","tbc_07");
const vf_te_critere_cleunik=new Array($constant_n1,$constant_n2,$constant_n3,$constant_n4,$constant_n5,$constant_n6,$constant_n7);
var vf_te_choix_cleunik=new Array(0,0,0,0,0,0,0);
var vf_e_critere_cleunik_fils,vf_c_action,vf_e_niveau;
function pf_alimente_liste(vv_niveau) {
  var vl_liste = fa_gid(vf_tc_nomliste[vv_niveau]);
  var raf_random=Math.random();
  var vl_c_fic="";
  vf_e_niveau=vv_niveau;
  switch (vv_niveau) {
    case 0 : 
      vl_c_fic=vf_tc_php[0]+"?vf_e_critere_cleunik_pere="+vf_te_critere_cleunik[0]+"&raf01="+raf_random;
      break;
    case 1 : case 2 : case 3 : case 4 : case 5 : case 6 :
      vl_c_fic=vf_tc_php[vv_niveau]+"?vf_e_critere_cleunik_pere="+vf_te_critere_cleunik[vv_niveau-1]+"&vf_e_critere_cleunik_fils="+vf_te_critere_cleunik[vv_niveau]+"&vf_e_choix_cleunik_pere="+vf_te_choix_cleunik[vv_niveau-1]+"&raf01="+raf_random;
      break;
  }
  fa_das(vf_tc_nomliste[vv_niveau],vl_c_fic);
}
function pf_construction_a_faire(aEvnt){	
  //alert("will rebulid");
}
function pf_construction_faite(aEvnt){
  var vf_e_timeout=100;
  if (vf_e_niveau==0) {vf_e_timeout=200;} //  C'est plus long la première fois
  setTimeout('pf_construction_faite_suite()',vf_e_timeout)	
}
function pf_construction_faite_suite() {
  var vl_liste = fa_gid(vf_tc_nomliste[vf_e_niveau]);
  fa_focusdonne(vf_tc_nomliste[vf_e_niveau])
  vl_liste.selectedIndex=0;
  pf_sel_ligne(vf_e_niveau)
}
function pf_etat_fen(vv_quoi) {
  vf_c_action=vv_quoi;
  var vl_gb;
  switch(vv_quoi) {
      case "annuler" :
        vf_e_niveau=0;
        fa_gid('dk_01').selectedIndex=vf_e_niveau;
        fa_grise_oui('bt_suiv');
        fa_grise_oui('bt_precedent');
        fa_grise_oui('bt_enregistrer');
        fa_focusdonne(vf_tc_nomliste[0])
        pf_sel_ligne(0)      
        break;
      case "ini": 
        vf_e_niveau=0;
        fa_grise_oui('bt_suiv');
        fa_grise_oui('bt_precedent');
        fa_grise_oui('bt_enregistrer');      
        var lstn = { 
          willRebuild : function(event){pf_construction_a_faire(event);},
          didRebuild  : function(event){pf_construction_faite(event);} 
        };
				fa_badl("list_01",lstn);
				fa_badl("list_02",lstn);
				fa_badl("list_03",lstn);
				fa_badl("list_04",lstn);
				fa_badl("list_05",lstn);
				fa_badl("list_06",lstn);
				fa_badl("list_07",lstn);
        pf_alimente_liste(0);
        break;
      case "precedent" :
        if (vf_e_niveau==0) {return;}
        vf_e_niveau--;
        fa_gid('dk_01').selectedIndex=vf_e_niveau;
        if (vf_e_niveau==0) {fa_grise_oui('bt_precedent');}
        fa_focusdonne(vf_tc_nomliste[vf_e_niveau])
        pf_sel_ligne(vf_e_niveau)
        break;
      case "sortir":
        window.close();
        break;   
      case "suivant" :
        var vl_liste = fa_gid(vf_tc_nomliste[vf_e_niveau]);
        var vl_e_nb = vl_liste.selectedCount
        if (vl_e_nb==0) {return;}
        vf_e_niveau++;
        fa_gid('dk_01').selectedIndex=vf_e_niveau;
        fa_grise_oui('bt_suivant');
        fa_grise_non('bt_precedent');
        pf_alimente_liste(vf_e_niveau);
        break;
    }
}
function pf_sel_ligne(vv_niveau) {
  var vl_liste = fa_gid(vf_tc_nomliste[vv_niveau]);
  var vl_e_nb = vl_liste.selectedCount
  if (vl_e_nb!=0) {
    fa_value_set(vf_tc_champs_01[vv_niveau],vl_liste.selectedItem.label)
    fa_value_set(vf_tc_champs_02[vv_niveau],vl_liste.selectedItem.getAttribute("_graal_code"))
    vf_te_choix_cleunik[vv_niveau]=vl_liste.selectedItem.value;

    fa_value_set("tb_101",fa_value_get(vf_tc_champs_01[0]))
    fa_value_set("tb_201",fa_value_get(vf_tc_champs_01[0]))
    fa_value_set("tb_301",fa_value_get(vf_tc_champs_01[0]))
    fa_value_set("tb_401",fa_value_get(vf_tc_champs_01[0]))
    fa_value_set("tb_501",fa_value_get(vf_tc_champs_01[0]))
    fa_value_set("tb_601",fa_value_get(vf_tc_champs_01[0]))
    fa_value_set("tb_701",fa_value_get(vf_tc_champs_01[0]))

    fa_value_set("tb_202",fa_value_get(vf_tc_champs_01[1]))
    fa_value_set("tb_302",fa_value_get(vf_tc_champs_01[1]))
    fa_value_set("tb_402",fa_value_get(vf_tc_champs_01[1]))
    fa_value_set("tb_502",fa_value_get(vf_tc_champs_01[1]))
    fa_value_set("tb_602",fa_value_get(vf_tc_champs_01[1]))
    fa_value_set("tb_702",fa_value_get(vf_tc_champs_01[1]))


    fa_value_set("tb_303",fa_value_get(vf_tc_champs_01[2]))
    fa_value_set("tb_403",fa_value_get(vf_tc_champs_01[2]))
    fa_value_set("tb_503",fa_value_get(vf_tc_champs_01[2]))
    fa_value_set("tb_603",fa_value_get(vf_tc_champs_01[2]))
    fa_value_set("tb_703",fa_value_get(vf_tc_champs_01[2]))

    fa_value_set("tb_404",fa_value_get(vf_tc_champs_01[3]))
    fa_value_set("tb_504",fa_value_get(vf_tc_champs_01[3]))
    fa_value_set("tb_604",fa_value_get(vf_tc_champs_01[3]))
    fa_value_set("tb_704",fa_value_get(vf_tc_champs_01[3]))

    fa_value_set("tb_505",fa_value_get(vf_tc_champs_01[4]))
    fa_value_set("tb_605",fa_value_get(vf_tc_champs_01[4]))
    fa_value_set("tb_705",fa_value_get(vf_tc_champs_01[4]))

    fa_value_set("tb_606",fa_value_get(vf_tc_champs_01[5]))
    fa_value_set("tb_706",fa_value_get(vf_tc_champs_01[5]))

    fa_value_set("tb_707",fa_value_get(vf_tc_champs_01[6]))

    fa_value_set("tbc_101",fa_value_get(vf_tc_champs_02[0]))
    fa_value_set("tbc_201",fa_value_get(vf_tc_champs_02[0]))
    fa_value_set("tbc_301",fa_value_get(vf_tc_champs_02[0]))
    fa_value_set("tbc_401",fa_value_get(vf_tc_champs_02[0]))
    fa_value_set("tbc_501",fa_value_get(vf_tc_champs_02[0]))
    fa_value_set("tbc_601",fa_value_get(vf_tc_champs_02[0]))
    fa_value_set("tbc_701",fa_value_get(vf_tc_champs_02[0]))

    fa_value_set("tbc_202",fa_value_get(vf_tc_champs_02[1]))
    fa_value_set("tbc_302",fa_value_get(vf_tc_champs_02[1]))
    fa_value_set("tbc_402",fa_value_get(vf_tc_champs_02[1]))
    fa_value_set("tbc_502",fa_value_get(vf_tc_champs_02[1]))
    fa_value_set("tbc_602",fa_value_get(vf_tc_champs_02[1]))
    fa_value_set("tbc_702",fa_value_get(vf_tc_champs_02[1]))


    fa_value_set("tbc_303",fa_value_get(vf_tc_champs_02[2]))
    fa_value_set("tbc_403",fa_value_get(vf_tc_champs_02[2]))
    fa_value_set("tbc_503",fa_value_get(vf_tc_champs_02[2]))
    fa_value_set("tbc_603",fa_value_get(vf_tc_champs_02[2]))
    fa_value_set("tbc_703",fa_value_get(vf_tc_champs_02[2]))

    fa_value_set("tbc_404",fa_value_get(vf_tc_champs_02[3]))
    fa_value_set("tbc_504",fa_value_get(vf_tc_champs_02[3]))
    fa_value_set("tbc_604",fa_value_get(vf_tc_champs_02[3]))
    fa_value_set("tbc_704",fa_value_get(vf_tc_champs_02[3]))

    fa_value_set("tbc_505",fa_value_get(vf_tc_champs_02[4]))
    fa_value_set("tbc_605",fa_value_get(vf_tc_champs_02[4]))
    fa_value_set("tbc_705",fa_value_get(vf_tc_champs_02[4]))

    fa_value_set("tbc_606",fa_value_get(vf_tc_champs_02[5]))
    fa_value_set("tbc_706",fa_value_get(vf_tc_champs_02[5]))

    fa_value_set("tbc_707",fa_value_get(vf_tc_champs_02[6]))
    if (constant_niveau_max==vf_e_niveau) {
      fa_grise_non('bt_enregistrer');
    } else {
      fa_grise_non('bt_suivant');
    }
  }
}
function pf_validation(vv_quoi) {
  var vl_c_donnees="";
  switch(vv_quoi) {
    case "enregistrer":
      switch (constant_critere_cleunik_pere) {
        case 31:  //  articles
          vl_c_donnees+="vl_te_art_cleunik="+fa_enc(fa_jsarray2php_00(constant_te_act_cleunik))+"&";
          vl_c_donnees+="vl_te_choix_cleunik="+fa_enc(fa_jsarray2php_00(vf_te_choix_cleunik))+"&";
          vl_c_donnees+="vl_te_critere_cleunik="+fa_enc(fa_jsarray2php_00(vf_te_critere_cleunik))+"&";
          vl_c_donnees+="vf_c_action=enregistrer_kilometre&";
        default :
          vl_c_donnees+="vl_te_act_cleunik="+fa_enc(fa_jsarray2php_00(constant_te_act_cleunik))+"&";
          vl_c_donnees+="vl_te_choix_cleunik="+fa_enc(fa_jsarray2php_00(vf_te_choix_cleunik))+"&";
          vl_c_donnees+="vl_te_critere_cleunik="+fa_enc(fa_jsarray2php_00(vf_te_critere_cleunik))+"&";
          vl_c_donnees+="vf_c_action=enregistrer_kilometre&";
      }
      break;
  }
  fa_xmlhttprequest_txt(vf_c_script_bdope_fen,vl_c_donnees,pf_validation_fin);
}
function pf_validation_fin(stream) {
  var vl_datas = stream;
  pf_etat_fen("sortir");
}
]]></script>
END;
?>
