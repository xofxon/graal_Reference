<?php
include("_graal_header_xul.inc.php");
$vl_c_id_fenetre="Fen_00511";
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vf_imp_cleunik=intval(fa_recup_param('vf_imp_cleunik',-1));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);
$vl_b_acces=$vl_tb_droits[0];
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=1;
if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_dico_00005=fa_recup_dico('dico_00005');
$vl_c_bgm_100=fa_recup_dico("bgm_100");
$vl_c_bgm_101=fa_recup_dico("bgm_101");
$vl_c_bgm_102=fa_recup_dico("bgm_102");
$vl_c_bgm_103=fa_recup_dico("bgm_103");
$vl_c_bgm_104=fa_recup_dico("bgm_104");
$vl_c_bgm_105=fa_recup_dico("bgm_105");
$vl_c_bgm_106=fa_recup_dico("bgm_106");
$vl_c_bgm_107=fa_recup_dico("bgm_107");
$vl_c_bgm_108=fa_recup_dico("bgm_108");
$vl_c_bgm_109=fa_recup_dico("bgm_109");
$vl_c_bgm_110=fa_recup_dico("bgm_110");
$vl_c_bgm_111=fa_recup_dico("bgm_111");
$vl_c_bgm_112=fa_recup_dico("bgm_112");
$vl_c_bgm_113=fa_recup_dico("bgm_113");
$vl_c_bgm_114=fa_recup_dico("bgm_114");
$vl_c_bgm_115=fa_recup_dico("bgm_115");
$vl_c_bgm_119=fa_recup_dico("bgm_119");
$vl_c_bgm_120=fa_recup_dico("bgm_120");
$vl_c_bgm_121=fa_recup_dico("bgm_121");
$vl_c_bgm_122=fa_recup_dico("bgm_122");
$vl_c_bgm_123=fa_recup_dico("bgm_123");
$vl_c_bgm_124=fa_recup_dico("bgm_124");
$vl_c_bgm_125=fa_recup_dico("bgm_125");
$vl_c_bgm_126=fa_recup_dico("bgm_126");
$vl_c_bgm_127=fa_recup_dico("bgm_127");
$vl_c_bgm_128=fa_recup_dico("bgm_128");
$vl_c_bgm_129=fa_recup_dico("bgm_129");
$vl_c_bgm_130=fa_recup_dico("bgm_130");
$vl_c_bgm_133=fa_recup_dico("bgm_133");
$vl_c_bgm_136=fa_recup_dico("bgm_136");
$vl_c_bgm_137=fa_recup_dico("bgm_137");
$vl_c_dico_00006=fa_recup_dico("dico_00006");
$vl_c_dico_00013=fa_recup_dico("dico_00013");
$vl_c_dico_00014=fa_recup_dico("dico_00014");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
include("_graal_header_winxul.inc.php");
echo <<<END
<window title="$vl_c_bgm_100" onload="fa_aa(this);pf_etat_fen('ini')" onunload="pf_onunload();" $c_xmlns>
$vl_c_graal_cp00 
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_import_adresses_courriel_01.js.php");
include("js/_graal_03.js.php");
echo <<<END
<script type="application/x-javascript" src="js/sha1.js" />
<popupset>
  <popup id="pop_fichier">
    <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_entetes_courriels');" />
    <menuitem label="$vl_c_bgm_129" class="menuitem-iconic al17" oncommand="pf_fichier_supprime();" />
  </popup>
  <popup id="pop_courriel">
    <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_adresses_courriel');" />
    <menuitem label="$vl_c_bgm_133" class="menuitem-iconic al17" oncommand="pf_courriel_supprime();" />
  </popup>

</popupset>
<deck id="deck01" flex="1">
<vbox flex="1">
<vbox>
  <hbox flex="1">
    <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="1" id="menu_02" observes="broadcaster_01">
     <menupopup>
      <menuitem id="menu_02_01" label="01 $vl_c_bgm_102" value="1" />
      <menuitem id="menu_02_02" label="02 $vl_c_bgm_112" value="2" />
      <menuitem id="menu_02_03" label="03 $vl_c_bgm_119" value="3" />
      <menuitem id="menu_02_04" label="04 $vl_c_bgm_120" value="4" />
     </menupopup>
   </menulist>
   <button tooltiptext ="$vl_c_dico_00006 Ctrl+Shift+F6" id="bt_annuler" label="$vl_c_dico_00006" crop="end" dir="normal" oncommand="pf_etat_fen('annuler');" />
  </hbox>
  <hbox flex="1">
    <toolbarbutton id="bt_rouvrir" label="$vl_c_bgm_122" class="aa01" tooltiptext="$vl_c_bgm_122"  oncommand="pf_fichier_ouvre(2);"/>
    <toolbarbutton id="bt_selection" label="$vl_c_bgm_101" class="al02" tooltiptext="$vl_c_bgm_101"  oncommand="pf_fichier_ouvre(1);"/>
    <textbox flex="1" id="tb_emplacement"   maxlenght="260"/>
		<label value="IntÃ©grer le fichier dans la GED entreprise"/>
		<radiogroup id='rdg_conserver' name='name' value="1">
      <hbox>
        <radio id='ra_conserver_oui' label="$vl_c_dico_00013" value='1' />
        <radio id='ra_conserver_non' label="$vl_c_dico_00014" value='2'/>
       </hbox>
     </radiogroup>
    <toolbarbutton id="bt_exploiter" label="$vl_c_bgm_103" class="ad02" tooltiptext="$vl_c_bgm_103"  oncommand="pf_fichier_exploite();"/>
    <keyset id="_graal_ks_02">
    <key id="k-recherche" modifiers="alt" keycode="VK_F3" oncommand="pf_alimente_arbre();"/>
	</keyset>
    <toolbarbutton id="bt_rafraichir" label="$vl_c_bgm_136" class="table-rafraichir" tooltiptext="$vl_c_bgm_136"  oncommand="pf_alimente_arbre();"/>
  </hbox>
</vbox>
  <tree id="arbre_adresses_courriel" ignoreincolumnpicker="true" flex="1" flags="" ref="*" querytype="xml" datasources="" seltype="multiple" enableColumnDrag="true" context="pop_courriel" ondblclick="pf_ouvre('courriel');">
    <treecols>
      <treecol id="tc_imp_cleunik" hidden="true" ignoreincolumnpicker="true" />
      <treecol id="tc_lig_cleunik" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_prenom" label="$vl_c_bgm_104" sort="?prenom"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_nom" label="$vl_c_bgm_105" sort="?nom"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_refweb" label="$vl_c_bgm_106" sort="?refweb"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_nombre_deja" label="$vl_c_bgm_107" class="centre" sort="?val_nombre_deja"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_val_nombre_deja" hidden="true" ignoreincolumnpicker="true" sort="?val_nombre_deja"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_valide" label="$vl_c_bgm_113" sort="?valide"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_nombre_doublon" label="$vl_c_bgm_114" class="centre" sort="?nombre_doublon_bis"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_controle_01" label="$vl_c_bgm_115" class="centre" sort="?controle_01"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_emailing" label="$vl_c_bgm_121" sort="?emailing"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_nombre_doublon_bis" hidden="true" ignoreincolumnpicker="true" sort="?nombre_doublon_bis"/><splitter class="tree-splitter" resizeafter="grow"/>
    </treecols>
    <template><query expr="*"/><action>
      <treechildren>
        <treeitem uri="?" seltype="single">
          <treerow>
            <treecell label="?imp_cleunik"/>
            <treecell label="?lig_cleunik"/>
            <treecell label="?prenom"/>
            <treecell label="?nom"/>
            <treecell label="?refweb"/>
            <treecell label="?nombre_deja"/>
            <treecell label="?val_nombre_deja"/>
            <treecell properties="?prop_valide"/>
            <treecell label="?nombre_doublon"/>
            <treecell label="?controle_01"/>
            <treecell properties="?prop_emailing"/>
            <treecell label="?nombre_doublon_bis"/>
          </treerow>
        </treeitem>
      </treechildren>
    </action></template>
  </tree>

<spacer />
<vbox id="vb_traitement" collapsed="true" >
  <hbox>
    <radiogroup id='rdg_defaut' flex="1" oncommand="pf_sel_genre(this.value)">
      <hbox>
        <radio width="250" id='ra_defaut_cre_inter' label="$vl_c_bgm_108" value='1' />
        <toolbarbutton width="250" id="bt_sel_inter" label="$vl_c_bgm_110" class="al02" tooltiptext="$vl_c_bgm_110"  oncommand="pf_ouvre('acteur');"/>
        <textbox flex="1" readonly="true" id="tb_acteur" _graal_cleunik="" />
      </hbox>  
      <hbox>
        <radio width="250" id='ra_defaut_cre_courr' label="$vl_c_bgm_109" value='2' />
        <toolbarbutton width="250" id="bt_sel_courr" label="$vl_c_bgm_111" class="al02" tooltiptext="$vl_c_bgm_111"  oncommand="pf_ouvre('interlo');"/>
        <textbox flex="1" readonly="true" id="tb_interlo" _graal_cleunik="" />
        <textbox flex="1" readonly="true" id="tb_acteur_interlo" _graal_cleunik="" />
      </hbox>  
     </radiogroup>
   <button id="bt_enregistrer" label="$vl_c_dico_00005" crop="end" dir="normal" oncommand="pf_validation('enregistrer');" />
  </hbox>   
</vbox>
</vbox>
<pseudo_boite>
<vbox id="box_boite_outils_xof_01" flex="1">
  <tree id="arbre_entetes_courriels" flex="1" hidecolumnpicker="false" flags="" ref="*" querytype="xml" datasources="" enableColumnDrag="true" context="pop_fichier">
    <treecols>
      <treecol id="tc_imp_cleunik" hidden="true" sort="?imp_cleunik" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_description" label="$vl_c_bgm_123" sort="?description" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_dateheuremodif" label="$vl_c_bgm_124" sort="?dateheuremodif" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_dateheurecreation" label="$vl_c_bgm_125" sort="?dateheurecreation" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="tc_typeimport" label="$vl_c_bgm_126" sort="?typeimport" /><splitter class="tree-splitter" resizeafter="grow"/>
			<treecol id="tc_nombre_adresses" label="$vl_c_bgm_137" sort="?emailing" class="droite"/><splitter class="tree-splitter" resizeafter="grow"/>
    </treecols>
    <template><query expr="*"/><action>
      <treechildren>
        <treeitem uri="?" seltype="single">
          <treerow>
            <treecell label="?imp_cleunik"/>
            <treecell label="?description"/>
            <treecell label="?dateheuremodif"/>
            <treecell label="?dateheurecreation"/>
            <treecell label="?typeimport"/>
						<treecell label="?nombre_adresses"/>
          </treerow>
        </treeitem>
      </treechildren>
    </action></template>
  </tree>
  <hbox>
    <button flex="1" label="$vl_c_bgm_127" oncommand="pf_fichier_ouvre(3);" />
    <button flex="1" label="$vl_c_bgm_128" oncommand="pf_fichier_ouvre(4);" />
  </hbox>
</vbox>
</pseudo_boite>
<pseudo_boite>
  <vbox flex="1">
    <iframe flex="1" src="_graal_en_plein_travail.php" />
  </vbox>
</pseudo_boite>
</deck>
</window>
END;
?>
