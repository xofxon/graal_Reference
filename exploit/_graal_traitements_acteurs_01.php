<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik=intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_c_genreacteur=fa_recup_param('genreacteur','tousss');
$vl_c_type=fa_recup_param('type','1');  //  1 Normal,2 Choix,3 Critere
$vl_e_genreacteur=intval(fa_recup_param('vl_e_genreacteur','0'));
$vl_e_choix_cleunik=intval(fa_recup_param('vl_e_choix_cleunik','0'));
$vl_e_critere_cleunik=intval(fa_recup_param('vl_e_critere_cleunik','0'));
$vl_c_quoi=fa_recup_param('vl_c_quoi','');
$vl_c_enclair=fa_recup_param('vl_c_enclair','');
$vl_c_code_critere=fa_recup_param('vl_c_code_critere','');
$vl_c_code_choix=fa_recup_param('vl_c_code_choix','');
$vl_c_deno_critere=fa_ent_xml(fa_recup_param('vl_c_deno_critere',''));
$vl_c_deno_choix=fa_ent_xml(fa_recup_param('vl_c_deno_choix',''));
$vl_c_p02=fa_recup_param('p02','');
$vl_intitule_categorie_fiscale=fa_recup_param("vl_intitule_categorie_fiscale","");
$vl_catcompta_cleunik=fa_recup_param("vl_catcompta_cleunik","");
switch ($vl_c_genreacteur) {
  case "tousss": $vl_c_id_fenetre="Fen_00366";$vl_c_id_inc_acteurs_01="Div_00033";$vl_c_id_inc_acteurs_selection_01="Div_00040";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  Tous les acteurs
  case "110001": $vl_c_id_fenetre="Fen_00346";$vl_c_id_inc_acteurs_01="Div_00035";$vl_c_id_inc_acteurs_selection_01="Div_00042";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  prospects clients
  case "110002": $vl_c_id_fenetre="Fen_00347";$vl_c_id_inc_acteurs_01="Div_00036";$vl_c_id_inc_acteurs_selection_01="Div_00043";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  prospects fournisseurs
  case "110003": $vl_c_id_fenetre="Fen_00348";$vl_c_id_inc_acteurs_01="Div_00032";$vl_c_id_inc_acteurs_selection_01="Div_00044";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  clients
  case "110004": $vl_c_id_fenetre="Fen_00349";$vl_c_id_inc_acteurs_01="Div_00037";$vl_c_id_inc_acteurs_selection_01="Div_00045";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  fournisseurs
  case "110005": $vl_c_id_fenetre="Fen_00350";$vl_c_id_inc_acteurs_01="Div_00038";$vl_c_id_inc_acteurs_selection_01="Div_00046";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  autres acteurs
  case "110006": $vl_c_id_fenetre="Fen_00351";$vl_c_id_inc_acteurs_01="Div_00039";$vl_c_id_inc_acteurs_selection_01="Div_00047";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  acteurs indéterminés
  case "110006_dupliq": $vl_c_id_fenetre="Fen_01093";$vl_c_id_inc_acteurs_01="Div_00039";$vl_c_id_inc_acteurs_selection_01="Div_00047";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  acteurs indéterminés
  case "liste_blanc_tousss": $vl_c_id_fenetre="Fen_01142";$vl_c_id_inc_acteurs_01="Div_00033";$vl_c_id_inc_acteurs_selection_01="Div_00040";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  Tous les acteurs
  case "liste_noire_tousss": $vl_c_id_fenetre="Fen_01143";$vl_c_id_inc_acteurs_01="Div_00033";$vl_c_id_inc_acteurs_selection_01="Div_00040";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  Tous les acteurs
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_tc_composants=array($vl_c_id_fenetre,$vl_c_id_inc_acteurs_01,$vl_c_id_inc_acteurs_selection_01,$vl_c_id_inc_infos_critere_choix_01);
$vl_c_bdc_100=fa_recup_dico("bdc_100");
$vl_c_bdc_101=fa_recup_dico("bdc_101");
$vl_c_bdc_103=fa_recup_dico("bdc_103");
$vl_c_bdc_104=fa_recup_dico("bdc_104");
$vl_c_bdc_106=fa_recup_dico("bdc_106");
$vl_c_bdc_107=fa_recup_dico("bdc_107");
$vl_c_bdc_108=fa_recup_dico("bdc_108");
$vl_c_bdc_109=fa_recup_dico("bdc_109");
$vl_c_bdc_110=fa_recup_dico("bdc_110");
$vl_c_bdc_111=fa_recup_dico("bdc_111");
$vl_c_bdc_112=fa_recup_dico("bdc_112");
$vl_c_bdc_113=fa_recup_dico("bdc_113");
$vl_c_bdc_114=fa_recup_dico("bdc_114");
$vl_c_bdc_115=fa_recup_dico("bdc_115");

$vl_c_bdc_116=fa_recup_dico("bdc_116");
$vl_c_bdc_117=fa_recup_dico("bdc_117");
$vl_c_bdc_118=fa_recup_dico("bdc_118");
$vl_c_bdc_119=fa_recup_dico("bdc_119");
$vl_c_bdc_120=fa_recup_dico("bdc_120");
$vl_c_bdc_121=fa_recup_dico("bdc_121");
$vl_c_bdc_122=fa_recup_dico("bdc_122");
$vl_c_bdc_123=fa_recup_dico("bdc_123");
$vl_c_bdc_124=fa_recup_dico("bdc_124");
$vl_c_bdc_125=fa_recup_dico("bdc_125");
$vl_c_bdc_126=fa_recup_dico("bdc_126");
$vl_c_bdc_127=fa_recup_dico("bdc_127");
$vl_c_dico_00002=fa_recup_dico("dico_00002");
$vl_c_dico_00004=fa_recup_dico("dico_00004");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_dico00020=fa_recup_dico("dico_00020");
$vl_c_dico00021=fa_recup_dico("dico_00021");
$vl_c_dico00022=fa_recup_dico("dico_00022");
$vl_c_dico00023=fa_recup_dico("dico_00023");
$vl_c_dico00024=fa_recup_dico("dico_00024");
$vl_c_dico00025=fa_recup_dico("dico_00025");
$vl_c_dico00026=fa_recup_dico("dico_00026");
$vl_c_dico00051=fa_recup_dico("dico_00051");
$vl_c_dico00052=fa_recup_dico("dico_00052");
$vl_c_dico00053=fa_recup_dico("dico_00053");
$vl_c_dico00054=fa_recup_dico("dico_00054");
$vl_c_dico_00149=fa_recup_dico('dico_00149');
switch ($vl_c_genreacteur) {
  case "tousss": $lib_act=$vl_c_dico00026;$vl_c_id_t01="Trait_00060";$vl_c_id_t02="Trait_00061";$vl_c_id_t03="Trait_00062";$vl_c_id_t04="Trait_00095";$vl_c_id_t05="Trait_00102";$vl_c_id_t06="Trait_00109";$vl_c_id_t07="Trait_00116";$vl_c_id_t08="Trait_00123";$vl_c_id_t09="Trait_00233";$vl_c_id_t10="Trait_00226";break;  //  Tous les acteurs
  case "110001": $lib_act=$vl_c_dico00020;$vl_c_id_t01="Trait_00040";$vl_c_id_t02="Trait_00046";$vl_c_id_t03="Trait_00054";$vl_c_id_t04="Trait_00096";$vl_c_id_t05="Trait_00103";$vl_c_id_t06="Trait_00110";$vl_c_id_t07="Trait_00117";$vl_c_id_t08="Trait_00124";$vl_c_id_t09="Trait_00227";$vl_c_id_t10="Trait_00220";break;  //  prospects clients
  case "110002": $lib_act=$vl_c_dico00022;$vl_c_id_t01="Trait_00041";$vl_c_id_t02="Trait_00047";$vl_c_id_t03="Trait_00055";$vl_c_id_t04="Trait_00097";$vl_c_id_t05="Trait_00104";$vl_c_id_t06="Trait_00111";$vl_c_id_t07="Trait_00118";$vl_c_id_t08="Trait_00125";$vl_c_id_t09="Trait_00228";$vl_c_id_t10="Trait_00221";break;  //  prospects fournisseurs
  case "110003": $lib_act=$vl_c_dico00021;$vl_c_id_t01="Trait_00042";$vl_c_id_t02="Trait_00048";$vl_c_id_t03="Trait_00056";$vl_c_id_t04="Trait_00098";$vl_c_id_t05="Trait_00105";$vl_c_id_t06="Trait_00112";$vl_c_id_t07="Trait_00119";$vl_c_id_t08="Trait_00126";$vl_c_id_t09="Trait_00229";$vl_c_id_t10="Trait_00222";break;  //  clients
  case "110004": $lib_act=$vl_c_dico00023;$vl_c_id_t01="Trait_00043";$vl_c_id_t02="Trait_00049";$vl_c_id_t03="Trait_00057";$vl_c_id_t04="Trait_00099";$vl_c_id_t05="Trait_00106";$vl_c_id_t06="Trait_00113";$vl_c_id_t07="Trait_00120";$vl_c_id_t08="Trait_00127";$vl_c_id_t09="Trait_00230";$vl_c_id_t10="Trait_00223";break;  //  fournisseurs
  case "110005": $lib_act=$vl_c_dico00024;$vl_c_id_t01="Trait_00044";$vl_c_id_t02="Trait_00050";$vl_c_id_t03="Trait_00058";$vl_c_id_t04="Trait_00100";$vl_c_id_t05="Trait_00107";$vl_c_id_t06="Trait_00114";$vl_c_id_t07="Trait_00121";$vl_c_id_t08="Trait_00128";$vl_c_id_t09="Trait_00231";$vl_c_id_t10="Trait_00224";break;  //  autres acteurs
  case "110006": $lib_act=$vl_c_dico00025;$vl_c_id_t01="Trait_00045";$vl_c_id_t02="Trait_00051";$vl_c_id_t03="Trait_00059";$vl_c_id_t04="Trait_00101";$vl_c_id_t05="Trait_00108";$vl_c_id_t06="Trait_00115";$vl_c_id_t07="Trait_00122";$vl_c_id_t08="Trait_00129";$vl_c_id_t09="Trait_00232";$vl_c_id_t10="Trait_00225";break;  //  acteurs indéterminés
  case "110006_dupliq":$vl_c_id_t03="Trait_00059";break;
}
switch ($vl_c_genreacteur) {
  case "tousss": $vl_c_id_t11="Trait_00234";$vl_c_id_t12="Trait_00327";$vl_c_id_t13="Trait_00000";$vl_c_id_t14="Trait_00335";$vl_c_id_t15="Trait_00335";break;  //  Tous les acteurs
  case "110001": $vl_c_id_t11="Trait_00235";$vl_c_id_t12="Trait_00328";$vl_c_id_t13="Trait_00000";$vl_c_id_t14="Trait_00336";$vl_c_id_t15="Trait_00336";break;  //  prospects clients
  case "110002": $vl_c_id_t11="Trait_00236";$vl_c_id_t12="Trait_00329";$vl_c_id_t13="Trait_00000";$vl_c_id_t14="Trait_00337";$vl_c_id_t15="Trait_00337";break;  //  prospects fournisseurs
  case "110003": $vl_c_id_t11="Trait_00237";$vl_c_id_t12="Trait_00330";$vl_c_id_t13="Trait_00334";$vl_c_id_t14="Trait_00338";$vl_c_id_t15="Trait_00338";break;  //  clients
  case "110004": $vl_c_id_t11="Trait_00238";$vl_c_id_t12="Trait_00331";$vl_c_id_t13="Trait_00000";$vl_c_id_t14="Trait_00339";$vl_c_id_t15="Trait_00339";break;  //  fournisseurs
  case "110005": $vl_c_id_t11="Trait_00239";$vl_c_id_t12="Trait_00332";$vl_c_id_t13="Trait_00000";$vl_c_id_t14="Trait_00340";$vl_c_id_t15="Trait_00340";break;  //  autres acteurs
  case "110006": $vl_c_id_t11="Trait_00240";$vl_c_id_t12="Trait_00333";$vl_c_id_t13="Trait_00000";$vl_c_id_t14="Trait_00341";$vl_c_id_t15="Trait_00341";break;  //  acteurs indéterminés
  case "110006_dupliq":break;
}
switch ($vl_c_genreacteur) {
  case "tousss": $vl_c_id_t16="Trait_00335";$vl_c_id_t17="Trait_00335";$vl_c_id_t18="Trait_00335";break;  //  Tous les acteurs
  case "110001": $vl_c_id_t16="Trait_00336";$vl_c_id_t17="Trait_00336";$vl_c_id_t18="Trait_00336";break;  //  prospects clients
  case "110002": $vl_c_id_t16="Trait_00337";$vl_c_id_t17="Trait_00337";$vl_c_id_t18="Trait_00337";break;  //  prospects fournisseurs
  case "110003": $vl_c_id_t16="Trait_00338";$vl_c_id_t17="Trait_00338";$vl_c_id_t18="Trait_00338";break;  //  clients
  case "110004": $vl_c_id_t16="Trait_00339";$vl_c_id_t17="Trait_00339";$vl_c_id_t18="Trait_00339";break;  //  fournisseurs
  case "110005": $vl_c_id_t16="Trait_00340";$vl_c_id_t17="Trait_00340";$vl_c_id_t18="Trait_00340";break;  //  autres acteurs
  case "110006": $vl_c_id_t16="Trait_00341";$vl_c_id_t17="Trait_00341";$vl_c_id_t18="Trait_00341";break;  //  acteurs indéterminés
  case "110006_dupliq":break;
}



/*
$vl_c_id_t13="Trait_00323";
$vl_c_id_t14="Trait_00324";
$vl_c_pop_selections="";
switch ($vl_c_type) {
  case '6' : // Normal+critères
		$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t13,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==true) {$vl_c_pop_selections.='<menuitem label="'.$vl_c_bdc_123.'" oncommand="pf_actions_choix(1,2);" />';}
		$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t14,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==true) {$vl_c_pop_selections.='<menuitem label="'.$vl_c_bdc_124.'" oncommand="pf_actions_choix(1,1);" />';}
		$vl_c_pop_selections.="<menuseparator/>";
    break;
}
*/
switch ($vl_c_genreacteur) {
  case "tousss":break;
  case "110006_dupliq":
$chaine_choix_critere=<<<EOT
<menuitem label="$vl_c_bdc_116" oncommand="pf_validation_duplication('110001');" />
<menuitem label="$vl_c_bdc_117" oncommand="pf_validation_duplication('110003');" />
<menuitem label="$vl_c_bdc_118" oncommand="pf_validation_duplication('110002');" />
<menuitem label="$vl_c_bdc_119" oncommand="pf_validation_duplication('110004');" />
<menuitem label="$vl_c_bdc_120" oncommand="pf_validation_duplication('110005');" />
<menuitem label="$vl_c_bdc_121" oncommand="pf_validation_duplication('110006');" />
EOT;
    break;
  case "110001":
  case "110002":
  case "110003":
  case "110004":
  case "110005":
  case "110006":
$chaine_choix_critere=<<<EOT
<menuitem label="$vl_c_bdc_110" oncommand="pf_ouvre_choix_critere('entreprise');" id="bt_sel_critere" />
<menuitem label="$vl_c_bdc_111" oncommand="pf_ouvre_choix_critere('moi');" id="bt_sel_choix" />
<menuitem label="$vl_c_bdc_112" oncommand="pf_enleve_choix_critere();" id="bt_sup_choix" collapsed="true"/>
EOT;
    break;
}
$bloc_categories_fiscales=<<<EOT
    <hbox>
    	<textbox flex="10" id="tb_enclair" value="Acteurs ayant la catégorie fiscale $vl_intitule_categorie_fiscale" vl_catcompta_cleunik="$vl_catcompta_cleunik"/>
    	<toolbarbutton class="al05" id="tob_requete" tooltiptext="Enregistrer la requête" oncommand="pf_valide_requete();"/>
    </hbox>
EOT;

switch ($vl_c_genreacteur) {
  case "liste_blanc_tousss":
  case "liste_noire_tousss":
  $vl_menulist_utilisateurs="<hbox flex='1'>";
$vl_menulist_utilisateurs.='<menulist sizetopopup="none" crop="end" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" class="menuitem-iconic" flex="1" id="brk_ml_utilisateurs" oncommand="pf_approximatif();">';
$vl_menulist_utilisateurs.='<menupopup>';
$vl_nb_utilisateurs=0;
$sql_req = "SELECT uti_cleunik,CONCAT_WS(' ',_utilisateur.prenom,_utilisateur.patronyme) AS nomcomplet,param_environ as param_environ from _utilisateur where actif=1;";
$result = _graal_requete_bd($sql_req);
while ($row = mysql_fetch_assoc($result)) {
	if (is_null($row['param_environ'])==false) {
		$vl_c_xml=simplexml_load_string($row['param_environ']);
		if (isset($vl_c_xml->gesacteurs_ml_zone)){$gesacteurs_ml_zone=$vl_c_xml->gesacteurs_ml_zone->attributes();}else{$gesacteurs_ml_zone='1';}
	}
	$vl_ok=false;
	switch ($vl_c_genreacteur) {
	  case "liste_blanc_tousss":if($gesacteurs_ml_zone==4){$vl_ok=true;};break;
	  case "liste_noire_tousss":if($gesacteurs_ml_zone==3){$vl_ok=true;};break;
		default:$vl_ok=false;break;
	}
	if ($vl_ok==true){
		$vl_nb_utilisateurs++;
		$vl_menulist_utilisateurs.="<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['uti_cleunik'])). "' label='".fa_remplace_quotes(fa_ent_xml($row['nomcomplet']))."' />";
	}
}
if ($vl_nb_utilisateurs==0){
	$vl_menulist_utilisateurs.="<menuitem crop='none' value='-1' label='$vl_c_bdc_125' />";
}
_graal_libere_requete_bd($result);
$vl_menulist_utilisateurs.='</menupopup>';
$vl_menulist_utilisateurs.='</menulist>';
if ($vl_nb_utilisateurs!=0){
$vl_menulist_utilisateurs.=<<<EOT
<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="1" id="brk_ml_action" value="1" oncommand="pf_approximatif(this.value);">
      <menupopup>
        <menuitem label="$vl_c_bdc_126" value="1" oncommand="fa_gid('blocs_validation').selectedIndex=0;"/> <!--  Ajouter-->
        <menuitem label="$vl_c_bdc_127" value="2" oncommand="fa_gid('blocs_validation').selectedIndex=1;"/> <!--  Supprimer-->
      </menupopup>
    </menulist>
EOT;
$vl_bloc_validation_listes=<<<EOT
<deck id="blocs_validation" selectedIndex="0">
	<vbox >
		 <button width="40" flex="1" id="bt_ajouter_listes" label="$vl_c_dico_00002" crop="end" dir="normal" oncommand="pf_validation('ajouter_$vl_c_genreacteur')" />
    </vbox>
    <vbox >
		 <button width="40" flex="1" id="bt_supprimer" label="$vl_c_dico_00004" crop="end" dir="normal" oncommand="pf_validation('supprimer_$vl_c_genreacteur')" />
    </vbox>
</deck>
EOT;

}
$vl_menulist_utilisateurs.="</hbox>";
	break;
}


_graal_requete_charge_libobj($vl_c_id_t01,$vl_e_uti_cleunik);$vl_c_t01=fa_recup_dico("$vl_c_id_t01");
_graal_requete_charge_libobj($vl_c_id_t02,$vl_e_uti_cleunik);$vl_c_t02=fa_recup_dico("$vl_c_id_t02");
_graal_requete_charge_libobj($vl_c_id_t03,$vl_e_uti_cleunik);$vl_c_t03=fa_recup_dico("$vl_c_id_t03");
_graal_requete_charge_libobj($vl_c_id_t04,$vl_e_uti_cleunik);$vl_c_t04=fa_recup_dico("$vl_c_id_t04");

_graal_requete_charge_libobj($vl_c_id_t05,$vl_e_uti_cleunik);$vl_c_t05=fa_recup_dico("$vl_c_id_t05");
_graal_requete_charge_libobj($vl_c_id_t06,$vl_e_uti_cleunik);$vl_c_t06=fa_recup_dico("$vl_c_id_t06");
_graal_requete_charge_libobj($vl_c_id_t07,$vl_e_uti_cleunik);$vl_c_t07=fa_recup_dico("$vl_c_id_t07");
_graal_requete_charge_libobj($vl_c_id_t08,$vl_e_uti_cleunik);$vl_c_t08=fa_recup_dico("$vl_c_id_t08");
_graal_requete_charge_libobj($vl_c_id_t09,$vl_e_uti_cleunik);$vl_c_t09=fa_recup_dico("$vl_c_id_t09");
_graal_requete_charge_libobj($vl_c_id_t10,$vl_e_uti_cleunik);$vl_c_t10=fa_recup_dico("$vl_c_id_t10");
_graal_requete_charge_libobj($vl_c_id_t11,$vl_e_uti_cleunik);$vl_c_t11=fa_recup_dico("$vl_c_id_t11");
_graal_requete_charge_libobj($vl_c_id_t12,$vl_e_uti_cleunik);$vl_c_t12=fa_recup_dico("$vl_c_id_t12");
_graal_requete_charge_libobj($vl_c_id_t13,$vl_e_uti_cleunik);$vl_c_t13=fa_recup_dico("$vl_c_id_t13");
_graal_requete_charge_libobj($vl_c_id_t14,$vl_e_uti_cleunik);$vl_c_t14=fa_recup_dico("$vl_c_id_t14");
_graal_requete_charge_libobj($vl_c_id_t15,$vl_e_uti_cleunik);$vl_c_t15=fa_recup_dico("$vl_c_id_t15");$vl_c_t15="Export MS Excel des adresses postales des acteurs sélectionnés avec les interlocuteurs.";
_graal_requete_charge_libobj($vl_c_id_t16,$vl_e_uti_cleunik);$vl_c_t16=fa_recup_dico("$vl_c_id_t16");$vl_c_t16="Export MS Excel des adresses courriels des interlocuteurs des acteurs sélectionnés.";
_graal_requete_charge_libobj($vl_c_id_t17,$vl_e_uti_cleunik);$vl_c_t17=fa_recup_dico("$vl_c_id_t17");$vl_c_t17="Export MS Excel des téléphones des interlocuteurs des acteurs sélectionnés.";
_graal_requete_charge_libobj($vl_c_id_t18,$vl_e_uti_cleunik);$vl_c_t18=fa_recup_dico("$vl_c_id_t18");$vl_c_t18="Export MS Excel des adresses postales+courriels+tel des acteurs sélectionnés avec les interlocuteurs.";

include("_graal_header_winxul.inc.php");
echo <<<END
<window _graal_genreacteur="$vl_c_genreacteur" title="$vl_c_aai_101" id="_win_traitements_acteurs_01" onload="fa_aa(this);pf_aa_init()" $c_xmlns>
$vl_c_graal_cp00
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_acteurs_traitements_01.js.php");
echo <<<END
<deck id="deck_acteurs" selectedIndex="0" flex="1">
<vbox flex="1">
END;
$vl_c_id_vbox_inc_acteurs_01='aai_acteurs_01';
$vl_c_id_arbre_inc_acteurs_01='arbre_des_acteurs';
$vl_c_bloc_arbre_criteres=false;
switch ($vl_c_type) {
  case '1' : // Normal
    $vl_c_infos_adresses="true";$vl_c_infos_sitesweb="true";$collapsed_acteurs="false";$collapsed_00="false";$collapsed_01="false";
    include("_graal_inc_acteurs_selection_01.php");
    include("_graal_inc_acteurs_01.php");
    break;
  case '2' : // Choix
  case '3' : // Critère
  case '4' : // Critère (ceux qui n'ont pas un certain choix pour pouvoir l'ajouter)
    $_graal_inc_infos_critere_choix_01="acteurs";
    include("_graal_inc_infos_critere_choix_01.php");
    include("_graal_inc_acteurs_02.php");
    break;
  case '5' : // Duplication acteurs indéterminés concernés par visites site suite emailing
    $vl_c_infos_adresses="true";$vl_c_infos_sitesweb="true";$collapsed_acteurs="true";$collapsed_00="true";$collapsed_01="true";
    include("_graal_inc_acteurs_selection_01.php");
    include("_graal_inc_acteurs_01.php");
    break;
  case '6' : // Sélections de critères "simples"
    $vl_c_infos_adresses="true";$vl_c_infos_sitesweb="true";$collapsed_acteurs="false";$collapsed_00="false";$collapsed_01="false";
    $vl_c_bloc_arbre_criteres=true;
    include("_graal_inc_acteurs_selection_01.php");
    include("_graal_inc_acteurs_01.php");
    echo $vl_bloc_validation_listes;
    break;
  case '7' : // Appartenant à une catégorie comptable particulière
    $vl_c_infos_adresses="true";$vl_c_infos_sitesweb="true";$collapsed_acteurs="false";$collapsed_00="false";$collapsed_01="false";
    echo $bloc_categories_fiscales;
    include("_graal_inc_acteurs_02.php");
    break;
}

echo <<<END
<popupset>
  <popup id="pop_selections">
  <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_des_acteurs');" />
  <menuitem label="$vl_c_bdc_108" oncommand="" />
  <menuitem class="menuitem-iconic ai15" label="$vl_c_bdc_109" oncommand="pf_acteur_ouvre();" />
  $vl_c_pop_selections
END;
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t03,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem class="menuitem-iconic ak11" label="'.$vl_c_bdc_107.'" oncommand="pf_panier_ajoute();" />');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t01,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t01.'" oncommand="pf_acteurs_active();"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t02,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t02.'" oncommand="pf_acteurs_desactive();"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t12,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t12.'" oncommand="pf_acteurs_supprime();"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t13,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t13.'" oncommand="pf_acteurs_compta_defaut();"/>');}
echo('<menuseparator/>');
switch ($vl_c_type) {
  case '2' : // Choix
    switch ($vl_c_quoi) {
      case 'in':
        $vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t10,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t10.'" oncommand="pf_choix_action(\'sup\');"/>');}
        break;
       case 'notin':
        $vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t09,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t09.'" oncommand="pf_choix_action(\'ajo\');"/>');}
      break;
    }
    break;
  case '3' : // Critère (qui ont choix)
        $vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t11,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t11.'" oncommand="pf_critere_action(\'sup\');"/>');}
    break;
	case '4' : // Critère
        $vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t09,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t09.'" oncommand="pf_choix_action(\'ajo\');"/>');}
    break;
}
echo <<<END
  <menuitem label="$vl_c_bdc_103" oncommand="pf_voir_deck(1);" collapsed="true" id="bt_voir_panier" />
  </popup>
</popupset>
</vbox>
<vbox flex="1">
END;
$vl_c_id_vbox_inc_acteurs_01='aai_acteurs_panier';
$vl_c_id_arbre_inc_acteurs_01='arbre_des_acteurs_panier';
$vl_c_bloc_arbre_criteres=false;
switch ($vl_c_type) {
  case '1' : // Normal
    include("_graal_inc_acteurs_01.php");
    break;
  case '2' : // Choix
  case '3' : // Critère
  case '4' : // Critère (ceux qui n'ont pas un certain choix pour pouvoir l'ajouter)
    include("_graal_inc_acteurs_02.php");
    break;
  case '5' : // Duplication acteurs indéterminés concernés par visites site suite emailing
    include("_graal_inc_acteurs_01.php");
    break;
  case '6' : // Sélection de critères "simples"
  	include("_graal_inc_acteurs_01.php");
    break;
  case '7' : // Appartenant à une catégorie comptable particulière
    include("_graal_inc_acteurs_01.php");
    break;
}
echo <<<END
	<vbox id="vb_duplication" collapsed="true">
	<hbox>
	<progressmeter id="pm_evolution_01" mode="determined" value="0" collapsed="true" flex="1"/>
	</hbox>
	</vbox>
  <vbox id="vb_criteres_panier" collapsed="true">
    <_graal_datas id="_graal_ajout_ove_bdc_datas" _graal_genreacteur="$vl_c_genreacteur" _graal_choix_cleunik="" _graal_critere_cleunik="" _graal_critere_qui=""/>
    <hbox>
      <caption label="$vl_c_bdc_113" /><textbox flex="10" id="tb_ajout_critere_denomination" />
      <caption label="$vl_c_bdc_114" /><textbox flex="10" id="tb_ajout_choix_valeur_texte_01"/>
      <toolbarbutton class="al01" id="tob_requete" tooltiptext="$vl_c_bdc_115" oncommand="pf_valide_criteres('ajout');"/>
    </hbox>
  </vbox>
  <vbox id="vb_transformation_panier" collapsed="true">
    <_graal_datas id="_graal_ajout_ove_bdc_datas" _graal_genreacteur="$vl_c_genreacteur" _graal_choix_cleunik="" _graal_critere_cleunik="" _graal_critere_qui=""/>
    <hbox>
      <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="1" id="bao_ml_transformation" value="110003">
      <menupopup>
        <menuitem class="menuitem-iconic ai17" label="$vl_c_dico_00020" tooltiptext="$vl_c_dico_00020" value="110001" _graal_portee="$vl_e_procli"/> <!--  Prospects clients-->
        <menuitem class="menuitem-iconic ai14" label="$vl_c_dico_00021" tooltiptext="$vl_c_dico_00021" value="110003" _graal_portee="$vl_e_client"/> <!--  Clients-->
        <menuitem class="menuitem-iconic ah10" label="$vl_c_dico_00022" tooltiptext="$vl_c_dico_00022" value="110002" _graal_portee="$vl_e_profou"/> <!--  Prospects fournisseurs-->
        <menuitem class="menuitem-iconic ah06" label="$vl_c_dico_00023" tooltiptext="$vl_c_dico_00023" value="110004" _graal_portee="$vl_e_fourni"/> <!--  Fournisseurs-->
        <menuitem class="menuitem-iconic ai16" label="$vl_c_dico_00024" tooltiptext="$vl_c_dico_00024" value="110005" _graal_portee="$vl_e_autrac"/> <!--  Autres acteurs-->
        <menuitem class="menuitem-iconic aj08" label="$vl_c_dico_00025" tooltiptext="$vl_c_dico_00025" value="110006" _graal_portee="$vl_e_actind"/> <!--  Acteurs indéterminés-->
      </menupopup>
    </menulist>
      <toolbarbutton class="al01" id="tob_requete" tooltiptext="$vl_c_bdc_115" oncommand="pf_valide_transformation();"/>
    </hbox>
  </vbox>
  <popupset>
    <popup id="pop_panier">
      <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" tooltiptext="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_des_acteurs_panier');" />
      <menuitem label="$vl_c_bdc_108" tooltiptext="$vl_c_bdc_108" oncommand="" />
      <menuitem class="menuitem-iconic ak12" label="$vl_c_bdc_106" tooltiptext="$vl_c_bdc_106'" oncommand="pf_panier_enleve();"/>
      <menuitem class="menuitem-iconic ak13" label="$vl_c_t03" tooltiptext="$vl_c_t03" oncommand="pf_valide_danspanier();"/>
      <menuitem label="$vl_c_bdc_104" tooltiptext="$vl_c_bdc_104" oncommand="pf_voir_deck(0);" id="bt_retour" />
      <menuseparator />
      $chaine_choix_critere
      <menuseparator />
      <menuitem label="Transformer le genre d'acteur" tooltiptext="Transformer le genre d'acteur" oncommand="pf_montre_transformer();" id="bt_sel_transformation" />
      <menuseparator />
END;
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t04,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t04.'" tooltiptext="'.$vl_c_t04.'" oncommand="pf_recup_requete(\'ods\');" class="menuitem-iconic ac12" />');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t05,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t05.'" tooltiptext="'.$vl_c_t05.'" oncommand="pf_recup_requete(\'rdf\');" class="menuitem-iconic ak02"  collapsed="true"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t06,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t06.'" tooltiptext="'.$vl_c_t06.'" oncommand="pf_recup_requete(\'htm\');" class="menuitem-iconic ak03" />');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t07,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t07.'" tooltiptext="'.$vl_c_t07.'" oncommand="pf_recup_requete(\'xml\');" class="menuitem-iconic ak04" disabled="true"/>');}
echo ('<menuseparator />');
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t08,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t08.'" tooltiptext="'.$vl_c_t08.'" oncommand="pf_recup_requete(\'xls\');" class="menuitem-iconic ak05" dir="reverse"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t14,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t14.'" tooltiptext="'.$vl_c_t14.'" oncommand="pf_xls_adresses_postales();" class="menuitem-iconic ak05" dir="reverse"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t15,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t15.'" tooltiptext="'.$vl_c_t15.'" oncommand="pf_xls_adresses_postales_interlo();" class="menuitem-iconic ak05" dir="reverse"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t16,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t16.'" tooltiptext="'.$vl_c_t16.'" oncommand="pf_xls_adresses_courriels_interlo();" class="menuitem-iconic ak05" dir="reverse"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t17,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t17.'" tooltiptext="'.$vl_c_t17.'" oncommand="pf_xls_téléphones_interlo();" class="menuitem-iconic ak05" dir="reverse"/>');}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t18,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {echo('<menuitem label="'.$vl_c_t18.'" tooltiptext="'.$vl_c_t18.'" oncommand="pf_xls_totale_01();" class="menuitem-iconic ak05" dir="reverse"/>');}
echo <<<END
    </popup>
  </popupset>
</vbox>
</deck>
</window>
END;
?>
