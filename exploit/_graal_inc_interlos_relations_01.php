<?php
_graal_requete_charge_varlib($vl_c_inc_interlos_relations_01,$vl_e_uti_cleunik);
$vl_c_bba_001=fa_recup_dico("bba_001");
$vl_c_bba_002=fa_recup_dico("bba_002");
$vl_c_bba_003=fa_recup_dico("bba_003");
$vl_c_bba_004=fa_recup_dico("bba_004");
$vl_c_bba_019=fa_recup_dico("bba_019");
$vl_c_bba_020=fa_recup_dico("bba_020");
$vl_c_bba_021=fa_recup_dico("bba_021");
switch ($vl_c_inc_interlos_relations_01){
  case "Div_00056": $vl_c_id_fen_relation="00000000000";break;  //  Interlocuteurs de tous les acteurs On considère dans ce cas qu'il n'y a pas de test de gestion des droits
  case "Div_00167": $vl_c_id_fen_relation="00000000000";break;  //  Interlocuteurs des acteurs favoris On considère dans ce cas qu'il n'y a pas de test de gestion des droits
  case "Div_00187": $vl_c_id_fen_relation="Fen_00194";break;  //  Entreprise
  case "Div_00188": $vl_c_id_fen_relation="Fen_00195";break;  //  prospects clients
  case "Div_00189": $vl_c_id_fen_relation="Fen_00196";break;  //  prospects fournisseurs
  case "Div_00190": $vl_c_id_fen_relation="Fen_00197";break;  //  clients
  case "Div_00191": $vl_c_id_fen_relation="Fen_00198";break;  //  fournisseurs
  case "Div_00192": $vl_c_id_fen_relation="Fen_00199";break;  //  autres acteurs
  case "Div_00193": $vl_c_id_fen_relation="Fen_00200";break;  //  acteurs indéterminés
  default: die;  
}
echo <<<END
<vbox id="bba_interlo_relations_01" flex="1">
END;
if ($vl_c_barre_presente_interlos_relations_01=='ok'){
echo <<<END
      <toolbar grippyhidden="true">
  		  <toolbarbutton class="table-rafraichir" tooltiptext="$vl_c_bba_019" oncommand="pf_affiche_donnees_relations();"/>
        <toolbarseparator />
        <hbox id="bloc_relations">
END;
if ($vl_c_id_fen_relation=="000000000") {$vl_tb_droits[0]=1;$vl_tb_droits[1]=1;} else {$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fen_relation,$vl_e_uti_cleunik);}
if ($vl_tb_droits[0]!=0){
if ($vl_tb_droits[1]!=0){
echo <<<END
          <toolbarbutton class="aa01" id="tb_relation_01" observes="broadcaster_01" tooltiptext="$vl_c_bba_020" oncommand="pf_ouvre('relation','nouveau');"/>
END;
}
echo <<<END
          <toolbarbutton class="aa01" id="tb_relation_02" observes="broadcaster_01" tooltiptext="$vl_c_bba_021" oncommand="pf_ouvre('relation','ouvrir');" />
END;
}
echo <<<END
        </hbox>
        <toolbarseparator />
      </toolbar>
END;
}
echo <<<END
  <tree id="arbre_relations" flex="1" hidecolumnpicker="true" flags="" ref="*" querytype="xml" datasources="" onselect="pf_sel_arbre_relations();">
      <treecols>
        <treecol hidden="true" id="tc_int_cleunik_gauche" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tc_choix_cleunik_gauche" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tc_choix_cleunik_droite" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tc_int_cleunik_droite" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_qui_gauche_00" label="$vl_c_bba_002" sort="?qui_gauche_00"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_choix_01_gauche" label="$vl_c_bba_003" sort="?choix_01_gauche"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_qui_droite" label="$vl_c_bba_002" sort="?qui_droite"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_choix_01_droite" label="$vl_c_bba_003" sort="?choix_01_droite"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_qui_gauche_01" label="$vl_c_bba_002" sort="?qui_gauche_01"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="tc_blocnotebrut" label="$vl_c_bba_001" sort="?blocnotebrut"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol hidden="true" id="tc_blocnoteriche" sort="?blocnoteriche"/><splitter class="tree-splitter" resizeafter="grow"/>
      </treecols>
      <template><query expr="*"/><action>
        <treechildren>
          <treeitem uri="?" seltype="single">
            <treerow>
              <treecell label="?int_cleunik_gauche"/>
              <treecell label="?choix_cleunik_gauche"/>
              <treecell label="?choix_cleunik_droite"/>
              <treecell label="?int_cleunik_droite"/>
              <treecell label="?qui_gauche_00"/>
              <treecell label="?choix_01_gauche"/>
              <treecell label="?qui_droite"/>
              <treecell label="?choix_01_droite"/>
              <treecell label="?qui_gauche_01"/>
              <treecell label="?blocnotebrut"/>
              <treecell label="?blocnoteriche"/>
            </treerow>
          </treeitem>
        </treechildren>
      </action></template>
    </tree>
  </vbox>
END;
?>
