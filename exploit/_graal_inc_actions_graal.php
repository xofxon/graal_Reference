<?php
//  Tableau des critères des actions (vue "tout le monde")
_graal_requete_charge_varlib($id_inc_actions_graal,$vl_e_uti_cleunik);
$vl_c_bfc_001=fa_recup_dico("bfc_001");
$vl_c_bfc_002=fa_recup_dico("bfc_002");
$vl_c_bfc_003=fa_recup_dico("bfc_003");
$vl_c_bfc_004=fa_recup_dico("bfc_004");
$vl_c_bfc_005=fa_recup_dico("bfc_005");
$vl_c_bfc_006=fa_recup_dico("bfc_006");
$vl_c_bfc_007=fa_recup_dico("bfc_007");
$vl_c_bfc_008=fa_recup_dico("bfc_008");
$vl_c_bfc_009=fa_recup_dico("bfc_009");
$vl_c_bfc_010=fa_recup_dico("bfc_010");
$vl_c_bfc_011=fa_recup_dico("bfc_011");
$vl_c_bfc_012=fa_recup_dico("bfc_012");
$vl_c_bfc_013=fa_recup_dico("bfc_013");
$vl_c_bfc_014=fa_recup_dico("bfc_014");
$vl_c_bfc_015=fa_recup_dico("bfc_015");
$vl_c_bfc_016=fa_recup_dico("bfc_016");
$vl_c_bfc_017=fa_recup_dico("bfc_017");
$vl_c_bfc_018=fa_recup_dico("bfc_018");
$vl_c_bfc_019=fa_recup_dico("bfc_019");
$vl_c_bfc_020=fa_recup_dico("bfc_020");
$vl_c_bfc_021=fa_recup_dico("bfc_021");
$vl_c_bfc_022=fa_recup_dico("bfc_022");
$vl_c_bfc_023=fa_recup_dico("bfc_023");

$vl_c_mes_00007=fa_recup_dico("mess_00007");
$vl_c_dico_00031=fa_recup_dico("dico_00031");
$vl_c_dico_00032=fa_recup_dico("dico_00032");
$vl_c_dico_00033=fa_recup_dico("dico_00033");
$vl_c_dico_00034=fa_recup_dico("dico_00034");
$vl_c_dico_00035=fa_recup_dico("dico_00035");
$vl_c_dico_00036=fa_recup_dico("dico_00036");
$vl_c_dico_00037=fa_recup_dico("dico_00037");
$vl_c_dico_00065=fa_recup_dico("dico_00065");

$vl_c_dico_00020=fa_recup_dico("dico_00020");
$vl_c_dico_00021=fa_recup_dico("dico_00021");
$vl_c_dico_00022=fa_recup_dico("dico_00022");
$vl_c_dico_00023=fa_recup_dico("dico_00023");
$vl_c_dico_00024=fa_recup_dico("dico_00024");
$vl_c_dico_00025=fa_recup_dico("dico_00025");
$vl_c_dico_00029=fa_recup_dico("dico_00029");
$vl_c_dico_00075=fa_recup_dico("dico_00075");

$vl_menu_interlo="";
$vl_menu_acteur="";
$vl_tb_droits[0]=0;
if ($vl_c_inc_actions_graal_barre_invisible==true) {
  $vl_tb_droits_1=_graal_requete_droits_fenetre("Fen_00536",$vl_e_uti_cleunik);if ($vl_tb_droits_1[1]==true) {$vl_menu_interlo.="<menuitem class='menuitem-iconic ba02' label='$vl_c_bfc_011' oncommand='pf_cree_interlo(\"110001\");'/>";}/*interlocuteurs prospects clients*/
  $vl_tb_droits_2=_graal_requete_droits_fenetre("Fen_00537",$vl_e_uti_cleunik);if ($vl_tb_droits_1[1]==true) {$vl_menu_interlo.="<menuitem class='menuitem-iconic ba04' label='$vl_c_bfc_012' oncommand='pf_cree_interlo(\"110002\");'/>";}/*interlocuteurs prospects fournisseurs*/
  $vl_tb_droits_3=_graal_requete_droits_fenetre("Fen_00538",$vl_e_uti_cleunik);if ($vl_tb_droits_1[1]==true) {$vl_menu_interlo.="<menuitem class='menuitem-iconic ba01' label='$vl_c_bfc_013' oncommand='pf_cree_interlo(\"110003\");'/>";}/*interlocuteurs clients*/
  $vl_tb_droits_4=_graal_requete_droits_fenetre("Fen_00539",$vl_e_uti_cleunik);if ($vl_tb_droits_1[1]==true) {$vl_menu_interlo.="<menuitem class='menuitem-iconic ba03' label='$vl_c_bfc_014' oncommand='pf_cree_interlo(\"110004\");'/>";}/*interlocuteurs fournisseurs*/
  $vl_tb_droits_5=_graal_requete_droits_fenetre("Fen_00540",$vl_e_uti_cleunik);if ($vl_tb_droits_1[1]==true) {$vl_menu_interlo.="<menuitem class='menuitem-iconic ba05' label='$vl_c_bfc_015' oncommand='pf_cree_interlo(\"110005\");'/>";}/*interlocuteurs autres acteurs*/
  $vl_tb_droits_6=_graal_requete_droits_fenetre("Fen_00541",$vl_e_uti_cleunik);if ($vl_tb_droits_1[1]==true) {$vl_menu_interlo.="<menuitem class='menuitem-iconic ba06' label='$vl_c_bfc_016' oncommand='pf_cree_interlo(\"110006\");'/>";}/*interlocuteurs acteurs indéterminés*/
  $vl_tb_droits_1=_graal_requete_droits_fenetre("Fen_00543",$vl_e_uti_cleunik);if ($vl_tb_droits_1[1]==true) {$vl_menu_acteur.="<menuitem class='menuitem-iconic ai17' label='$vl_c_bfc_017' oncommand='pf_cree_acteur(\"110001\");'/>";}/*prospects clients*/
  $vl_tb_droits_2=_graal_requete_droits_fenetre("Fen_00544",$vl_e_uti_cleunik);if ($vl_tb_droits_2[1]==true) {$vl_menu_acteur.="<menuitem class='menuitem-iconic ah10' label='$vl_c_bfc_018' oncommand='pf_cree_acteur(\"110002\");'/>";}/*prospects fournisseurs*/
  $vl_tb_droits_3=_graal_requete_droits_fenetre("Fen_00545",$vl_e_uti_cleunik);if ($vl_tb_droits_3[1]==true) {$vl_menu_acteur.="<menuitem class='menuitem-iconic ai14' label='$vl_c_bfc_019' oncommand='pf_cree_acteur(\"110003\");'/>";}/*clients*/
  $vl_tb_droits_4=_graal_requete_droits_fenetre("Fen_00546",$vl_e_uti_cleunik);if ($vl_tb_droits_4[1]==true) {$vl_menu_acteur.="<menuitem class='menuitem-iconic ah06' label='$vl_c_bfc_020' oncommand='pf_cree_acteur(\"110004\");'/>";}/*fournisseurs*/
  $vl_tb_droits_5=_graal_requete_droits_fenetre("Fen_00547",$vl_e_uti_cleunik);if ($vl_tb_droits_5[1]==true) {$vl_menu_acteur.="<menuitem class='menuitem-iconic ai16' label='$vl_c_bfc_021' oncommand='pf_cree_acteur(\"110005\");'/>";}/*autres acteurs*/
  $vl_tb_droits_6=_graal_requete_droits_fenetre("Fen_00548",$vl_e_uti_cleunik);if ($vl_tb_droits_6[1]==true) {$vl_menu_acteur.="<menuitem class='menuitem-iconic aj08' label='$vl_c_bfc_022' oncommand='pf_cree_acteur(\"110006\");'/>";}/*acteurs indéterminés*/
  $vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fen_graal,$vl_e_uti_cleunik);
}
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_context_00=<<<EOT
	<popupset>
		<popup id="pop_arbre_graal">
			<menuitem class="menuitem-iconic ad05" label="$vl_c_bfc_023" oncommand="pf_inverse_etat_principal();"/>
			<menuseparator/>
			<menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_graal')"/>
		</popup>
	</popupset>
EOT;
echo <<<END
$vl_c_context_00
<vbox id="bfc_graal">
     <toolbar grippyhidden="true" collapsed="$vl_c_inc_actions_graal_barre_invisible">
	  <toolbarbutton class="table-rafraichir" tooltiptext="$vl_c_mes_00007" label="" _graal_nombre="0" id="tb_affiche_graal" oncommand="pf_affiche_arbre_graal();"/>
	       <label value="$vl_c_bfc_004"/>
END;
if ($vl_tb_droits[0]!=0){
echo <<<END
  <popupset>
  </popupset>
    <hbox id="bloc_graal">
      <toolbarbutton class="ag17" observes="broadcaster_01" tooltiptext="$vl_c_bfc_009" oncommand="pf_ouvre('graal','acteur_110000');"/>
      <toolbarbutton class="ak15" observes="broadcaster_01" tooltiptext="$vl_c_bfc_005" oncommand="pf_ouvre('graal','moi');"/>
      <toolbarbutton class="ba07" observes="broadcaster_01" tooltiptext="$vl_c_bfc_008" oncommand="pf_ouvre('graal','interlo_110000');"/>
      <toolbarbutton type="menu" class="ai18" observes="broadcaster_01" tooltiptext="$vl_c_bfc_006">
				<menupopup id="mt_interlo">
		      <menuitem class="menuitem-iconic ag15" label="$vl_c_dico_00037" oncommand="pf_ouvre('graal','interlo_888888');"/>
		      <menuseparator/>
		      <menuitem class="menuitem-iconic ba02" label="$vl_c_dico_00031" oncommand="pf_ouvre('graal','interlo_110001');"/>
		      <menuitem class="menuitem-iconic ba04" label="$vl_c_dico_00032" oncommand="pf_ouvre('graal','interlo_110002');"/>
		      <menuitem class="menuitem-iconic ba01" label="$vl_c_dico_00033" oncommand="pf_ouvre('graal','interlo_110003');"/>
		      <menuitem class="menuitem-iconic ba03" label="$vl_c_dico_00034" oncommand="pf_ouvre('graal','interlo_110004');"/>
		      <menuitem class="menuitem-iconic ba05" label="$vl_c_dico_00035" oncommand="pf_ouvre('graal','interlo_110005');"/>
		      <menuitem class="menuitem-iconic ba06" label="$vl_c_dico_00036" oncommand="pf_ouvre('graal','interlo_110006');"/>
		      <menuseparator/>
		      <menuitem class="menuitem-iconic ai18" label="$vl_c_dico_00065" oncommand="pf_ouvre('graal','interlo_999999');"/>
		      <menuseparator/>
		      $vl_menu_interlo
		    	</menupopup>
			</toolbarbutton>
      <toolbarbutton type="menu" class="ai15" observes="broadcaster_01" tooltiptext="$vl_c_bfc_007">
				<menupopup id="mt_acteur">
		      <menuitem class="menuitem-iconic ag15" label="$vl_c_dico_00029" oncommand="pf_ouvre('graal','acteur_888888');"/>
		      <menuseparator/>
		      <menuitem class="menuitem-iconic ai17" label="$vl_c_dico_00020" oncommand="pf_ouvre('graal','acteur_110001');"/>
		      <menuitem class="menuitem-iconic ah10" label="$vl_c_dico_00022" oncommand="pf_ouvre('graal','acteur_110002');"/>
		      <menuitem class="menuitem-iconic ai14" label="$vl_c_dico_00021" oncommand="pf_ouvre('graal','acteur_110003');"/>
		      <menuitem class="menuitem-iconic ah06" label="$vl_c_dico_00023" oncommand="pf_ouvre('graal','acteur_110004');"/>
		      <menuitem class="menuitem-iconic ai16" label="$vl_c_dico_00024" oncommand="pf_ouvre('graal','acteur_110005');"/>
		      <menuitem class="menuitem-iconic aj08" label="$vl_c_dico_00025" oncommand="pf_ouvre('graal','acteur_110006');"/>
		      <menuseparator/>
		      <menuitem class="menuitem-iconic ai15" label="$vl_c_dico_00075" oncommand="pf_ouvre('graal','acteur_999999');"/>
		      <menuseparator/>
		      $vl_menu_acteur
		    </menupopup>
			</toolbarbutton>
    </hbox>
END;
}
echo <<<END
  </toolbar>
   <tree id="arbre_graal" enableColumnDrag="true" flex="1" flags="" ref="*" querytype="xml" datasources="" seltype="single" onselect="pf_sel_ligne_arbre_graal();" ondblclick="pf_dblclick_arbre_graal();" context="pop_arbre_graal" rows="5">
     <treecols>
       <treecol id="act_cleunik_graal" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
       <treecol id="int_cleunik_graal" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
       <treecol id="action_cleunik_graal" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
       <treecol id="choix_cleunik_graal" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
       <treecol id="portee_graal" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="choix_valeur_texte_01_graal" label="$vl_c_bfc_001" sort="?choix_valeur_texte_01"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="raisonsoc_graal" label="$vl_c_bfc_002" sort="?raisonsoc"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="interlocuteur_graal" label="$vl_c_bfc_003" sort="?interlocuteur"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="typeacteur_graal" label="$vl_c_bfc_010" sort="?type_acteur_en_clair"/><splitter class="tree-splitter" resizeafter="grow"/>
       <treecol id="val_principal" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
     </treecols>
     <template><query expr="*"/><action>
       <treechildren>
         <treeitem uri="?" seltype="single">
           <treerow>
             <treecell label="?act_cleunik"/>
             <treecell label="?int_cleunik"/> 
             <treecell label="?action_cleunik"/>
             <treecell label="?choix_cleunik"/>
             <treecell label="?portee"/>
             <treecell label="?choix_valeur_texte_01"/>
             <treecell label="?raisonsoc" properties="?prop_act"/>
             <treecell label="?interlocuteur" properties="?prop_int"/>
             <treecell label="?type_acteur_en_clair" properties="?principal"/>
             <treecell label="?val_principal"/>             
           </treerow>
         </treeitem>
       </treechildren>
     </action></template>
   </tree>
 </vbox>
END;
?>
