<?php
include("_graal_header_xul.inc.php");
$vl_c_quelsdocs=fa_recup_param('quelsdocs','?');
$vl_e_doc_cleunik=fa_recup_param('doc_cleunik','A');
$vl_c_id_baroutils_03="Div_00519";
switch ($vl_c_quelsdocs){
  case "medoc"  : $vl_c_id_fenetre="Fen_00088";break;  //Mes dossiers
  default : fa_redirige("acces_interdit");break;
}
switch ($vl_e_doc_cleunik) {
	case "A":
		$premier_deck=1;
		break;
	default:
		$premier_deck=2;
		break;
		
}
$vl_c_id_inc_doc_06="Div_00012";   //pseudo-liens  
$vl_c_id_inc_note="Div_00015";   //  notes
$vl_c_id_inc_acteurs_selection_01="Div_00040";   //  Tous les tiers
$vl_c_id_inc_uti_01="Div_00136";
$vl_c_id_inc_uti_02="Div_00137";
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=1;
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_aae_101=fa_recup_dico("aae_101");
$vl_c_aae_102=fa_recup_dico("aae_102");
$vl_c_aae_103=fa_recup_dico("aae_103");
$vl_c_aae_104=fa_recup_dico("aae_104");
$vl_c_aae_105=fa_recup_dico("aae_105");
$vl_c_aae_106=fa_recup_dico("aae_106");
$vl_c_aae_107=fa_recup_dico("aae_107");
$vl_c_aae_108=fa_recup_dico("aae_108");
$vl_c_aae_109=fa_recup_dico("aae_109");
$vl_c_aae_110=fa_recup_dico("aae_110");
$vl_c_aae_111=fa_recup_dico("aae_111");
$vl_c_aae_112=fa_recup_dico("aae_112");
$vl_c_aae_113=fa_recup_dico("aae_113");
$vl_c_aae_114=fa_recup_dico("aae_114");
$vl_c_aae_115=fa_recup_dico("aae_115");
$vl_c_aae_116=fa_recup_dico("aae_116");
$vl_c_aae_117=fa_recup_dico("aae_117");
$vl_c_aae_118=fa_recup_dico("aae_118");
$vl_c_aae_118=fa_recup_dico("aae_119");
$vl_c_aae_120=fa_recup_dico("aae_120");
$vl_c_aae_121=fa_recup_dico("aae_121");
$vl_c_aae_122=fa_recup_dico("aae_122");
$vl_c_aae_123=fa_recup_dico("aae_123");
$vl_c_aae_124=fa_recup_dico("aae_124");
$vl_c_aae_125=fa_recup_dico("aae_125");
$vl_c_aae_126=fa_recup_dico("aae_126");
$vl_c_aae_127=fa_recup_dico("aae_127");
$vl_c_aae_128=fa_recup_dico("aae_128");
$vl_c_aae_129=fa_recup_dico("aae_129");
$vl_c_aae_130=fa_recup_dico("aae_130");
$vl_c_aae_131=fa_recup_dico("aae_131");
$vl_c_aae_132=fa_recup_dico("aae_132");
$vl_c_aae_132=fa_recup_dico("aae_133");
$vl_c_aae_134=fa_recup_dico("aae_134");
$vl_c_aae_135=fa_recup_dico("aae_135");
$vl_c_aae_136=fa_recup_dico("aae_136");
$vl_c_aae_137=fa_recup_dico("aae_137");
$vl_c_aae_138=fa_recup_dico("aae_138");
$vl_c_aae_139=fa_recup_dico("aae_139");
$vl_c_aae_140=fa_recup_dico("aae_140");
$vl_c_aae_141=fa_recup_dico("aae_141");
$vl_c_aae_142=fa_recup_dico("aae_142");
$vl_c_aae_143=fa_recup_dico("aae_143");
$vl_c_aae_144=fa_recup_dico("aae_144");
$vl_c_aae_145=fa_recup_dico("aae_145");
$vl_c_aae_146=fa_recup_dico("aae_146");
$vl_c_aae_147=fa_recup_dico("aae_147");$vl_c_aae_147="Ajouter des actions";
$vl_c_aae_148=fa_recup_dico("aae_148");$vl_c_aae_148="Ajouter un acteur";
$vl_c_aae_149=fa_recup_dico("aae_149");$vl_c_aae_149="Ajouter un interlocuteur";
$vl_c_aae_150=fa_recup_dico("aae_150");$vl_c_aae_150="Ajouter un article";
$vl_c_aae_151=fa_recup_dico("aae_151");$vl_c_aae_151="Ajouter des pseudo-documents";
$vl_c_aae_152=fa_recup_dico("aae_152");$vl_c_aae_152="Ajouter des notes";
$vl_c_aae_153=fa_recup_dico("aae_153");$vl_c_aae_153="Ajouter des documents";
$vl_c_aae_154=fa_recup_dico("aae_154");$vl_c_aae_154="Ajouter des dossiers";
$vl_c_aae_163=fa_recup_dico("aae_163");$vl_c_aae_163="Ajouter une ligne neutre";

$vl_c_aae_155=fa_recup_dico("aae_155");$vl_c_aae_155="Action";
$vl_c_aae_156=fa_recup_dico("aae_156");$vl_c_aae_156="Acteur";
$vl_c_aae_157=fa_recup_dico("aae_157");$vl_c_aae_157="Interlocuteur";
$vl_c_aae_158=fa_recup_dico("aae_158");$vl_c_aae_158="Article";
$vl_c_aae_159=fa_recup_dico("aae_159");$vl_c_aae_159="Pseudo-document";
$vl_c_aae_160=fa_recup_dico("aae_160");$vl_c_aae_160="Note";
$vl_c_aae_161=fa_recup_dico("aae_161");$vl_c_aae_161="Document";
$vl_c_aae_162=fa_recup_dico("aae_162");$vl_c_aae_162="Dossier";
$vl_c_aae_164=fa_recup_dico("aae_164");$vl_c_aae_164="Ligne";
$vl_c_aae_165=fa_recup_dico("aae_165");$vl_c_aae_165="Importer un document";

_graal_requete_charge_varlib($vl_c_id_baroutils_03,$vl_e_uti_cleunik);
$vl_c_bpt_001=fa_recup_dico("bpt_001");
$vl_c_bpt_002=fa_recup_dico("bpt_002");
$vl_c_bpt_003=fa_recup_dico("bpt_003");
$vl_c_bpt_004=fa_recup_dico("bpt_004");
$vl_c_bpt_005=fa_recup_dico("bpt_005");
$vl_c_bpt_006=fa_recup_dico("bpt_006");
$vl_c_bpt_007=fa_recup_dico("bpt_007");
$vl_c_bpt_008=fa_recup_dico("bpt_008");
$vl_c_bpt_009=fa_recup_dico("bpt_009");
$vl_c_bpt_010=fa_recup_dico("bpt_010");
$vl_c_bpt_011=fa_recup_dico("bpt_011");

include("_graal_header_winxul.inc.php");
echo <<<END
<?xml-stylesheet href="css/outliner.css" type="text/css"?>
<window context="graal_cp00" id="_graal_dossier_01" title="$vl_c_aae_101" width="600" height="400" onload="fa_aa(this);aae_pf_init()" $c_xmlns >
$vl_c_graal_cp00
END;
include("_graal_visites.inc.php");
include("js/_graal_xml_dossiers_01.js.php");
include_once("js/_graal_01.js.php");
echo <<<END
<keyset >
  <key id="insert-key"                          keycode="VK_INSERT" oncommand="aae_pf_insertnewitem();"/>
  <key id="delete-key"                          keycode="VK_DELETE" oncommand="aae_pf_deletenode();"/>
</keyset>
<deck id="aag_deck_01" flex="1" selectedIndex="$premier_deck">
END;
include('_graal_inc_xml_dossier_01.php');
echo <<<END
<hbox flex="1"><vbox width="300">
<toolbar id="aae_treebar">
  <toolbarbutton observes="broadcaster_01" id="tbDuplicate" tooltiptext="$vl_c_bpt_005"     oncommand="aae_pf_duplicatenode();" />
  <toolbarbutton observes="broadcaster_01" id="tbDelete"    tooltiptext="$vl_c_bpt_006"        oncommand="aae_pf_deletenode();" />
  <toolbarseparator />
  <toolbarbutton observes="broadcaster_01" id="tbUp"    tooltiptext="$vl_c_bpt_007"    oncommand="aae_pf_movenodeup();"/>
  <toolbarbutton observes="broadcaster_01" id="tbDown"  tooltiptext="$vl_c_bpt_008"  oncommand="aae_pf_movenodedown();"/>
  <toolbarbutton observes="broadcaster_01" id="tbLeft"  tooltiptext="$vl_c_bpt_009"  oncommand="aae_pf_promotenode();"/>
  <toolbarbutton observes="broadcaster_01" id="tbRight" tooltiptext="$vl_c_bpt_010" oncommand="aae_pf_demotenode();"/>
  <toolbarseparator />
  <toolbarbutton id="tbPreview" label="$vl_c_bpt_011" oncommand="aae_pf_viewxml();" hidden="true"/>
</toolbar>
<toolbar id="aae_treebar">
  <toolbarbutton observes="broadcaster_01" id="tbNewItem"   tooltiptext="$vl_c_aae_164"      oncommand="aae_pf_insertnewitem();" />
  <toolbarbutton observes="broadcaster_01" id="tbNewItem_action"   tooltiptext="$vl_c_aae_147"      class="af08" oncommand="aae_pf_ajoute_liaison('action');"/>
  <toolbarbutton observes="broadcaster_01" id="tbNewItem_acteur"   tooltiptext="$vl_c_aae_148"      class="ai15" oncommand="aae_pf_ajoute_liaison('acteur');"/>
  <toolbarbutton observes="broadcaster_01" id="tbNewItem_interl"   tooltiptext="$vl_c_aae_149"      class="ai18" oncommand="aae_pf_ajoute_liaison('interlocuteur');"/>
  <toolbarbutton observes="broadcaster_01" id="tbNewItem_articl"   tooltiptext="$vl_c_aae_150"      class="ai07" oncommand="aae_pf_ajoute_liaison('article');"/>
  <toolbarbutton observes="broadcaster_01" id="tbNewItem_pseudo"   tooltiptext="$vl_c_aae_151"      class="ah05" oncommand="aae_pf_ajoute_liaison('pseudodocs');"/>
  <toolbarbutton observes="broadcaster_01" id="tbNewItem_notess"   tooltiptext="$vl_c_aae_152"      class="ai02" oncommand="aae_pf_ajoute_liaison('note');"/>
  <toolbarbutton observes="broadcaster_01" id="tbNewItem_docume"   tooltiptext="$vl_c_aae_153"      class="ai03" oncommand="aae_pf_ajoute_liaison('doc');"/>
  <toolbarbutton observes="broadcaster_01" id="tbNewItem_docume_import"   tooltiptext="$vl_c_aae_165"      class="ai03" oncommand="aae_pf_ajoute_liaison('doc_import');"/>
  <toolbarbutton observes="broadcaster_01" id="tbNewItem_dossie"   tooltiptext="$vl_c_aae_154"      class="ag13" oncommand="aae_pf_ajoute_liaison('dossier');"/>
  
</toolbar>
      <tree id="treedata_destination" flex="1" hidecolumnpicker="true" seltype="single" context="popup_destination" onclick="aae_pf_selectnode('viewarea');">
      <treecols>
        <treecol id="colname_destination" ignoreincolumnpicker="true" class="colname" flex="2" primary="true" hideheader="true"/>
        <treecol hidden="true" id="colvalue_destination" />
      </treecols>
      <treechildren id="treeitems_destination"/>
    </tree>
    </vbox>
    <splitter/>
    <vbox flex="1">
        <tabbox flex="1">
          <tabs id="aae_onglets" >
            <tab id="aae_tab01" label="$vl_c_aae_102" />
            <tab id="aae_tab02" label="$vl_c_aae_124" />
            <tab id="aae_tab03" label="$vl_c_aae_125" />
          </tabs>
          <tabpanels flex="1" >
            <tabpanel id="tabview" flex="1">
              <!-- 1° onglet Navigation -->
                <iframe onload="event.stopPropagation();" id="viewarea" flex="1" src=""/>
            </tabpanel>
            <tabpanel id="dosedit" flex="1">
              <!-- 2° onglet Détail du dossier -->
              <grid flex="1">
                <columns flex="1">
                 <column/>
                 <column flex="1"/>
                </columns>
                  <rows>
                      <row flex= "10">
                       <label control="la_emplacement" value="$vl_c_aae_125"/>
                       <textbox id="tb_emplacement"   maxlenght="260"/>
                      </row>
                      <row flex= "10">
                       <label control="la_titre" value="$vl_c_aae_129"/>
                       <textbox id="tb_titre"  />
                      </row>
                      <row flex= "10">
                        <label control="la_descriptif_sommaire" value="$vl_c_aae_128"/>
                        <textbox id="tb_descriptif_sommaire"   />
                      </row>
                      <row flex= "10">
                       <label control="la_dateheurecreation" value="$vl_c_aae_126"/>
                       <label id="la_dateheurecreation" />
                      </row>
                      <row flex= "10">
                       <label control="la_dateheuremodif" value="$vl_c_aae_1027"/>
                       <label id="la_dateheuremodif" />
                      </row>
                  </rows>
              </grid>
              <spacer/>
            </tabpanel>  
            <tabpanel id="tabedit" flex="1">
              <!-- 3° onglet Détail de ligne de dossier -->
              <groupbox flex="1">
                <caption label="$vl_c_aae_106"/>
                <vbox>
                  <grid >
                    <columns><column/><column flex="1"/></columns>
                    <rows>
                      <row><label value="$vl_c_aae_104" /><textbox id="tb_label" value=""/></row>
                      <row><label value="$vl_c_aae_105" />
                        <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="ml_type" value="1" disabled="true">
                          <menupopup>
                            <menuitem label="$vl_c_aae_141" value="0"/>
                            <menuitem label="$vl_c_aae_142" value="1"/>
                            <menuitem label="$vl_c_aae_143" value="2"/>
                            <menuitem label="$vl_c_aae_144" value="3"/>
                            <menuitem label="$vl_c_aae_157" value="4"/>
                            <menuitem label="Lien externe " value="5"/>
                            <menuitem label="$vl_c_aae_155" value="6"/>
                            <menuitem label="$vl_c_aae_158" value="7"/>
                            <menuitem label="$vl_c_aae_161" value="8"/>
                            <menuitem label="$vl_c_aae_162" value="9"/>
                          </menupopup>
                        </menulist>
                      </row>
                      <row><label value="$vl_c_aae_123" /><textbox id="tb_link"  value="" disabled="true" hidden="true"/></row>
                      <row hidden="true"><label value="$vl_c_aae_107" />
                        <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="ml_cache">
                          <menupopup>
                            <menuitem label="Non" selected="true" value="non"/>
                            <menuitem label="Oui" value="oui"/>
                          </menupopup>
                        </menulist>
                      </row>
                    </rows>
                  </grid>
                </vbox>
                <tree id="treeproperties" flex="1" hidecolumnpicker="true">
                  <treecols>
                    <treecol properties="pa" id="col_prop"  class="colname"  flex="1" label="$vl_c_aae_104" />
                  </treecols>
                  <treechildren id="toto">
                    <treeitem><treerow><treecell value="documents00" properties="documents00" label="$vl_c_aae_111"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="af08" properties="af08" label="$vl_c_aae_155"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="ai15" properties="ai15" label="$vl_c_aae_156"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="ai18" properties="ai18" label="$vl_c_aae_157"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="ai07" properties="ai07" label="$vl_c_aae_158"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="ah05" properties="ah05" label="$vl_c_aae_159"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="ai02" properties="ai02" label="$vl_c_aae_160"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="ai03" properties="ai03" label="$vl_c_aae_161"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="ag13" properties="ag13" label="$vl_c_aae_162"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="e1" properties="e1" label="$vl_c_aae_119"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="e0" properties="e0" label="$vl_c_aae_120"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="e2" properties="e2" label="$vl_c_aae_118"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="e3" properties="e3" label="$vl_c_aae_117"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="cb" properties="cb" label="$vl_c_aae_116"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="cb_obsolete" properties="cb_obsolete" label="$vl_c_aae_110"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="lo" properties="lo" label="$vl_c_aae_121"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="lo_obsolete" properties="lo_obsolete" label="$vl_c_aae_122"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="pa" properties="pa" label="$vl_c_aae_115"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="oo" properties="oo" label="$vl_c_aae_114"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="oo_obsolete" properties="oo_obsolete" label="$vl_c_aae_109"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="ww" properties="ww" label="$vl_c_aae_113"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="ww_obsolete" properties="ww_obsolete" label="$vl_c_aae_108"/></treerow></treeitem>
                    <treeitem><treerow><treecell value="acteur00" properties="acteur00" label="$vl_c_aae_112"/></treerow></treeitem>
                  </treechildren>
                </tree>
                <spacer/>
                <button width="40" id="aae_enregistrer_ligne" label="$vl_c_aae_130" crop="end" dir="normal" oncommand="aae_pf_validation('ligne')" />
              </groupbox>
            </tabpanel>
          </tabpanels>
        </tabbox>
    </vbox>
  </hbox>
</deck>  
      <hbox flex="0" id="boutons_standards" >
END;
include("_graal_inc_boutons_01.php");
echo <<<END
      </hbox>
</window>
END;
?>
