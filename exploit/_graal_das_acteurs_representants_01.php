<?php
include("_graal_header_xml.inc.php");
define('EOL', "\r\n");
$vl_c_dico_00010=fa_recup_dico('dico_00010');
$vl_c_dico_00020=fa_recup_dico('dico_00020');
$vl_c_dico_00021=fa_recup_dico('dico_00021');
$vl_c_dico_00022=fa_recup_dico('dico_00022');
$vl_c_dico_00023=fa_recup_dico('dico_00023');
$vl_c_dico_00024=fa_recup_dico('dico_00024');
$vl_c_dico_00025=fa_recup_dico('dico_00025');
$vl_c_dico_00079=fa_recup_dico('dico_00079');
$vl_c_dico_00080=fa_recup_dico('dico_00080');
$vl_c_dico_00081=fa_recup_dico('dico_00081');
$vl_c_dico_00091=fa_recup_dico('dico_00091');
$vl_c_dico_00092=fa_recup_dico('dico_00092');

$prop_obsolete="css_0001";
$vl_e_act_cleunik=intval(fa_recup_param('vl_e_act_cleunik','10007305'));
$sql_req = "SELECT _acteurs_representants.act_cleunik_gauche as `act_cleunik_gauche`,_acteurs_representants.choix_cleunik_gauche as `choix_cleunik_gauche`,_acteurs_representants.act_cleunik_droite as `act_cleunik_droite`,_acteurs_representants.choix_cleunik_droite as `choix_cleunik_droite`,acteur_gauche.raisonsoc as qui_gauche,acteur_droite.raisonsoc as qui_droite,choix_droite.choix_valeur_texte_01 as choix_01_droite,choix_gauche.choix_valeur_texte_01 as choix_01_gauche,_acteurs_representants.blocnotebrut as `blocnotebrut`,_acteurs_representants.blocnoteriche as `blocnoteriche`,acteur_gauche.typeacteur as `typeacteur_gauche`,acteur_droite.typeacteur as `typeacteur_droite`,_acteurs_representants.commission_typ as `type`,_acteurs_representants.commission_taux as `taux`,_acteurs_representants.commission_fixe as `fixe`,acteur_gauche.actif as actif_gauche,acteur_droite.actif as actif_droite,_acteurs_representants.commission_regle as `regle` FROM _acteurs_representants,_acteurs acteur_gauche,_acteurs acteur_droite,_choix choix_droite,_choix choix_gauche where act_cleunik_gauche=$vl_e_act_cleunik and act_cleunik_gauche=acteur_gauche.act_cleunik and act_cleunik_droite=acteur_droite.act_cleunik and choix_droite.choix_cleunik=_acteurs_representants.choix_cleunik_droite and choix_gauche.choix_cleunik=_acteurs_representants.choix_cleunik_gauche
union
SELECT _acteurs_representants.act_cleunik_gauche as `act_cleunik_gauche`,_acteurs_representants.choix_cleunik_gauche as `choix_cleunik_gauche`,_acteurs_representants.act_cleunik_droite as `act_cleunik_droite`,_acteurs_representants.choix_cleunik_droite as `choix_cleunik_droite`,acteur_gauche.raisonsoc as qui_gauche,acteur_droite.raisonsoc as qui_droite,choix_droite.choix_valeur_texte_01 as choix_01_droite,choix_gauche.choix_valeur_texte_01 as choix_01_gauche,_acteurs_representants.blocnotebrut as `blocnotebrut`,_acteurs_representants.blocnoteriche as `blocnoteriche`,acteur_gauche.typeacteur as `typeacteur_gauche`,acteur_droite.typeacteur as `typeacteur_droite`,_acteurs_representants.commission_typ as `type`,_acteurs_representants.commission_taux as `taux`,_acteurs_representants.commission_fixe as `fixe`,acteur_gauche.actif as actif_gauche,acteur_droite.actif as actif_droite,_acteurs_representants.commission_regle as `regle` FROM _acteurs_representants,_acteurs acteur_gauche,_acteurs acteur_droite,_choix choix_droite,_choix choix_gauche where act_cleunik_droite=$vl_e_act_cleunik and act_cleunik_gauche=acteur_gauche.act_cleunik and act_cleunik_droite=acteur_droite.act_cleunik and choix_droite.choix_cleunik=_acteurs_representants.choix_cleunik_droite and choix_gauche.choix_cleunik=_acteurs_representants.choix_cleunik_gauche;";
//echo($sql_req);
$result = _graal_requete_bd($sql_req);
echo('<donnees>');
while ($row = mysql_fetch_assoc($result)) {
  {
    $vl_c_genreacteur_gauche=$row['typeacteur_gauche'];
    switch ($vl_c_genreacteur_gauche)
      {
        case "110001": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00020)";break;  //  Relations des prospects clients
        case "110002": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00022)";break;  //  Relations des prospects fournisseurs
        case "110003": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00021)";break;  //  Relations des clients
        case "110004": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00023)";break;  //  Relations des fournisseurs
        case "110005": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00024)";break;  //  Relations des autres acteurs
        case "110006": $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00025)";break;  //  Relations des acteurs indéterminés
        default : $vl_c_quigauche=fa_ent_xml($row['qui_gauche'])."($vl_c_dico_00010)";break;
      }
    $vl_c_genreacteur_droite=$row['typeacteur_droite'];
    switch ($vl_c_genreacteur_droite)
      {
        case "110001": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00020)";break;  //  Relations des prospects clients
        case "110002": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00022)";break;  //  Relations des prospects fournisseurs
        case "110003": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00021)";break;  //  Relations des clients
        case "110004": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00023)";break;  //  Relations des fournisseurs
        case "110005": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00024)";break;  //  Relations des autres acteurs
        case "110006": $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00025)";break;  //  Relations des acteurs indéterminés
        default : $vl_c_quidroite=fa_ent_xml($row['qui_droite'])."($vl_c_dico_00010)";break;
      }
		echo('<quoi ');
    echo(' act_cleunik_gauche="'.fa_ent_xml($row['act_cleunik_gauche']).'"');
    echo(' choix_cleunik_gauche="'.fa_ent_xml($row['choix_cleunik_gauche']).'"');
    echo(' choix_cleunik_droite="'.fa_ent_xml($row['choix_cleunik_droite']).'"');
    echo(' act_cleunik_droite="'.fa_ent_xml($row['act_cleunik_droite']).'"');
    echo(' typeacteur_droite="'.fa_ent_xml($row['typeacteur_droite']).'"');
    echo(' qui_gauche_00="'.$vl_c_quigauche.'"');
    echo(' choix_01_gauche="'.fa_ent_xml($row['choix_01_gauche']).'"');
    echo(' qui_droite="'.$vl_c_quidroite.'"');
    echo(' choix_01_droite="'.fa_ent_xml($row['choix_01_droite']).'"');
    echo(' qui_gauche_01="'.$vl_c_quigauche.'"');
    echo(' blocnotebrut="'.fa_ent_xml($row['blocnotebrut']).'"');
    echo(' blocnoteriche="'.fa_ent_xml($row['blocnoteriche']).'"');
    switch ($row['type']) {
      case 1 : echo(' type="'.$vl_c_dico_00079.'"');break;
      case 2 : echo(' type="'.$vl_c_dico_00080.'"');break;
      case 3 : echo(' type="'.$vl_c_dico_00081.'"');break;
    }
    switch ($row['regle']) {
      case 1 : echo(' regle="'.$vl_c_dico_00091.'"');break;
      case 2 : echo(' regle="'.$vl_c_dico_00092.'"');break;
    }
    if ($row['taux']==0) {
      echo(' taux=""');
    } else {
      echo(' taux="'.fa_ent_xml($row['taux']).'"');
    }
    if ($row['fixe']==0) {
      echo(' fixe=""');
    } else {
      echo(' fixe="'.fa_ent_xml($row['fixe']).'"');
    }
    if ($row['actif_gauche']==1) {
      echo(' properties_gauche=""');
    } else {
      echo(' properties_gauche="'.$prop_obsolete.'"');
    }
    if ($row['actif_droite']==1) {
      echo(' properties_droite=""');
    } else {
      echo(' properties_droite="'.$prop_obsolete.'"');
    }
    echo('/>');
	}
}
echo('</donnees>');
_graal_libere_requete_bd($result);
_graal_ferme_connexion();
?>
