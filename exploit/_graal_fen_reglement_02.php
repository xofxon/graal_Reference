<?php
include("_graal_header_xul.inc.php");
include("_graal_fonctions_echeances.php");
$vl_e_uti_cleunik =intval(fa_recup_session("vs_uti_cleunik","0"));
$vl_c_genreacteur=fa_recup_param('genreacteur','tousss');
switch ($vl_c_genreacteur){
  case "tousss": fa_redirige("acces_interdit");break;  //  Tous les acteurs
  case "110003": $vl_c_id_fenetre="Fen_00963";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00551";break;  //  clients
  case "110004": $vl_c_id_fenetre="Fen_00964";$vl_c_id_fenetre_reglement=$vl_c_id_fenetre;$vl_c_id_tab_echeancier="Div_00552";break;  //  fournisseurs
  default:fa_redirige("acces_interdit");break;
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_b_acces=$vl_tb_droits[0];
$vl_b_ajout=$vl_tb_droits[1];
$vl_b_modif=$vl_tb_droits[2];
$vl_b_suppr=$vl_tb_droits[3];
$vl_b_impri=$vl_tb_droits[4];
if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
if ($vl_b_suppr==true){
	$vl_c_context_annulation='<menuitem class="menuitem-iconic ac03" label="Annulation de réglement" tooltiptext="Annulation de réglement" oncommand="pf_annule_reglement();" />';
}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);
$ml_journal=fa_brik_menulist_journaux("","ml_journal","","","tous");
$vl_c_brh_100=fa_recup_dico("brh_100");
$vl_c_brh_101=fa_recup_dico("brh_101");
$vl_c_brh_102=fa_recup_dico("brh_102");
$vl_c_brh_103=fa_recup_dico("brh_103");
$vl_c_brh_104=fa_recup_dico("brh_104");
$vl_c_brh_105=fa_recup_dico("brh_105");
$vl_c_brh_106=fa_recup_dico("brh_106");
$vl_c_brh_107=fa_recup_dico("brh_107");
$vl_c_brh_108=fa_recup_dico("brh_108");
$vl_c_brh_109=fa_recup_dico("brh_109");
$vl_c_brh_110=fa_recup_dico("brh_110");
$vl_c_brh_111=fa_recup_dico("brh_111");
$vl_c_brh_112=fa_recup_dico("brh_112");
$vl_c_brh_113=fa_recup_dico("brh_113");
$vl_c_brh_114=fa_recup_dico("brh_114");
$vl_c_brh_115=fa_recup_dico("brh_115");
$vl_c_brh_116=fa_recup_dico("brh_116");
$vl_c_brh_117=fa_recup_dico("brh_117");
$vl_c_brh_118=fa_recup_dico("brh_118");
$vl_c_brh_119=fa_recup_dico("brh_119");
$vl_c_brh_120=fa_recup_dico("brh_120");
$vl_c_brh_121=fa_recup_dico("brh_121");
$vl_c_brh_122=fa_recup_dico("brh_122");
$vl_c_brh_123=fa_recup_dico("brh_123");
$vl_c_brh_124=fa_recup_dico("brh_124");
$vl_c_brh_125=fa_recup_dico("brh_125");
$vl_c_brh_126=fa_recup_dico("brh_126");
$vl_c_dico_00149=fa_recup_dico('dico_00149');
include("_graal_header_winxul.inc.php");
echo <<<END
<window context="graal_cp00" title="$vl_c_brh_123" id="_win_fen_echeancier" onload="fa_aa(this);pf_aa_init();" onunload="pf_onunload();" flex="1" $c_xmlns>
<broadcasterset><broadcaster id="broadcaster_01" /></broadcasterset>
$vl_c_graal_cp00
END;
include_once("js/_graal_01.js.php");
include("js/_graal_reglements_02.js.php");
include_once("js/_graal_05_dates.js.php");
echo <<<END
<vbox flex="1" class="overflow_01">
<vbox>
	$ml_journal
 <hbox flex="1">
	<menulist sizetopopup="none" flex="1" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="brh_ml_typedate" oncommand="pf_approximatif()" value="4">
    <menupopup>
      <menuitem label="$vl_c_brh_100" value="1"/>
      <menuitem collapsed="true" label="$vl_c_brh_101" value="2"/>
      <menuitem collapsed="true" label="$vl_c_brh_102" value="3"/>
      <menuitem label="$vl_c_brh_126" value="4"/>
    </menupopup>
  </menulist>
END;
$id_pref="";$id_deb="brh_tb_deb";$id_fin="brh_tb_fin";include ("_graal_inc_choix_periodes_01.php");
echo <<<END
</hbox>
</vbox>
<vbox>
<hbox flex="1">
<label value="$vl_c_brh_108"/>
<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="brh_ml_type" oncommand="pf_approximatif()" value="4">
    <menupopup>
      <menuitem collapsed="true" label="$vl_c_brh_103" value="1"/>
      <menuitem collapsed="true" label="$vl_c_brh_104" value="2"/>
      <menuitem collapsed="true" label="$vl_c_brh_105" value="3"/>
      <menuitem label="$vl_c_brh_106" value="4"/>
      <menuitem collapsed="true" label="$vl_c_brh_107" value="5"/>
			<menuitem collapsed="true" label="$vl_c_brh_115" value="6"/>
      <menuitem collapsed="true" label="$vl_c_brh_116" value="7"/>
      <menuitem collapsed="true" label="$vl_c_brh_117" value="8"/>
			<menuitem collapsed="true" label="$vl_c_brh_118" value="9"/>
      <menuitem collapsed="true" label="$vl_c_brh_119" value="10"/>
      <menuitem collapsed="true" label="$vl_c_brh_120" value="11"/>
			<menuitem label="$vl_c_brh_124" value="12"/>
			<menuitem label="$vl_c_brh_125" value="13"/>			
    </menupopup>
  </menulist>
  <textbox flex="2" value="$vl_c_brh_109" id="brh_tb_rechapproxima" oninput="pf_approximatif()"/>
  <hbox flex="2" collapsed="true">
	<menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex="2" id="brh_ml_etat" oncommand="pf_approximatif()" value="5">
    <menupopup>
			<menuitem label="$vl_c_brh_122" value="7"/>
      <menuitem label="$vl_c_brh_110" value="1"/>
      <menuitem label="$vl_c_brh_111" value="2"/>
      <menuitem label="$vl_c_brh_112" value="3"/>
      <menuitem label="$vl_c_brh_113" value="4"/>
      <menuitem label="$vl_c_brh_114" value="5"/>
			<menuitem label="$vl_c_brh_121" value="6"/>
    </menupopup>
  </menulist>
	</hbox>
	<keyset id="_graal_ks_02">
    <key id="k-recherche" modifiers="alt" keycode="VK_F3" oncommand="pf_approximatif();"/>
	</keyset>
	<toolbarbutton class="table-rafraichir" id="brh_top_raf01" oncommand="pf_approximatif();"/>
	<toolbarbutton id="bt_info_fen" class="ab19" label="$vl_c_dico_00149"  crop="end" dir="normal" oncommand="fa_infos_fenetre('$vl_c_id_fenetre')" />
</hbox>
</vbox>
END;
include("_graal_inc_reglements_01.php");
echo('</vbox>');
if ($vl_c_reglement=="oui") {
echo <<<END
<splitter/>
  <vbox flex="1">
      <iframe onload="fa_aa(window.graal_iframe_visu_reglement);event.stopPropagation();" id="graal_iframe_visu_reglement" src="" flex="1"/>
  </vbox>
END;
}
echo <<<END
</window>
END;
?>
