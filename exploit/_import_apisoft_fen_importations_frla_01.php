<?php
include("_graal_header_xul.inc.php");
$vl_c_id_fenetre="Imp_00001";
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_b_acces=$vl_tb_droits[0];
if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);
$vl_b_import_fournisseur=true;
$vl_b_import_client=true;
$vl_b_import_transporteur=true;
$vl_b_import_representant=true;
$vl_c_zaa_101=fa_recup_dico("zaa_101");
$vl_c_zaa_101="Importation depuis le système d'information 'APISoft France LAMPES' vers celui 'XsOFtware'";
$vl_c_base_origine="apisoft_fla_gc";
$vl_c_base_destination="$sql_bdd";
$ml_prefixes=fa_brik_menulist_choix(66,1,4,1,'','ml_prefixe_tel_00',"broadcaster_01",121111);
$ml_familles_art_00=pf_menulist_criteres("ml_familles_art_00","1024");
$ml_types_art_00=pf_menulist_criteres("ml_types_art_00","1024");
$ml_secteurs_geo_00=pf_menulist_criteres("ml_secteurs_geo_00","4");
$ml_familles_cli_00=pf_menulist_criteres("ml_familles_cli_00","4");

$ml_genres_00=pf_menulist_choix("ml_genres_00","4","80");
$ml_civilite_00=pf_menulist_choix("ml_civilite_00","4","86");
$ml_courriel_00=pf_menulist_choix("ml_courriel_00","4","84");
$ml_fax_00=pf_menulist_choix("ml_fax_00","4","83");
$ml_prefixe_fax_00=pf_menulist_choix("ml_prefixe_fax_00","4","66");
$ml_tel_00=pf_menulist_choix("ml_tel_00","4","82");
$ml_prefixe_tel_00=pf_menulist_choix("ml_prefixe_tel_00","4","66");
$ml_por_00=pf_menulist_choix("ml_por_00","4","82");
$ml_prefixe_por_00=pf_menulist_choix("ml_prefixe_por_00","4","66");
$ml_site_00=pf_menulist_choix("ml_site_00","4","85");

$ml_familles_fou_00=pf_menulist_criteres("ml_familles_fou_00","16");
$ml_genres_01=pf_menulist_choix("ml_genres_01","16","80");
$ml_civilite_01=pf_menulist_choix("ml_civilite_01","16","86");
$ml_courriel_01=pf_menulist_choix("ml_courriel_01","16","84");
$ml_fax_01=pf_menulist_choix("ml_fax_01","16","83");
$ml_prefixe_fax_01=pf_menulist_choix("ml_prefixe_fax_01","16","66");
$ml_tel_01=pf_menulist_choix("ml_tel_01","16","82");
$ml_prefixe_tel_01=pf_menulist_choix("ml_prefixe_tel_01","16","66");
$ml_por_01=pf_menulist_choix("ml_por_01","16","82");
$ml_prefixe_por_01=pf_menulist_choix("ml_prefixe_por_01","16","66");
$ml_site_01=pf_menulist_choix("ml_site_01","16","85");
include("_graal_header_winxul.inc.php");
echo <<<END
<window title="$vl_c_zaa_101" id="_graal_trad_objets_01" onload="fa_aa(this);pf_etat_fen('ini')" $c_xmlns>
$vl_c_graal_cp00
END;
include_once("js/_graal_01.js.php");
include("js/_import_apisoft_frla_01.js.php");
echo <<<END
  <vbox flex="1" class="overflow_01">
    <groupbox>
      <description>$vl_c_zaa_101</description>
      <hbox>
        <description>Base origine <textbox id="c_base_ori" value="$vl_c_base_origine"/></description>
        <description>Base destination <textbox id="c_base_des" value="$vl_c_base_destination"/></description>
      </hbox>
      <groupbox>
        <description>Fichiers de base</description>
        <tabbox flex="1">
          <tabs>
            <tab label="Tables diverses" linkedpanel="tabpanel_diverse" id="tab_diverse"/>
            <tab label="Représentants" linkedpanel="tabpanel_representant" id="tab_representant"/>
            <tab label="Transporteurs" linkedpanel="tabpanel_transporteur" id="tab_transporteur"/>
            <tab label="Clients" linkedpanel="tabpanel_client" id="tab_client"   />
            <tab label="Fournisseurs" linkedpanel="tabpanel_fournisseur" id="tab_fournisseur"/>
            <tab label="Articles" linkedpanel="tabpanel_article" id="tab_article"/>
            
          </tabs>
          <tabpanels flex="1" >
           <tabpanel id="tabpanel_diverse">
              <groupbox>
                <description>Importations</description>
                <vbox>
                  <button label="1 Table des taxes" oncommand="pf_importation('6');" />
                  <button label="2 Table des catégories achat/vente" oncommand="pf_importation('7');" />
                  <button label="3 Table des tarifs" oncommand="pf_importation('8');"/>
                  <button label="4 Table des unités (stock,achat,vente)" oncommand="pf_importation('12');"/>
                  <button label="5 Table des modes de règlement" oncommand="pf_importation('14');"/>
                  <button label="6 Table des comptes comptables des articles" oncommand="pf_importation('15');"/>
                  <button label="7 Table des taxes parafiscales" oncommand="pf_importation('19');" />
                  <button hidden="true" label="" oncommand=""/>
                </vbox>
              </groupbox>   
            </tabpanel>
            <tabpanel id="tabpanel_client">
              
            <groupbox>
                <description>Préparation</description>
                <vbox>
                  <button label="Correspondances des pays d'adresses de livraison et de facturation" oncommand="pf_preparation('1');"/>
                  <button label="Associer les pays" oncommand="pf_ouvre_pays_apisoft();"/>
                  <button label="Correspondances des devises" oncommand="pf_preparation('10');"/>
                  <button label="Associer les devises" oncommand="pf_ouvre_devise_apisoft();"/>

                  <label value="Secteurs géographiques"/>
                  $ml_secteurs_geo_00
                  <button label="Importer" oncommand="pf_importation_critere('ml_secteurs_geo_00');"/>
                  <label value="Familles de clients"/>
                  $ml_familles_cli_00
                  <button label="Importer" oncommand="pf_importation_critere('ml_familles_cli_00');"/>
                  <button hidden="true" label="Autre traitements" oncommand="alert('Bonjour le monde');"/>
                </vbox>
              </groupbox>   
              <groupbox>
                <description>Importation</description>
                <vbox>
                <label value="Genres d'acteurs"/>
                $ml_genres_00
                <label value="Civilités"/>
                $ml_civilite_00
                <label value="Courriels"/>
                $ml_courriel_00
                <label value="Fax"/>
                $ml_fax_00
                <label value="Préfixes internationaux Fax"/>
                $ml_prefixe_fax_00
                <label value="Téléphones"/>
                $ml_tel_00
                <label value="Préfixes internationaux Tel"/>
                $ml_prefixe_tel_00
                <label value="Portables"/>
                $ml_por_00
                <label value="Préfixes internationaux Portables"/>
                $ml_prefixe_por_00
                <label value="Sites"/>
                $ml_site_00
				<button label="Importer" oncommand="pf_importation('1');"/>
				</vbox>
             </groupbox>   
              <groupbox>
                <description>Annexes</description>
                <vbox>
                  <button label="Rattachements Représentants/clients" oncommand="pf_importation('17');"/>
                </vbox>
              </groupbox>
            </tabpanel>
            <tabpanel id="tabpanel_fournisseur">
              <groupbox>
                <description>Préparation</description>
                <vbox>
                  <button label="Correspondances des pays" oncommand="pf_preparation('2');"/>
                  <button label="Associer les pays" oncommand="pf_ouvre_pays_apisoft();"/>
                  <button label="Correspondances des devises" oncommand="pf_preparation('11');"/>
                  <button label="Associer les devises" oncommand="pf_ouvre_devise_apisoft();"/>
                  <label value="Familles des fournisseurs"/>
                  $ml_familles_fou_00
					<button label="Importer" oncommand="pf_importation_critere('ml_familles_fou_00')" />
                </vbox>
              </groupbox>   
              <groupbox>
                <description>Importation</description>
                <vbox>
                <label value="Genres d acteurs."/>
                $ml_genres_01
				<label value="Civilités."/>
                $ml_civilite_01
				<label value="Courriel."/>
                $ml_courriel_01
				<label value="Fax."/>
                $ml_fax_01
                <label value="Préfixes internationaux Fax"/>
                $ml_prefixe_fax_01
				<label value="Téléphones"/>
                $ml_tel_01
                <label value="Préfixes internationaux Tel"/>
                $ml_prefixe_tel_01
				<label value="Portables"/>
                $ml_por_01
                <label value="Préfixes internationaux Portables"/>
                $ml_prefixe_por_01
                <label value="Sites"/>
                $ml_site_01
				<button label="Importer" oncommand="pf_importation('2');"/>
				</vbox>
              </groupbox>   
            </tabpanel>
            <tabpanel id="tabpanel_transporteur">
              <groupbox>
                <description>Préparation</description>
                <vbox>
                  <button label="Pas de préparation particulière" oncommand="alert('On vous a dit qu\'il n\'y avait rien !!');"/>
                </vbox>
              </groupbox>   
              <groupbox>
                <description>Importation</description>
                <hbox>
END;
//  On recherche Tous les genres d'acteur fournisseurs ( pour les transporteurs)        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (80) and  choix_portee & 16";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_transporteur=false;
echo <<<END
<label control="la_genre" value="Genres d\'acteurs"/>
END;
}
else
{
echo('<label control="la_genre" value="Genres d acteurs."/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_genres_02" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END
</hbox>
<hbox>
END;
//  On recherche Tous les civilités        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (86) and  choix_portee & 16";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_transporteur=false;
echo <<<END
<label control="la_civilite" value="Civilités"/>
END;
}
else
{
echo('<label control="la_civilite" value="Civilités."/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_civilite_02" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END
</hbox>
<hbox>
END;
//  On recherche Tous les genres de courriel        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (84) and  choix_portee & 16";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_transporteur=false;
echo <<<END
<label control="la_courriels" value="Courriels"/>
END;
}
else
{
echo('<label control="la_courriel" value="Courriel."/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_courriel_02" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END
</hbox>
<hbox>
END;

//  On recherche Tous les genres de fax        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (83) and  choix_portee & 16";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_transporteur=false;
echo <<<END
<label control="la_fax" value="Fax"/>
END;
}
else
{
echo('<label control="la_fax" value="Fax."/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_fax_02" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
//  On recherche Tous les préfixes internationaux        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur',_choix.choix_code as 'prefixe' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (66) and  choix_portee & 16";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_client=false;
echo <<<END
<label control="la_fax" value="Préfixes internationaux Fax"/>
END;
}
else
{
echo('<label control="la_fax" value="Préfixes internationaux Fax"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_prefixe_fax_02" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='(".fa_remplace_quotes(fa_ent_xml($row['prefixe'])) . ") ".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END

</hbox>
<hbox>
END;

//  On recherche Tous les genres de téléphones        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (82) and  choix_portee & 16";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_transporteur=false;
echo <<<END
<label control="la_tel" value="Téléphones"/>
END;
}
else
{
echo('<label control="la_tel" value="Téléphones"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_tel_02" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
//  On recherche Tous les préfixes internationaux        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur',_choix.choix_code as 'prefixe' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (66) and  choix_portee & 16";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_client=false;
echo <<<END
<label control="la_fax" value="Préfixes internationaux Tel"/>
END;
}
else
{
echo('<label control="la_fax" value="Préfixes internationaux Tel"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_prefixe_tel_02" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='(".fa_remplace_quotes(fa_ent_xml($row['prefixe'])) . ") ".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END

</hbox>
<hbox>
END;

//  On recherche Tous les genres de portables        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (82) and  choix_portee & 16";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_transporteur=false;
echo <<<END
<label control="la_por" value="Portables"/>
END;
}
else
{
echo('<label control="la_por" value="Portables"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_por_02" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
//  On recherche Tous les préfixes internationaux        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur',_choix.choix_code as 'prefixe' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (66) and  choix_portee & 16";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_client=false;
echo <<<END
<label control="la_fax" value="Préfixes internationaux Portables"/>
END;
}
else
{
echo('<label control="la_fax" value="Préfixes internationaux Portables"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_prefixe_por_02" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='(".fa_remplace_quotes(fa_ent_xml($row['prefixe'])) . ") ".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END

</hbox>
END;


if ($vl_b_import_transporteur==true)
{ echo ('<button label="Importer" oncommand="pf_importation(\'3\');"/>');}
else
{echo ('<button label="Importation impossible "/>');}
echo <<<END
              </groupbox>   
            </tabpanel>
            <tabpanel id="tabpanel_representant">
              <groupbox>
                <description>Préparation</description>
                <vbox>
                  <button label="Pas de préparation particulière" oncommand="alert('On vous a dit qu\'il n\'y avait rien !!');"/>
                </vbox>
              </groupbox>   
              <groupbox>
                <description>Importation</description>
                <hbox>
END;
//  On recherche Tous les genres d'acteur entreprise ( pour les représentants)        
//  la condition "choix_portee & 1" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (80) and  choix_portee & 1";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_representant=false;
echo <<<END
<label control="la_genre" value="Genres d'acteurs"/>
END;
}
else
{
echo('<label control="la_genre" value="Genres d\'acteurs."/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_genres_03" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END
</hbox>
<hbox>
END;
//  On recherche Tous les civilités        
//  la condition "choix_portee & 1" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (86) and  choix_portee & 1";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_representant=false;
echo <<<END
<label control="la_civilite" value="Civilités"/>
END;
}
else
{
echo('<label control="la_civilite" value="Civilités."/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_civilite_03" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END
</hbox>
<hbox>
END;
//  On recherche Tous les genres de courriel        
//  la condition "choix_portee & 1" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (84) and  choix_portee & 1";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_representant=false;
echo <<<END
<label control="la_courriels" value="Courriels"/>
END;
}
else
{
echo('<label control="la_courriel" value="Courriel."/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_courriel_03" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END
</hbox>
<hbox>
END;

//  On recherche Tous les genres de fax        
//  la condition "choix_portee & 1" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (83) and  choix_portee & 1";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_representant=false;
echo <<<END
<label control="la_fax" value="Fax"/>
END;
}
else
{
echo('<label control="la_fax" value="Fax."/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_fax_03" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
//  On recherche Tous les préfixes internationaux        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur',_choix.choix_code as 'prefixe' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (66) and  choix_portee & 1";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_client=false;
echo <<<END
<label control="la_fax" value="Préfixes internationaux Fax"/>
END;
}
else
{
echo('<label control="la_fax" value="Préfixes internationaux Fax"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_prefixe_fax_03" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='(".fa_remplace_quotes(fa_ent_xml($row['prefixe'])) . ") ".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END

</hbox>
<hbox>
END;

//  On recherche Tous les genres de téléphones        
//  la condition "choix_portee & 1" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (82) and  choix_portee & 1";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_representant=false;
echo <<<END
<label control="la_tel" value="Téléphones"/>
END;
}
else
{
echo('<label control="la_tel" value="Téléphones"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_tel_03" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
//  On recherche Tous les préfixes internationaux        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur',_choix.choix_code as 'prefixe' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (66) and  choix_portee & 1";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_client=false;
echo <<<END
<label control="la_fax" value="Préfixes internationaux Tel"/>
END;
}
else
{
echo('<label control="la_fax" value="Préfixes internationaux Tel"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_prefixe_tel_03" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='(".fa_remplace_quotes(fa_ent_xml($row['prefixe'])) . ") ".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END

</hbox>
<hbox>
END;

//  On recherche Tous les genres de portables        
//  la condition "choix_portee & 1" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (82) and  choix_portee & 1";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_representant=false;
echo <<<END
<label control="la_por" value="Portables"/>
END;
}
else
{
echo('<label control="la_por" value="Portables"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_por_03" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
//  On recherche Tous les préfixes internationaux        
//  la condition "choix_portee & 16" permet d'utiliser le et binaire
$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur',_choix.choix_code as 'prefixe' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN (66) and  choix_portee & 1";
$sql_result = _graal_requete_bd($sql_req);
$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
if ($vl_e_nombre_valeurs == 0) 
{
$vl_b_import_client=false;
echo <<<END
<label control="la_fax" value="Préfixes internationaux Portables"/>
END;
}
else
{
echo('<label control="la_fax" value="Préfixes internationaux Portables"/>');
echo('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" flex="15" class="normal" id="ml_prefixe_por_03" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
echo('<menupopup>');
while ($row = mysql_fetch_assoc($sql_result))
  {
  echo("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['valeur'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='(".fa_remplace_quotes(fa_ent_xml($row['prefixe'])) . ") ".fa_remplace_quotes(fa_ent_xml($row['valeur']))."' selected='true'/>");
  }
echo <<<END
  </menupopup>
</menulist>
END;
}
_graal_libere_requete_bd($sql_result);
echo <<<END

</hbox>
END;


if ($vl_b_import_representant==true)
{ echo ('<button label="Importer" oncommand="pf_importation(\'4\');"/>');}
else
{echo ('<button label="Importation impossible "/>');}
echo <<<END
              </groupbox>   
            </tabpanel>
            <tabpanel id="tabpanel_article">
              <vbox>
              <groupbox>
                <description>Préparation</description>
                <vbox>
                  <button collapsed="true" label="Millésimes" oncommand="pf_preparation('4');" />
                  <button collapsed="true" label="Couleurs" oncommand="pf_preparation('5');" />
                  <label value="Types" />
                  $ml_types_art_00
					<button label="Importer" oncommand="pf_preparation('6');" />
                  <button collapsed="true" label="Conditionnements" oncommand="pf_preparation('7');"/>
                  <button collapsed="true" label="Contenants" oncommand="pf_preparation('8');"/>
                  <label value="Familles"/>
					$ml_familles_art_00
					<button label="Importer" oncommand="pf_preparation('9');" />
					<button label="4 Table des unités (stock,achat,vente)" oncommand="pf_importation('12');"/>
                </vbox>
              </groupbox>   
              <groupbox>
                <description>1 Importation des articles</description>
                <button label="Importer" oncommand="pf_importation('5');"/>
              </groupbox>
              <groupbox>
                <description>1 Importation des famille d'articles (si elles n'ont pas encore été importées.)</description>
                <button label="Importer" oncommand="pf_importation('18');"/>
              </groupbox>    
              <groupbox>
                <description>2 Importation des tarifs</description>
                <button label="Importer" oncommand="pf_importation('9');"/>
              </groupbox>   
              <groupbox collapsed="true">
                <description>3 Importation des nomenclatures</description>
                <button label="Importer" oncommand="pf_importation('10');"/>
              </groupbox>   
              <groupbox>
                <description>4 Importation des tarifs particuliers</description>
                <button label="Importer" oncommand="pf_importation('11');"/>
              </groupbox> 
              <groupbox>
              <description>4 bis Importer les tarifs et libellés fournisseurs</description>
				<button label="Importer" oncommand="pf_importation('20');"/> 
			  </groupbox> 
			  <groupbox>
			  <description>4 ter Importer les dépôts et emplacements(1/2)</description>
				<button label="Importer" oncommand="pf_importation('21');"/> 
			  </groupbox>
			  <groupbox>
			  <description>4 ter Importer les dépôts et emplacements(2/2)</description>
				<button label="Importer" oncommand="pf_importation('22');"/> 
			  </groupbox> 
              <groupbox>
                <description>5 Importation des mouvements de stock</description>
                <groupbox>
                  <description>Préparation</description>
                    <vbox>
                      <button label="Correspondances des origines de mouvement" oncommand="pf_preparation('12');"/>
                      <button label="Associer les origines" oncommand="pf_ouvre_orimou_apisoft();"/>
                    </vbox>
                </groupbox>
                <groupbox>
                  <description>Importation</description>
                  <button label="Importer" oncommand="pf_importation('13');"/>
                </groupbox>
              </groupbox>
             </vbox>   
             <vbox>
              <groupbox>
              <description>6 Importation des comptes comptables</description>
                <button label="Importer" oncommand="pf_importation('16');"/>
              </groupbox>   
             </vbox> 
            </tabpanel>
          </tabpanels>
        </tabbox>
      </groupbox>
    </groupbox>
  </vbox>
</window>
END;

function pf_menulist_criteres($id,$portee){
	$sql_req = "SELECT critere_cleunik,critere_denomination FROM _criteres WHERE critere_actif=1 and critere_cleunik >9999 and critere_portee & $portee";
	$sql_result = _graal_requete_bd($sql_req);
	$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
	$ml="";
	if ($vl_e_nombre_valeurs != 0) {
		$ml.=('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" value="" flex="15" class="normal" id="'.$id.'" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
		$ml.=('<menupopup>');
		$ml.=("<menuitem value='0' id='0' _graal_cleunik='0' label='Aucun' selected='true'/>");
		while ($row = mysql_fetch_assoc($sql_result)) {
  			$ml.=("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['critere_cleunik'])). "' id='".$row['critere_cleunik'] ."' _graal_cleunik='".$row['critere_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['critere_denomination']))."'/>");
   		}
		$ml.="</menupopup>";
		$ml.="</menulist>";
	}
	_graal_libere_requete_bd($sql_result);
	return $ml;
}
function pf_menulist_choix($id,$portee,$critere){
	$sql_req = "SELECT _choix.choix_cleunik AS choix_cleunik,_choix.choix_valeur_texte_01 AS 'valeur' FROM _choix WHERE _choix.choix_actif=1 and _choix.critere_cleunik IN ($critere) and  choix_portee & $portee";
	$sql_result = _graal_requete_bd($sql_req);
	$vl_e_nombre_valeurs=mysql_num_rows($sql_result);
	$ml="";
	if ($vl_e_nombre_valeurs != 0) {
		$ml.=('<menulist sizetopopup="none" onfocus="setTimeout(fa_focus_gere_menulist, 0, this);" value="" class="normal" id="'.$id.'" _graal_nombre="'.$vl_e_nombre_valeurs.'">');
		$ml.=('<menupopup>');
		while ($row = mysql_fetch_assoc($sql_result)) {
  			$ml.=("<menuitem crop='none' value='" .fa_remplace_quotes(fa_ent_xml($row['choix_cleunik'])). "' id='".$row['choix_cleunik'] ."' _graal_cleunik='".$row['choix_cleunik']."' label='".fa_remplace_quotes(fa_ent_xml($row['valeur']))."'/>");
  		}
		$ml.=("</menupopup></menulist>");
	}
	_graal_libere_requete_bd($sql_result);
	return $ml;
	//return $sql_req;
	//return $vl_e_nombre_valeurs;
}
?>
