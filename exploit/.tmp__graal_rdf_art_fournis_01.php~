<?php
//Devrait être enregistré sous forme _graal_rdf_art_fournis_01.php
include("_graal_header_xml.inc.php");
$vl_e_art_cleunik=intval(fa_recup_param('vl_e_art_cleunik',-1));
$vl_e_act_cleunik=intval(fa_recup_param('vl_e_act_cleunik',-1));
define('EOL', "\r\n");
// execution de la requète SQL
$sql_req="SELECT _art_acteur.art_acteur_cleunik ,_art_acteur.art_cleunik ,_art_acteur.act_cleunik ,_art_acteur.code ,_art_acteur.description ,_art_acteur.delai_reappro ,_art_acteur.unite_reappro ,_acteurs.raisonsoc, _article.code as 'code_article_interne', _article.description as 'desi_article_interne', _choix.choix_valeur_texte_01,"._graalsql_date('_art_acteur.dateheurevalidite')." as `dateheurevalidite` FROM _art_acteur left join _acteurs using(act_cleunik) left join _article using(art_cleunik) left join _choix on _choix.choix_cleunik=_art_acteur.unite_reappro";
if ($vl_e_art_cleunik!=-1) {$sql_req.=" where _acteurs.typeacteur in(110004,110002) and _art_acteur.art_cleunik=$vl_e_art_cleunik;";} 
if ($vl_e_act_cleunik!=-1) {$sql_req.=" where _acteurs.typeacteur in(110004,110002) and _art_acteur.act_cleunik=$vl_e_act_cleunik;";}
$result = _graal_requete_bd($sql_req);
echo(fa_xcree_entete_rdf());
while ($row = mysql_fetch_assoc($result)){
  echo('<RDF:li>'.EOL);
  echo('<RDF:Description>');
  // parseType = indication pour le type des données, utile pour le tri sur la colonne
    echo('<row:art_fournis_cleunik>'.fa_ent_xml($row['art_acteur_cleunik']).'</row:art_fournis_cleunik>');
    echo('<row:art_cleunik>'.fa_ent_xml($row['art_cleunik']).'</row:art_cleunik>');
    echo('<row:act_cleunik>'.fa_ent_xml($row['act_cleunik']).'</row:act_cleunik>');
    echo('<row:code>'.fa_ent_xml($row['code']).'</row:code>');
    echo('<row:description>'.fa_ent_xml($row['description']).'</row:description>');
    echo('<row:dateheurevalidite>'.fa_ent_xml($row['dateheurevalidite']).'</row:dateheurevalidite>');
    echo('<row:delai_reappro>'.fa_ent_xml($row['delai_reappro']).'</row:delai_reappro>');
    echo('<row:unite_reappro>'.fa_ent_xml($row['choix_valeur_texte_01']).'</row:unite_reappro>');
    echo('<row:nom_acteur>'.fa_ent_xml($row['raisonsoc']).'</row:nom_acteur>');
    echo('<row:code_article_interne>'.fa_ent_xml($row['code_article_interne']).'</row:code_article_interne>');
    echo('<row:desi_article_interne>'.fa_ent_xml($row['desi_article_interne']).'</row:desi_article_interne>');
  echo('</RDF:Description>');
  echo('</RDF:li>');
}
echo('</RDF:Bag>'.EOL);
echo('</RDF:RDF>'.EOL);
_graal_libere_requete_bd($result);
_graal_ferme_connexion();
?>
