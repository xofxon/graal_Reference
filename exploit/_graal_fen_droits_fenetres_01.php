<?php
include("_graal_header_xul.inc.php");
/* AAS Fenêtre de gestion des droits des objets par utilisateur Graal */
$vl_c_id_fenetre="Fen_00065"; //Droits d'accès aux fenêtres par les utilisateurs
$vl_c_id_inc_objets="Div_00006";   //  Tableau des fenêtres
$vl_c_id_inc_droits_fenetres="Div_00112";   //  Tableau des droits
$vl_c_win_id="_graal_fenetre_01";
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];
$vl_c_dico_00001=fa_recup_dico('dico_00001');
$vl_c_dico_00002=fa_recup_dico('dico_00002');
$vl_c_dico_00003=fa_recup_dico('dico_00003');
$vl_c_dico_00004=fa_recup_dico('dico_00004');
$vl_c_dico_00005=fa_recup_dico('dico_00005');
$vl_c_dico_00006=fa_recup_dico('dico_00006');
$vl_c_dico_00007=fa_recup_dico('dico_00007');
$vl_c_dico_00149=fa_recup_dico('dico_00149');
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_aas_100=fa_recup_dico("aas_100");
$vl_c_aas_101=fa_recup_dico("aas_101");
$vl_c_aas_102=fa_recup_dico("aas_102");
$vl_c_aas_103=fa_recup_dico("aas_103");
$vl_c_aas_104=fa_recup_dico("aas_104");
$vl_c_aas_105=fa_recup_dico("aas_105");
$vl_c_aas_106=fa_recup_dico("aas_106");
$vl_c_aas_107=fa_recup_dico("aas_107");
$vl_c_aas_108=fa_recup_dico("aas_108");
if ($vl_e_uti_cleunik!=1){
	$ml_uti=fa_brik_menulist_utilisateurs("15","1,2","ml_utilisateur",false,"0,1");
} else {
	$ml_uti=fa_brik_menulist_utilisateurs("15","1,2","ml_utilisateur",false);
}
$pop_complement_aar_cp01=<<<EOT
<menuitem label='Exporter sous Excel' oncommand='fa_exporte_requete_systeme_vers_xls("001");' class='menuitem-iconic ak05' dir='reverse'/>
EOT;
include("_graal_header_winxul.inc.php");
echo <<<END
<window context="graal_cp00" _graal_id_fenetre="$vl_c_id_fenetre" id="$vl_c_win_id" title="$vl_c_aas_108" onload="fa_aa(this);pf_etat_fen('ini')" $c_xmlns>
$vl_c_graal_cp00
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_droits_fenetres_01.js.php");
echo <<<END
<popupset>
  <popup id="aas_cp01">
END;
$vl_tb_droits=_graal_requete_droits_fenetre("Fen_00106",$vl_e_uti_cleunik);
if ($vl_tb_droits[0]==true) 
{ 
echo <<<END
<menuitem label="$vl_c_aas_104" oncommand="pf_duplique_tout();"/>
END;
}
$vl_tb_droits=_graal_requete_droits_fenetre("Trait_00003",$vl_e_uti_cleunik);
if ($vl_tb_droits[0]==true) 
{ 
echo <<<END
<menuitem label="$vl_c_aas_105" oncommand="pf_supprime_tout();"/>
END;
}
echo <<<END
  </popup>
</popupset>
<vbox flex="1" id="vb_tableau">
<hbox>
$ml_uti
<button width="40" flex="1" id="bt_sel_util" label="$vl_c_aas_107" crop="end" dir="normal" oncommand="pf_etat_fen('selectionner_utilisateur');" context="aas_cp01"/>
   </hbox>
   <hbox flex="1">
   <vbox flex="10">
END;
include("_graal_inc_droits_fenetres_01.php");
echo('<hbox>');
if ($vl_b_modif==true) 
{ 
echo <<<END
<button width="40" flex="1" id="bt_modifier" label="$vl_c_dico_00003" crop="end" dir="normal" oncommand="pf_etat_fen('modifier')" />
END;
}    
else
{
echo <<<END
<spacer flex="1"/>
END;
}
if ($vl_b_suppr==true)
{ 
echo <<<END
<button width="40" flex="1" id="bt_supprimer" label="$vl_c_dico_00004" crop="end" dir="normal" oncommand="pf_validation('supprimer')" />
END;
}    
else
{
echo <<<END
<spacer flex="1"/>
END;
}
echo <<<END
</hbox>
  </vbox>
  <splitter />
  <vbox flex="10"> 
END;
include("_graal_inc_objets_01.php");
if ($vl_b_ajout==true) 
{ 
echo <<<END
<button width="40" flex="1" id="bt_ajouter" label="$vl_c_dico_00002" crop="end" dir="normal" oncommand="pf_etat_fen('ajouter')" />
END;
}
else
{
echo <<<END
<spacer flex="1"/>
END;
}
echo <<<END
  </vbox>
  </hbox>
</vbox>
<splitter></splitter>
<hbox>
  <vbox flex="1">	
    <checkbox id="ch_n01" value="1"   label="$vl_c_aas_100" />
    <checkbox id="ch_n02" value="1"   label="$vl_c_aas_101" />
    <checkbox id="ch_n03" value="1"   label="$vl_c_aas_102" />
    <checkbox id="ch_n04" value="1"   label="$vl_c_aas_103" />
		</vbox>	
      <vbox flex="1" id="boutons_standards">
      <button width="40" flex="1" id="bt_detailler" label="$vl_c_dico_00001" crop="end" dir="normal" oncommand="pf_etat_fen('selectionner');" />
      <spacer flex="2" />
END;
if ($vl_b_ajout!=false and $vl_b_modif!=false and $vl_b_suppr!=false )
{
echo <<<END
    <button width="40" flex="1" id="bt_enregistrer" label="$vl_c_dico_00005" crop="end" dir="normal" oncommand="pf_validation('enregistrer')" />
END;
}
else
{
echo <<<END
<spacer flex="1"/>
END;
}

echo <<<END
    <button width="40" flex="1" id="bt_annuler" label="$vl_c_dico_00006" crop="end" dir="normal" oncommand="pf_etat_fen('annuler');" />
    <button width="40" flex="1" id="bt_sortir" label="$vl_c_dico_00007" crop="end" dir="normal" oncommand="pf_etat_fen('sortir')" />
    <button id="bt_info_fen" class="ab19" label="$vl_c_dico_00149"  crop="end" dir="normal" oncommand="fa_infos_fenetre('$vl_c_win_id')" />
  </vbox>
  </hbox>
 </window>
END;
?>
