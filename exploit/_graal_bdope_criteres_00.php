<?php
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_criteres_acteurs";
$t_origines_ok[1]="_graal_fen_criteres_actions";
$t_origines_ok[2]="_graal_fen_criteres_articles";
$t_origines_ok[3]="_graal_fen_criteres_ged";
$t_origines_ok[4]="_graal_fen_criteres_interlocuteurs";
$t_origines_ok[5]="_graal_fen_requeteur_acteurs_01";
fa_acces_script();
$vf_c_echo="";
$vf_c_action=fa_recup_param("vl_c_action","??????");
$vl_critere_cleunik=intval(fa_recup_param("vl_critere_cleunik",""));
$vl_critere_code=fa_recup_param("vl_critere_code","");
$vl_critere_denomination=fa_recup_param("vl_critere_denomination","");
$vl_critere_type=intval(fa_recup_param("vl_critere_type",""));
$vl_critere_choixmultiples=intval(fa_recup_param("vl_critere_choixmultiples",""));
$vl_critere_blocnotebrut=fa_recup_param("vl_critere_blocnotebrut","");
$vl_critere_actif=intval(fa_recup_param("vl_critere_actif",""));
$vl_critere_portee=intval(fa_recup_param("vl_critere_portee",""));
$vl_critere_hl=intval(fa_recup_param("vl_critere_hl",""));
$vl_critere_perso=intval(fa_recup_param("vl_critere_perso",""));
$vl_critere_codechoixpertinent=intval(fa_recup_param("vl_critere_codechoixpertinent",""));
switch (TRUE){
  case $vf_c_action=="supprimer":
    $sql_req = "DELETE FROM _criteres WHERE _criteres.critere_cleunik = $vl_critere_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
//    if($vf_c_echo=='ok') {$vf_c_echo=$vl_critere_cleunik;} else {$vf_c_echo='-1 ->'.$sql_req;}
    break;
  case $vf_c_action=="ajouter":
    $vl_critere_cleunik=_graal_requete_max_particuliere("critere_cleunik","_criteres","10000","999999999999");
    $sql_req = "INSERT INTO _criteres set critere_cleunik=$vl_critere_cleunik,critere_code='$vl_critere_code',critere_denomination='$vl_critere_denomination',critere_type=$vl_critere_type,critere_choixmultiples=$vl_critere_choixmultiples,critere_blocnotebrut='$vl_critere_blocnotebrut',critere_dateheurecreation=now(),critere_actif=$vl_critere_actif,critere_portee=$vl_critere_portee,critere_hl=$vl_critere_hl,critere_perso=$vl_critere_perso,critere_codechoixpertinent=$vl_critere_codechoixpertinent";
    $vf_c_echo=_graal_exec_requete($sql_req);
//    if($vf_c_echo=='ok') {$vf_c_echo=$vl_critere_cleunik;} else {$vf_c_echo='-1 ->'.$sql_req;}
    break;
  case $vf_c_action=="modifier":
    $sql_req = "UPDATE _criteres set critere_code='$vl_critere_code',critere_denomination='$vl_critere_denomination',critere_type=$vl_critere_type,critere_choixmultiples=$vl_critere_choixmultiples,critere_blocnotebrut='$vl_critere_blocnotebrut',critere_dateheuremodification=now(),critere_actif=$vl_critere_actif,critere_portee=$vl_critere_portee,critere_hl=$vl_critere_hl,critere_perso=$vl_critere_perso,critere_codechoixpertinent=$vl_critere_codechoixpertinent where critere_cleunik=$vl_critere_cleunik;";
    $vf_c_echo=_graal_exec_requete($sql_req);
//    if($vf_c_echo=='ok') {$vf_c_echo=$vl_critere_cleunik;} else {$vf_c_echo='-1 ->'.$sql_req;}
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;
?>
