<?php
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_act_rib_01";
fa_acces_script();
$vf_c_echo="";
$vf_c_action=fa_recup_param("vf_c_action","??????");
$vl_rib_cleunik=fa_recup_param("vl_rib_cleunik","");
$vl_act_cleunik=intval(fa_recup_param("vl_act_cleunik",""));
$vl_domiciliation=fa_recup_param("vl_domiciliation","");
$vl_etablissement=fa_recup_param("vl_etablissement","");
$vl_guichet=fa_recup_param("vl_guichet","");
$vl_compte=fa_recup_param("vl_compte","");
$vl_cle=fa_recup_param("vl_cle","");
$vl_blocnotebrut=fa_recup_param("vl_blocnotebrut","");
$vl_principal=intval(fa_recup_param("vl_principal",""));
switch (TRUE){
  case $vf_c_action=="supprimer":
    $sql_req = "DELETE FROM _act_rib WHERE rib_cleunik = $vl_rib_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_rib_cleunik;}  else {$vf_c_echo='-1-'.$vf_c_echo;}
    break;
  case $vf_c_action=="ajouter":
    $vl_rib_cleunik=_graal_requete_max("rib_cleunik","_act_rib");
    $sql_req = "INSERT INTO _act_rib set rib_cleunik=$vl_rib_cleunik,domiciliation='$vl_domiciliation',etablissement='$vl_etablissement',guichet='$vl_guichet',compte='$vl_compte',cle='$vl_cle',blocnotebrut='$vl_blocnotebrut',act_cleunik=$vl_act_cleunik,principal=$vl_principal;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_rib_cleunik;}  else {$vf_c_echo='-1-Ce RIB existe dèjà pour cet acteur.';}
    break;
  case $vf_c_action=="modifier":
    $sql_req = "UPDATE _act_rib set domiciliation='$vl_domiciliation',etablissement='$vl_etablissement',guichet='$vl_guichet',compte='$vl_compte',cle='$vl_cle',blocnotebrut='$vl_blocnotebrut',dateheuremodif=now(),principal=$vl_principal WHERE rib_cleunik=$vl_rib_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_rib_cleunik;}  else {$vf_c_echo='-1-Ce RIB existe dèjà pour cet acteur.';}
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;
?>
