<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_c_genre=fa_recup_param('genre','tousss');
switch ($vl_c_genre){
  case "recfou": $vl_c_id_fenetre="Fen_01159";$vl_c_id_article_recherche="Div_00227";$vl_c_type_article_recherche="18";$vl_c_id_t01="Trait_00344";break;  //  Tous les articles
  case "facfou": $vl_c_id_fenetre="Fen_01160";$vl_c_id_article_recherche="Div_00227";$vl_c_type_article_recherche="18";$vl_c_id_t01="Trait_00345";break;  //  Favoris
  default: fa_redirige("acces_interdit");break; 
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bvl_100=fa_recup_dico("bvl_100");
$vl_c_bvl_101=fa_recup_dico("bvl_101");
$vl_c_bvl_102=fa_recup_dico("bvl_102");
$vl_c_bvl_103=fa_recup_dico("bvl_103");
$vl_c_bvl_104=fa_recup_dico("bvl_104");
$vl_c_bvl_105=fa_recup_dico("bvl_105");
$vl_c_bvl_106=fa_recup_dico("bvl_106");
$vl_c_bvl_107=fa_recup_dico("bvl_107");
$vl_c_bvl_108=fa_recup_dico("bvl_108");
$vl_c_bvl_109=fa_recup_dico("bvl_109");
$vl_c_bvl_110=fa_recup_dico("bvl_110");
$vl_c_bvl_111=fa_recup_dico("bvl_111");
$vl_c_bvl_112=fa_recup_dico("bvl_112");
$vl_c_bvl_113=fa_recup_dico("bvl_113");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_dico_00149=fa_recup_dico('dico_00149');
$vl_tb_droits=_graal_requete_droits_fenetre("Trait_00343",$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {$vl_c_menu_contextmaj="<menuitem class='menuitem-iconic ai07' label='$vl_c_bvl_112' tooltiptext='$vl_c_bvl_112' oncommand='pf_validation_maj_derpa();' />";}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_t01,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];if ($vl_b_acces==true) {$vl_c_menu_contextexc="<menuitem class='menuitem-iconic ak05' label='$vl_c_bvl_113' tooltiptext='$vl_c_bvl_113' oncommand='pf_ouvre(\"excel_01\");' dir='reverse'/>";}

$vl_c_menu_context="<popup id='pop_art'>";
$vl_c_menu_context.="<menuitem class='menuitem-iconic ad09' label='$vl_c_dico_00106' tooltiptext='$vl_c_dico_00106' oncommand='fa_infos_colonnes_arbre_recup(\"$vl_c_id_fenetre\",\"arbre_des_articles\");'/>";
$vl_c_menu_context.="<menuitem class='menuitem-iconic ai07' label='$vl_c_bvl_109' tooltiptext='$vl_c_bvl_109' oncommand='pf_ouvre(\"art\");' />";
$vl_c_menu_context.="<menuitem class='menuitem-iconic ai07' label='$vl_c_bvl_111' tooltiptext='$vl_c_bvl_111' oncommand='pf_ouvre(\"docciaux\");' />";
$vl_c_menu_context.="<menuitem class='menuitem-iconic ai07' label='$vl_c_bvl_110' tooltiptext='$vl_c_bvl_110' oncommand='pf_ouvre(\"docciaux_ligne\");' />";
$vl_c_menu_context.=$vl_c_menu_contextmaj;
$vl_c_menu_context.=$vl_c_menu_contextexc;
$vl_c_menu_context.="</popup>";
include("_graal_header_winxul.inc.php");
$vl_tc_composants=array($vl_c_id_article_recherche);
echo <<<END
<window context="graal_cp00" _graal_toto="$vl_c_id_fenetre" _graal_genre="$vl_c_genre" title="$vl_c_bvl_100" id="_win_fen_articles_inventories_01" onload="fa_aa(this);pf_aa_init()" $c_xmlns>
$vl_c_graal_cp00
$vl_c_menu_context
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_fen_articles_derpa_01.js.php");
include("js/_graal_articles_selection_01.js.php");
include("_graal_inc_articles_recherche_01.php");
echo <<<END

<vbox id="bbb_ove_01" >

</vbox>
  <hbox flex="100" class="overflow_01">
  
  <tree id="arbre_des_articles" enableColumnDrag="true" flex="1" flags="" ref="*" querytype="xml" datasources="" seltype="multiple" context="pop_art">
  <treecols>
 <treecol id="code" sort="?code" label="$vl_c_bvl_101" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="mnemotechnique" sort="?mnemotechnique" label="$vl_c_bvl_102" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="art_cleunik"  hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="description" sort="?description" label="$vl_c_bvl_103" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="der_pa" class="droite" sort="?val_der_pa" label="$vl_c_bvl_104" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="date_der_achat_clair" class="centre" sort="?date_der_achat" label="$vl_c_bvl_105" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="difference" class="centre" sort="?difference" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="pu" class="droite" sort="?val_pu" label="$vl_c_bvl_106" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="dateheure_reception_clair" class="centre" sort="?dateheure_reception" label="$vl_c_bvl_107"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="commercial_ligne_cleunik" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="commercial_cleunik" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="dateheure_reception" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>

 </treecols>
 <template><query expr="*"/><action>
 <treechildren>

 <treeitem container="true" uri="?" seltype="single">
 <treerow>
 <treecell properties="?properties" label="?code" />
 <treecell properties="?properties" label="?mnemotechnique"/>
 <treecell properties="?properties" label="?art_cleunik"/>
 <treecell properties="?properties" label="?description"/>
 <treecell properties="?properties" label="?der_pa"/>
 <treecell properties="?properties" label="?date_der_achat_clair"/>
 <treecell properties="?properties" label="?difference"/>
 <treecell properties="?properties" label="?pu"/>
 <treecell properties="?properties" label="?dateheure_reception_clair"/>
 <treecell properties="?properties" label="?commercial_ligne_cleunik"/>
 <treecell properties="?properties" label="?commercial_cleunik"/>
 <treecell properties="?properties" label="?dateheure_reception"/>

 </treerow>
 </treeitem>
 </treechildren>
 </action></template>
 </tree>
  
  
  </hbox> 
 </window>
END;
?>
