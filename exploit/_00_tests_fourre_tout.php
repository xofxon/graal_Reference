<?php
/*
header('Content-type: text/html; charset=utf-8');
echo "odb.gif:<br />\n";
$exif = exif_read_data('graphics/odb.gif', 'IFD0');
echo $exif===false ? "Aucun en-tête de donnés n'a été trouvé.<br />\n" : "L'image contient des en-têtes<br />\n";

$exif = exif_read_data('graphics/browse.bmp', 0, true);
echo "browse.bmp:<br />\n";
foreach ($exif as $key => $section) {
    foreach ($section as $name => $val) {
        echo "$key.$name: $val<br />\n";
    }
}


*/

/*
 *  sections

    Liste de valeur séparées par des virgules des sections qui devront être présentées dans le tableau de résultat. Si aucune des sections demandées n'est trouvée, la valeur retournée est FALSE.
    FILE 	FileName (nom du ficher), FileSize (taille du fichier), FileDateTime (date de modification du fichier), SectionsFound (sections trouvées)
    COMPUTED 	Attribut Html, largeur, hauteur, couleur ou noir et blanc et plus si disponible. La largeur et la hauteur sont calculées de la même façon que la fonction getimagesize(), donc, leurs valeurs ne devraient jamais différer. De même, l'index html est la représentation textuelle de la hauteur/largeur utilisée dans une balise image HTML classique.
    ANY_TAG 	Toutes les informations concernant cette balise, comme IFD0, EXIF, ...
    IFD0 	Toutes les balises IFD0. Dans les images normales, ils contiennent les dimensions de l'image, etc.
    THUMBNAIL 	Un fichier qui contient une miniature, s'il y a un second IFD. Toutes les informations mises en balises à propos de cette miniature seront stockées dans cette section.
    COMMENT 	En-tête de commentaire des images JPEG.
    EXIF 	La section EXIF est une sous section de la section IFD0. Elle contient des informations plus détaillées sur les images. La plupart de ces index sont reliés aux appareils numériques. 
 */

//header('Content-type: text/plain; charset=utf-8');
header('Content-type: text/plain;charset=ISO-8859-1 ');
$filename='css/Fotolia_3110138_S.jpg';
//$filename='css/IMG_6219.jpg';
/*
$exif = exif_read_data($filename, 'IFD0');
echo $exif===false ? "Aucun en-tête de donnés n'a été trouvé.<br />\n" : "L'image contient des en-têtes<br />\n";
foreach ($exif as $key => $section) {
    foreach ($section as $name => $val) {
        echo "$key.$name: $val<br />\n";
    }
}
*/
/*
$exif = exif_read_data($filename, 'ANY_TAG');
echo $exif===false ? "Aucun en-tête de donnés n'a été trouvé.<br />\n" : "L'image contient des en-têtes<br />\n";
foreach ($exif as $key => $section) {
    foreach ($section as $name => $val) {
        echo "$key.$name: $val<br />\n";
    }
}
*/
$exif = exif_read_data($filename, 'ANY_TAG');
echo $exif===false ? "Aucun en-tête de donnés n'a été trouvé.<br />\n" : "L'image contient des en-têtes<br />\n";
var_dump($exif);

$size = getimagesize($filename, $info);
if(isset($info['APP13'])){
    $iptc = iptcparse($info['APP13']);
    var_dump($iptc);
} else {
	echo "pas d'infos AAP13";
}

$size = GetImageSize ("$filename",&$info); 
$iptc = iptcparse ($info["APP13"]); 
if (isset($info["APP13"])) {
    $iptc = iptcparse($info["APP13"]);
    if (is_array($iptc)) { 
        $caption = $iptc["2#120"][0]; 
    	$graphic_name = $iptc["2#005"][0]; 
        $urgency = $iptc["2#010"][0];    
    	$category = $iptc["2#015"][0];    
    // note that sometimes supp_categories contans multiple entries 
		$supp_categories = $iptc["2#020"][0]; 
		$spec_instr = $iptc["2#040"][0]; 
		$creation_date = $iptc["2#055"][0]; 
		$photog = $iptc["2#080"][0]; 
		$credit_byline_title = $iptc["2#085"][0]; 
		$city = $iptc["2#090"][0]; 
		$state = $iptc["2#095"][0]; 
		$country = $iptc["2#101"][0]; 
		$otr = $iptc["2#103"][0]; 
		$headline = $iptc["2#105"][0]; 
		$source = $iptc["2#110"][0]; 
		$photo_source = $iptc["2#115"][0]; 
		$caption = $iptc["2#120"][0];    
   	}
}
/*
$size = getimagesize($filename);
$fp = fopen($filename, "rb");
if ($size && $fp) {
    header("Content-type: {$size['mime']}");
    fpassthru($fp);
    exit;
} else {
    echo "error";
}
*/
?>