<?php
include("_graal_header_xul.inc.php");
include("_graal_fonctions_echeances.php");
$vl_e_uti_cleunik =intval(fa_recup_session("vs_uti_cleunik","0"));
$vl_c_type=fa_recup_param("type","ventes");
switch ($vl_c_type) {
	case "ventes":$vl_c_id_fenetre="Fen_01094";break;
	case "achats":$vl_c_id_fenetre="Fen_01095";break;
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bsv_100=fa_recup_dico("bsv_100");
$vl_c_bsv_101=fa_recup_dico("bsv_101");
$vl_c_bsv_102=fa_recup_dico("bsv_102");
$vl_c_bsv_103=fa_recup_dico("bsv_103");
$vl_c_bsv_104=fa_recup_dico("bsv_104");
$vl_c_bsv_105=fa_recup_dico("bsv_105");
$vl_c_bsv_106=fa_recup_dico("bsv_106");
$vl_c_bsv_107=fa_recup_dico("bsv_107");
$vl_c_bsv_108=fa_recup_dico("bsv_108");
$vl_c_bsv_109=fa_recup_dico("bsv_109");$vl_c_bsv_109="Format date";
$vl_c_bsv_110=fa_recup_dico("bsv_110");$vl_c_bsv_110="JJ/MM/AAAA";
$vl_c_bsv_111=fa_recup_dico("bsv_111");$vl_c_bsv_111="AAAA-MM-JJ";
$vl_c_bsv_112=fa_recup_dico("bsv_112");$vl_c_bsv_112="IntitulÃ© compte acteur";
$vl_c_dico00051=fa_recup_dico('dico_00051');
$vl_c_dico00052=fa_recup_dico('dico_00052');
$vl_c_dico00053=fa_recup_dico("dico_00053");
$vl_c_dico00054=fa_recup_dico('dico_00054');
$vl_c_dico00055=fa_recup_dico("dico_00055");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_dico_00149=fa_recup_dico("dico_00149");
$ml_journal_remise=fa_brik_menulist_journaux("1","ml_journal_remise","","","-1");
$vl_tc_composants=array($vl_c_id_fenetre);
$vl_c_menu_context="<popup id='pop_ecritures'>";
$vl_c_menu_context.="<menuitem class='menuitem-iconic ad09' label='$vl_c_dico_00106' tooltiptext='$vl_c_dico_00106' oncommand='fa_infos_colonnes_arbre_recup(\"$vl_c_id_fenetre\",\"arbre_des_ecritures\");'/><menuseparator />";
$vl_c_menu_context.=<<<EOT
  <menuitem label="$vl_c_dico00055" tooltiptext='$vl_c_dico_00055' oncommand="pf_recup_sql('ods');" class="menuitem-iconic ac12" collapsed="true"/>
  <menuitem label="$vl_c_dico00052" tooltiptext='$vl_c_dico_00052' oncommand="pf_recup_sql('rdf');" class="menuitem-iconic ak02" collapsed="true"/>
  <menuitem label="$vl_c_dico00053" tooltiptext='$vl_c_dico_00053' oncommand="pf_recup_sql('htm');" class="menuitem-iconic ak03" collapsed="true"/>
  <menuitem label="$vl_c_dico00054" tooltiptext='$vl_c_dico_00054' disabled="true" oncommand="pf_recup_sql('xml');" class="menuitem-iconic ak04" collapsed="true"/>
  <menuitem dir="reverse" label="$vl_c_dico00051" tooltiptext='$vl_c_dico_00051' oncommand="pf_export_excel_01('raf');" class="menuitem-iconic ak05"/>
EOT;
$vl_c_menu_context.="</popup>";
include("_graal_header_winxul.inc.php");
echo <<<END
<window context="graal_cp00" title="$vl_c_bsv_100" id="_win_fen_treso_journaux_banque" onload="fa_aa(this);pf_aa_init();" onunload="pf_onunload();" $c_xmlns>
$vl_c_graal_cp00
$vl_c_menu_context
END;
include("_graal_visites.inc.php");
include("js/_graal_treso_journaux_02.js.php");
include_once("js/_graal_01.js.php");
echo <<<END
<vbox id="bbb_ove_01" >
<hbox flex="1">
END;
  $id_pref="";$id_deb="bbo_tb_deb";$id_fin="bbo_tb_fin";$trimestres="oui";include ("_graal_inc_choix_periodes_01.php");
echo <<<END
<groupbox>
    <caption><label value="$vl_c_bsv_109" /></caption>
    <radiogroup id='rdg_formatdate' flex="1" value="1">
      <hbox>
        <radio id='rdg_formatdate_jj' label="$vl_c_bsv_110" value='1' />
        <spacer flex="1"/>
        <radio id='rdg_formatdate_aa' label="$vl_c_bsv_111" value='2' />
       </hbox>
     </radiogroup>
    </groupbox>
$ml_journal_remise
<keyset id="_graal_ks_02">
    <key id="k-recherche" modifiers="alt" keycode="VK_F3" oncommand="pf_approximatif();"/>
	</keyset>
 <toolbarbutton class="table-rafraichir" id="bbo_top_raf01" oncommand="pf_approximatif();"/>
    <toolbarbutton id="bt_info_fen" class="ab19" label="$vl_c_dico_00149"  crop="end" dir="normal" oncommand="fa_infos_fenetre('$vl_c_id_fenetre')" />  
</hbox>
</vbox>
<hbox flex="100" class="overflow_01">
  
  <tree id="arbre_des_ecritures" enableColumnDrag="true" flex="1" flags="" ref="*" querytype="xml" datasources="" seltype="single" context="pop_ecritures">
  <treecols>
 <treecol id="facture" label="$vl_c_bsv_101" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="date_de_facture" label="$vl_c_bsv_102" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="raison_sociale"  label="$vl_c_bsv_103"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="debit" class="droite" label="$vl_c_bsv_105" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="val_debit" class="droite" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="credit" class="droite" label="$vl_c_bsv_106" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="val_credit" class="droite" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="intitule_compta" class="droite" label="$vl_c_bsv_107" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="compte_compta" class="droite" label="$vl_c_bsv_108" /><splitter class="tree-splitter" resizeafter="grow"/>
 <treecol id="intitule_compte_acteur"  label="$vl_c_bsv_112"/><splitter class="tree-splitter" resizeafter="grow"/>
 </treecols>
 <template><query expr="*"/><action>
 <treechildren>

 <treeitem container="true" uri="?" seltype="single">
 <treerow>
 <treecell properties="?properties" label="?no_piece" />
 <treecell properties="?properties" label="?date_reglement"/>
 <treecell properties="?properties" label="?libelle"/>
 <treecell properties="?properties" label="?debit"/>
 <treecell properties="?properties" label="?val_debit"/>
 <treecell properties="?properties" label="?credit"/>
 <treecell properties="?properties" label="?val_credit"/>
 <treecell properties="?properties" label="?compte_acteur"/>
 <treecell properties="?properties" label="?compte_banque"/>
 <treecell properties="?properties" label="?intitule_compte_acteur"/>
 </treerow>
 </treeitem>
 </treechildren>
 </action></template>
 </tree>
  
  
  </hbox> 
</window>
END;
?>
