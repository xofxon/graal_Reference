<?php
include("_graal_header_xml.inc.php");
define('EOL', "\r\n");
$vl_e_uti_cleunik=intval(fa_recup_param('vl_e_uti_cleunik','0'));
$vl_e_type=intval(fa_recup_param('vl_e_type','0'));
$vl_e_langue=120131;  //  français par défaut
//  Fenêtres pour lesquelles, pour un utilisateur donnée, il n'y a aucun droits
$sql_req = "SELECT _objets.fen_cleunik as fen_cleunik,_objets.titre AS titre,_objets_libelle.descriptif AS descriptif FROM _objets,_objets_libelle WHERE _objets.type_objet=$vl_e_type and _objets_libelle.langue=$vl_e_langue and _objets_libelle.fen_cleunik=_objets.fen_cleunik and _objets.fen_cleunik not in (select _droits_uti_fen.fen_cleunik from _droits_uti_fen where _droits_uti_fen.uti_cleunik=$vl_e_uti_cleunik) ORDER BY titre;";
$result = _graal_requete_bd($sql_req);
echo(fa_xcree_entete_rdf());
  // boucle de récupération des enregistrements de la requête et génération du contenu RDF
  while ($row = mysql_fetch_assoc($result))
    {
      echo('<RDF:li>'.EOL);
      echo('<RDF:Description>');
      // parseType = indication pour le type des données, utile pour le tri sur la colonne
      echo('<row:fen_cleunik NC:parseType="Integer">'.fa_ent_xml($row['fen_cleunik']).'</row:fen_cleunik>');
      echo('<row:titre>'.fa_ent_xml($row['titre']).'</row:titre>');
      echo('<row:descriptif>'.fa_ent_xml($row['descriptif']).'</row:descriptif>');
      echo('</RDF:Description>'.EOL);
      echo('</RDF:li>'.EOL);
    }
echo('</RDF:Bag>'.EOL);
echo('</RDF:RDF>'.EOL);
_graal_libere_requete_bd($result);
_graal_ferme_connexion();
?>
