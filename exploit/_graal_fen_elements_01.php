<?php
include("_graal_header_xul.inc.php");
$vl_e_type=intval(fa_recup_param('vl_e_type','1'));  //  fenêtres par défaut
$vl_e_fen_cleunik=intval(fa_recup_param('vl_e_fen_cleunik',0));
switch ($vl_e_type){
  case 1 :$vl_c_id_fenetre="Fen_00094";$vl_c_id_inc_objets="Div_00005";$vl_c_id_inc_elements="Div_00004";$vl_c_dupliqu="Fen_00109";break;  // Gestion des éléments des fenêtres de l'application
  case 2 :$vl_c_id_fenetre="Fen_00103";$vl_c_id_inc_objets="Div_00030";$vl_c_id_inc_elements="Div_00031";$vl_c_dupliqu="Fen_00110";break;  // Gestion des éléments des traitements de l'application
  case 4 :$vl_c_id_fenetre="Fen_00095";$vl_c_id_inc_objets="Div_00003";$vl_c_id_inc_elements="Div_00002";$vl_c_dupliqu="Fen_00108";break;  // Gestion des éléments des autres objets de l'application
  case 11:$vl_c_id_fenetre="Fen_00522";$vl_c_id_inc_elements="Div_00481";break;  // Gestion des éléments d'une fenêtre de l'application
  default :fa_redirige("acces_interdit");break;
}
$vl_c_win_id="win_fen_elements";
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_b_acces=$vl_tb_droits[0];
switch ($vl_e_type){
  case 1 :
  case 2 :
  case 4 :
    $vl_b_acces=true;
    $vl_e_fen_cleunik=0;
    break;
  case 11:
    break;
}
if ($vl_b_acces==false) {fa_redirige("acces_interdit");}
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=1;
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_dico00008=fa_recup_dico("dico_00008");
$vl_c_dico00009=fa_recup_dico("dico_00009");
$vl_c_dico00011=fa_recup_dico("dico_00011");
$vl_c_dico00012=fa_recup_dico("dico_00012");
$vl_c_dico00017=fa_recup_dico("dico_00017");
$vl_c_dico00030=fa_recup_dico("dico_00030");
$vl_c_dico00060=fa_recup_dico("dico_00060");
$vl_c_dico00061=fa_recup_dico("dico_00061");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_bab_100=fa_recup_dico("bab_100");
$vl_c_bab_101=fa_recup_dico("bab_101");
$vl_c_bab_102=fa_recup_dico("bab_102");
$vl_c_bab_103=fa_recup_dico("bab_103");
$vl_c_bab_104=fa_recup_dico("bab_104");
$vl_c_bab_105=fa_recup_dico("bab_105");
$vl_c_bab_106=fa_recup_dico("bab_106");
include("_graal_header_winxul.inc.php");
if ($vl_e_uti_cleunik==1){
$bloc_requete_sql=<<<EOT
<button tooltiptext ="$vl_c_bab_106" width="40" flex="1" id="bt_mysql" label="$vl_c_bab_106" crop="end" dir="normal" oncommand="pf_etat_fen('mysql');" />
EOT;
} else {
	$vl_b_suppr=0;
}
$vl_tc_composants=array($vl_c_id_inc_elements);
echo <<<END
<window context="graal_cp00" _graal_id_fenetre="$vl_c_id_fenetre" id="$vl_c_win_id" title="$vl_c_bab_101" _graal_type="$vl_e_type" _graal_dupliq="$vl_c_dupliqu" onload="fa_aa(this);pf_etat_fen('ini')" $c_xmlns>
$vl_c_graal_cp00
<broadcasterset><broadcaster id="broadcaster_01" /></broadcasterset>
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_elements_01.js.php");
echo <<<END
<keyset id="_graal_ks_01" />
END;
$vl_tb_droits_dupliq=_graal_requete_droits_fenetre($vl_c_dupliqu,$vl_e_uti_cleunik);
if ($vl_tb_droits_dupliq[0]==true){ 
	$pop_complement_aar_cp01="<menuitem label='$vl_c_bab_100' oncommand='pf_duplique_elements();'/>";
}
switch ($vl_e_type){
  case 1 :
  case 2 :
  case 4 :
    echo('<vbox flex="1" id="vb_tableau">');
    include("_graal_inc_objets_01.php");
    echo('</vbox><splitter></splitter>');
  case 11:
    break;
}
echo('<vbox flex="1" id="vb_tableau01">');
include('_graal_inc_elements_01.php');
echo <<<END
</vbox>
<splitter></splitter>

<hbox>
  <vbox flex="1">	
    <hbox>
      <vbox width="70" >  
        <label control="la_titre" value="$vl_c_bab_102"/>
        <textbox id="tb_titre" observes="broadcaster_01"/>
      </vbox>
	    <vbox flex="1">
        <label control="la_descriptif_sommaire" value="$vl_c_bab_103"/>
        <textbox id="tb_descriptif_sommaire" observes="broadcaster_01"/>
      </vbox>
    </hbox>
	    <vbox>
        <label control="la_commentaire" value="$vl_c_bab_104"/>
        <textbox id="tb_commentaire"   multiline="true" width="400" observes="broadcaster_01" />
      </vbox>
      	    <vbox>
        <label control="la_type" value="$vl_c_bab_105"/>
        <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' id="ml_types_elements" _graal_nombre="8" observes="broadcaster_01">
          <menupopup>
            <menuitem value="$vl_c_dico00008" id="1" _graal_type_objet="1" label="$vl_c_dico00008" selected='true'/>
            <menuitem value="$vl_c_dico00009" id="2" _graal_type_objet="2" label="$vl_c_dico00009" selected='false'/>
            <menuitem value="$vl_c_dico00011" id="3" _graal_type_objet="3" label="$vl_c_dico00011" selected='false'/>
            <menuitem value="$vl_c_dico00012" id="4" _graal_type_objet="4" label="$vl_c_dico00012" selected='false'/>
            <menuitem value="$vl_c_dico00017" id="5" _graal_type_objet="5" label="$vl_c_dico00017" selected='false'/>
            <menuitem value="$vl_c_dico00030" id="6" _graal_type_objet="6" label="$vl_c_dico00030" selected='false'/>
            <menuitem value="$vl_c_dico00060" id="7" _graal_type_objet="7" label="$vl_c_dico00060" selected='false'/>
            <menuitem value="$vl_c_dico00061" id="8" _graal_type_objet="8" label="$vl_c_dico00061" selected='false'/>
          </menupopup>
        </menulist>
		</vbox>	

            </vbox>
      <vbox flex="1" id="boutons_standards" >
END;
include("_graal_inc_boutons_01.php");
echo <<<END
$bloc_requete_sql
      </vbox>
  </hbox>
 </window>
END;
?>
