<?php
function fa_brik_menulist_mode_reglements($vv_flex="1",$vv_actif="1",$vv_id="ml_modereglement",$vv_observer="broadcaster_01",$vv_except=""){
  $sql_req = "SELECT reg_cleunik,description,actif FROM _modereg where actif in ($vv_actif)";
  if ($vv_except!='') {$sql_req.=" and reg_cleunik not in($vv_except)";}
  $sql_req.=" order by description;";
  $sql_result = _graal_requete_bd($sql_req);
  $vl_e_nombre=mysql_num_rows($sql_result);
  if (trim($vv_observer)!="") {
    $vv_brik="<menulist sizetopopup='none' class='sans_icone' onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex='$vv_flex' id='$vv_id' observes='$vv_observer' _graal_nombre='$vl_e_nombre'><menupopup>";
  } else {
    $vv_brik="<menulist sizetopopup='none' class='sans_icone' onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' flex='$vv_flex' id='$vv_id' _graal_nombre='$vl_e_nombre'><menupopup>";
  }
  
  if ($vl_e_nombre == 0){
    $vv_brik.="<menuitem value='Aucun mode de règlement !!!' _graal_cleunik='-2' label='Aucun mode de règlement !!!' selected='true'/>";
  } else {
    while ($row = mysql_fetch_assoc($sql_result)){
      if ($row['actif']==2) {
        $classe="obsolete";
      } else {
        $classe="";
      }
      $intitule=fa_remplace_quotes(fa_ent_xml($row['description']));
      $vv_brik.="<menuitem class='.$classe.' value='" .$intitule. "' _graal_cleunik='".$row['reg_cleunik']."' tooltiptext='".$intitule."' label='".$intitule."' selected='true'/>";
    }
  }
  $vv_brik.="</menupopup></menulist>";
  _graal_libere_requete_bd($sql_result);
  return $vv_brik; 
}
?>
