<?php
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_cial_consignes_01";
fa_acces_script();
$vf_c_echo="";
$genreaction=fa_recup_param("genreaction","??");
$vl_commercial_cleunik=intval(fa_recup_param("vl_commercial_cleunik",-1));
switch ($genreaction){
  case "offcli":
  case "cdecli":
  case "livcli":
  case "faccli":
  case "demfou":
  case "cdefou":
  case "recfou":
  case "facfou":
    $fichier="_".$genreaction."_consignes";
    break;
  case "avocli":
  case "avofin":
    $fichier="_avocli_consignes";
    break;
  default:
    $fichier="foireux";
    break;  //  Toutes les actions génériques
}
$vl_action_consi_cleunik=intval(fa_recup_param("vl_action_consi_cleunik",-1));
$vl_act_cleunik=intval(fa_recup_param("vl_e_act_cleunik",-1));
$vl_art_cleunik=intval(fa_recup_param("vl_art_cleunik",-1));
$vf_c_action=fa_recup_param("vf_c_action","??????");
$vl_qte=intval(fa_recup_param("vl_qte","1"));
$qte_colis=intval(fa_recup_param("vl_qte_colis","-1"));
switch (TRUE){
  case $vf_c_action=="supprimer":
    $sql_req = "DELETE FROM $fichier WHERE action_consi_cleunik=$vl_action_consi_cleunik;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vf_c_action=="ajouter":
    $vl_action_consi_cleunik=_graal_requete_max("action_consi_cleunik","$fichier");
    $sql_req = "INSERT INTO $fichier (action_consi_cleunik,commercial_cleunik,act_cleunik,art_cleunik,qte,qte_colis) VALUES ($vl_action_consi_cleunik,$vl_commercial_cleunik,$vl_act_cleunik,$vl_art_cleunik,$vl_qte,$qte_colis)";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vf_c_action=="modifier":
    $sql_req = "UPDATE $fichier set qte=$vl_qte,qte_colis=$qte_colis WHERE action_consi_cleunik=$vl_action_consi_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;
//echo $sql_req;
?>
