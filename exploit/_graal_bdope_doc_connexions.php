<?php
include("_graal_header_txt.inc.php");
include("_graal_var_portee.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_doc_07";
$t_origines_ok[1]="_graal_fen_note_01";
$t_origines_ok[2]="_graal_fen_pseudodocs_01";
fa_acces_script();
define('EOL', "\r\n");
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0')); 
$vl_e_doc_cleunik_droite=intval(fa_recup_param('vl_e_doc_cleunik_droite','0'));
$vl_e_doc_cleunik_gauche=intval(fa_recup_param('vl_e_doc_cleunik_gauche','0'));
$vf_c_action=fa_recup_param('vf_c_action','0');
$vf_c_echo='';
switch (TRUE) {
  case $vf_c_action=='connecter':
    $sql_req = "INSERT INTO _documents_connexions set doc_cleunik_droite=$vl_e_doc_cleunik_droite,doc_cleunik_gauche=$vl_e_doc_cleunik_gauche;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
  case $vf_c_action=='connecter_kilometre':
		$vl_t_listecles=fa_recup_param("vl_t_doc","");
		$vl_t_listecles=unserialize(stripslashes($vl_t_listecles));
		$vl_e_i=-1;
    $droits_groupe=0;
    $droits_lambda=0;
    foreach($vl_t_listecles as $vl_raf) {
      $vl_e_i++;
      $vl_e_doc_cleunik_droite=$vl_t_listecles[$vl_e_i];
			$sql_req = "INSERT INTO _documents_connexions set doc_cleunik_droite=$vl_e_doc_cleunik_droite,doc_cleunik_gauche=$vl_e_doc_cleunik_gauche;";
    	$vf_c_echo=_graal_exec_requete($sql_req);
    }
    break;
  case $vf_c_action=='deconnecter': 
    $sql_req = "delete from _documents_connexions where doc_cleunik_droite=$vl_e_doc_cleunik_droite and doc_cleunik_gauche=$vl_e_doc_cleunik_gauche;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    $sql_req = "delete from _documents_connexions where doc_cleunik_droite=$vl_e_doc_cleunik_gauche and doc_cleunik_gauche=$vl_e_doc_cleunik_droite;";
    $vf_c_echo=_graal_exec_requete($sql_req);
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;       
?>
