<?php
include("_graal_header_xul.inc.php");
include("_graal_var_portee.php");
$vl_e_uti_cleunik =intval(fa_recup_session("vs_uti_cleunik","0"));
$vl_c_genreacteur=fa_recup_param('genreacteur','0');
$vl_e_act_cleunik=intval(fa_recup_param("vl_e_act_cleunik","-1"));
$vl_e_adr_cleunik=intval(fa_recup_param("vl_e_adr_cleunik","-1"));
$vl_e_pays_adresse=intval(fa_recup_param("vl_e_pays_adresse","60000")); //  france par défaut  
switch ($vl_c_genreacteur) {
  case "110000": $vl_c_id_fenetre="Fen_01032";$vl_e_choix_portee="01";break;  //  Adresses postales de l'entreprise (format étranger)
  case "110001": $vl_c_id_fenetre="Fen_01033";$vl_e_choix_portee="02";break;  //  Adresses postales des prospects clients (format étranger)
  case "110002": $vl_c_id_fenetre="Fen_01034";$vl_e_choix_portee="08";break;  //  Adresses postales des prospects fournisseurs (format étranger)
  case "110003": $vl_c_id_fenetre="Fen_01035";$vl_e_choix_portee="04";break;  //  Adresses postales des clients (format étranger)
  case "110004": $vl_c_id_fenetre="Fen_01036";$vl_e_choix_portee="16";break;  //  Adresses postales des fournisseurs (format étranger)
  case "110005": $vl_c_id_fenetre="Fen_01037";$vl_e_choix_portee="32";break;  //  Adresses postales des autres acteurs (format étranger)
  case "110006": $vl_c_id_fenetre="Fen_01038";$vl_e_choix_portee="64";break;  //  Adresses postales des acteurs indéterminés (format étranger)
  default:
    die;  
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_tb_droits[1]=0; //  On n'affiche pas le bouton "ajouter"
$vl_tb_droits[5]=0; //  On n'affiche pas le bouton "détailler"
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=$vl_tb_droits[5];
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bbf_100=fa_recup_dico("bbf_100");
$vl_c_bbf_101=fa_recup_dico("bbf_101");
$vl_c_bbf_102=fa_recup_dico("bbf_102");
$vl_c_bbf_103=fa_recup_dico("bbf_103");
$vl_c_bbf_104=fa_recup_dico("bbf_104");
$vl_c_bbf_105=fa_recup_dico("bbf_105");
$vl_c_bbf_106=fa_recup_dico("bbf_106");
$vl_c_bbf_107=fa_recup_dico("bbf_107");
$vl_c_bbf_108=fa_recup_dico("bbf_108");
$vl_c_bbf_109=fa_recup_dico("bbf_109");
$vl_c_bbf_110=fa_recup_dico("bbf_110");
$vl_c_bbf_111=fa_recup_dico("bbf_111");
$vl_c_bbf_112=fa_recup_dico("bbf_112");   // Raf
$vl_c_dico_00010=fa_recup_dico("dico_00010");
//  On recherche les informations sur l'acteur 
if ($vl_e_act_cleunik!=-1){$vl_c_qui=_graal_requete_acteur($vl_e_act_cleunik);}
$cb_adresses=fa_brik_checkbox_choix(98,1,$vl_e_choix_portee,1,'','cb_adresse_00',"broadcaster_01",0,false,false);
$ml_pays=fa_brik_menulist_choix(60,1,$vl_e_choix_portee,1,'','ml_pays',"broadcaster_01",60000); //  France par défaut
include("_graal_header_winxul.inc.php");
include("_graal_header_textfied.inc.php");
echo <<<END
<window context="graal_cp00" _graal_act_cleunik="$vl_e_act_cleunik" _graal_adr_cleunik="$vl_e_adr_cleunik" title="$vl_c_bbf_100" id="_win_fen_act_adresses" onload="fa_aa(this);pf_aa_init();" $c_xmlns>
$vl_c_graal_cp00
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_act_adresses_02.js.php");
echo <<<END
<broadcasterset>
  <broadcaster id="broadcaster_01" />
</broadcasterset>
<vbox id="hbox_panneaudegauche" flex="1">
<description>$vl_c_qui</description>
<hbox flex="20">
<vbox id="box_boite_outils_xof_03" flex="1">
  <grid>
    <columns flex="1">
      <column/>
      <column flex="1"/>
    </columns>
    <rows>
      <row flex= "1">
        <label control="la_adr_complementnom" value="$vl_c_bbf_102"/>
        <textbox observes="broadcaster_01" id="tb_adr_complementnom"  />
      </row>
      <row flex= "1">
        <label control="la_adr_ligne1" value="$vl_c_bbf_103"/>
        <textbox observes="broadcaster_01" id="tb_adr_ligne1"  />
      </row>
      <row flex= "1">
        <label control="la_adr_ligne2" value="$vl_c_bbf_104"/>
        <textbox observes="broadcaster_01" id="tb_adr_ligne2"  />
      </row>
      <row flex= "1">
        <label control="la_adr_ligne3" value="$vl_c_bbf_105"/>
        <textbox observes="broadcaster_01" id="tb_adr_ligne3"  />
      </row>
	  <row collapsed="true">
	  <label control="la_adr_cp" value="$vl_c_bbf_106" collapsed="true"/> 
		<textbox id="tb_adr_cp" collapsed="true" />
	</row>	
      <row flex= "1">
		<label flex= "1" control="la_adr_ville" value="$vl_c_bbf_107"/>
          <textbox observes="broadcaster_01" flex= "10" id="tb_adr_ville"  />
      </row>
      <row flex= "1">
      </row>
      <row flex= "1">
        <label control="la_choix_cleunik" value="$vl_c_bbf_108"/>
        $ml_pays
      </row>
      <row flex= "1">
        <label control="la_adr_latitude" value="$vl_c_bbf_110"/>
        <hbox flex="1">
          <textbox observes="broadcaster_01" flex="1" id="tb_adr_latitude" type="number" hidespinbuttons="true" decimalplaces="6"  />
          <label flex="1" control="la_adr_longitude" value="$vl_c_bbf_111"/>
          <textbox observes="broadcaster_01" flex="10" id="tb_adr_longitude" type="number" hidespinbuttons="true" decimalplaces="6"  />
        </hbox>
      </row>
      <row flex= "1">
          <label flex="1" control="la_adr_cod" value="$vl_c_bbf_101"/>
          <textbox observes="broadcaster_01" id="tb_adr_cod"  />
      </row>
      <row flex= "1">
        <label control="la_dateheuremodif" value="$vl_c_bbf_109"/>
        <label id="tb_dateheuremodif" />
      </row>

    </rows>
  </grid>
</vbox>
$cb_adresses
</hbox>
<hbox flex="1" id="boutons_standards" >
END;
include("_graal_inc_boutons_01.php");
echo <<<END
</hbox>

</vbox>
</window>
END;
?>
