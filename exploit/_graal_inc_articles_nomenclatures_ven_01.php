<?php
_graal_requete_charge_varlib($vl_c_id_article_nome_ventes,$vl_e_uti_cleunik);
error_reporting(E_ALL ^ E_NOTICE ^ E_WARNING);  //  Pour éviter les warnings éventuels générés par simplexml_load_string
$vl_c_bqk_001=fa_recup_dico("bqk_001");
$vl_c_bqk_002=fa_recup_dico("bqk_002");
$vl_c_bqk_003=fa_recup_dico("bqk_003");
$vl_c_bqk_004=fa_recup_dico("bqk_004");
$vl_c_bqk_005=fa_recup_dico("bqk_005");
$vl_c_bqk_007=fa_recup_dico("bqk_007");
$vl_c_bqk_008=fa_recup_dico("bqk_008");
$vl_c_bqk_009=fa_recup_dico("bqk_009");
$vl_c_bqk_010=fa_recup_dico("bqk_010");
$vl_c_bqk_011=fa_recup_dico("bqk_011");
$vl_c_bqk_013=fa_recup_dico("bqk_013");
$vl_c_bqk_018=fa_recup_dico("bqk_018");
$vl_c_bqk_019=fa_recup_dico("bqk_019");
$vl_c_bqk_020=fa_recup_dico("bqk_020");
$vl_c_bqk_021=fa_recup_dico("bqk_021");
$vl_c_bqk_022=fa_recup_dico("bqk_022");
$vl_c_bqk_023=fa_recup_dico("bqk_023");
$vl_c_bqk_024=fa_recup_dico("bqk_024");
$vl_c_bqk_025=fa_recup_dico("bqk_025");
$vl_c_bqk_026=fa_recup_dico("bqk_026");
$vl_c_dico_00001=fa_recup_dico('dico_00001');
$vl_c_dico_00002=fa_recup_dico('dico_00002');
$vl_c_dico_00003=fa_recup_dico('dico_00003');
$vl_c_dico_00004=fa_recup_dico('dico_00004');
$vl_c_dico_00005=fa_recup_dico('dico_00005');
$vl_c_dico_00006=fa_recup_dico('dico_00006');
$vl_c_dico_00007=fa_recup_dico('dico_00007');
$vl_c_id_fen_nomenclature_ven="Fen_00775";
$vl_tb_droits_nomenc_ven=_graal_requete_droits_fenetre($vl_c_id_fen_nomenclature_ven,$vl_e_uti_cleunik);
if ($vl_tb_droits_nomenc_ven[1]!=0){ $vl_c_ajouter="<button id='bt_nomclatureven_ajouter' class='ajouter' observes='broadcaster_01' tooltiptext='$vl_c_dico_00002' label='$vl_c_dico_00002' oncommand='pf_nomclatureven_ajouter()'/>";}
if ($vl_tb_droits_nomenc_ven[2]!=0){ $vl_c_modifier="<button id='bt_nomclatureven_modifier' class='modifier' observes='broadcaster_01' tooltiptext='$vl_c_dico_00003' label='$vl_c_dico_00003' oncommand='pf_nomclatureven_modifier()'/>";}
if ($vl_tb_droits_nomenc_ven[3]!=0){ $vl_c_supprimer="<button id='bt_nomclatureven_supprimer' class='supprimer' observes='broadcaster_01' tooltiptext='$vl_c_dico_00004' label='$vl_c_dico_00004' oncommand='pf_nomclatureven_supprimer()'/>";}
if (($vl_tb_droits_nomenc_ven[1]!=0) or ($vl_tb_droits_nomenc_fab[2]!=0) or ($vl_tb_droits_nomenc_fab[3]!=0)) {
  $vl_c_enregistrer="<button observes='broadcaster_01' class='enregistrer' id='bt_val_nomencven' tooltiptext ='$vl_c_dico_00005' label='$vl_c_dico_00005' oncommand='pf_nomclatureven_valider()'/>";
  $vl_c_annuler="<button observes='broadcaster_01' class='annuler' id='bt_nomencven_annuler' tooltiptext ='$vl_c_dico_00006' label='$vl_c_dico_00006' oncommand='pf_nomclatureven_annuler()'/>";
}
$vl_c_xml=simplexml_load_string(fa_recup_session("vs_param_environ",""));
$selection_article=fa_ent_xml($vl_c_xml->selection_article->attributes());
echo <<<END
<hbox flex="1">
<vbox flex="3">
      <toolbar grippyhidden="true">
  		  <toolbarbutton class="table-rafraichir" tooltiptext="$vl_c_bqk_001" oncommand="pf_affiche_donnees_nomenclature_ven();"/>
      </toolbar>
<popup id="pop_nomclatureven_arbre_nomenc">
  <menuitem class="menuitem-iconic ai07" label="$vl_c_bqk_013" oncommand="pf_ouvre('nomenc_ven');" />
</popup>
<tree id="arbre_nomenc_ven" flex="20" seltype="single" onselect="pf_sel_arbre_nomenc_ven();" context="pop_nomclatureven_arbre_nomenc">
  <treecols>
    <treecol id="arbre_nomenc_ven_col01" flex="1" label="$vl_c_bqk_007"/><splitter class="tree-splitter" />
    <treecol id="arbre_nomenc_ven_codearticle" flex="3" label="$vl_c_bqk_009"/><splitter class="tree-splitter" />
    <treecol id="arbre_nomenc_ven_quantite" flex="1" label="$vl_c_bqk_008" class="droite" /><splitter class="tree-splitter" />
    <treecol id="arbre_nomenc_ven_col02"  class="colname" primary="true" flex="20" label="$vl_c_bqk_011" /><splitter class="tree-splitter" />
    <treecol id="arbre_nomenc_ven_art_cleunik_pere"  hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" />
    <treecol id="arbre_nomenc_ven_art_cleunik_fils"  hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" />
    <treecol id="arbre_nomenc_ven_modifiable" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" />
  </treecols>
  <treechildren id="fils_arbre_nomenc_ven">
  </treechildren>
</tree>
</vbox>
<splitter/>
<vbox id="bqk_art_nomenclatures_ven_02"> 
<groupbox flex="1">
  <caption><label value="$vl_c_bqk_018"/></caption>
        <grid flex="1">
          <columns >
           <column flex="1" />
           <column flex="4" />
          </columns>
          <rows>
           <row >
             <label value="$vl_c_bqk_007"/>
             <textbox observes="broadcaster_03" id="tb_nomencven_noligne" type="number" hidespinbuttons="true" size="3"   />
           </row>
           <row >
            <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' observes="broadcaster_03" flex="1" id="selart_nomenc_ven_ml_zone" class="normal" oncommand="pf_param_choix_selart_nomenc_ven();" value="$selection_article">
              <menupopup>
                <menuitem label="$vl_c_bqk_010" value="1"/>
                <menuitem label="$vl_c_bqk_009" value="2"/>
                <menuitem label="$vl_c_bqk_019" value="3"/>
              </menupopup>
            </menulist>

            <hbox>
            <textbox observes="broadcaster_03" flex="1" type="autosuggest" autosuggestsearch="" autosuggestparam="recherche" autosuggestlimit="limit" limit="50"
              minlength="2"
              maxrows="50"
              ref="urn:suggest:values"
              label="?label"
              properties="?prop"
              issuggest="?issuggest"
               
              
              _graal_cleunik=""
              id="selart_nomenc_ven"
            />
            <button observes="broadcaster_03" class="ad02" oncommand="pf_nomclatureven_sel_article_pour_ligne();"/>
            </hbox>
           </row>
           <row >
             <label value="$vl_c_bqk_009"/>
             <textbox readonly="true" id="tb_nomencven_codefils"   />
           </row>
           <row >
             <label value="$vl_c_bqk_010"/>
             <textbox readonly="true" id="tb_nomencven_descourfils"   />
           </row>
           <row >
             <label value="$vl_c_bqk_008"/>
             <hbox>
               <textbox observes="broadcaster_03" id="tb_nomencven_quantite" type="number" hidespinbuttons="true" decimalplaces="2"  onblur="pf_nomenclatureven_valorise();" />
               <label value="$vl_c_bqk_020"/>
               <textbox observes="broadcaster_03" id="tb_nomencven_nbdecimales" max="4" min="0" type="number"  onblur="fa_att_set('tb_nomencven_quantite','decimalplaces',this.value);" flex="1"/>
            </hbox>
           </row>
           <row >
             <label value="$vl_c_bqk_021"/>
                <hbox>
                  <textbox id="tb_nomencven_valorisation" type="number" hidespinbuttons="true" decimalplaces="2" readonly="true"  onblur="pf_nomenclatureven_valorise();" _graal_base_valorisation=""/>
                  <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' observes="broadcaster_03" flex="1" id="ml_nomencven_base_valorisation" oncommand="pf_nomclatureven_change_menu_actifs_base_valorisation();" flags="" ref="*" querytype="xml" datasources="">
                    <template><query expr="*"/><action>
                      <menupopup>
                        <menuitem uri="?" class="menuitem-iconic ?prop" _graal_nombre="?nombre" label="?tar_designation" value="?tar_cleunik" _graal_cleunik="?tar_cleunik" _graal_base_valorisation="?pu_reference"/> <!--  Les tarifs -->
                      </menupopup>
                    </action></template>
                  </menulist>
                  
                </hbox>
            </row>
           <row >
             <label value="$vl_c_bqk_022"/>
             <hbox>
               <textbox observes="broadcaster_03" id="tb_nomencven_valeur_complement" type="number" hidespinbuttons="true" decimalplaces="2"  onblur="pf_nomenclatureven_valorise();" />
               <label value="Type"/>
                <menulist sizetopopup="none" onfocus='setTimeout(fa_focus_gere_menulist, 0, this);' observes="broadcaster_03" flex="1" id="ml_nomencven_valeur_complement_type" class="normal" oncommand="pf_nomenclatureven_valorise();">
              <menupopup>
                <menuitem label="$vl_c_bqk_023" value="1" selected="true"/>
                <menuitem label="$vl_c_bqk_024" value="2" />
              </menupopup>
            </menulist>
            </hbox>
            </row>
           <row >
             <label value="$vl_c_bqk_025"/>
                <hbox>
                  <textbox id="tb_nomencven_valeurligne" type="number" hidespinbuttons="true" decimalplaces="2" readonly="true"  />
                  <_graal_raf flex="1" />
                </hbox>
            </row>

           <row flex= "10">
             <label value="$vl_c_bqk_026" flex="10"/>
             <textbox observes="broadcaster_03" id="tb_nomencven_blocnotebrut" multiline="true" row="10"   flex= "10"/>
           </row>
					<row flex= "1" collapsed="true">
						<_graal_raf />
						<hbox flex="1">
							<caption><label value="$vl_c_bqk_002" /></caption>
		          <radiogroup id='rdg_nomencven_ajout_pv_pere' flex="1" value="2" disabled="true">
		            <hbox>
		              <radio id='ra_nomencven_ajout_pv_pere_oui' label="$vl_c_dico_00013" value='1' />
		              <spacer flex="1"/>
		              <radio id='ra_nomencven_ajout_pv_pere_non' label="$vl_c_dico_00014" value='2'/>
		             </hbox>
		           </radiogroup>
						</hbox>	
					</row>	
					<row flex= "1" collapsed="true">
						<_graal_raf />
						<hbox flex="1">
							<caption><label value="$vl_c_bqk_003" /></caption>
		          <radiogroup id='rdg_nomencven_ajout_pr_pere' flex="1" value="2" disabled="true">
		            <hbox>
		              <radio id='ra_nomencven-ajout_pr_pere_oui' label="$vl_c_dico_00013" value='1' observes="broadcaster_03"/>
		              <spacer flex="1"/>
		              <radio id='ra_nomencven_ajout_pr_pere_non' label="$vl_c_dico_00014" value='2' observes="broadcaster_03"/>
		             </hbox>
		           </radiogroup>
						</hbox>	
					</row>
					<row flex= "1" collapsed="true">
						<_graal_raf />
						<hbox flex="1">
							<caption><label value="$vl_c_bqk_004" /></caption>
		          <radiogroup id='rdg_nomencven_gere_stock' flex="1" value="2" disabled="true">
		            <hbox>
		              <radio id='ra_nomencven_gere_stock_oui' label="$vl_c_dico_00013" value='1' />
		              <spacer flex="1"/>
		              <radio id='ra_nomencven_gere_stock_non' label="$vl_c_dico_00014" value='2'/>
		             </hbox>
		           </radiogroup>
						</hbox>	
					</row>	
					<row flex= "1" collapsed="true">
						<_graal_raf />
						<hbox flex="1">
							<caption><label value="$vl_c_bqk_005" /></caption>
		          <radiogroup id='rdg_nomencven_gere_classique' flex="1" value="1" disabled="true">
		            <hbox>
		              <radio id='ra_nomencven_gere_classique_oui' label="$vl_c_dico_00013" value='1' />
		              <spacer flex="1"/>
		              <radio id='ra_nomencven_gere_classique_non' label="$vl_c_dico_00014" value='2'/>
		             </hbox>
		           </radiogroup>
						</hbox>	
					</row>	
          </rows>
        </grid>
<hbox>
$vl_c_ajouter<spacer flex="1"/>
$vl_c_modifier<spacer flex="1"/>
$vl_c_supprimer<spacer flex="1"/>
$vl_c_enregistrer<spacer flex="1"/>
$vl_c_annuler<spacer flex="1"/>
</hbox>
</groupbox>
</vbox>
</hbox>
END;
?>
