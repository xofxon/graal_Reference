<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_c_genredoc=fa_recup_param('vl_c_genredoc','');
$vl_e_doc_cleunik=intval(fa_recup_param('vl_e_doc_cleunik','0'));
switch ($vl_c_genredoc){
  case "Notes" : $vl_c_id_fenetre="Fen_00063";break;  //Gestion des droits des notes
  case "Docus" : $vl_c_id_fenetre="Fen_00061";break;  //Gestion des droits des documents
  case "Pseud" : $vl_c_id_fenetre="Fen_00062";break;  //Gestion des droits des pseudos-documents
  case "Flrss" : $vl_c_id_fenetre="Fen_01002";break;  //Gestion des droits des Flux Rss
  default: fa_redirige("acces_interdit");break;
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];
$vl_c_dico_00001=fa_recup_dico('dico_00001');
$vl_c_dico_00002=fa_recup_dico('dico_00002');
$vl_c_dico_00003=fa_recup_dico('dico_00003');
$vl_c_dico_00004=fa_recup_dico('dico_00004');
$vl_c_dico_00005=fa_recup_dico('dico_00005');
$vl_c_dico_00006=fa_recup_dico('dico_00006');
$vl_c_dico_00007=fa_recup_dico('dico_00007');
$vl_c_dico_00106=fa_recup_dico("dico_00106");
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bat_101=fa_recup_dico("bat_101");
$vl_c_bat_102=fa_recup_dico("bat_102");
$vl_c_bat_104=fa_recup_dico("bat_104");
$vl_c_bat_105=fa_recup_dico("bat_105");
$vl_c_bat_106=fa_recup_dico("bat_106");
$vl_c_bat_107=fa_recup_dico("bat_107");
$vl_c_bat_108=fa_recup_dico("bat_108");
$vl_c_bat_109=fa_recup_dico("bat_109");
$vl_c_bat_110=fa_recup_dico("bat_110");
$vl_c_bat_111=fa_recup_dico("bat_111");
$vl_c_bat_112=fa_recup_dico("bat_112");
$vl_c_bat_113=fa_recup_dico("bat_113");
$vl_c_bat_114=fa_recup_dico("bat_114");
include("_graal_header_winxul.inc.php");
echo <<<END
<window context="graal_cp00" title="$vl_c_bat_101" id="_graal_fen_droits_01" _graal_doc_cleunik="$vl_e_doc_cleunik" onload="fa_aa(this);pf_etat_fen('ini')" $c_xmlns >
$vl_c_graal_cp00
<popupset>
  <popup id="pop_arb_ajout">
    <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arb_ajout');" />
  </popup>
  <popup id="pop_arb_modif">
    <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arb_modif');" />
  </popup>
</popupset>

END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_droits_01.js.php");
echo <<<END
<hbox flex="1">
   <vbox flex="1">
   <tree flex="1" tooltiptext="$vl_c_bat_102" id="arb_ajout" enableColumnDrag="true" flags="" ref="*" querytype="xml" datasources="" onselect="pf_sel_ligne(this.id);" context="pop_arb_ajout">
     <treecols> 
       <treecol id="ajo_uti_cleunik" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="ajo_prenom" label="$vl_c_bat_104" sort="?prenom"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="ajo_patronyme" label="$vl_c_bat_105" sort="?patronyme"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="ajo_nomcomplet" label="$vl_c_bat_106" sort="?nomcomplet"/><splitter class="tree-splitter" resizeafter="grow"/>
     </treecols>
     <template><query expr="*"/><action>
       <treechildren >
         <treeitem uri="?" seltype="single">
           <treerow >
             <treecell label="?uti_cleunik"/>
             <treecell label="?prenom"/>
             <treecell label="?patronyme"/>
             <treecell label="?nomcomplet"/>
           </treerow>
         </treeitem>
       </treechildren>
     </action></template>
   </tree>
    </vbox>
    <vbox flex="1">
      <groupbox flex="1">
      <caption><label value="$vl_c_bat_107" /></caption>
      <vbox flex="1">
        <description  id="des_01" />
        <checkbox id="ch_n01" label="$vl_c_bat_108" accesskey="P" />
        <checkbox id="ch_n02" label="$vl_c_bat_109" accesskey="L" checked="true"/>
        <checkbox id="ch_n03" label="$vl_c_bat_110" accesskey="M" />
        <checkbox id="ch_n04" label="$vl_c_bat_111" accesskey="S" />
        <checkbox id="ch_n05" label="$vl_c_bat_112" accesskey="I" disabled="true"/>
      </vbox> 
     </groupbox>
END;
if ($vl_b_ajout==true) { echo('<button width="40" flex="1" id="bt_ajouter" label="'.$vl_c_dico_00002.'" crop="end" dir="normal" oncommand="pf_validation(\'ajouter\')" />');}
else { echo('<spacer flex="1"/>');}
echo <<<END
    </vbox>
</hbox>

<hbox flex="1">
   <vbox flex="1">
   <tree flex="1" tooltiptext="$vl_c_bat_113" id="arb_modif" enableColumnDrag="true" flags="" ref="*" querytype="xml" datasources="" onselect="pf_sel_ligne(this.id);" context="pop_arb_modif">
     <treecols> 
       <treecol id="mod_uti_cleunik" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="mod_prenom" label="$vl_c_bat_104"   sort="?prenom"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="mod_patronyme" label="$vl_c_bat_105"   sort="?patronyme"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="mod_nomcomplet" label="$vl_c_bat_106"   sort="?nomcomplet"/><splitter class="tree-splitter" resizeafter="grow"/>
     </treecols>
     <template><query expr="*"/><action>
       <treechildren >
         <treeitem uri="?" seltype="single">
           <treerow >
             <treecell label="?uti_cleunik"/>
             <treecell label="?prenom"/>
             <treecell label="?patronyme"/>
             <treecell label="?nomcomplet"/>
           </treerow>
         </treeitem>
       </treechildren>
     </action></template>
   </tree>
    </vbox>
    <vbox flex="1">
      <groupbox flex="1">
      <caption><label value="$vl_c_bat_114" /></caption>
      <vbox flex="1">
        <description  id="des_02" />
        <checkbox id="ch_m01" label="$vl_c_bat_108" accesskey="r" />
        <checkbox id="ch_m02" label="$vl_c_bat_109" accesskey="e" />
        <checkbox id="ch_m03" label="$vl_c_bat_110" accesskey="o" />
        <checkbox id="ch_m04" label="$vl_c_bat_111" accesskey="u" />
        <checkbox id="ch_m05" label="$vl_c_bat_112" accesskey="p" disabled="true"/>
      </vbox> 
     </groupbox>
END;
if ($vl_b_modif==true) { echo('<button width="40" flex="1" id="bt_modifier" label="'.$vl_c_dico_00003.'" crop="end" dir="normal" oncommand="pf_validation(\'modifier\')" />');}    
else { echo('<spacer flex="1"/>');}
if ($vl_b_suppr==true){ echo ('<button width="40" flex="1" id="bt_supprimer" label="'.$vl_c_dico_00004.'" crop="end" dir="normal" oncommand="pf_validation(\'supprimer\')" />');}    
else { echo ('<spacer flex="1"/>');}
echo <<<END
    </vbox>
</hbox>
<hbox flex="1">
<button _graal_cleunik="$vl_e_doc_cleunik" width="40" flex="1" id="bt_sortir" label="$vl_c_dico_00007" crop="end" dir="normal" oncommand="pf_etat_fen('sortir')" />
</hbox>
</window>
END;
?>
