<?php
include("_graal_header_xul.inc.php");
$vl_e_uti_cleunik=intval(fa_recup_session("vs_uti_cleunik","0"));
$vl_c_genreaction=fa_recup_param("genreaction","???");
$vl_c_destination=fa_recup_param("destination","nullepart");
$vl_c_visu=fa_recup_param("visu","non");
$lesquels=fa_recup_param("lesquels","raf");
$vl_e_doc_cleunik=intval(fa_recup_param("vl_e_doc_cleunik",-1));
$vl_c_dico_00005=fa_recup_dico('dico_00005');
$vl_c_dico_00106=fa_recup_dico('dico_00106');
switch ($vl_c_genreaction){
	case "faccli":
		switch ($vl_c_destination){
		  case "edition":$vl_c_id_fenetre="Fen_01069";$vl_c_action="";$vl_c_particularisme="";break;
		  case "compta":$vl_c_id_fenetre="Fen_01071";$vl_c_action="comptabilise";$vl_c_particularisme=5;break;
		  case "decompta":$vl_c_id_fenetre="Fen_01084";$vl_c_action="enleve";$vl_c_particularisme=6;break;
		  default:fa_redirige("acces_interdit");
		}
		break;
	case "avocli":
		switch ($vl_c_destination){
		  case "edition":$vl_c_id_fenetre="Fen_01118";$vl_c_action="";$vl_c_particularisme="";break;
		  case "compta":$vl_c_id_fenetre="Fen_01119";$vl_c_action="comptabilise";$vl_c_particularisme=13;break;
		  case "decompta":$vl_c_id_fenetre="Fen_01120";$vl_c_action="enleve";$vl_c_particularisme=8;break;
		}
		break;
	case "facfou":
		switch ($vl_c_destination){
		  case "edition":$vl_c_id_fenetre="Fen_01121";$vl_c_action="";$vl_c_particularisme="";break;
		  case "compta":$vl_c_id_fenetre="Fen_01122";$vl_c_action="comptabilise";$vl_c_particularisme=9;break;
		  case "decompta":$vl_c_id_fenetre="Fen_01123";$vl_c_action="enleve";$vl_c_particularisme=10;break;
		  default:fa_redirige("acces_interdit");
		}
		break;	
	case "avofou":
		switch ($vl_c_destination){
		  case "edition":$vl_c_id_fenetre="Fen_01152";$vl_c_action="";$vl_c_particularisme="";break;
		  case "compta":$vl_c_id_fenetre="Fen_01153";$vl_c_action="comptabilise";$vl_c_particularisme=16;break;
		  case "decompta":$vl_c_id_fenetre="Fen_01154";$vl_c_action="enleve";$vl_c_particularisme=17;break;
		  default:fa_redirige("acces_interdit");
		}
		break;	
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$id_inc_actions_recherche="Div_00573";
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=0;
$vl_tc_composants=array($id_inc_actions_recherche);
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bsk_100=fa_recup_dico("bsk_100");
$vl_c_bsk_101=fa_recup_dico("bsk_101");
$vl_c_bsk_102=fa_recup_dico("bsk_102");
$vl_c_bsk_103=fa_recup_dico("bsk_103");
$vl_c_bsk_104=fa_recup_dico("bsk_104");
$vl_c_bsk_105=fa_recup_dico("bsk_105");
$vl_c_bsk_107=fa_recup_dico("bsk_107");
$vl_c_bsk_110=fa_recup_dico("bsk_110");$vl_c_bsk_110="Re-comptabiliser";
if ($vl_c_destination=="decompta"){
	$recompta=<<<EOT
	<button tooltiptext ="$vl_c_bsk_110" keycode="k-enregistrer" flex="1" id="bt_recomptabilise" label="$vl_c_bsk_110" orient="horizontal" crop="end" oncommand="pf_validation('recompta')" />
EOT;
}
include("_graal_header_winxul.inc.php");
$c_id_windows=$vl_c_id_fenetre;
$vl_c_pop_selections="";$vl_c_pop_panier="";
$vl_c_pop_selections.="<popupset><popup id='pop_selections'>";
$vl_c_pop_selections.='<menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\''."arbre_actions_01".'\');" />';
$vl_c_pop_selections.='<menuseparator/>';
$vl_c_pop_selections.="<menuitem class='menuitem-iconic af08' label='$vl_c_bsk_101' oncommand='pf_action_ouvre(\"arbre_actions_01\");' />";
$vl_c_pop_selections.='<menuitem class="menuitem-iconic ak11" label="'.$vl_c_bsk_102.'" oncommand="pf_panier_ajoute();" />';
$vl_c_pop_selections.="</popup></popupset>";
$vl_c_pop_panier.="<popupset><popup id='pop_panier'>";
$vl_c_pop_panier.='<menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\''."arbre_actions_panier".'\');" />';
$vl_c_pop_panier.='<menuseparator/>';
$vl_c_pop_panier.="<menuitem class='menuitem-iconic af08' label='$vl_c_bsk_103' oncommand='pf_action_ouvre(\"arbre_actions_panier\");' />";
$vl_c_pop_panier.="<menuitem class='menuitem-iconic ak12' label='$vl_c_bsk_104' oncommand='pf_panier_enleve();'/>";
$vl_c_pop_panier.="</popup></popupset>";
echo <<<END
<window context="graal_cp00" title="$vl_c_bda_100" id="$c_id_windows" onload="fa_aa(this);pf_aa_init_bem('21')" onunload="pf_onunload();" $c_xmlns>
$vl_c_graal_cp00
<broadcasterset><broadcaster id="broadcaster_01" /></broadcasterset>
$vl_c_pop_selections
$vl_c_pop_panier
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_04.js.php");
include_once("js/_graal_actions_faccli_01.js.php");
include_once("js/_graal_05_dates.js.php");
$vl_b_bloc_action_recherche=true;$vl_c_arbre_action="arbre_actions_01";
echo('<vbox flex="10" class="overflow_01">');
include ("_graal_inc_actions_recherche_01.php");
$vl_b_bloc_action_recherche=false;$vl_c_arbre_action="arbre_des_actions_panier";
include ("_graal_inc_actions_recherche_01.php");
echo('<vbox><hbox id="boutons_standards">'); 
echo <<<END
	<progressmeter id="pm_evolution_01" mode="determined" value="0" collapsed="true" flex="1"/>
	<progressmeter id="pm_evolution_02" mode="determined" value="0" collapsed="true" flex="1"/>
	<button tooltiptext ="$vl_c_bsk_107 Ctrl+Shift+F5" keycode="k-enregistrer" flex="1" id="bt_enregistrer" label="$vl_c_bsk_107" orient="horizontal" crop="end" oncommand="pf_validation('$vl_c_destination')" />
    $recompta
	<button flex="1" id="bt_sortir" label="$vl_c_dico_00007" crop="end" dir="normal" oncommand="pf_etat_fen_bem('sortir')" collapsed="true"/>
</hbox></vbox></vbox>
END;
if ($vl_c_visu=="oui") {
echo <<<END
<splitter ondblclick="aad_pf_cache();"> </splitter>
  <vbox flex="10">
      <iframe onload="fa_aa(window.graal_iframe_visu_action);event.stopPropagation();" id="graal_iframe_visu_action" src="" flex="1"/>
  </vbox>
END;
}
echo("</window>");
?>
