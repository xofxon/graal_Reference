<?php
$vl_c_id_vbox=fa_recup_param('vl_c_id_vbox','bel_ged_01');
_graal_requete_charge_varlib($vl_c_id_article_image,$vl_e_uti_cleunik);
$vl_c_bel_001=fa_recup_dico("bel_001");
$vl_c_bel_002=fa_recup_dico("bel_002");
$vl_c_bel_003=fa_recup_dico("bel_003");
$vl_c_bel_004=fa_recup_dico("bel_004");
$vl_c_bel_005=fa_recup_dico("bel_005");
$vl_c_bel_006=fa_recup_dico("bel_006");
$vl_c_bel_007=fa_recup_dico("bel_007");
$vl_c_bel_008=fa_recup_dico("bel_008");
$vl_c_bel_009=fa_recup_dico("bel_009");
switch ($vl_c_id_article_image) {
  case "Div_00368": //Tous les articles
    $vl_tb_droits_documents=_graal_requete_droits_fenetre("Fen_00418",$vl_e_uti_cleunik);
    $vl_c_bloc_documents="";
    if ($vl_tb_droits_documents[0]!=0){
      $vl_c_bloc_documents='<toolbarseparator /><hbox id="bloc_ged_image"><label value="'.$vl_c_bel_006.'"/>';
      $vl_c_bloc_documents.='<toolbarbutton class="ai03" id="tb_ged_image_02" observes="broadcaster_01" tooltiptext="'.$vl_c_bel_007.'" oncommand="pf_ged_image_ouvre();" />';
      if ($vl_tb_droits_documents[1]!=0){$vl_c_bloc_documents.='<toolbarbutton class="al08" id="tb_ged_image_01" observes="broadcaster_01" tooltiptext="'.$vl_c_bel_005.'" oncommand="pf_ged_ajout(\'ged_image\');"/>';}
      $vl_c_bloc_documents.='</hbox><toolbarseparator />';
    }  
  case "Div_00536": //Logos de l'entreprise
    $vl_tb_droits_documents=_graal_requete_droits_fenetre("Fen_00733",$vl_e_uti_cleunik);
    $vl_c_bloc_documents="";
    if ($vl_tb_droits_documents[0]!=0){
      $vl_c_bloc_documents='<toolbarseparator /><hbox id="bloc_ged_image"><label value="'.$vl_c_bel_006.'"/>';
      $vl_c_bloc_documents.='<toolbarbutton class="ai03" id="tb_ged_image_02" observes="broadcaster_01" tooltiptext="'.$vl_c_bel_007.'" oncommand="pf_ged_image_ouvre();" />';
      if ($vl_tb_droits_documents[1]!=0){$vl_c_bloc_documents.='<toolbarbutton class="al08" id="tb_ged_image_01" observes="broadcaster_01" tooltiptext="'.$vl_c_bel_005.'" oncommand="pf_ged_ajout(\'ged_image\');"/>';}
      $vl_c_bloc_documents.='</hbox><toolbarseparator />';
    }  

}
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_context_00='<popupset><popup id="pop_arbre_des_images"><menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\'arbre_des_images\');" /></popup></popupset>';
echo <<<END
$vl_c_context_00
<vbox id="$vl_c_id_vbox" flex="1">  
  <hbox flex="1">
  <vbox flex="1">
    <vbox hidden="$vb_barre_hidden" >
      <toolbar grippyhidden="true">
  		  <toolbarbutton class="table-rafraichir" tooltiptext="$vl_c_bel_014" oncommand="pf_affiche_donnees_images();"/>
        $vl_c_bloc_documents
      </toolbar>
    </vbox>    
    <tree id="arbre_des_images" enableColumnDrag="true" flex="1" flags="" ref="*" querytype="xml" datasources="" seltype="single" ondblclick="pf_ged_image_ouvre('');" onselect="pf_affiche_image();" context="pop_arbre_des_images">
      <treecols>
        <treecol id="image_doc_cleunik" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="image_emplacement" label="$vl_c_bel_001" sort="?emplacement"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="image_titre" label="$vl_c_bel_002" sort="?titre"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="image_typedoc" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="image_descriptif_sommaire" label="$vl_c_bel_003" sort="?descriptif_sommaire"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="image_origine" label="$vl_c_bel_004" sort="?origine"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="image_portee" hidden="true" ignoreincolumnpicker="true"/><splitter class="tree-splitter" resizeafter="grow"/>
        <treecol id="image_tailledoc" label="$vl_c_bel_009" sort="?tailledoc"/><splitter class="tree-splitter" resizeafter="grow"/>
     </treecols>
      <template><query expr="*"/><action>
        <treechildren>
          <treeitem uri="?" seltype="single">
            <treerow>
              <treecell label="?doc_cleunik" />
              <treecell label="?emplacement"/>
              <treecell properties="?properties" label=" ?titre"/>
              <treecell label="?typedoc" />
              <treecell label="?descriptif_sommaire"/>
              <treecell label="?origine"/>
              <treecell label="?portee"/>
              <treecell label="?tailledoc"/>
            </treerow>
          </treeitem>
        </treechildren>
      </action></template>
    </tree>
  </vbox>
  <splitter />
  <vbox flex="1">
    <button label="$vl_c_bel_008" observes="broadcaster_01" oncommand="pf_affiche_image();"/>
    <iframe onload="event.stopPropagation();" id="ifr_image" flex="1" src=""/>
  </vbox>
  </hbox>
</vbox>
END;
?>
