<?php
include("_graal_header_xul.inc.php");
$vl_c_win_id="_graal_modelecourriel_01";
$vl_c_quelsdocs=fa_recup_param('quelsdocs','?');
$vl_e_doc_cleunik=fa_recup_param('doc_cleunik','A');
$vl_c_genre=fa_recup_param('genre','utilis');
$vl_c_type=fa_recup_param('type','');
$vl_e_portee_cleunik=fa_recup_param('portee_cleunik','0');
switch ($vl_c_type){
  case "texte":
    $_graal_typedoc="6";
    switch ($vl_c_quelsdocs){
      case "menot"  : $vl_c_id_fenetre="Fen_00090";$vl_c_id_inc_note="Div_00115";break;  //Mes modèles de courriel texte
      case "nosnot" : $vl_c_id_fenetre="Fen_00091";$vl_c_id_inc_note="Div_00114";break;  // Nos modèles de courriel texte
      case "leurnot": $vl_c_id_fenetre="Fen_00089";$vl_c_id_inc_note="Div_00014";break; //  Leurs modèles de courriel texte
      default : fa_redirige("acces_interdit");break;
    }
    break;
  case "notif":
    $_graal_typedoc="12";
    switch ($vl_c_quelsdocs){
      case "menot"  : $vl_c_id_fenetre="Fen_00578";$vl_c_id_inc_note="Div_00494";break;  // Mes modèles de notification de lecture
      case "nosnot" : $vl_c_id_fenetre="Fen_00579";$vl_c_id_inc_note="Div_00493";break;  // Nos modèles de notification de lecture
      case "leurnot": $vl_c_id_fenetre="Fen_00580";$vl_c_id_inc_note="Div_00493";break; //  Leurs modèles de notification de lecture
      default : fa_redirige("acces_interdit");break;
    }
    break;
  default : fa_redirige("acces_interdit");break;
}

$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=1;
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bag_100=fa_recup_dico("bag_100");
$vl_c_bag_101=fa_recup_dico("bag_101");
$vl_c_bag_102=fa_recup_dico("bag_102");
$vl_c_bag_103=fa_recup_dico("bag_103");
$vl_c_bag_104=fa_recup_dico("bag_104");
$vl_c_bag_105=fa_recup_dico("bag_105");
$vl_c_bag_106=fa_recup_dico("bag_106");
$vl_c_dico_00013=fa_recup_dico("dico_00013");
$vl_c_dico_00014=fa_recup_dico("dico_00014");
$vl_c_dico_00106=fa_recup_dico("dico_00106");
include("_graal_header_winxul.inc.php");
$vl_tc_composants=array($vl_c_id_inc_note);
echo <<<END
<window context="graal_cp00" _graal_id_fenetre="$vl_c_id_fenetre" id="$vl_c_win_id" title="$vl_c_bag_100" onload="fa_aa(this);pf_etat_fen('ini')" $c_xmlns>
$vl_c_graal_cp00
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_modeles_textes_01.js.php");
echo <<<END
<broadcasterset>
  <broadcaster id="broadcaster_01" />
</broadcasterset>
<keyset>
  <key id="key_masque_tab" modifiers="accel" key="A" oncommand="pf_cache_tab();"/>
</keyset>
<popupset>
  <popup id="bag_cp01">
  <menuitem label="Cacher la partie haute" key="key_masque_tab" oncommand="pf_cache_tab()"/> 
  </popup>
<popup id="pp_actions">
    <menuitem class="menuitem-iconic ad09" label="$vl_c_dico_00106" oncommand="fa_infos_colonnes_arbre_recup('$vl_c_id_fenetre','arbre_des_notes');" />
   </popup>
  </popupset>
<vbox flex="1" id="vb_tableau">
<_graal_conteneur id="bt_actualiser" context="bag_cp01" label="$vl_c_bag_102" _graal_typedoc="$_graal_typedoc" _graal_genre ="modeles_courriels" _graal_lesquels="$vl_c_quelsdocs"/>
END;
include("_graal_inc_note_01.php");
echo <<<END
</vbox>
<splitter></splitter>
<hbox flex="2">
  <vbox flex="1">	
    <menubar id="menu_menus" >
      <toolbarseparator />
      <menu id="menu_02" observes="broadcaster_01" label="$vl_c_bag_105"  >
        <menupopup>
          <menuitem id="menu_02_01" label="$vl_c_bag_106" oncommand="pf_action('droits')" />
        </menupopup>
      </menu>
    </menubar>
    <hbox >
      <vbox flex="1">  
        <label control="la_titre" value="$vl_c_bag_103"/>
        <textbox observes="broadcaster_01" id="tb_titre" width="300"   />
      </vbox>
	    <vbox flex="2">
        <label control="la_descriptif_sommaire" value="$vl_c_bag_104"/>
        <hbox flex="1">
					<textbox flex="1" observes="broadcaster_01" id="tb_descriptif_sommaire"   width="400" />
	        <label control="la_origine" value="Considérer comme sujet"/>
	        <radiogroup id='tb_origine' value="2">
	          <hbox>
	            <radio observes="broadcaster_01" id='ra_defaut_oui' label="$vl_c_dico_00013" value='1' />
	            <radio observes="broadcaster_01" id='ra_defaut_non' label="$vl_c_dico_00014" value='2'/>
	           </hbox>
	         </radiogroup>
				</hbox>
      </vbox>
    </hbox>
			<textbox id="tb_blocnote_riche" flex="2" multiline="true" observes="broadcaster_01"  />
		</vbox>	
		</hbox>
      <hbox  id="boutons_standards" >
END;
include("_graal_inc_boutons_01.php");
echo <<<END
</hbox>
 </window>
END;
?>
