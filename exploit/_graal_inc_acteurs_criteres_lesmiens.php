<?php
//  Tableau des critères des acteurs (vue "la mienne")
_graal_requete_charge_varlib($vl_c_id_inc_acteurs_criteres_lesmiens,$vl_e_uti_cleunik);
$vl_c_bcj_004=fa_recup_dico("bcj_004");
$vl_c_bcj_005=fa_recup_dico("bcj_005");
$vl_c_bcj_006=fa_recup_dico("bcj_006");
$vl_c_bcj_007=fa_recup_dico("bcj_007");
$vl_c_mes_00007=fa_recup_dico("mess_00007");
$vl_c_mes_00009=fa_recup_dico("mess_00009");
switch ($vl_c_id_inc_acteurs_criteres_lesmiens){
  case "Div_00264": $vl_c_id_fen_criteres="000000000";break;  //  Interlocuteurs de tous les acteurs On considère dans ce cas qu'il n'y a pas de test de gestion des droits
  case "Div_00263": $vl_c_id_fen_criteres="000000000";break;  //  Interlocuteurs des acteurs favoris On considère dans ce cas qu'il n'y a pas de test de gestion des droits
  case "Div_00265": $vl_c_id_fen_criteres="Fen_00299";break;  //  prospects clients
  case "Div_00266": $vl_c_id_fen_criteres="Fen_00300";break;  //  prospects fournisseurs
  case "Div_00267": $vl_c_id_fen_criteres="Fen_00301";break;  //  clients
  case "Div_00268": $vl_c_id_fen_criteres="Fen_00302";break;  //  fournisseurs
  case "Div_00269": $vl_c_id_fen_criteres="Fen_00303";break;  //  autres acteurs
  case "Div_00270": $vl_c_id_fen_criteres="Fen_00304";break;  //  acteurs indéterminés
  default:
    die;  
}
echo <<<END
<vbox id="bcj_acteurs_criteres_lesmiens" flex="3">
     <toolbar grippyhidden="true">
     <toolbarbutton class="table-rafraichir" tooltiptext="$vl_c_mes_00007" oncommand="pf_affiche_donnees_criteres_lesmiens();"/>
     <label value="$vl_c_bcj_007"/>
END;
if ($vl_c_id_fen_criteres!="000000000") {$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fen_criteres,$vl_e_uti_cleunik);} else {$vl_tb_droits[0]=1;}
if ($presence_bloc_interlo_lesmiens=="false"){
	$vl_tb_droits[0]=0;
}
if ($vl_tb_droits[0]!=0){
echo <<<END
    <hbox id="bloc_interlo_lesmiens">
      <toolbarbutton class="ak15" observes="broadcaster_01" tooltiptext="$vl_c_mes_00009" oncommand="pf_ouvre('critere_lesmiens','ouvrir');"/>
    </hbox>
END;
}
$vl_c_dico_00106=fa_recup_dico("dico_00106");
$vl_c_context_00='<popupset><popup id="pop_criteres_des_acteurs_lesmiens"><menuitem class="menuitem-iconic ad09" label="'.$vl_c_dico_00106.'" oncommand="fa_infos_colonnes_arbre_recup(\''.$vl_c_id_fenetre.'\',\'criteres_des_acteurs_lesmiens\');" /></popup></popupset>';
echo <<<END
$vl_c_context_00
  </toolbar>
   <tree id="criteres_des_acteurs_lesmiens" enableColumnDrag="true" flex="2" flags="" ref="*" querytype="xml" datasources="" seltype="single" context="pop_criteres_des_acteurs_lesmiens">
     <treecols>
       <treecol id="act_cleunik_lesmiens$affixe_colonne_criteres_des_acteurs_entreprise" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
       <treecol id="choix_cleunik_lesmiens$affixe_colonne_criteres_des_acteurs_entreprise" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
       <treecol id="critere_cleunik_lesmiens$affixe_colonne_criteres_des_acteurs_entreprise" hidden="true" ignoreincolumnpicker="true" /><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="critere_denomination_lesmiens$affixe_colonne_criteres_des_acteurs_entreprise" label="$vl_c_bcj_004" sort="?critere_denomination"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="choix_code_lesmiens$affixe_colonne_criteres_des_acteurs_entreprise" label="$vl_c_bcj_005" sort="?choix_code"/><splitter class="tree-splitter" resizeafter="grow"/>
      <treecol id="choix_valeur_texte_01_lesmiens$affixe_colonne_criteres_des_acteurs_entreprise" label="$vl_c_bcj_006" sort="?choix_valeur_texte_01"/><splitter class="tree-splitter" resizeafter="grow"/>
     </treecols>
     <template>
		 <query expr="*"/>
			<action>
       <treechildren>
         <treeitem uri="?" seltype="single">
           <treerow>
             <treecell label="?act_cleunik"/>
             <treecell label="?choix_cleunik"/>
             <treecell label="?critere_cleunik"/>
             <treecell label="?critere_denomination"/>
             <treecell label="?choix_code"/>
             <treecell label="?choix_valeur_texte_01"/>
           </treerow>
         </treeitem>
       </treechildren>
			 </action>
     </template>
   </tree>
 </vbox>
END;
?>
