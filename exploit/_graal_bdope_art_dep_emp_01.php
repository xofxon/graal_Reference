<?php
//Devrait être enregistré sous forme _graal_bdope_art_dep_emp_01.php
include("_graal_header_txt.inc.php");
$vf_c_echo="";
$vl_e_mini=intval(fa_recup_session("borne_mini","000000000000"));
$vl_e_maxi=intval(fa_recup_session("borne_maxi","999999999999"));
$vl_art_depemp_cleunik=intval(fa_recup_param("vl_art_depemp_cleunik","-1"));
$vl_art_cleunik=intval(fa_recup_param("vl_art_cleunik","-1"));
$vl_choix_depot=intval(fa_recup_param("vl_choix_depot","-1"));
$vl_choix_empla=intval(fa_recup_param("vl_choix_empla","-1"));
$vf_c_action=fa_recup_param("vf_c_action","??????");
switch (TRUE)
{
  case $vf_c_action=="supprimer":
    $sql_req = "DELETE FROM _art_dep_emp WHERE _art_dep_emp.art_depemp_cleunik = $vl_art_depemp_cleunik";
    break;
  case $vf_c_action=="ajouter":
    $vl_art_depemp_cleunik=_graal_requete_max("art_depemp_cleunik","_art_dep_emp");
    $sql_req = "INSERT INTO _art_dep_emp set art_depemp_cleunik=$vl_art_depemp_cleunik,art_cleunik=$vl_art_cleunik,choix_depot=$vl_choix_depot,choix_empla=$vl_choix_empla;";
    break;
  case $vf_c_action=="modifier":
    $sql_req = "UPDATE _art_dep_emp set choix_depot='$vl_choix_depot',choix_empla='$vl_choix_empla' WHERE _art_dep_emp.art_depemp_cleunik = $vl_art_depemp_cleunik";
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
$vf_c_echo=_graal_exec_requete($sql_req);
if($vf_c_echo=='ok') {$vf_c_echo=$vl_art_depemp_cleunik;} else {$vf_c_echo=-1;}
_graal_ferme_connexion();
echo $vf_c_echo;
?>
