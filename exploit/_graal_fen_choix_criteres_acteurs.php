<?php
include("_graal_header_xul.inc.php");
$vl_e_critere_cleunik=intval(fa_recup_param('critere_cleunik','0'));
$vl_e_cleunik_critere=$vl_e_critere_cleunik;
$vl_e_portee=intval(fa_recup_param('portee','0'));
$vl_e_pertinencecode=intval(fa_recup_param('per','1'));
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
switch ($vl_e_portee) {
  case '2'  : $vl_c_id_fenetre="Fen_00267";$vl_c_id_graal_inc_choix_criteres_01="Div_00242";$vl_c_id_graal_inc_criteres_acteurs_corpus_01="Div_00240";$vl_c_id_graal_inc_criteres_acteurs_choix_01="Div_00248";break; //Prospects clients
  case '4'  : $vl_c_id_fenetre="Fen_00269";$vl_c_id_graal_inc_choix_criteres_01="Div_00243";$vl_c_id_graal_inc_criteres_acteurs_corpus_01="Div_00240";$vl_c_id_graal_inc_criteres_acteurs_choix_01="Div_00248";break; //Clients
  case '8'  : $vl_c_id_fenetre="Fen_00268";$vl_c_id_graal_inc_choix_criteres_01="Div_00244";$vl_c_id_graal_inc_criteres_acteurs_corpus_01="Div_00240";$vl_c_id_graal_inc_criteres_acteurs_choix_01="Div_00248";break; //Prospects fournisseurs
  case '16' : $vl_c_id_fenetre="Fen_00270";$vl_c_id_graal_inc_choix_criteres_01="Div_00245";$vl_c_id_graal_inc_criteres_acteurs_corpus_01="Div_00240";$vl_c_id_graal_inc_criteres_acteurs_choix_01="Div_00248";break; //fournisseurs
  case '32' : $vl_c_id_fenetre="Fen_00271";$vl_c_id_graal_inc_choix_criteres_01="Div_00246";$vl_c_id_graal_inc_criteres_acteurs_corpus_01="Div_00240";$vl_c_id_graal_inc_criteres_acteurs_choix_01="Div_00248";break; //Autres acteurs
  case '64' : $vl_c_id_fenetre="Fen_00272";$vl_c_id_graal_inc_choix_criteres_01="Div_00247";$vl_c_id_graal_inc_criteres_acteurs_corpus_01="Div_00240";$vl_c_id_graal_inc_criteres_acteurs_choix_01="Div_00248";break; //Acteurs indéterminés
  default :
    fa_redirige("acces_interdit");
}
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
$vl_b_ajout=$vl_tb_droits[1];$vl_b_modif=$vl_tb_droits[2];$vl_b_suppr=$vl_tb_droits[3];$vl_b_impri=$vl_tb_droits[4];$vl_b_detai=1;
if (($vl_e_critere_cleunik==129)||($vl_e_critere_cleunik==59)||($vl_e_critere_cleunik==60)||($vl_e_critere_cleunik==67)||($vl_e_critere_cleunik==21)||($vl_e_critere_cleunik==22)||
	($vl_e_critere_cleunik==23)||($vl_e_critere_cleunik==24)||($vl_e_critere_cleunik==25)||($vl_e_critere_cleunik==71)||($vl_e_critere_cleunik==72)||($vl_e_critere_cleunik==73)||
	($vl_e_critere_cleunik==74)||($vl_e_critere_cleunik==75)) {
	$vl_b_ajout=0;	//	pas le droit d'ajouter
	$vl_b_suppr=0;	//	pas le droit de supprimer
}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_bcd_100=fa_recup_dico("bcd_100");
$vl_c_bcd_101=fa_recup_dico("bcd_101");
$vl_c_bcd_102=fa_recup_dico("bcd_102");
$vl_c_bcd_103=fa_recup_dico("bcd_103");
$vl_c_bcd_104=fa_recup_dico("bcd_104");
$vl_c_bcd_105=fa_recup_dico("bcd_105");
$vl_c_bcd_106=fa_recup_dico("bcd_106");
$vl_c_bcd_107=fa_recup_dico("bcd_107");
$vl_c_bcd_108=fa_recup_dico("bcd_108");
$vl_c_bcd_109=fa_recup_dico("bcd_109");
$vl_c_bcd_110=fa_recup_dico("bcd_110");
$vl_c_bcd_111=fa_recup_dico("bcd_111");
$vl_c_bcd_112=fa_recup_dico("bcd_112");
$vl_c_bcd_113=fa_recup_dico("bcd_113");
$vl_c_bcd_114=fa_recup_dico("bcd_114");
$vl_c_bcd_115=fa_recup_dico("bcd_115");
$vl_c_bcd_116=fa_recup_dico("bcd_116");
$vl_c_bcd_117=fa_recup_dico("bcd_117");
$vl_c_bcd_118=fa_recup_dico("bcd_118");
$vl_c_bcd_119=fa_recup_dico("bcd_119");
$vl_c_bcd_120=fa_recup_dico("bcd_120");
$vl_c_bcd_121=fa_recup_dico("bcd_121");
$vl_c_bcd_122=fa_recup_dico("bcd_122");
$vl_c_bcd_123=fa_recup_dico("bcd_123");
$vl_c_bcd_124=fa_recup_dico("bcd_124");
$vl_tb_droits_321=_graal_requete_droits_fenetre("Trait_00321",$vl_e_uti_cleunik);$vl_b_acces_321=$vl_tb_droits_321[0];
if ($vl_b_acces_321==true){
	$vl_c_context_export_00=('<menuseparator/><menuitem label="'.fa_recup_dico("Trait_00321").'" oncommand="pf06_export_excel();" class="menuitem-iconic ak05" dir="reverse"/>');
}	
if ($vl_e_pertinencecode==1) {$vl_c_codecache_criteres_acteurs_choix='false';} else {$vl_c_codecache_criteres_acteurs_choix='true';} 
$vl_tc_composants=array($vl_c_id_fenetre,$vl_c_id_graal_inc_criteres_acteurs_corpus_01,$vl_c_id_graal_inc_criteres_acteurs_choix_01);
include("_graal_header_winxul.inc.php");
echo <<<END
<window context="graal_cp00" title="$vl_c_bcd_100" id="_graal_critere_01" onload="fa_aa(this);pf_etat_fen('ini')" $c_xmlns>
$vl_c_graal_cp00
<broadcasterset><broadcaster id="broadcaster_01" /><broadcaster id="broadcaster_02" /></broadcasterset>
END;
include("js/_graal_06_choix_criteres.js.php");
include_once("js/_graal_01.js.php");
include("_graal_visites.inc.php");
include("js/_graal_02.js.php");
include("js/_graal_choix_criteres_acteurs.js.php");
echo <<<END
<popupset>
  <popup id="pop_fournis">
  <menuitem label="$vl_c_bcd_101" oncommand="pf_ouvre('110004', 1,'in','choix')" />
  <menuitem label="$vl_c_bcd_102" oncommand="pf_ouvre('110004', 2,'notin','choix')}" />
  <menuitem label="$vl_c_bcd_103" oncommand="pf_ouvre('110004', 3,'in','critere')" />
  <menuitem label="$vl_c_bcd_104" oncommand="pf_ouvre('110004', 4,'notin','critere')" />
  </popup>
</popupset>
<popupset>
  <popup id="pop_clients">
  <menuitem label="$vl_c_bcd_105" oncommand="pf_ouvre('110003', 5,'in','choix')" />
  <menuitem label="$vl_c_bcd_106" oncommand="pf_ouvre('110003', 6,'notin','choix')" />
  <menuitem label="$vl_c_bcd_107" oncommand="pf_ouvre('110003', 7,'in','critere')" />
  <menuitem label="$vl_c_bcd_108" oncommand="pf_ouvre('110003', 8,'notin','critere')" />
  </popup>
</popupset>
<popupset>
  <popup id="pop_prospects_clients">
  <menuitem label="$vl_c_bcd_109" oncommand="pf_ouvre('110001', 9,'in','choix')" />
  <menuitem label="$vl_c_bcd_110" oncommand="pf_ouvre('110001',10,'notin','choix')" />
  <menuitem label="$vl_c_bcd_111" oncommand="pf_ouvre('110001',11,'in','critere')" />
  <menuitem label="$vl_c_bcd_112" oncommand="pf_ouvre('110001',12,'notin','critere')" />
  </popup>
</popupset>
<popupset>
  <popup id="pop_prospects_fournisseurs">
  <menuitem label="$vl_c_bcd_113" oncommand="pf_ouvre('110002',13,'in','choix')" />
  <menuitem label="$vl_c_bcd_114" oncommand="pf_ouvre('110002',14,'notin','choix')" />
  <menuitem label="$vl_c_bcd_115" oncommand="pf_ouvre('110002',15,'in','critere')" />
  <menuitem label="$vl_c_bcd_116" oncommand="pf_ouvre('110002',16,'notin','critere')" />
  </popup>
</popupset>
<popupset>
  <popup id="pop_autres">
  <menuitem label="$vl_c_bcd_117" oncommand="pf_ouvre('110005',17,'in','choix')" />
  <menuitem label="$vl_c_bcd_118" oncommand="pf_ouvre('110005',18,'notin','choix')" />
  <menuitem label="$vl_c_bcd_119" oncommand="pf_ouvre('110005',19,'in','critere')" />
  <menuitem label="$vl_c_bcd_120" oncommand="pf_ouvre('110005',20,'notin','critere')" />
  </popup>
</popupset>
<popupset>
  <popup id="pop_indetermines">
  <menuitem label="$vl_c_bcd_121" oncommand="pf_ouvre('110006',21,'in','choix')" />
  <menuitem label="$vl_c_bcd_122" oncommand="pf_ouvre('110006',22,'notin','choix')" />
  <menuitem label="$vl_c_bcd_123" oncommand="pf_ouvre('110006',23,'in','critere')" />
  <menuitem label="$vl_c_bcd_124" oncommand="pf_ouvre('110006',24,'notin','critere')" />
  </popup>
</popupset>
<vbox id="box_boite_outils_xof_03" flex="1" class="overflow_01">
END;
include("_graal_inc_criteres_acteurs_corpus.php");
echo <<<END
<splitter />
<hbox flex="3">
END;
include("_graal_inc_choix_criteres_01.php");
include("_graal_inc_choix_criteres_acteurs.php");
echo <<<END
<spacer />
   <vbox >
  <vbox flex="1" id="boutons_standards"> 
END;
include("_graal_inc_boutons_01.php");
echo <<<END
   </vbox>
   </vbox>
</hbox>
</vbox>
 </window>
END;
?>
