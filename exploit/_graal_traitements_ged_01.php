<?php
include("_graal_header_xul.inc.php");
$vl_c_retour=fa_recup_param('retour','non');
$vl_c_selection=fa_recup_param('selection','non');

$vl_c_genreged=fa_recup_param('genreged','aucun');
$vl_c_quelsdocs=fa_recup_param('quelsdocs','aucun');
$vl_c_type=fa_recup_param('type','1');  //  1 Normal,2 Choix,3 Critere 
$vl_e_genreacteur=fa_recup_param('vl_e_genreacteur','tousss');
$vl_e_choix_cleunik=intval(fa_recup_param('vl_e_choix_cleunik','0'));
$vl_e_critere_cleunik=intval(fa_recup_param('vl_e_critere_cleunik','0'));
$vl_c_quoi=fa_recup_param('vl_c_quoi','');
$vl_c_enclair=fa_recup_param('vl_c_enclair','');
$vl_c_code_critere=fa_recup_param('vl_c_code_critere','');
$vl_c_code_choix=fa_recup_param('vl_c_code_choix','');
$vl_c_deno_critere=fa_recup_param('vl_c_deno_critere','');
$vl_c_deno_choix=fa_recup_param('vl_c_deno_choix','');

switch ($vl_c_quelsdocs) {
  case "tous":
    switch ($vl_c_genreged){
      case "tousss": $vl_c_id_fenetre="Fen_01004";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";$vl_c_id_inc_infos_critere_choix_01="Div_00344";break;  //  Tous les documents
    }   
    break;
  default: 
    fa_redirige("acces_interdit");
    break;
}
/*
switch ($vl_c_quelsdocs) {
  case "tous":
    switch ($vl_c_genreged){
      case "favori": $vl_c_id_fenetre="Fen_00408";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  Favoris
      case "tousss": $vl_c_id_fenetre="Fen_01004";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  Tous les documents
    }   
    break;
  case "aucun": 
    fa_redirige("acces_interdit");
    break;
  case "pseudodocs":
		$vl_c_genreged="tousss";
		$vl_c_id_fenetre="Fen_00760";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break; //  Tous les pseudos-documents
		break;
	case "notes":
    switch ($vl_c_genreged){
      case "tousss": $vl_c_id_fenetre="Fen_00589";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break; //  Toutes les notes (sélection des notes)
      case "totale": $vl_c_id_fenetre="Fen_00609";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  // la totale
      case "acteur": $vl_c_id_fenetre="Fen_00610";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  Tous les acteurs
      case "110001": $vl_c_id_fenetre="Fen_00611";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  prospects clients
      case "110002": $vl_c_id_fenetre="Fen_00612";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  prospects fournisseurs
      case "110003": $vl_c_id_fenetre="Fen_00613";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  clients
      case "110004": $vl_c_id_fenetre="Fen_00614";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  fournisseurs
      case "110005": $vl_c_id_fenetre="Fen_00615";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  autres acteurs
      case "110006": $vl_c_id_fenetre="Fen_00616";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  acteurs indéterminés
      case "110000": $vl_c_id_fenetre="Fen_00617";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  Entreprise
      case "articl": $vl_c_id_fenetre="Fen_00618";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  articles
      case "action": $vl_c_id_fenetre="Fen_00619";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  actions
      case "interl": $vl_c_id_fenetre="Fen_00620";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  tous les interlocuteurs
      case "210001": $vl_c_id_fenetre="Fen_00621";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de prospects clients
      case "210002": $vl_c_id_fenetre="Fen_00622";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de prospects fournisseurs
      case "210003": $vl_c_id_fenetre="Fen_00623";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de clients
      case "210004": $vl_c_id_fenetre="Fen_00624";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de fournisseurs
      case "210005": $vl_c_id_fenetre="Fen_00625";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de autres acteurs
      case "210006": $vl_c_id_fenetre="Fen_00626";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de acteurs indéterminés
      case "aucun": 
        fa_redirige("acces_interdit");
        break;
    }
    break;
  case "docs": 
    switch ($vl_c_genreged){
      case "tousss": $vl_c_id_fenetre="Fen_00590";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break; //  Tous les documents (sléction des documents)'
      case "acteur": $vl_c_id_fenetre="Fen_00591";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  Tous les acteurs
      case "110001": $vl_c_id_fenetre="Fen_00592";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  prospects clients
      case "110002": $vl_c_id_fenetre="Fen_00593";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  prospects fournisseurs
      case "110003": $vl_c_id_fenetre="Fen_00594";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  clients
      case "110004": $vl_c_id_fenetre="Fen_00595";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  fournisseurs
      case "110005": $vl_c_id_fenetre="Fen_00596";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  autres acteurs
      case "110006": $vl_c_id_fenetre="Fen_00597";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  acteurs indéterminés
      case "110000": $vl_c_id_fenetre="Fen_00598";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  Entreprise
      case "articl": $vl_c_id_fenetre="Fen_00599";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  articles
      case "action": $vl_c_id_fenetre="Fen_00600";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  actions
      case "interl": $vl_c_id_fenetre="Fen_00601";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  tous les interlocuteurs
      case "210001": $vl_c_id_fenetre="Fen_00602";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de prospects clients
      case "210002": $vl_c_id_fenetre="Fen_00603";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de prospects fournisseurs
      case "210003": $vl_c_id_fenetre="Fen_00604";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de clients
      case "210004": $vl_c_id_fenetre="Fen_00605";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de fournisseurs
      case "210005": $vl_c_id_fenetre="Fen_00606";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de autres acteurs
      case "210006": $vl_c_id_fenetre="Fen_00607";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  //  interlocuteurs de acteurs indéterminés
      case "totale": $vl_c_id_fenetre="Fen_00608";$vl_c_id_ged_selection="Div_00364";$id_inc_ged="Div_00363";break;  // la totale : tous les documents en vrac
      case "aucun": 
        fa_redirige("acces_interdit");
        break;
    }
    break;
}
*/
$vl_e_uti_cleunik =intval(fa_recup_session('vs_uti_cleunik','0'));
$vl_tb_droits=_graal_requete_droits_fenetre($vl_c_id_fenetre,$vl_e_uti_cleunik);if ($vl_tb_droits[0]==false) {fa_redirige("acces_interdit");}
_graal_requete_charge_varlib($vl_c_id_fenetre,$vl_e_uti_cleunik);$vl_c_graal_cp00=fa_cree_graal_cp00($vl_c_id_fenetre);
$vl_c_brs_100=fa_recup_dico("brs_100");
$vl_c_brs_101=fa_recup_dico("brs_101");
$vl_c_brs_102=fa_recup_dico("brs_102");
$vl_c_brs_103=fa_recup_dico("brs_103");
$vl_c_brs_104=fa_recup_dico("brs_104");
$vl_c_brs_105=fa_recup_dico("brs_105");
/*
 switch ($vl_c_genreged){
  case "favori": 
    $vl_tb_droits=_graal_requete_droits_fenetre("Fen_00642",$vl_e_uti_cleunik);
    if ($vl_tb_droits[0]==true) {$menu_partage='<menuitem class="menuitem-iconic ak08" label="'.$vl_c_brs_104.'" oncommand="pf_favoris_partager();" />';}
}
*/
$menu_ouvre='<menuitem label="'.$vl_c_brs_101.'" oncommand="pf07_ouvre_ged();"/>';
include("_graal_header_winxul.inc.php");
$vl_tc_composants=array($vl_c_id_ged_selection,$id_inc_ged,$vl_c_id_inc_infos_critere_choix_01);
echo <<<END
<window title="$vl_c_brs_100" context="graal_cp00" id="$vl_c_id_fenetre" onload="fa_aa(this);pf_aa_init();" onunload="pf_aa_ferme();" $c_xmlns>
$vl_c_graal_cp00
END;
include("_graal_visites.inc.php");
include_once("js/_graal_01.js.php");
include("js/_graal_ged_traitements_01.js.php");
switch ($vl_c_type) {
  case '1' : // Normal
		include("_graal_inc_ged_selection_01.php");
    break;
  case '2' : // Choix
  case '3' : // Critère
    $_graal_inc_infos_critere_choix_01="ged";
    include("_graal_inc_infos_critere_choix_01.php");
    break;
}
$vl_c_voir_doc="non";
include("_graal_inc_ged_01.php");
if ($vl_c_retour=="oui") {
  echo("<hbox>");
	echo("<button flex='1' tooltiptext ='$vl_c_brs_104' id='bt_sortir' label='$vl_c_brs_104' crop='end' dir='normal' oncommand='vf_c_renvoyer=true;pf_aa_ferme();' />");
  echo("<button flex='1' tooltiptext ='$vl_c_brs_102' id='bt_sortir' label='$vl_c_brs_102' crop='end' dir='normal' oncommand='vf_c_renvoyer=true;window.close();' />");
  echo("<button flex='1' tooltiptext ='$vl_c_brs_103' id='bt_sortir' label='$vl_c_brs_103' crop='end' dir='normal' oncommand='vf_c_renvoyer=false;window.close();' />");
  echo("</hbox>");
} else {
	echo("<hbox>");
	echo("<button flex='1' tooltiptext ='$vl_c_brs_105' id='bt_sortir' label='$vl_c_brs_105' crop='end' dir='normal' oncommand='vf_c_renvoyer=true;window.close();' />");
  echo("</hbox>");
}
echo("</window>");
?>
