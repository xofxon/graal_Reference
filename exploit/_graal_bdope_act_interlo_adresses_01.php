<?php
include("_graal_header_txt.inc.php");
$t_origines_ok=array();
$t_origines_ok[0]="_graal_fen_interlo_adresses_01";
$t_origines_ok[1]="_graal_fen_interlo_adresses_02";
fa_acces_script();
$vf_c_echo="";
$vl_e_mini=intval(fa_recup_session("borne_mini","000000000000"));
$vl_e_maxi=intval(fa_recup_session("borne_maxi","999999999999"));
$vf_c_action=fa_recup_param("vf_c_action","??????");
$vl_adr_cleunik=intval(fa_recup_param("vl_adr_cleunik",""));
$vl_int_cleunik=intval(fa_recup_param("vl_int_cleunik",""));
$vl_adr_cod=fa_recup_param("vl_adr_cod","");
$vl_act_cleunik=intval(fa_recup_param("vl_act_cleunik",""));
$vl_adr_complementnom=fa_recup_param("vl_adr_complementnom","");
$vl_adr_ligne1=fa_recup_param("vl_adr_ligne1","");
$vl_adr_ligne2=fa_recup_param("vl_adr_ligne2","");
$vl_adr_ligne3=fa_recup_param("vl_adr_ligne3","");
$vl_adr_cp=fa_recup_param("vl_adr_cp","");
$vl_adr_ville=fa_recup_param("vl_adr_ville","");
$vl_choix_cleunik=intval(fa_recup_param("vl_choix_cleunik",""));
$vl_adr_latitude=fa_floatval(fa_recup_param("vl_adr_latitude",""));
$vl_adr_longitude=fa_floatval(fa_recup_param("vl_adr_longitude",""));
$vl_adr_typecoordonnees=intval(fa_recup_param("vl_adr_typecoordonnees",""));
$vl_adr_type=intval(fa_recup_param("vl_adr_type","1"));
switch (TRUE)
{
  case $vf_c_action=="supprimer":
    $sql_req = "DELETE FROM _act_interlo_adresses WHERE _act_interlo_adresses.adr_cleunik=$vl_adr_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_adr_cleunik;} else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="ajouter":
    $vl_adr_cleunik=_graal_requete_max("adr_cleunik","_act_interlo_adresses");
    $sql_req = "INSERT INTO _act_interlo_adresses set adr_cleunik=$vl_adr_cleunik,adr_cod='$vl_adr_cod',act_cleunik=$vl_act_cleunik,int_cleunik=$vl_int_cleunik,adr_complementnom='$vl_adr_complementnom',adr_ligne1='$vl_adr_ligne1',adr_ligne2='$vl_adr_ligne2',adr_ligne3='$vl_adr_ligne3',adr_cp='$vl_adr_cp',adr_ville='$vl_adr_ville',choix_cleunik=$vl_choix_cleunik,dateheuremodif=now(),adr_latitude=$vl_adr_latitude,adr_longitude=$vl_adr_longitude,adr_typecoordonnees=$vl_adr_typecoordonnees,adr_type=$vl_adr_type";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_adr_cleunik;} else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="modifier":
    $sql_req = "UPDATE _act_interlo_adresses set adr_cod='$vl_adr_cod',adr_complementnom='$vl_adr_complementnom',adr_ligne1='$vl_adr_ligne1',adr_ligne2='$vl_adr_ligne2',adr_ligne3='$vl_adr_ligne3',adr_cp='$vl_adr_cp',adr_ville='$vl_adr_ville',choix_cleunik='$vl_choix_cleunik',dateheuremodif=Now(),adr_latitude='$vl_adr_latitude',adr_longitude='$vl_adr_longitude',adr_typecoordonnees='$vl_adr_typecoordonnees',adr_type=$vl_adr_type WHERE _act_interlo_adresses.adr_cleunik=$vl_adr_cleunik";
    $vf_c_echo=_graal_exec_requete($sql_req);
    if($vf_c_echo=='ok') {$vf_c_echo=$vl_adr_cleunik;} else {$vf_c_echo=-1;}
    break;
  case $vf_c_action=="??????":
    exit;
    break;
}
_graal_ferme_connexion();
echo $vf_c_echo;
?>
